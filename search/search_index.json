{"config": {"lang": ["en"], "separator": "[\\s\\-]+", "pipeline": ["stopWordFilter"]}, "docs": [{"location": "", "title": "Home", "text": ""}, {"location": "#welcome-to-thehive-5-documentation-website", "title": "Welcome to TheHive 5 documentation website", "text": "<p>For full documentation visit mkdocs.org.</p>"}, {"location": "cortex/", "title": "Home", "text": "Cortex : Installation, operation and user guides <p>Source Code: https://github.com/thehive-project/Cortex/</p> <p>Website: https://www.strangebee.com</p>"}, {"location": "cortex/#cortex", "title": "Cortex", "text": "<p>Cortex solves two common problems frequently encountered by SOCs, CSIRTs and security researchers in the course of threat intelligence, digital forensics and incident response:</p> <ul> <li>How to analyze observables they have collected, at scale, by querying a single tool instead of several?</li> <li>How to actively respond to threats and interact with the constituency and other teams?</li> </ul> <p>Thanks to its many analyzers and to its RESTful API, Cortex makes observable analysis a breeze, particularly if called from TheHive, the highly popular, Security Incident Response Platform (SIRP).</p> <p>TheHive can also leverage Cortex responders to perform specific actions on alerts, cases, tasks and observables collected in the course of the investigation: send an email to the constituents, block an IP address at the proxy level, notify team members that an alert needs to be taken care of urgently and much more.</p> <p>Many features are included with Cortex:</p> <ul> <li>Manage multiple organizations (i.e multi-tenancy)</li> <li>Manage users per organizations and roles</li> <li>Specify per-org analyzer &amp; responder configuration</li> <li>Define rate limits: avoid consuming all your quotas at once</li> <li>Cache: an analysis is not re-executed for the same observable if a given analyzer is called on that observable several times within a specific timespan (10 minutes by default, can be adjusted for each analyzer).</li> </ul>"}, {"location": "cortex/#installation-and-configuration-guides", "title": "Installation and configuration guides", "text": "<p>This documentation contains step-by-step installation instructions for Cortex for different operating systems as well as corresponding ZIP binary packages.</p> <p>All aspects of the configuration are also detailed in a dedicated section. s</p>"}, {"location": "cortex/#user-guides", "title": "User guides", "text": "<p>The first connection to the application requires several actions.</p> <p>Cortex supports different roles for users. Refer to User roles for more details.</p>"}, {"location": "cortex/#license", "title": "License", "text": "<p>Cortex is an open source and free software released under the AGPL (Affero General Public License). We, StrangeBee, are committed to ensure that Cortex will remain a free and open source project on the long-run.</p>"}, {"location": "cortex/#updates-and-community-discussions", "title": "Updates and community discussions", "text": "<p>Information, news and updates are regularly posted on several communication channels:</p> <p> StrangeBee Twitter account / TheHive Project Twitter account</p> <p> TheHive Project Mastodon account / StrangeBee Mastodon account</p> <p> blog at StrangeBee</p> <p> Join users community on Discord</p>"}, {"location": "cortex/#professional-support", "title": "Professional support", "text": "<p> Since 2018, Cortex is fully developed and maintained by StrangeBee. Should you need specific assistance, be aware that StrangeBee also provides professional services and support.</p>"}, {"location": "cortex/code-of-conduct/", "title": "Contributor Covenant Code of Conduct", "text": ""}, {"location": "cortex/code-of-conduct/#contributor-covenant-code-of-conduct", "title": "Contributor Covenant Code of Conduct", "text": ""}, {"location": "cortex/code-of-conduct/#our-pledge", "title": "Our Pledge", "text": "<p>In the interest of fostering an open and welcoming environment, we as contributors and maintainers pledge to making participation in our project and our community a harassment-free experience for everyone, regardless of age, body size, disability, ethnicity, gender identity and expression, level of experience, nationality, personal appearance, race, religion, or sexual identity and orientation.</p>"}, {"location": "cortex/code-of-conduct/#our-standards", "title": "Our Standards", "text": "<p>Examples of behavior that contributes to creating a positive environment include:</p> <ul> <li>Using welcoming and inclusive language</li> <li>Being respectful of differing viewpoints and experiences</li> <li>Gracefully accepting constructive criticism</li> <li>Focusing on what is best for the community</li> <li>Showing empathy towards other community members</li> </ul> <p>Examples of unacceptable behavior by participants include:</p> <ul> <li>The use of sexualized language or imagery and unwelcome sexual attention or   advances</li> <li>Trolling, insulting/derogatory comments, and personal or political attacks</li> <li>Public or private harassment</li> <li>Publishing others' private information, such as a physical or electronic   address, without explicit permission</li> <li>Other conduct which could reasonably be considered inappropriate in a   professional setting</li> </ul>"}, {"location": "cortex/code-of-conduct/#our-responsibilities", "title": "Our Responsibilities", "text": "<p>Project maintainers are responsible for clarifying the standards of acceptable behavior and are expected to take appropriate and fair corrective action in response to any instances of unacceptable behavior, in compliance with the licensing terms applying to the Project developments.</p> <p>Project maintainers have the right and responsibility to remove, edit, or reject comments, commits, code, wiki edits, issues, and other contributions that are not aligned to this Code of Conduct, or to ban temporarily or permanently any contributor for other behaviors that they deem inappropriate, threatening, offensive, or harmful. However, these actions shall respect the licensing terms of the Project Developments that will always supersede such Code of Conduct.</p>"}, {"location": "cortex/code-of-conduct/#scope", "title": "Scope", "text": "<p>This Code of Conduct applies both within project spaces and in public spaces when an individual is representing the project or its community. Examples of representing a project or community include using an official project e-mail address, posting via an official social media account, or acting as an appointed representative at an online or offline event. Representation of a project may be further defined and clarified by project maintainers.</p>"}, {"location": "cortex/code-of-conduct/#enforcement", "title": "Enforcement", "text": "<p>Instances of abusive, harassing, or otherwise unacceptable behavior may be reported by contacting the project team at support@thehive-project.org. The project team will review and investigate all complaints, and will respond in a way that it deems appropriate to the circumstances. The project team is obligated to maintain confidentiality with regard to the reporter of an incident. Further details of specific enforcement policies may be posted separately.</p> <p>Project maintainers who do not follow or enforce the Code of Conduct in good faith may face temporary or permanent repercussions as determined by other members of the project's leadership.</p>"}, {"location": "cortex/code-of-conduct/#attribution", "title": "Attribution", "text": "<p>This Code of Conduct is adapted from the Contributor Covenant, version 1.4, available at http://contributor-covenant.org/version/1/4</p> <p>This version includes a clarification to ensure that the code of conduct is in compliance with the free software licensing terms of the project.</p>"}, {"location": "cortex/api/api-guide/", "title": "API Guide", "text": ""}, {"location": "cortex/api/api-guide/#api-guide", "title": "API Guide", "text": "<p>This guide applies only to Cortex 2 and newer. It is not applicable to Cortex 1.</p>"}, {"location": "cortex/api/api-guide/#table-of-contents", "title": "Table of Contents", "text": "<ul> <li>Introduction<ul> <li>Request &amp; Response Formats</li> <li>Authentication</li> </ul> </li> <li>Organization APIs<ul> <li>Organization Model</li> <li>List</li> <li>Create an Organization</li> <li>Update an Organization</li> <li>Delete an Organization</li> <li>Obtain Details</li> <li>List Users</li> <li>List Enabled Analyzers</li> </ul> </li> <li>User APIs<ul> <li>User Model</li> <li>List All</li> <li>List Users within an Organization</li> <li>Search</li> <li>Create a User</li> <li>Update a User</li> <li>Get Details About a User</li> <li>Set a Password</li> <li>Change a password</li> <li>Set and Renew an API Key</li> <li>Get an API Key</li> <li>Revoke an API Key</li> </ul> </li> <li>Job APIs<ul> <li>Job Model</li> <li>List and Search Jobs</li> <li>Get Details About a Job</li> <li>Get Details and Report</li> <li>Wait and Get Job Report</li> <li>Get Artifacts</li> <li>Delete a Job</li> </ul> </li> <li>Analyzer APIs<ul> <li>Analyzer Model</li> <li>Enable</li> <li>List and Search</li> <li>Get Details</li> <li>Get By Type</li> <li>Update</li> <li>Run</li> <li>Disable</li> </ul> </li> <li>Miscellaneous APIs<ul> <li>Paging and Sorting</li> </ul> </li> </ul>"}, {"location": "cortex/api/api-guide/#introduction", "title": "Introduction", "text": "<p>Cortex 2 offers a REST API that can be leveraged by various applications and programs to interact with it. The following guide describe the Cortex 2 API to allow developers to interface the powerful observable analysis engine with other SIRPs (Security Incident Response Platforms) besides TheHive, TIPs (Threat Intelligence Platforms), SIEMs or scripts. Please note that the Web UI of Cortex 2 exclusively leverage the REST API to interact with the back-end.</p> <p>Note: You can use Cortex4py, the Python library we provide, to facilitate interaction with the REST API of Cortex. You need Cortex4py 2.0.0 or later as earlier versions are not compatible with Cortex 2.</p> <p>All the exposed APIs share the same request &amp; response formats and authentication strategies as described below.</p> <p>There are also some transverse parameters supported by several calls, in addition to utility APIs.</p> <p>If you want to create an analyzer, please read the How to Write and Submit an Analyzer  guide.</p>"}, {"location": "cortex/api/api-guide/#request-and-response-formats", "title": "Request and Response Formats", "text": "<p>Cortex accepts several parameter formats within a HTTP request. They can be used indifferently. Input data can be:</p> <ul> <li>A query string</li> <li>A URL-encoded form</li> <li>A multi-part</li> <li>JSON</li> </ul> <p>Hence, the requests shown below are equivalent.</p>"}, {"location": "cortex/api/api-guide/#query-string", "title": "Query String", "text": "<pre><code>curl -XPOST 'https://CORTEX_APP_URL:9001/api/login?user=me&amp;password=secret'\n</code></pre>"}, {"location": "cortex/api/api-guide/#url-encoded-form", "title": "URL-encoded Form", "text": "<pre><code>curl -XPOST 'https://CORTEX_APP_URL:9001/api/login' -d user=me -d password=secret\n</code></pre>"}, {"location": "cortex/api/api-guide/#json", "title": "JSON", "text": "<pre><code>curl -XPOST https://CORTEX_APP_URL:9001/api/login -H 'Content-Type: application/json' -d '{\n  \"user\": \"me\",\n  \"password\": \"secret\"\n}'\n</code></pre>"}, {"location": "cortex/api/api-guide/#multi-part", "title": "Multi-part", "text": "<pre><code>curl -XPOST https://CORTEX_APP_URL:9001/api/login -F '_json=&lt;-;type=application/json' &lt;&lt; _EOF_\n{\n  \"user\": \"me\",\n  \"password\": \"secret\"\n}\n_EOF_\n</code></pre>"}, {"location": "cortex/api/api-guide/#response-format", "title": "Response Format", "text": "<p>For each request submitted, Cortex will respond back with JSON data. For example, if the authentication request is successful, Cortex should return the following output:</p> <pre><code>{\"id\":\"me\",\"name\":\"me\",\"roles\":[\"read\",\"analyze\",\"orgadmin\"]}\n</code></pre> <p>If not, Cortex should return an authentication error:</p> <pre><code>{\"type\":\"AuthenticationError\",\"message\":\"Authentication failure\"}\n</code></pre>"}, {"location": "cortex/api/api-guide/#authentication", "title": "Authentication", "text": "<p>Most API calls require authentication. Credentials can be provided using a session cookie, an API key or directly using HTTP basic authentication (if this method is specifically enabled).</p> <p>Session cookies are better suited for browser authentication. Hence, we recommend authenticating with API keys when calling the Cortex APIs.</p>"}, {"location": "cortex/api/api-guide/#generating-api-keys-with-an-orgadmin-account", "title": "Generating API Keys with an orgAdmin Account", "text": "<p>API keys can be generated using the Web UI. To do so, connect using an <code>orgAdmin</code> account then click on Organization and then on the <code>Create API Key</code> button in the row corresponding to the user you intend to use for API authentication. Once the API key has been created, click on <code>Reveal</code> to display the API key then click on the copy to clipboard button if you wish to copy the key to your system's clipboard.</p> <p>If the user is not yet created, start by clicking on <code>Add user</code> to create it then follow the steps mentioned above.</p>"}, {"location": "cortex/api/api-guide/#generating-api-keys-with-a-superadmin-account", "title": "Generating API Keys with a superAdmin Account", "text": "<p>You can use a <code>superAdmin</code> account to achieve the same result as described above. Once authenticated, click on Users then on the <code>Create API Key</code> button in the row corresponding to the user you intend to use for API authentication. Please make sure the user is in the right organization by thoroughly reading its name, which is shown below the user name. Once the API key has been created, click on <code>Reveal</code> to display the API key then click on the copy to clipboard button if you wish to copy the key to your system's clipboard.</p>"}, {"location": "cortex/api/api-guide/#authenticating-with-an-api-key", "title": "Authenticating with an API Key", "text": "<p>Once you have generated an API key you can use it, for example, to list the Cortex jobs thanks to the following <code>curl</code> command:</p> <p></p><pre><code># Using API key\ncurl -H 'Authorization: Bearer **API_KEY**' https://CORTEX_APP_URL:9001/api/job\n</code></pre> As you can see in the example above, we instructed <code>curl</code> to add the Authorization header to the request. The value of the header is <code>Bearer: **API_KEY**</code>. So if your API key is <code>GPX20GUAQWwpqnhA6JpOwNGPMfWuxsX3</code>, the <code>curl</code> command above would look like the following:<p></p> <pre><code># Using API key\ncurl -H 'Authorization: Bearer GPX20GUAQWwpqnhA6JpOwNGPMfWuxsX3' https://CORTEX_APP_URL:9001/api/job\n</code></pre>"}, {"location": "cortex/api/api-guide/#using-basic-authentication", "title": "Using Basic Authentication", "text": "<p>Cortex also supports basic authentication but it is disabled by default for security reasons. If you absolutely need to use it, you can enable it by adding <code>auth.method.basic=true</code> to the configuration file (<code>/etc/cortex/application.conf</code> by default). Once you do, restart the Cortex service. You can then, for example, list the Cortex jobs using the following <code>curl</code> command:</p> <pre><code># Using basic authentication\ncurl -u mylogin:mypassword https://CORTEX_APP_URL:9001/api/job\n</code></pre>"}, {"location": "cortex/api/api-guide/#organization-apis", "title": "Organization APIs", "text": "<p>Cortex offers a set of APIs to create, update and list organizations.</p>"}, {"location": "cortex/api/api-guide/#organization-model", "title": "Organization Model", "text": "<p>An organization (org) is defined by the following attributes:</p> Attribute Description Type <code>id</code> Copy of the org's name (see next row) readonly <code>name</code> Name readonly <code>status</code> Status (<code>Active</code> or <code>Locked</code>) writable <code>description</code> Description writable <code>createdAt</code> Creation date computed <code>createdBy</code> User who created the org computed <code>updatedAt</code> Last update computed <code>updatedBy</code> User who last updated the org computed <p>Please note that <code>id</code> and <code>name</code> are essentially the same. Also, <code>createdAt</code> and <code>updatedAt</code> are in epoch.</p>"}, {"location": "cortex/api/api-guide/#list", "title": "List", "text": "<p>It is possible to list all the organizations using the following API call, which requires the API key associated with a <code>superAdmin</code> account:</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/organization'\n</code></pre> <p>You can also search/filter organizations using the following query:</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/organization/_search' -d '{\n  \"query\": {\"status\": \"Active\"}\n}'\n</code></pre> <p>Both APIs supports the <code>range</code> and <code>sort</code> query parameters described in paging and sorting details.</p>"}, {"location": "cortex/api/api-guide/#create-an-organization", "title": "Create an Organization", "text": "<p>It is possible to create an organization using the following API call, which requires the API key associated with a <code>superAdmin</code> account:</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/organization' -d '{\n  \"name\": \"demo\",\n  \"description\": \"Demo organization\",\n  \"status\": \"Active\"\n}'\n</code></pre>"}, {"location": "cortex/api/api-guide/#update-an-organization", "title": "Update an Organization", "text": "<p>You can update an organization's description and status (<code>Active</code> or <code>Locked</code>) using the following API call. This requires the API key associated with a <code>superAdmin</code> account:</p> <pre><code>curl -XPATCH -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/organization/ORG_ID' -d '{\n  \"description\": \"New Demo organization\",\n}'\n</code></pre> <p>or</p> <pre><code>curl -XPATCH -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/organization/ORG_ID' -d '{\n  \"status\": \"Active\",\n}'\n</code></pre>"}, {"location": "cortex/api/api-guide/#delete-an-organization", "title": "Delete an Organization", "text": "<p>Deleting an organization just marks it as <code>Locked</code> and doesn't remove the associated data from the DB. To \"delete\" an organization, you can use the API call shown below. It requires the API key associated with a <code>superAdmin</code> account.</p> <pre><code>curl -XDELETE -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/organization/ORG_ID'\n</code></pre>"}, {"location": "cortex/api/api-guide/#obtain-details", "title": "Obtain Details", "text": "<p>This API call returns the details of an organization as described in the Organization model section.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/organization/ORG_ID'\n</code></pre> <p>Let's assume that the organization we are seeking to obtain details about is called demo. The <code>curl</code> command would be:</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/organization/demo'\n</code></pre> <p>and it should return:</p> <pre><code>{\n  \"id\": \"demo\",\n  \"name\": \"demo\",\n  \"status\": \"Active\",\n  \"description\": \"Demo organization\",\n  \"createdAt\": 1520258040437,\n  \"createdBy\": \"superadmin\",\n  \"updatedBy\": \"superadmin\",\n  \"updatedAt\": 1522077420693\n}\n</code></pre>"}, {"location": "cortex/api/api-guide/#list-users", "title": "List Users", "text": "<p>As mentioned above, you can use the API to return the list of all the users declared withing an organization. For that purpose, use the API call shown below with the API key of an <code>orgAdmin</code> or <code>superAdmin</code> account. It supports the <code>range</code> and <code>sort</code> query parameters declared in paging and sorting details.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/organization/ORG_ID/user'\n</code></pre> <p>and should return a list of users.</p> <p>If one wants to filter/search for some users (active ones for example), there is a search API to use as below:</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/organization/ORG_ID/user/_search' -d '{\n  \"query\": {}\n}'\n</code></pre> <p>It also supports the <code>range</code> and <code>sort</code> query parameters declared in paging and sorting details.</p>"}, {"location": "cortex/api/api-guide/#list-enabled-analyzers", "title": "List Enabled Analyzers", "text": "<p>To list the analyzers that have been enabled within an organization, use the following API call with the API key of an <code>orgAdmin</code> user:</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/analyzer'\n</code></pre> <p>It should return a list of Analyzers.</p> <p>Please note that this API call does not display analyzers that are disabled. It supports the <code>range</code> and <code>sort</code> query parameters declared in paging and sorting details.</p>"}, {"location": "cortex/api/api-guide/#user-apis", "title": "User APIs", "text": "<p>The following section describes the APIs that allow creating, updating and listing users within an organization.</p>"}, {"location": "cortex/api/api-guide/#user-model", "title": "User Model", "text": "<p>A user is defined by the following attributes:</p> Attribute Description Type <code>id</code> ID/login readonly <code>name</code> Name writable <code>roles</code> Roles. Possible values are: <code>read</code>, <code>read,analyze</code>, <code>read,analyze,orgadmin</code> and <code>superadmin</code> writable <code>status</code> Status (<code>Active</code> or <code>Locked</code>) writable <code>organization</code> organization to which the user belongs (set upon account creation) readonly <code>createdAt</code> Creation date computed <code>createdBy</code> User who created the account computed <code>updatedAt</code> Last update date computed <code>updatedBy</code> User who last updated the account computed <code>hasKey</code> true when the user has an API key computed <code>hasPassword</code> true if the user has a password computed"}, {"location": "cortex/api/api-guide/#list-all", "title": "List All", "text": "<p>This API call allows a <code>superAdmin</code> to list and search all the users of all defined organizations:</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/user'\n</code></pre> <p>This call supports the <code>range</code> and <code>sort</code> query parameters declared in paging and sorting details.</p>"}, {"location": "cortex/api/api-guide/#list-users-within-an-organization", "title": "List Users within an Organization", "text": "<p>This call is described in organization APIs.</p>"}, {"location": "cortex/api/api-guide/#search", "title": "Search", "text": "<p>This API call allows a <code>superAdmin</code> to perform search on the user accounts created in a Cortex instance:</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/user/_search' -d '{\n  \"query\": {}\n}'\n</code></pre> <p>This call supports the <code>range</code> and <code>sort</code> query parameters declared in paging and sorting details</p>"}, {"location": "cortex/api/api-guide/#create-a-user", "title": "Create a User", "text": "<p>This API calls allows you to programmatically create user creation. If the call is made by a <code>superAdmin</code> user, the request must specify the organization to which the user belong in the <code>organization</code> field.</p> <p>If the call is made by an <code>orgAdmin</code> user, the value of <code>organization</code> field must be the same as the user who makes the call: <code>orgAdmin</code> users are allowed to create users only in their organization.</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/user' -d '{\n  \"name\": \"Demo org Admin\",\n  \"roles\": [\n    \"read\",\n    \"analyze\",\n    \"orgadmin\"\n  ],\n  \"organization\": \"demo\",\n  \"login\": \"demo\"\n}'\n</code></pre> <p>If successful, the call returns a JSON object representing the created user as described above.</p> <pre><code>{\n  \"id\": \"demo\",\n  \"organization\": \"demo\",\n  \"name\": \"Demo org Admin\",\n  \"roles\": [\n    \"read\",\n    \"analyze\",\n    \"orgadmin\"\n  ],\n  \"status\": \"Ok\",\n  \"createdAt\": 1526050123286,\n  \"createdBy\": \"superadmin\",\n  \"hasKey\": false,\n  \"hasPassword\": false\n}\n</code></pre>"}, {"location": "cortex/api/api-guide/#update-a-user", "title": "Update a User", "text": "<p>This API call allows updating the writable attributed of a user account. It's available to users with <code>superAdmin</code> or <code>orgAdmin</code> roles. Any user can also use it to update their own information (but obviously not their roles).</p> <pre><code>curl -XPATCH -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/user/USER_LOGIN' -d '{\n  \"name\": \"John Doe\",\n  \"roles\": [\n    \"read\",\n    \"analyze\"\n  ],\n  \"status\": \"Locked\"\n}'\n</code></pre> <p>It returns a JSON object representing the updated user as described above.</p>"}, {"location": "cortex/api/api-guide/#get-details-about-a-user", "title": "Get Details About a User", "text": "<p>This call returns the user details. It's available to users with <code>superAdmin</code> roles and to users in the same organization. Every user can also use it to read their own details.</p> <p></p><pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/user/USER_LOGIN'\n</code></pre> It returns a JSON object representing the user as described previously.<p></p>"}, {"location": "cortex/api/api-guide/#set-a-password", "title": "Set a Password", "text": "<p>This call sets the user's password. It's available to users with <code>superAdmin</code> or <code>orgAdmin</code> roles. Please note that the request needs to be made using HTTPS with a valid certificate on the server's end to prevent credential sniffing or other PITM (Person-In-The-Middle) attacks.</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/user/USER_LOGIN/password/set' -d '{\n  \"password\": \"SOMEPASSWORD\"\n}'\n</code></pre> <p>If successful, the call returns 204 (success / no content).</p>"}, {"location": "cortex/api/api-guide/#change-a-password", "title": "Change a password", "text": "<p>This call allows a given user to change only their own existing password. It is available to all users including <code>superAdmin</code> and <code>orgAdmin</code> ones. Please note that if a <code>superAdmin</code> or an <code>orgAdmin</code> needs to update the password of another user, they must use the <code>/password/set</code> call described in the previous subsection.</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/user/USER_LOGIN/password/change' -d '{\n  \"currentPassword\": \"password\",\n  \"password\": \"new-password\"\n}'\n</code></pre> <p>If successful, the call returns 204 (success / no content).</p>"}, {"location": "cortex/api/api-guide/#set-and-renew-an-api-key", "title": "Set and Renew an API Key", "text": "<p>This calls allows setting and renewing the API key of a user. It's available to users with <code>superAdmin</code> or <code>orgAdmin</code> roles. Any user can also use it to renew their own API key. Again, the request needs to be made using HTTPS with a valid certificate on the server's end to prevent credential sniffing or other PITM (Person-In-The-Middle) attacks. You know the drill ;-)</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/user/USER_LOGIN/key/renew'\n</code></pre> <p>If successful, it returns the generated API key in a <code>text/plain</code>response.</p>"}, {"location": "cortex/api/api-guide/#get-an-api-key", "title": "Get an API Key", "text": "<p>This calls allows getting a user's API key. It's available to users with <code>superAdmin</code> or <code>orgAdmin</code> roles. Any user can also use it to obtain their own API key.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/user/USER_LOGIN/key'\n</code></pre> <p>If successful, the generated API key is returned in <code>text/plain</code>response</p>"}, {"location": "cortex/api/api-guide/#revoke-an-api-key", "title": "Revoke an API Key", "text": "<p>This calls allow revoking a user's API key. This calls allow revoking a user's API key.</p> <pre><code>curl -XDELETE -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/user/USER_LOGIN/key'\n</code></pre> <p>A successful request returns nothing (HTTP 200 OK).</p>"}, {"location": "cortex/api/api-guide/#job-apis", "title": "Job APIs", "text": "<p>The following section describes the APIs that allow manipulating jobs. Jobs are basically submissions made to analyzers and the resulting reports.</p>"}, {"location": "cortex/api/api-guide/#job-model", "title": "Job Model", "text": "<p>A job is defined by the following attributes:</p> Attribute Description Type <code>id</code> Job ID computed <code>organization</code> The organization to which the job belongs readonly <code>analyzerDefinitionId</code> Analyzer definition name readonly <code>analyzerId</code> Instance ID of the analyzer to which the job is associated readonly <code>organization</code> Organization to which the user belongs (set upon account creation) readonly <code>analyzerName</code> Name of the analyzer to which the job is associated readonly <code>dataType</code> the datatype of the analyzed observable readonly <code>status</code> Status of the job (<code>Waiting</code>, <code>InProgress</code>, <code>Success</code>, <code>Failure</code>, <code>Deleted</code>) computed <code>data</code> Value of the analyzed observable (does not apply to <code>file</code> observables) readonly <code>attachment</code> JSON object representing <code>file</code> observables (does not apply to non-<code>file</code> observables). It  defines the<code>name</code>, <code>hashes</code>, <code>size</code>, <code>contentType</code> and <code>id</code> of the <code>file</code> observable readonly <code>parameters</code> JSON object of key/value pairs set during job creation readonly <code>message</code> A free text field to set additional text/context for a job readonly <code>tlp</code> The TLP of the analyzed observable readonly <code>startDate</code> Start date computed <code>endDate</code> End date computed <code>createdAt</code> Creation date. Please note that a job can be requested but not immediately honored. The actual time at which it is started is the value of <code>startDate</code> computed <code>createdBy</code> User who created the job computed <code>updatedAt</code> Last update date (only Cortex updates a job when it finishes) computed <code>updatedBy</code> User who submitted the job and which identity is used by Cortex to update the job once it is finished computed"}, {"location": "cortex/api/api-guide/#list-and-search-jobs", "title": "List and Search Jobs", "text": "<p>This call allows a user with <code>read</code>,<code>analyze</code> or <code>orgAdmin</code> role to list and search all the analysis jobs made by their organization.</p> <p>If you want to list all the jobs: </p><pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/_search?range=all'\n</code></pre><p></p> <p>If you want to list 10 jobs: </p><pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/_search'\n</code></pre><p></p> <p>If you want to list 100 jobs: </p><pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/_search?range=0-100'\n</code></pre><p></p> <p>If you want to search jobs according to various criteria: </p><pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/job/_search' -d '{\n  \"query\": {\n    \"_and\": [\n      {\"status\": \"Success\"},\n      {\"dataType\": \"ip\"}\n    ]\n  }\n}'\n</code></pre><p></p> <p>This call supports the <code>range</code> and <code>sort</code> query parameters declared in paging and sorting details</p>"}, {"location": "cortex/api/api-guide/#get-details", "title": "Get Details", "text": "<p>This call allows a user with <code>read</code>,<code>analyze</code> or <code>orgAdmin</code> role to get the details of a job. It does not fetch the job report.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/JOB_ID'\n</code></pre> <p>It returns a JSON response with the following structure:</p> <pre><code>{\n  \"id\": \"AWNei4vH3rJ8unegCPB9\",\n  \"analyzerDefinitionId\": \"Abuse_Finder_2_0\",\n  \"analyzerId\": \"220483fde9608c580fb6a2508ff3d2d3\",\n  \"analyzerName\": \"Abuse_Finder_2_0\",\n  \"status\": \"Success\",\n  \"data\": \"8.8.8.8\",\n  \"parameters\": \"{}\",\n  \"tlp\": 0,\n  \"message\": \"\",\n  \"dataType\": \"ip\",\n  \"organization\": \"demo\",\n  \"startDate\": 1526299593923,\n  \"endDate\": 1526299597064,\n  \"date\": 1526299593633,\n  \"createdAt\": 1526299593633,\n  \"createdBy\": \"demo\",\n  \"updatedAt\": 1526299597066,\n  \"updatedBy\": \"demo\"\n}\n</code></pre>"}, {"location": "cortex/api/api-guide/#get-details-and-report", "title": "Get Details and Report", "text": "<p>This call allows a user with <code>read</code>,<code>analyze</code> or <code>orgAdmin</code> role to get the details of a job including its report.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/JOB_ID/report'\n</code></pre> <p>It returns a JSON response with the structure below. If the job is not yet completed, the <code>report</code> field contains a string representing the job status:</p> <pre><code>{\n  \"id\": \"AWNei4vH3rJ8unegCPB9\",\n  \"analyzerDefinitionId\": \"Abuse_Finder_2_0\",\n  \"analyzerId\": \"220483fde9608c580fb6a2508ff3d2d3\",\n  \"analyzerName\": \"Abuse_Finder_2_0\",\n  \"status\": \"Success\",\n  \"data\": \"8.8.8.8\",\n  \"parameters\": \"{}\",\n  \"tlp\": 0,\n  \"message\": \"\",\n  \"dataType\": \"ip\",\n  \"organization\": \"demo\",\n  \"startDate\": 1526299593923,\n  \"endDate\": 1526299597064,\n  \"date\": 1526299593633,\n  \"createdAt\": 1526299593633,\n  \"createdBy\": \"demo\",\n  \"updatedAt\": 1526299597066,\n  \"updatedBy\": \"demo\",\n  \"report\": {\n    \"summary\": {\n      \"taxonomies\": [\n        {\n          \"predicate\": \"Address\",\n          \"namespace\": \"Abuse_Finder\",\n          \"value\": \"network-abuse@google.com\",\n          \"level\": \"info\"\n        }\n      ]\n    },\n    \"full\": {\n      \"abuse_finder\": {\n        \"raw\": \"...\",\n        \"abuse\": [\n          \"network-abuse@google.com\"\n        ],\n        \"names\": [\n          \"Google LLC\",\n          \"Level 3 Parent, LLC\"\n        ],\n        \"value\": \"8.8.8.8\"\n      }\n    },\n    \"success\": true,\n    \"artifacts\": []\n  }\n}\n</code></pre>"}, {"location": "cortex/api/api-guide/#wait-and-get-job-report", "title": "Wait and Get Job Report", "text": "<p>This call is similar the one described above but allows the user to provide a timeout to wait for the report in case it is not available at the time the query was made:</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/JOB_ID/waitreport?atMost=1minute'\n</code></pre> <p>The <code>atMost</code> is a duration using the format <code>Xhour</code>, <code>Xminute</code> or <code>Xsecond</code>.</p>"}, {"location": "cortex/api/api-guide/#get-artifacts", "title": "Get Artifacts", "text": "<p>This call allows a user with <code>read</code>,<code>analyze</code> or <code>orgAdmin</code> role to get the extracted artifacts from a job if such extraction has been enabled in the corresponding analyzer configuration. Please note that extraction is imperfect and you might have inconsistent or incorrect data.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/JOB_ID/artifacts'\n</code></pre> <p>It returns a JSON array with the following structure:</p> <pre><code>[\n  {\n    \"dataType\": \"ip\",\n    \"createdBy\": \"demo\",\n    \"data\": \"8.8.8.8\",\n    \"tlp\": 0,\n    \"createdAt\": 1525432900553,\n    \"id\": \"AWMq4tvLjidKq_asiwcl\"\n  }\n]\n</code></pre>"}, {"location": "cortex/api/api-guide/#delete-a-job", "title": "Delete a Job", "text": "<p>This API allows a user with <code>analyze</code> or <code>orgAdmin</code> role to delete a job:</p> <pre><code>curl -XDELETE -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/job/JOB_ID'\n</code></pre> <p>This marks the job as <code>Deleted</code>. However the job's data is not removed from the  database.</p>"}, {"location": "cortex/api/api-guide/#analyzer-apis", "title": "Analyzer APIs", "text": "<p>The following section describes the APIs that allow manipulating analyzers.</p>"}, {"location": "cortex/api/api-guide/#analyzer-model", "title": "Analyzer Model", "text": "<p>An analyzer is defined by the following attributes:</p> Attribute Description Type <code>id</code> Analyzer ID once enabled within an organization readonly <code>analyzerDefinitionId</code> Analyzer definition name readonly <code>name</code> Name of the analyzer readonly <code>version</code> Version of the analyzer readonly <code>description</code> Description of the analyzer readonly <code>author</code> Author of the analyzer readonly <code>url</code> URL where the analyzer has been published readonly <code>license</code> License of the analyzer readonly <code>dataTypeList</code> Allowed datatypes readonly <code>baseConfig</code> Base configuration name. This identifies the shared set of configuration with all the analyzer's flavors readonly <code>jobCache</code> Report cache timeout in minutes, visible for <code>orgAdmin</code> users only writable <code>rate</code> Numeric amount of analyzer calls authorized for the specified <code>rateUnit</code>, visible for <code>orgAdmin</code> users only writable <code>rateUnit</code> Period of availability of the rate limite: <code>Day</code> or <code>Month</code>, visible for <code>orgAdmin</code> users only writable <code>configuration</code> A JSON object where key/value pairs represent the config names, and their values. It includes the default properties <code>proxy_http</code>, <code>proxy_https</code>, <code>auto_extract_artifacts</code>, <code>check_tlp</code>, and <code>max_tlp</code>, visible for <code>orgAdmin</code> users only writable <code>createdBy</code> User who enabled the analyzer computed <code>updatedAt</code> Last update date computed <code>updatedBy</code> User who last updated the analyzer computed"}, {"location": "cortex/api/api-guide/#enable", "title": "Enable", "text": "<p>This call allows a user with an <code>orgAdmin</code> role to enable an analyzer.</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/organization/analyzer/:analyzerId' -d '{\n  \"name\": \"Censys_1_0\",\n  \"configuration\": {\n    \"uid\": \"XXXX\",\n    \"key\": \"XXXXXXXXXXXXXXXXXXXX\",\n    \"proxy_http\": \"http://proxy:9999\",\n    \"proxy_https\": \"http://proxy:9999\",\n    \"auto_extract_artifacts\": false,\n    \"check_tlp\": true,\n    \"max_tlp\": 2\n  },\n  \"rate\": 1000,\n  \"rateUnit\": \"Day\",\n  \"jobCache\": 5\n}'\n</code></pre>"}, {"location": "cortex/api/api-guide/#list-and-search", "title": "List and Search", "text": "<p>These calls allow a user with a <code>analyze</code> or <code>orgAdmin</code> role to list and search all the enabled analyzers within the organization.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/analyzer'\n</code></pre> <p>or</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/analyzer/_search' -d '{\n  \"query\": {}\n}'\n</code></pre> <p>Both calls supports the <code>range</code> and <code>sort</code> query parameters declared in paging and sorting details, and both return a JSON array of analyzer objects as described in Analyzer Model section.</p> <p>If called by a user with only an <code>nalyzer</code> role, the <code>configuration</code> attribute is not included on the JSON objects.</p>"}, {"location": "cortex/api/api-guide/#get-details-about-a-job", "title": "Get Details About a Job", "text": "<p>This call allows a user with a <code>analyze</code> or <code>orgAdmin</code> role to get an analyzer's details.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/analyzer/ANALYZER_ID'\n</code></pre> <p>It returns a analyzer JSON object as described in Analyzer Model section.</p> <p>If called by a user with only an <code>nalyzer</code> role, the <code>configuration</code> attribute is not included on the JSON objects.</p>"}, {"location": "cortex/api/api-guide/#get-by-type", "title": "Get By Type", "text": "<p>This call is mostly used by TheHive and allows to quickly get the list of analyzers that can run on the given datatype. It requires an <code>analyze</code> or <code>orgAdmin</code> role.</p> <pre><code>curl -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/analyzer/type/DATA_TYPE'\n</code></pre> <p>It returns a JSON array of analyzer objects as described in Analyzer Model section without the <code>configuration</code> attribute, which could contain sensitive data.</p>"}, {"location": "cortex/api/api-guide/#update", "title": "Update", "text": "<p>This call allows an <code>orgAdmin</code> user to update the <code>name</code>, <code>configuration</code> and <code>jobCache</code> of an enabled analyzer.</p> <pre><code>curl -XPATCH -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/analyzer/ANALYZER_ID' -d '{\n  \"configuration\": {\n    \"key\": \"XXXXXXXXXXXXXXXXXXXXXXXXXXXX\",\n    \"polling_interval\": 60,\n    \"proxy_http\": \"http://localhost:8080\",\n    \"proxy_https\": \"http://localhost:8080\",\n    \"auto_extract_artifacts\": true,\n    \"check_tlp\": true,\n    \"max_tlp\": 1\n  },\n  \"name\": \"Shodan_Host_1_0\",\n  \"rate\": 1000,\n  \"rateUnit\": \"Day\",\n  \"jobCache\": null\n}'\n</code></pre> <p>It returns a JSON object describing the analyzer as defined in Analyzer Model section.</p>"}, {"location": "cortex/api/api-guide/#run", "title": "Run", "text": "<p>This API allows a user with a <code>analyze</code> or <code>orgAdmin</code> role to run analyzers on observables of different datatypes.</p> <p>For <code>file</code> observables, the API call must be made as described below:</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/analyzer/ANALYZER_ID/run' \\\n  -F 'attachment=@/path/to/observable-file' \\\n  -F '_json=&lt;-;type=application/json' &lt;&lt; _EOF_\n  {\n    \"dataType\":\"file\",\n    \"tlp\":0\n  }\n_EOF_\n</code></pre> <p>for all the other types of observerables, the request is:</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/analyzer/ANALYZER_ID/run' -d '{\n  \"data\":\"8.8.8.8\",\n  \"dataType\":\"ip\",\n  \"tlp\":0,\n  \"message\": \"A message that can be accessed from the analyzer\",\n  \"parameters\": {\n    \"key1\": \"value1\",\n    \"key2\": \"value2\"\n  }\n}'\n</code></pre> <p>This call will fetch a similar job from the cache, and if it finds one, it returns it from the cache, based on the duration defined in <code>jobCache</code> attribute of the analyzer.</p> <p>To force bypassing the cache, one can add the following query parameter: <code>force=1</code></p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'https://CORTEX_APP_URL:9001/api/analyzer/ANALYZER_ID/run?force=1' -d '{\n  \"data\":\"8.8.8.8\",\n  \"dataType\":\"ip\",\n  \"tlp\":0,\n  \"message\": \"A message that can be accessed from the analyzer\",\n  \"parameters\": {\n    \"key1\": \"value1\",\n    \"key2\": \"value2\"\n  }\n}'\n</code></pre>"}, {"location": "cortex/api/api-guide/#disable", "title": "Disable", "text": "<p>This API allows an <code>orgAdmin</code> to disable an existing analyzer in their organization and delete the corresponding configuration.</p> <pre><code>curl -XDELETE -H 'Authorization: Bearer **API_KEY**' 'https://CORTEX_APP_URL:9001/api/analyzer/ANALYZER_ID'\n</code></pre>"}, {"location": "cortex/api/api-guide/#miscellaneous-apis", "title": "Miscellaneous APIs", "text": ""}, {"location": "cortex/api/api-guide/#paging-and-sorting", "title": "Paging and Sorting", "text": "<p>All the <code>search</code> API calls allow sorting and paging parameters, in addition to a query in the request's body. These calls usually have URLs ending with the <code>_search</code> keyword but that's not always the case.</p> <p>The followings are query parameters:</p> <ul> <li><code>range</code>: <code>all</code> or <code>x-y</code> where <code>x</code> and <code>y</code> are numbers (ex: 0-10).</li> <li><code>sort</code>: you can provide multiple sort criteria such as: <code>-createdAt</code> or <code>+status</code>.</li> </ul> <p>Example:</p> <pre><code>curl -XPOST -H 'Authorization: Bearer **API_KEY**' -H 'Content-Type: application/json' 'http://CORTEX_APP_URL:9001/api/organization/ORG_ID/user?range=0-10&amp;sort=-createdAt&amp;sort=+status' -d '{\n  \"query\": {}\n}'\n</code></pre>"}, {"location": "cortex/api/how-to-create-a-responder/", "title": "How to create a Responder", "text": ""}, {"location": "cortex/api/how-to-create-a-responder/#write-and-submit-a-responder", "title": "Write and Submit a Responder", "text": ""}, {"location": "cortex/api/how-to-create-a-responder/#table-of-contents", "title": "Table of Contents", "text": "<ul> <li>Writing a Responder<ul> <li>The Program</li> <li>Service Interaction Files (Flavors)</li> <li>Python Requirements</li> <li>Example: Mailer Responder Files</li> <li>Input</li> <li>Service Interaction Configuration Items</li> <li>Output</li> <li>The Cortexutils Python Library</li> </ul> </li> <li>Submitting a Responder<ul> <li>Check Existing Issues</li> <li>Open an Issue</li> <li>Review your Service Interaction File(s)</li> <li>Provide the List of Requirements</li> <li>Verify Execution</li> <li>Create a Pull Request</li> </ul> </li> <li>Need Help?</li> </ul>"}, {"location": "cortex/api/how-to-create-a-responder/#writing-a-responder", "title": "Writing a Responder", "text": "<p>A responder is a program that takes JSON input and do an action and produces a basic result of that action. Responders are very similar to analyzers though they have different purposes. Responders are made of at least 2 types of files:</p> <ul> <li>The program itself</li> <li>One or several service interaction files or flavors</li> <li>A Python requirements file, which is only necessary if the responder is written in Python.</li> </ul>"}, {"location": "cortex/api/how-to-create-a-responder/#the-program", "title": "The Program", "text": "<p>The first type of files a responder is made of is the core program that performs actions. It can be written in any programming language that is supported by Linux.</p> <p>you can write your responders in Python, Ruby, Perl or even Scala. However, the very handy <code>Cortexutils</code> library described below is in Python. It greatly facilitates responder development and it also provides some methods to quickly format the output to make it compliant with the JSON schema expected by TheHive.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#service-interaction-files-flavors", "title": "Service Interaction Files (Flavors)", "text": "<p>A responder must have at least one service interaction file. Such files contain key configuration information such as the responder's author information, the datatypes (<code>thehive:case</code>, <code>thehive:alert</code>, ...) the responder accepts as input and to which it applies to if used from TheHive, the TLP and PAP (or Permissible Actions Protocol) above which it will refuse to execute to protect against data leakage and to enforce sane OPSEC practices and so on.</p> <p>A responder can have two or more service interaction files to allow it to perform different actions.  We speak then of flavors. For example, a Mailer responder can send message using several body templates.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#python-requirements", "title": "Python Requirements", "text": "<p>If the responder is written in Python, a <code>requirements.txt</code> must be provided with the list of all the dependencies.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#example-mailer-responder-files", "title": "Example: Mailer Responder Files", "text": "<p>Below is a directory listing of the files corresponding to a Mailer responder.</p> <pre><code>responders/Mailer\n|-- Mailer.json\n|-- requirements.txt\n`-- mailer.py\n</code></pre>"}, {"location": "cortex/api/how-to-create-a-responder/#input", "title": "Input", "text": "<p>The input of a responder can be any JSON data, even a simple string. The submitter must send data with the structure expected by the program. The acceptable datatypes described in the Service Interaction files indicate what kind of data is expected. For example, if the program requires a <code>thehive:case</code> (i.e. it applies at the case level in TheHive), input must comply with TheHive case. Below an example of <code>thehive:case</code> input.</p> <pre><code>    {\n        \"data\": {\n        \"updatedAt\": 1606230814019,\n        \"tlp\": 2,\n        \"endDate\": 1606230814019,\n        \"description\": \"Case Description\",\n        \"tags\": [\n            \"tag\"\n        ],\n        \"caseId\": 157,\n        \"customFields\": {},\n        \"pap\": 2,\n        \"status\": \"Open\",\n        \"resolutionStatus\": \"Indeterminate\",\n        \"createdAt\": 1606183201646,\n        \"createdBy\": \"user\",\n        \"flag\": false,\n        \"severity\": 2,\n        \"metrics\": {},\n        \"owner\": \"user\",\n        \"title\": \"Title\",\n        \"updatedBy\": \"user\",\n        \"startDate\": 1606183201000,\n        \"impactStatus\": \"NotApplicable\",\n        \"_type\": \"case\",\n        \"_routing\": \"iwD693UBlJefU8pMrqOq\",\n        \"_parent\": null,\n        \"_id\": \"iwD693UBlJefU8pMrqOq\",\n        \"_seqNo\": 4572,\n        \"_primaryTerm\": 48,\n        \"id\": \"iwD693UBlJefU8pMrqOq\"\n        },\n        \"dataType\": \"thehive:case\",\n        \"tlp\": 2,\n        \"pap\": 2,\n        \"message\": \"\",\n        \"parameters\": {\n        \"user\": \"user\"\n        },\n        \"config\": {\n        \"proxy_https\": null,\n        \"cacerts\": null,\n        \"max_pap\": 2,\n        \"jobTimeout\": 30,\n        \"api_key\": \"3bDBUb7EL409MHOmXBkqsysZ1vpTab1Q\",\n        \"check_tlp\": true,\n        \"proxy_http\": null,\n        \"max_tlp\": 2,\n        \"url\": \"configured_url\",\n        \"check_pap\": true\n        }\n    }\n</code></pre> <p>In the addition to the input (<code>data</code> section) sent by the submitter, Cortex adds the <code>config</code> section which is the responder's specific configuration provided by an <code>orgAdmin</code> user when the responder is enabled in the Cortex UI. </p>"}, {"location": "cortex/api/how-to-create-a-responder/#example-service-interaction-file-for-the-mailer-responder", "title": "Example: Service Interaction File for the Mailer Responder", "text": "<p>The <code>&lt;==</code> sign and anything after it are comments that do no appear in the original file. </p><pre><code>{\n  \"name\": \"Mailer\",\n  \"version\": \"1.0\",\n  \"author\": \"CERT-BDF\",\n  \"url\": \"https://github.com/TheHive-Project/Cortex-Analyzers\",\n  \"license\": \"AGPL-V3\",\n  \"description\": \"Send an email with information from a TheHive case or alert\",\n  \"dataTypeList\": [\"thehive:case\", \"thehive:alert\", \"thehive:case_task\"],\n  \"command\": \"Mailer/mailer.py\",\n  \"baseConfig\": \"Mailer\",\n  \"configurationItems\": [\n    {\n      \"name\": \"from\",\n      \"description\": \"email address from which the mail is send\",\n      \"type\": \"string\", &lt;== defines what kind of data type the configuration item is (string, number)\n      \"multi\": false, &lt;== setting multi to true allows to pass a list of items\n      \"required\": true\n    },\n    {\n      \"name\": \"smtp_host\",\n      \"description\": \"SMTP server used to send mail\",\n      \"type\": \"string\",\n      \"multi\": false,\n      \"required\": true,\n      \"defaultValue\": \"localhost\"\n    },\n    {\n      \"name\": \"smtp_port\",\n      \"description\": \"SMTP server port\",\n      \"type\": \"number\",\n      \"multi\": false,\n      \"required\": true,\n      \"defaultValue\": 25\n    },\n    {\n      \"name\": \"smtp_user\",\n      \"description\": \"SMTP server user\",\n      \"type\": \"string\",\n      \"multi\": false,\n      \"required\": false,\n      \"defaultValue\": \"user\"\n    },\n    {\n      \"name\": \"smtp_pwd\",\n      \"description\": \"SMTP server password\",\n      \"type\": \"string\",\n      \"multi\": false,\n      \"required\": false,\n      \"defaultValue\": \"pwd\"\n    }\n  ]\n}\n</code></pre><p></p>"}, {"location": "cortex/api/how-to-create-a-responder/#service-interaction-configuration-items", "title": "Service Interaction Configuration Items", "text": ""}, {"location": "cortex/api/how-to-create-a-responder/#name", "title": "name", "text": "<p>Name of the specific service (or flavor) of the responder.</p> <p>If your responder has only one service interaction (i.e. performs only one action), it is the name of the responder's directory.</p> <p>If your responder performs several actions (i.e. comes in several flavors), you have to give a specific and meaningful name to each flavor.</p> <p>Each flavor's name appear in TheHive responder list and in MISP when you use Cortex for attribute enrichment.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#version", "title": "version", "text": "<p>The version of the responder.</p> <p>You must increase major version numbers when new features are added, modifications are made to take into account API changes, report output is modified or when report templates (more on this later) are updated.</p> <p>You must increase minor version numbers when bugs are fixed.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#author", "title": "author", "text": "<p>You must provide your full name and/or your organization/team name when submitting a responder. Pseudos are not accepted. If you'd rather remain anonymous, please contact us at support@thehive-project.org prior to submitting your responder.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#url", "title": "url", "text": "<p>The URL where the responder is stored. This should ideally be <code>https://github.com/TheHive-Project/Cortex-Analyzers</code></p>"}, {"location": "cortex/api/how-to-create-a-responder/#license", "title": "license", "text": "<p>The license of the code. Ideally, we recommend using the AGPL-v3 license.</p> <p>Make sure your code's license is compatible with the license(s) of the various components and libraries you use if applicable.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#description", "title": "description", "text": "<p>Description of the responder. Please be concise and clear. The description is  shown in the Cortex UI and TheHive.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#datatypelist", "title": "dataTypeList", "text": "<p>The list of TheHive datatypes supported by the responder. Currently TheHive accepts the following datatypes:</p> <ul> <li><code>thehive:case</code></li> <li><code>thehive:case_artifact</code> (i.e. observable)</li> <li><code>thehive:alert</code></li> <li><code>thehive:case_task</code></li> <li><code>thehive:case_task_log</code> (i.e. task log)</li> </ul>"}, {"location": "cortex/api/how-to-create-a-responder/#baseconfig", "title": "baseConfig", "text": "<p>Name used to group configuration items common to several responders. This prevent the user to enter the same API key for all responder flavors. The Cortex responder config page group configuration items by their <code>baseConfig</code>.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#config", "title": "config", "text": "<p>Configuration dedicated to the responder's flavor. This is where we  typically specify the TLP level of observables allowed to be analyzed with the  <code>check_tlp</code> and <code>max_tlp</code> parameters. For example, if <code>max_tlp</code> is set to <code>2</code> (TLP:AMBER), TLP:RED observables cannot be analyzed.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#max_tlp", "title": "max_tlp", "text": "<p>The TLP level above which the responder must not be executed.</p> TLP max_tlp value Unknown -1 WHITE 0 GREEN 1 AMBER 2 RED 3"}, {"location": "cortex/api/how-to-create-a-responder/#check_tlp", "title": "check_tlp", "text": "<p>This is a boolean parameter. When <code>true</code>, <code>max_tlp</code> is checked. And if the input's TLP is above <code>max_tlp</code>, the responder is not executed.</p> <p>For consistency reasons, we do recommend setting both <code>check_tlp</code> and <code>max_tlp</code> even if <code>check_tlp</code> is set to <code>false</code>.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#max_pap", "title": "max_pap", "text": "<p>The PAP level above which the responder must not be executed.</p> TLP max_tlp value Unknown -1 WHITE 0 GREEN 1 AMBER 2 RED 3"}, {"location": "cortex/api/how-to-create-a-responder/#check_pap", "title": "check_pap", "text": "<p>This is a boolean parameter. When <code>true</code>, <code>max_pap</code> is checked. And if the input's PAP is above <code>max_pap</code>, the responder is not executed.</p> <p>For consistency reasons, we do recommend setting both <code>check_pap</code> and <code>max_pap</code> even if <code>check_pap</code> is set to <code>false</code>.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#command", "title": "command", "text": "<p>The command used to run the responder. That's typically the full, absolute path to the main program file.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#configurationitems", "title": "configurationItems", "text": "<p>The list of configurationItems is necessary in order to be able to set all configuration variables for responders directly in the Cortex 2 user interface. As in the VirusTotal example above can be seen, every item is a json object that defines: - name (string) - description (string) - type (string) - multi (boolean) - required (boolean) - defaultValue (according to type, optional)</p> <p>The <code>multi</code> parameter allows to pass a list as configuration variable instead of a single string or number. This is used e.g. in the MISP responder that queries multiple servers in one run and needs different parameters for that.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#output", "title": "Output", "text": "<p>The output of a responder depends on the success or failure of its execution.</p> <p>If the responder fails to execute:</p> <pre><code>{\n    \"success\": false,\n    \"errorMessage\":\"..\"\n}\n</code></pre> <ul> <li>When <code>success</code> is set to <code>false</code>, it indicates that something went wrong     during the execution.</li> <li><code>errorMessage</code> is free text - typically the error output message.</li> </ul> <p>If the responder succeeds (i.e. it runs without any error):</p> <pre><code>{\n    \"success\":true,\n    \"full\":{ \"message\": \"..\" },\n    \"operations\":[]\n}\n</code></pre> <ul> <li>When <code>success</code> is set to <code>true</code>, it indicates that the responder ran     successfully.</li> <li><code>full</code> is the full report of the responder. It must contain at least     a message.</li> <li><code>operations</code> is a list what the submitter system should execute.     As of version 3.1.0, TheHive accepts the following operations:<ul> <li><code>AddTagToArtifact</code> (<code>{ \"type\": \"AddTagToArtifact\", \"tag\": \"tag to add\" }</code>): add      a tag to the artifact related to the object</li> <li><code>AddTagToCase</code> (<code>{ \"type\": \"AddTagToCase\", \"tag\": \"tag to add\" }</code>): add      a tag to the case related to the object</li> <li><code>MarkAlertAsRead</code>: mark the alert related to the object as read</li> <li><code>AddCustomFields</code> (<code>{\"name\": \"key\", \"value\": \"value\", \"tpe\": \"type\"</code>): add a custom field to the case related to the object</li> </ul> </li> </ul> <p>The list of acceptable operations will increase in future releases of TheHive.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#the-cortexutils-python-library", "title": "The Cortexutils Python Library", "text": "<p>So far, all the published responders have been written in Python. We provide a Python library called <code>cortexutils</code> to help developers easily write their programs. Note though that Python is not mandatory for responder coding and any language that runs on Linux can be used, though you won't have the benefits of the CortexUtils library.</p> <p>Cortexutils can be used with Python 2 and 3. Due to the end of life from Python2 it is strongly advised to work as much with Python3 as possible. To install it :</p> <pre><code>pip install cortexutils\n</code></pre> <p>or</p> <pre><code>pip3 install cortexutils\n</code></pre> <p>This library is already used by all the responders published in our Github repository. Feel free to start reading the code of some of them before writing your own.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#submitting-a-responder", "title": "Submitting a Responder", "text": "<p>We highly encourage you to share your responders with the community through our Github repository. To do so, we invite you to follow a few steps before submitting a pull request.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#check-existing-issues", "title": "Check Existing Issues", "text": "<p>Start by checking if an issue already exists for the responder you'd like to write and contribute. Verify that nobody is working on it. If an issue exists and has the in progress, under review or pr-submitted label, it means somebody is already working on the code or has finished it.</p> <p>If you are short on ideas, check issues with a help wanted label. If one of those issues interest you, indicate that you are working on it.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#open-an-issue", "title": "Open an Issue", "text": "<p>If there's no issue open for the responder you'd like to contribute, open one. Indicate that you are working on it to avoid having someone start coding it.</p> <p>You have to create an issue for each responder you'd like to submit.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#review-your-service-interaction-files", "title": "Review your Service Interaction File(s)", "text": "<p>Review your service interaction files. For example, let's check the Mailer JSON responder configuration file(s):</p> <p></p><pre><code>{\n  \"name\": \"Mailer\",\n  \"version\": \"1.0\",\n  \"author\": \"CERT-BDF\",\n  \"url\": \"https://github.com/TheHive-Project/Cortex-Analyzers\",\n  \"license\": \"AGPL-V3\",\n  \"description\": \"Send an email with information from a TheHive case or alert\",\n  \"dataTypeList\": [\"thehive:case\", \"thehive:alert\", \"thehive:case_task\"],\n  \"command\": \"Mailer/mailer.py\",\n  \"baseConfig\": \"Mailer\",\n  \"configurationItems\": [\n    {\n      \"name\": \"from\",\n      \"description\": \"email address from which the mail is send\",\n      \"type\": \"string\", &lt;== defines what kind of data type the configuration item is (string, number)\n      \"multi\": false, &lt;== setting multi to true allows to pass a list of items\n      \"required\": true\n    },\n    {\n      \"name\": \"smtp_host\",\n      \"description\": \"SMTP server used to send mail\",\n      \"type\": \"string\",\n      \"multi\": false,\n      \"required\": true,\n      \"defaultValue\": \"localhost\"\n    },\n    {\n      \"name\": \"smtp_port\",\n      \"description\": \"SMTP server port\",\n      \"type\": \"number\",\n      \"multi\": false,\n      \"required\": true,\n      \"defaultValue\": 25\n    },\n    {\n      \"name\": \"smtp_user\",\n      \"description\": \"SMTP server user\",\n      \"type\": \"string\",\n      \"multi\": false,\n      \"required\": false,\n      \"defaultValue\": \"user\"\n    },\n    {\n      \"name\": \"smtp_pwd\",\n      \"description\": \"SMTP server password\",\n      \"type\": \"string\",\n      \"multi\": false,\n      \"required\": false,\n      \"defaultValue\": \"pwd\"\n    }\n  ]\n}\n</code></pre> Ensure that all information is correct and particularly the <code>author</code> and <code>license</code> parameters.<p></p>"}, {"location": "cortex/api/how-to-create-a-responder/#provide-the-list-of-requirements", "title": "Provide the List of Requirements", "text": "<p>If your responder is written in Python, make sure to complete the <code>requirements.txt</code> file with the list of all the external libraries that are needed to run the responder correctly.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#verify-execution", "title": "Verify Execution", "text": "<p>Use these three simple checks before submitting your responder:</p> <ul> <li>Ensure it works with the expected configuration, TLP, PAP or datatype.</li> <li>Ensure it works with missing configuration, PAP, datatype or TLP: your responder must generate an explicit error message.</li> </ul>"}, {"location": "cortex/api/how-to-create-a-responder/#create-a-pull-request", "title": "Create a Pull Request", "text": "<p>Create one Pull Request per responder against the develop branch of the Cortex-Analyzers repository. Reference the issue you've created in your PR.</p> <p>We have to review your responders. Distinct PRs will allow us to review them more quickly and release them to the benefit of the whole community.</p>"}, {"location": "cortex/api/how-to-create-a-responder/#need-help", "title": "Need Help?", "text": "<p>Something does not work as expected? No worries, we got you covered. Please join our user forum,  contact us on Gitter, or send us  an email at support@thehive-project.org. We are here to help.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/", "title": "How to create an Analyzer", "text": ""}, {"location": "cortex/api/how-to-create-an-analyzer/#write-and-submit-an-analyzer", "title": "Write and Submit an Analyzer", "text": ""}, {"location": "cortex/api/how-to-create-an-analyzer/#table-of-contents", "title": "Table of Contents", "text": "<ul> <li>Writing an Analyzer<ul> <li>The Program</li> <li>Service Interaction Files (Flavors)</li> <li>Python Requirements</li> <li>Example: VirusTotal Analyzer Files</li> <li>Input</li> <li>Service Interaction Configuration Items</li> <li>Output</li> <li>The Cortexutils Python Library</li> <li>Report Templates</li> </ul> </li> <li>Submitting an Analyzer<ul> <li>Check Existing Issues</li> <li>Open an Issue</li> <li>Review your Service Interaction File(s)</li> <li>Provide the List of Requirements</li> <li>Check the Taxonomy</li> <li>Provide Global Configuration Parameters</li> <li>Verify Execution</li> <li>Create a Pull Request</li> </ul> </li> <li>Need Help?</li> </ul>"}, {"location": "cortex/api/how-to-create-an-analyzer/#writing-an-analyzer", "title": "Writing an Analyzer", "text": "<p>An analyzer is a program that takes an observable and configuration information as raw input, analyze the observable and produces a result as raw output. It is made of at least 2 types of files:</p> <ul> <li>The program itself</li> <li>One or several service interaction files or flavors</li> <li>A Python requirements file, which is only necessary if the analyzer is written in Python.</li> </ul>"}, {"location": "cortex/api/how-to-create-an-analyzer/#the-program", "title": "The Program", "text": "<p>The first type of files an analyzer is made of is the core program that performs actions. It can be written in any programming language that is supported by Linux.</p> <p>While many analyzers are written in Python (<code>*.py</code> files), you can write yours in Ruby, Perl or even Scala. However, the very handy <code>Cortexutils</code> library described below is in Python. It greatly facilitates analyzer development and it also provides some methods to quickly format the output to make it compliant with the JSON schema expected by TheHive.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#service-interaction-files-flavors", "title": "Service Interaction Files (Flavors)", "text": "<p>An analyzer must have at least one service interaction file. Such files contain key configuration information such as the analyzer's author information, the datatypes (IP, URL, hash, domain...) the analyzer accepts as input, the TLP and PAP (Permissible Actions Protocol) above which it will refuse to execute to protect against data leakage and to enforce sane OPSEC practices and so on.</p> <p>An analyzer can have two or more service interaction files to allow it to perform different actions.  We speak then of flavors. For example, a sandbox analyzer can analyze a file with or without an Internet connection. Another example could be an analyzer that can either send a file to VirusTotal for analysis or get the last report using its hash.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#python-requirements", "title": "Python Requirements", "text": "<p>If the analyzer is written in Python, a <code>requirements.txt</code> must be provided with the list of all the dependencies.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#example-virustotal-analyzer-files", "title": "Example: VirusTotal Analyzer Files", "text": "<p>Below is a directory listing of the files corresponding to the VirusTotal analyzer. You can see that the analyzer has two flavors: GetReport and Scan.</p> <pre><code>analyzers/VirusTotal\n|-- VirusTotal_GetReport.json\n|-- VirusTotal_Scan.json\n|-- requirements.txt\n|-- virustotal.py\n`-- virustotal_api.py\n</code></pre>"}, {"location": "cortex/api/how-to-create-an-analyzer/#input", "title": "Input", "text": "<p>The input of an analyzer is a JSON structure with different pieces of information. For example, to use the VirusTotal analyzer's GetReport flavor in order to obtain the latest available report for hash <code>d41d8cd98f00b204e9800998ecf8427e</code>, you must submit input such as:</p> <pre><code>{\n    \"data\":\"d41d8cd98f00b204e9800998ecf8427e\",\n    \"dataType\":\"hash\",\n    \"tlp\":0,\n    \"config\":{\n        \"key\":\"1234567890abcdef\",\n        \"max_tlp\":3,\n        \"check_tlp\":true,\n        \"service\":\"GetReport\"\n        [..]\n    },\n    \"proxy\":{\n        \"http\":\"http://myproxy:8080\",\n        \"https\":\"https://myproxy:8080\"\n      }\n  }\n</code></pre> <p><code>data</code>, <code>dataType</code> and <code>tlp</code> are the observable-related information generated by TheHive or any other program that is calling Cortex. <code>config</code> is the analyzer's specific configuration provided by an <code>orgAdmin</code> users when the analyzer is enabled in the Cortex UI.</p> <p>Let's take the GetReport flavor of the VirusTotal analyzer as an example again.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#example-virustotal-get-report-input", "title": "Example: VirusTotal Get Report Input", "text": "<pre><code>{\n    \"data\":\"d41d8cd98f00b204e9800998ecf8427e\",\n    \"dataType\":\"hash\",\n    \"tlp\":0,\n    [..]\n  }\n</code></pre>"}, {"location": "cortex/api/how-to-create-an-analyzer/#example-service-interaction-file-for-virustotal-getreport", "title": "Example: Service Interaction File for VirusTotal GetReport", "text": "<p>The <code>&lt;==</code> sign and anything after it are comments that do no appear in the original file. </p><pre><code>{\n  \"name\": \"VirusTotal_GetReport\",\n  \"version\": \"3.0\",\n  \"author\": \"CERT-BDF\",\n  \"url\": \"https://github.com/TheHive-Project/Cortex-Analyzers\",\n  \"license\": \"AGPL-V3\",\n  \"description\": \"Get the latest VirusTotal report for a file, hash, domain or an IP address.\",\n  \"dataTypeList\": [\"file\", \"hash\", \"domain\", \"ip\"],\n  \"command\": \"VirusTotal/virustotal.py\", &lt;== Program to run when invoking the analyzer\n  \"baseConfig\": \"VirusTotal\", &lt;== name of base config in Cortex analyzer config page\n  \"config\": {\n    \"service\": \"get\"\n  },\n  \"configurationItems\": [ &lt;== list of configuration items the analyzer needs to operate (api key etc.)\n    {\n      \"name\": \"key\",\n      \"description\": \"API key for Virustotal\",\n      \"type\": \"string\", &lt;== defines what kind of data type the configuration item is (string, number)\n      \"multi\": false, &lt;== setting multi to true allows to pass a list of items (e.g. MISP analyzer)\n      \"required\": true \n    },\n    {\n      \"name\": \"polling_interval\",\n      \"description\": \"Define time interval between two requests attempts for the report\",\n      \"type\": \"number\",\n      \"multi\": false,\n      \"required\": false,\n      \"defaultValue\": 60\n    }\n  ]\n}\n</code></pre><p></p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#service-interaction-configuration-items", "title": "Service Interaction Configuration Items", "text": ""}, {"location": "cortex/api/how-to-create-an-analyzer/#name", "title": "name", "text": "<p>Name of the specific service (or flavor) of the analyzer.</p> <p>If your analyzer has only one service interaction (i.e. performs only one action), it is the name of the analyzer's directory.</p> <p>If your analyzer performs several actions (i.e. comes in several flavors), you have to give a specific and meaningful name to each flavor.</p> <p>Each flavor's name appear in TheHive analyzer list and in MISP when you use Cortex for attribute enrichment.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#version", "title": "version", "text": "<p>The version of the analyzer.</p> <p>You must increase major version numbers when new features are added, modifications are made to take into account API changes, report output is modified or when report templates (more on this later) are updated.</p> <p>You must increase minor version numbers when bugs are fixed.</p> <p>The version number is also used in the folder name of the associated report templates ; e.g. VirusTotal_GetReport and 3.0 on the JSON file should correspond a folder named VirusTotal_GetReport_3_0 for report templates.  Report templates are used by TheHive to display the analyzer's JSON output  in an analyst-friendly fashion.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#author", "title": "author", "text": "<p>You must provide your full name and/or your organization/team name when submitting an analyzer. Pseudos are not accepted. If you'd rather remain anonymous, please contact us at support@thehive-project.org prior to submitting your analyzer.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#url", "title": "url", "text": "<p>The URL where the analyzer is stored. This should ideally be <code>https://github.com/TheHive-Project/Cortex-Analyzers</code></p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#license", "title": "license", "text": "<p>The license of the code. Ideally, we recommend using the AGPL-v3 license.</p> <p>Make sure your code's license is compatible with the license(s) of the various components and libraries you use if applicable.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#description", "title": "description", "text": "<p>Description of the analyzer. Please be concise and clear. The description is  shown in the Cortex UI, TheHive and MISP.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#datatypelist", "title": "dataTypeList", "text": "<p>The list of TheHive datatypes supported by the analyzer. Currently TheHive accepts the following datatypes:</p> <ul> <li>domain</li> <li>file</li> <li>filename</li> <li>fqdn</li> <li>hash</li> <li>hostname</li> <li>ip</li> <li>mail</li> <li>mail_subject</li> <li>other</li> <li>regexp</li> <li>registry</li> <li>uri_path</li> <li>url</li> <li>user-agent</li> </ul> <p>If you need additional datatypes for your analyzer, please let us know at support@thehive-project.org.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#baseconfig", "title": "baseConfig", "text": "<p>Name used to group configuration items common to several analyzer. This prevent the user to enter the same API key for all analyzer flavors. The Cortex analyzer config page group configuration items by their <code>baseConfig</code>.  </p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#config", "title": "config", "text": "<p>Configuration dedicated to the analyzer's flavor. This is where we  typically specify the TLP level of observables allowed to be analyzed with the  <code>check_tlp</code> and <code>max_tlp</code> parameters. For example, if <code>max_tlp</code> is set to <code>2</code> (TLP:AMBER),  TLP:RED observables cannot be analyzed.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#max_tlp", "title": "max_tlp", "text": "<p>The TLP level above which the analyzer must not be executed.</p> TLP max_tlp value Unknown -1 WHITE 0 GREEN 1 AMBER 2 RED 3"}, {"location": "cortex/api/how-to-create-an-analyzer/#check_tlp", "title": "check_tlp", "text": "<p>This is a boolean parameter. When <code>true</code>, <code>max_tlp</code> is checked. And if the input's TLP is above <code>max_tlp</code>, the analyzer is not executed.</p> <p>For consistency reasons, we do recommend setting both <code>check_tlp</code> and <code>max_tlp</code> even if <code>check_tlp</code> is set to <code>false</code>.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#max_pap", "title": "max_pap", "text": "<p>The PAP level above which the analyzer must not be executed.</p> TLP max_tlp value Unknown -1 WHITE 0 GREEN 1 AMBER 2 RED 3"}, {"location": "cortex/api/how-to-create-an-analyzer/#check_pap", "title": "check_pap", "text": "<p>This is a boolean parameter. When <code>true</code>, <code>max_pap</code> is checked. And if the input's PAP is above <code>max_pap</code>, the analyzer is not executed.</p> <p>For consistency reasons, we do recommend setting both <code>check_pap</code> and <code>max_pap</code> even if <code>check_pap</code> is set to <code>false</code>.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#command", "title": "command", "text": "<p>The command used to run the analyzer. That's typically the full, absolute path to the main program file.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#configurationitems", "title": "configurationItems", "text": "<p>The list of configurationItems is necessary in order to be able to set all configuration variables for analyzers directly in the Cortex 2 user interface. As in the VirusTotal example above can be seen, every item is a json object that defines: - name (string) - description (string) - type (string) - multi (boolean) - required (boolean) - defaultValue (according to type, optional)</p> <p>The <code>multi</code> parameter allows to pass a list as configuration variable instead of a single string or number. This is used e.g. in the MISP analyzer that queries multiple servers in one run and needs different parameters for that.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#output", "title": "Output", "text": "<p>The output of an analyzer depends on the success or failure of its execution.</p> <p>If the analyzer fails to execute:</p> <pre><code>{\n    \"success\": false,\n    \"errorMessage\":\"..\"\n}\n</code></pre> <ul> <li>When <code>success</code> is set to <code>false</code>, it indicates that something went wrong     during the execution.</li> <li><code>errorMessage</code> is free text - typically the error output message.</li> </ul> <p>If the analyzer succeeds (i.e. it runs without any error):</p> <pre><code>{\n    \"success\":true,\n    \"artifacts\":[..],\n    \"summary\":{\n        \"taxonomies\":[..]\n    },\n    \"full\":{..}\n}\n</code></pre> <ul> <li>When <code>success</code> is set to <code>true</code>, it indicates that the analyzer ran     successfully.</li> <li><code>artifacts</code> is a list of indicators extracted from the produced report.</li> <li><code>full</code> is the full report of the analyzer. It is free form, as long as it is JSON formatted.</li> <li> <p><code>summary</code> is used in TheHive for short reports displayed in the     observable list and in the detailed page of each observable. It     contains a list of taxonomies.</p> <ul> <li><code>taxonomies</code>:</li> </ul> <pre><code>\"taxonomies\":[\n  {\n      \"namespace\": \"NAME\",\n      \"predicate\": \"PREDICATE\",\n      \"value\": \"\\\"VALUE\\\"\",\n      \"level\":\"info\"\n  }\n]\n</code></pre> <ul> <li><code>namespace</code> and <code>predicate</code> are free values but they should be as  concise as possible. For example, the VirusTotal analyzer uses VT  as a namespace and Score as a predicate.</li> <li><code>level</code> intends to convey the maliciousness of the result:     :<ul> <li><code>info</code> : the analyzer produced an information, and the     short report is shown in blue color in TheHive.</li> <li><code>safe</code> : the analyzer did not find anything suspicious     or the analyzed observable is safe according to     the analyzer. TheHive displays the short report in green     color.</li> <li><code>suspicious</code> : the analyzer found that the observable is     either suspicious or warrants further investigation. The     short report has an orange color in TheHive.</li> <li><code>malicious</code> : the analyzer found that the observable     is malicious. The short report is red colored in TheHive.</li> </ul> </li> </ul> </li> </ul> <p>For more information refer to our blog.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#the-cortexutils-python-library", "title": "The Cortexutils Python Library", "text": "<p>So far, all the published analyzers have been written in Python. We released a special Python library called <code>cortexutils</code> to help developers easily write their programs. Note though that Python is not mandatory for analyzer coding and any language that runs on Linux can be used, though you won't have the benefits of the CortexUtils library.</p> <p>Cortexutils can be used with Python 2 and 3. To install it :</p> <pre><code>pip install cortexutils\n</code></pre> <p>or</p> <pre><code>pip3 install cortexutils\n</code></pre> <p>This library is already used by all the analyzers published in our Github repository. Feel free to start reading the code of some of them before writing your own.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#report-templates", "title": "Report Templates", "text": "<p>When using TheHive, analysts can submit an observable for analysis to one or several Cortex instances by a click of a button. Once finished, Cortex returns the result to TheHive. The TheHive displays that result using HTML templates for short and long reports.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#cortex-result-in-thehive", "title": "Cortex Result in TheHive", "text": "<p>TheHive receives the Cortex result which is simply the JSON formatted analyzer output described above:</p> <ul> <li>The <code>summary</code> section is read to display short reports in the observables list and in the detailed observable page. This is stored in a dict object named <code>content</code> within TheHive.</li> <li>The <code>full</code> section is read to display long reports when clicking the short     report in the observable list or when accessing a detailed observable     page. In TheHive application, it is stored in a dict object named     <code>content</code>.</li> </ul>"}, {"location": "cortex/api/how-to-create-an-analyzer/#displayed-information", "title": "Displayed Information", "text": ""}, {"location": "cortex/api/how-to-create-an-analyzer/#when-no-template-is-imported", "title": "When No Template is Imported", "text": "<p>In the event that the analyzer report templates are not imported in TheHive (only administrators can do such an operation via the Admin &gt; Report Templates menu):</p> <ul> <li>In the observable list, TheHive is able to display the analyzer <code>summary</code>     results using a builtin style sheet associated with the previously     described taxonomy.</li> <li>In the detailed observable page:<ul> <li>the <code>full</code> result is displayed in raw format (the JSON output from   Cortex)</li> <li>the <code>summary</code> result is not displayed.</li> </ul> </li> </ul>"}, {"location": "cortex/api/how-to-create-an-analyzer/#when-templates-are-imported", "title": "When Templates are Imported", "text": "<p>If templates are imported into TheHive:</p> <ul> <li>Short reports are displayed in the observable list and in the detailed observable page.</li> </ul> <p></p> <ul> <li>Long reports are displayed when clicking on the short reports or in the detailed observable page.</li> </ul> <p></p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#writing-templates", "title": "Writing Templates", "text": "<p>To display results nicely in TheHive, write two HTML templates:</p> <ul> <li>One for short reports</li> <li>One for long reports</li> </ul> <p>When TheHive users import them in the application, they will be definitely more efficient at reading the analyzer reports and do their job accordingly.</p> <p>If the analyzer is made of different flavors (i.e. has different service interaction files with a <code>json</code> extension), you should provide two HTML templates (short and long reports) for each flavor.</p> <p>For example, the VirusTotal analyzer comes in two flavors hence it has 4 HTML  templates:</p> <pre><code>thehive-templates/VirusTotal_GetReport_3_0\n|-- long.html\n`-- short.html\nthehive-templates/VirusTotal_Scan_3_0\n|-- long.html\n`-- short.html\n</code></pre> <p>The folder's name is the concatenation of the <code>name</code> and the <code>version</code> values found in the service interaction files.</p> <p>TheHive uses Bootstrap and AngularJS so you can leverage them in your templates.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#short-report-templates-shorthtml", "title": "Short Report Templates (short.html)", "text": "<p>The short report uses taxonomies and is built into the analyzers by the <code>summary()</code> function. Report templates read it as shown in the example below:</p> <pre><code>&lt;span class=\"label\" ng-repeat=\"t in content.taxonomies\"\n  ng-class=\"{'info': 'label-info', 'safe': 'label-success',\n  'suspicious': 'label-warning',\n  'malicious':'label-danger'}[t.level]\"&gt;\n    {{t.namespace}}:{{t.predicate}}={{t.value}}\n&lt;/span&gt;\n</code></pre> <p>If you want to change or add the information displayed in the short report in the detailed observable page, you have to update the <code>summary()</code> function in the analyzer's program and edit short.html as well. Basically, copy the code in your short.html template and it will do the job.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#long-report-templates-longhtml", "title": "Long Report Templates (long.html)", "text": "<p>Long report templates are more or less free form as long as it reads the content of the relevant section in the Cortex result (<code>full</code>). Feel free to check what has already been written for existing analyzers to write yours.</p> <p>A good start can be:</p> <pre><code>&lt;!-- Success --&gt;\n&lt;div class=\"panel panel-danger\" ng-if=\"success\"&gt;\n    &lt;div class=\"panel-heading\"&gt;\n        ANALYZERNAME Report\n    &lt;/div&gt;\n    &lt;div class=\"panel-body\"&gt;\n        [...]                      &lt;= code here\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;!-- General error  --&gt;\n&lt;div class=\"panel panel-danger\" ng-if=\"!success\"&gt;\n    &lt;div class=\"panel-heading\"&gt;\n        &lt;strong&gt;{{(artifact.data || artifact.attachment.name) | fang}}&lt;/strong&gt;\n    &lt;/div&gt;\n    &lt;div class=\"panel-body\"&gt;\n        &lt;dl class=\"dl-horizontal\" ng-if=\"content.errorMessage\"&gt;\n            &lt;dt&gt;&lt;i class=\"fa fa-warning\"&gt;&lt;/i&gt; ANALYZERNAME: &lt;/dt&gt;\n            &lt;dd class=\"wrap\"&gt;{{content.errorMessage}}&lt;/dd&gt;\n        &lt;/dl&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>"}, {"location": "cortex/api/how-to-create-an-analyzer/#submitting-an-analyzer", "title": "Submitting an Analyzer", "text": "<p>We highly encourage you to share your analyzers with the community through our Github repository. To do so, we invite you to follow a few steps before submitting a pull request.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#check-existing-issues", "title": "Check Existing Issues", "text": "<p>Start by checking if an issue already exists for the analyzer you'd like to write and contribute. Verify that nobody is working on it. If an issue exists and has the in progress, under review or pr-submitted label, it means somebody is already working on the code or has finished it.</p> <p>If you are short on ideas, check issues with a help wanted label. If one of those issues interest you, indicate that you are working on it.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#open-an-issue", "title": "Open an Issue", "text": "<p>If there's no issue open for the analyzer you'd like to contribute, open one. Indicate that you are working on it to avoid having someone start coding it.</p> <p>You have to create an issue for each analyzer you'd like to submit.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#review-your-service-interaction-files", "title": "Review your Service Interaction File(s)", "text": "<p>Review your service interaction files. For example, let's check the VirusTotal JSON analyzer configuration file(s):</p> <p></p><pre><code>{\n    \"name\": \"VirusTotal_GetReport\",\n    \"version\": \"3.0\",\n    \"author\": \"CERT-BDF\",\n    \"url\": \"https://github.com/TheHive-Project/Cortex-Analyzers\",\n    \"license\": \"AGPL-V3\",\n    \"description\": \"Get the latest VirusTotal report for a file, hash, domain or an IP address\",\n    \"dataTypeList\": [\"file\", \"hash\", \"domain\", \"ip\"],\n    \"baseConfig\": \"VirusTotal\",\n    \"config\": {\n        \"check_tlp\": true,\n        \"max_tlp\": 3,\n        \"service\": \"get\"\n    },\n    \"command\": \"VirusTotal/virustotal.py\"\n}\n</code></pre> Ensure that all information is correct and particularly the <code>author</code> and <code>license</code> parameters.<p></p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#provide-the-list-of-requirements", "title": "Provide the List of Requirements", "text": "<p>If your analyzer is written in Python, make sure to complete the <code>requirements.txt</code> file with the list of all the external libraries that are needed to run the analyzer correctly.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#check-the-taxonomy", "title": "Check the Taxonomy", "text": "<p>We chose to use a formatted summary report to match a taxonomy as described above. If you want your analyzer reports in the observable lists, ensure that your summary matches this format. If your analyzer is written in Python and you are using our <code>cortexutils</code> library, you can use the <code>summary()</code>and <code>build_taxonomy()</code> functions.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#provide-global-configuration-parameters", "title": "Provide Global Configuration Parameters", "text": "<p>When submitting your analyzer, please provide the necessary global configuration in <code>/etc/cortex/application.conf</code> if needed. You can provide this information in a <code>README</code> file.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#verify-execution", "title": "Verify Execution", "text": "<p>Use these three simple checks before submtting your analyzer:</p> <ul> <li>Ensure it works with the expected configuration, TLP or dataType.</li> <li>Ensure it works with missing configuration, dataType or TLP: your analyzer must generate an explicit error message.</li> <li>Ensure the long report template handles error messages correctly.</li> </ul>"}, {"location": "cortex/api/how-to-create-an-analyzer/#create-a-pull-request", "title": "Create a Pull Request", "text": "<p>Create one Pull Request per analyzer against the develop branch of the Cortex-Analyzers repository. Reference the issue you've created in your PR.</p> <p>We have to review your analyzers. Distinct PRs will allow us to review them more quickly and release them to the benefit of the whole community.</p>"}, {"location": "cortex/api/how-to-create-an-analyzer/#need-help", "title": "Need Help?", "text": "<p>Something does not work as expected? No worries, we got you covered. Please join our user forum,  contact us on Gitter, or send us  an email at support@thehive-project.org. We are here to help.</p>"}, {"location": "cortex/download/", "title": "Download Cortex", "text": ""}, {"location": "cortex/download/#download-cortex", "title": "Download Cortex", "text": "<p>Cortex is distributed in various formats to suit different environments and deployment preferences. Whether you want to install it on traditional Linux systems, run it as a container with Docker, or deploy it in a Kubernetes cluster, you\u2019ll find the appropriate options and instructional links below.</p>"}, {"location": "cortex/download/#debian-ubuntu", "title": "Debian /  Ubuntu", "text": "<p>If you use a Debian- or Ubuntu-based OS, follow the steps in the Step-by-Step Installation Guide to install and configure Cortex.</p> <p>DEB tab</p> <p>Select the DEB tab in the guide to ensure you use the correct commands.</p>"}, {"location": "cortex/download/#redhat-enterprise-linux-fedora", "title": "RedHat Enterprise Linux /  Fedora", "text": "<p>For RedHat or Fedora-based systems, use the Step-by-Step Installation Guide to install and configure Cortex.</p> <p>RPM tab</p> <p>Select the RPM tab in the guide to ensure you use the correct commands.</p>"}, {"location": "cortex/download/#zip-binary-packages", "title": "ZIP binary packages", "text": "<p>If you prefer more control over where Cortex is installed, need to use it in environments without package managers, or want to avoid dependency issues, you can install Cortex by downloading a ZIP binary package.</p> <p>ZIP binary packages tab</p> <p>Select the ZIP binary packages tab in the guide to ensure you use the correct commands.</p>"}, {"location": "cortex/download/#docker", "title": "Docker", "text": "<p>Prefer containerized deployment? Use the official pre-built Docker images on Cortex Docker Hub. Follow the Docker deployment instructions to get started.</p>"}, {"location": "cortex/download/#kubernetes", "title": "Kubernetes", "text": "<p>For Kubernetes users, deploy Cortex with pre-built Docker images from Cortex Docker Hub. Refer to the Kubernetes deployment guide for detailed instructions.</p>"}, {"location": "cortex/installation-and-configuration/", "title": "Installation and Configuration Guides", "text": ""}, {"location": "cortex/installation-and-configuration/#installation-and-configuration-guides", "title": "Installation and Configuration Guides", "text": ""}, {"location": "cortex/installation-and-configuration/#overview", "title": "Overview", "text": "<p>Cortex relies on Elasticsearch to store its data. A basic setup to install Elasticsearch, then Cortex on a standalone and dedicated server (physical or virtual).</p>"}, {"location": "cortex/installation-and-configuration/#hardware-requirements", "title": "Hardware requirements", "text": "<p>Hardware requirements depends on the usage of the system. We recommend starting with dedicated resources: </p> <ul> <li> 8 vCPU</li> <li> 16 GB of RAM</li> </ul>"}, {"location": "cortex/installation-and-configuration/#operating-systems", "title": "Operating systems", "text": "<p>Cortex has been tested and is supported on the following operating systems: </p> <ul> <li> Ubuntu 20.04 LTS</li> <li> Debian 11</li> <li> RHEL 8</li> <li> Fedora 35</li> </ul>"}, {"location": "cortex/installation-and-configuration/#software-requirements", "title": "Software requirements", "text": "<ul> <li>Java 11+</li> <li>Elasticsearch 7.x</li> </ul>"}, {"location": "cortex/installation-and-configuration/#installation-guide", "title": "Installation guide", "text": "<p>Too much in a hurry to read?</p> <p>If you are using one of the supported operating systems, use our all-in-one installation script: </p> <pre><code>wget -q -O /tmp/install_script.sh https://scripts.download.strangebee.com/latest/sh/install_script.sh ; sudo -v ; bash /tmp/install_script.sh\n</code></pre> <p>This script helps with the installation process on a fresh and supported OS; the program also run successfully if the conditions in terms of hardware requirements are met.</p> <p></p> <p>Once executed, several options are available: </p> <ol> <li>Setup proxy settings ; will configure everything on the host to work with a HTTP proxy, and custom CA certificate.</li> <li>Install TheHive ; use this option to install TheHive 5 and its dependencies</li> <li>Install Cortex and all its dependencies to run Analyzers &amp; Responders as Docker images</li> <li>Install Cortex and all its dependencies to run Analyzers &amp; Responders on the host (Debian and Ubuntu ONLY)</li> </ol> <p>For each release, DEB, RPM and ZIP binary packages are built and provided.</p> <p>For deploying Cortex on a Kubernetes cluster, refer to our detailed Kubernetes deployment guide.</p> <p>The following Guide let you prepare, install and configure Cortex and its prerequisites for Debian and RPM packages based operating systems, as well as for other systems and using our ZIP binary packages.</p>"}, {"location": "cortex/installation-and-configuration/#configuration-guides", "title": "Configuration guides", "text": "<p>The configuration of Cortex is in files stored in the <code>/etc/cortex</code> folder:</p> <ul> <li><code>application.conf</code> contains all parameters and options</li> <li><code>logback.xml</code> is dedicated to log management</li> </ul> <pre><code>/etc/cortex\n\u251c\u2500\u2500 application.conf\n\u251c\u2500\u2500 logback.xml\n\u2514\u2500\u2500 secret.conf\n</code></pre> <p>A separate secret.conf file is automatically created by Debian or RPM packages. This file should contain a secret that should be used by one instance.</p> <p>Various aspects can configured in the <code>application.conf</code> file:</p> <ul> <li>database</li> <li>Authentication</li> <li>Analyzers &amp; Responders</li> </ul>"}, {"location": "cortex/installation-and-configuration/#analyzers-responders", "title": "Analyzers &amp; Responders", "text": "<p>Before starting the installation of Cortex, this is important to know how Analyzers and Responders will be managed and run. 2 solutions are available to run them:</p>"}, {"location": "cortex/installation-and-configuration/#run-locally", "title": "Run locally", "text": "<p>The programs are downloaded and installed on the system running Cortex. </p> <p>There are many disadvantages with this option:</p> <ul> <li>Some public Analyzers or Responders, or you own custom program might required specific applications installed on the system</li> <li>All of the programs published are written in Python and come with dependencies. To run successfully, the dependencies of all programs should be installed on the same operating system ; so there is a high risk of incompatibilities (some program might require a specific version of a library with the latest is also required by another one)</li> <li>The goal of Analyzers is to extract or gather information or intelligence about observables; and some of them might be malicious. Depending on the analysis, like a code analysis, you might want to ensure the Analyzer has not been compromised - and the host - by the observable itself</li> <li>You might want to ensure that when you run an Analyzer, there is no question about the integrity of its programs</li> <li>Updating them might be a pain regarding Operating System used and dependencies</li> </ul>"}, {"location": "cortex/installation-and-configuration/#run-with-docker", "title": "Run with Docker", "text": "<p>Analyzers &amp; Responders we publish also have their own Docker images. </p> <p>There are several benefits to use Docker images of Analyzers &amp; Responders.</p> <ul> <li>No need to worry about applications required or libraries, it just works</li> <li>When requested, Cortex downloads the docker image of a program and instantiate a container running the program. When finished, the container is trashed and a new one is created the next time. No need to worry about the integrity of the program</li> <li>This is simple to use and maintain</li> </ul> <p>This is the recommended option. It requires installing Docker engine as well.</p> <p>This is not an exclusive choice, both solutions can be used by the same instance of Cortex.</p>"}, {"location": "cortex/installation-and-configuration/advanced-configuration/", "title": "Advanced configuration", "text": ""}, {"location": "cortex/installation-and-configuration/advanced-configuration/#advanced-configuration", "title": "Advanced configuration", "text": ""}, {"location": "cortex/installation-and-configuration/advanced-configuration/#cache", "title": "Cache", "text": ""}, {"location": "cortex/installation-and-configuration/advanced-configuration/#performance", "title": "Performance", "text": "<p>In order to increase Cortex performance, a cache is configured to prevent repetitive database solicitation. Cache retention time can be configured for users and organizations (default is 5 minutes). If a user is updated, the cache is automatically invalidated.</p>"}, {"location": "cortex/installation-and-configuration/advanced-configuration/#analyzer-results", "title": "Analyzer Results", "text": "<p>Analyzer results (job reports) can also be cached. If an analyzer is executed against the same observable, the previous report can be returned without re-executing the analyzer. The cache is used only if the second job occurs within <code>cache.job</code> (the default is 10 minutes).</p> <pre><code>cache {\n  job = 10 minutes\n  user = 5 minutes\n  organization = 5 minutes\n}\n</code></pre> <p>Notes</p> <ol> <li>The global <code>cache.job</code> value can be overridden for each analyzer in the analyzer configuration Web dialog</li> <li>it is possible to bypass the cache altogether (for example to get extra fresh results) through the API as explained in the API Guide or by setting the cache to Custom in the Cortex UI for each analyzer and specifying <code>0</code> as the number of minutes.</li> </ol>"}, {"location": "cortex/installation-and-configuration/advanced-configuration/#streaming-aka-the-flow", "title": "Streaming (a.k.a The Flow)", "text": "<p>The user interface is automatically updated when data is changed in the back-end. To do this, the back-end sends events to all the connected front-ends. The mechanism used to notify the front-end is called long polling and its settings are:</p> <ul> <li><code>refresh</code> : when there is no notification, close the connection after this  duration (the default is 1 minute).</li> <li><code>cache</code> : before polling a session must be created, in order to make sure no  event is lost between two polls. If there is no poll during the cache setting,  the session is destroyed (the default is 15 minutes).</li> <li><code>nextItemMaxWait</code>, <code>globalMaxWait</code> : when an event occurs, it is not  immediately sent to the front-ends. The back-end waits nextItemMaxWait and up  to globalMaxWait in case another event can be included in the notification.  This mechanism saves many HTTP requests.</li> </ul> <p>The default values are:</p> <pre><code># Streaming\nstream.longpolling {\n  # Maximum time a stream request waits for new element\n  refresh = 1m\n  # Lifetime of the stream session without request\n  cache = 15m\n  nextItemMaxWait = 500ms\n  globalMaxWait = 1s\n}\n</code></pre>"}, {"location": "cortex/installation-and-configuration/advanced-configuration/#entity-size-limit", "title": "Entity Size Limit", "text": "<p>The Play framework used by Cortex sets the HTTP body size limit to 100KB by default for textual content (json, xml, text, form data) and 10MB for file uploads. This could be too small in some cases so you may want to change it with the following settings in the <code>application.conf</code> file:</p> <pre><code># Max textual content length\nplay.http.parser.maxMemoryBuffer=1M\n# Max file size\nplay.http.parser.maxDiskBuffer=1G\n</code></pre> <p>Note</p> <p>if you are using a NGINX reverse proxy in front of Cortex, be aware that it doesn't distinguish between text data and a file upload. So, you should also set the <code>client_max_body_size</code> parameter in your NGINX server configuration to the highest value among the two: file upload and text size as defined in Cortex <code>application.conf</code> file.</p>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/", "title": "Analyzers &amp; Responders", "text": ""}, {"location": "cortex/installation-and-configuration/analyzers-responders/#analyzers-responders", "title": "Analyzers &amp; Responders", "text": ""}, {"location": "cortex/installation-and-configuration/analyzers-responders/#run-with-docker", "title": "Run with Docker", "text": "<p>Ensure Cortex is authorized to run use Docker</p> <p>To run docker images of Analyzers &amp; Responders, Cortex should have permissions to use docker. </p> <pre><code>sudo usermod -G docker cortex\n</code></pre>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#configure-cortex", "title": "Configure Cortex", "text": "<p>To run Analyzers&amp;Responders with Docker images, Cortex should be able have access to Internet:</p> <ul> <li>To download public catalogs from the catalogs official website</li> <li>To download Docker images from hub.docker.com (https://hub.docker.com/search?q=cortexneurons)</li> </ul> /etc/cortex/application.conf<pre><code>[..]\nanalyzer {\n  # Directory that holds analyzers\n  urls = [\n    \"https://catalogs.download.strangebee.com/latest/json/analyzers.json\"\n  ]\n\n  fork-join-executor {\n    # Min number of threads available for analyze\n    parallelism-min = 2\n    # Parallelism (threads) ... ceil(available processors * factor)\n    parallelism-factor = 2.0\n    # Max number of threads available for analyze\n    parallelism-max = 4\n  }\n}\n\nresponder {\n  # Directory that holds responders\n  urls = [\n    \"https://catalogs.download.strangebee.com/latest/json/responders.json\"\n  ]\n\n  fork-join-executor {\n    # Min number of threads available for analyze\n    parallelism-min = 2\n    # Parallelism (threads) ... ceil(available processors * factor)\n    parallelism-factor = 2.0\n    # Max number of threads available for analyze\n    parallelism-max = 4\n  }\n}\n[..]\n</code></pre>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#store-run-programs-on-the-host", "title": "Store &amp; run programs on the host", "text": ""}, {"location": "cortex/installation-and-configuration/analyzers-responders/#additional-packages", "title": "Additional packages", "text": "<p>Some system packages are required to run Analyzers&amp;Responders programs successfully: </p> Debian <pre><code>sudo apt install -y --no-install-recommends python3-pip python3-dev ssdeep libfuzzy-dev libfuzzy2 libimage-exiftool-perl libmagic1 build-essential git libssl-dev\n</code></pre> <p>You may need to install Python <code>setuptools</code> and update pip/pip3:</p> <pre><code>sudo pip3 install -U pip setuptools\n</code></pre>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#clone-the-repository", "title": "Clone the repository", "text": "<p>Once finished, clone the Cortex-analyzers repository in the directory of your choosing:</p> <pre><code>cd /opt\ngit clone https://github.com/TheHive-Project/Cortex-Analyzers\nchown -R cortex:cortex /opt/Cortex-Analyzers \n</code></pre>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#install-dependencies", "title": "Install dependencies", "text": "<p>Each analyzer comes with its own, pip compatible <code>requirements.txt</code> file. You can install all requirements with the following commands:</p> <pre><code>cd /opt\nfor I in $(find Cortex-Analyzers -name 'requirements.txt'); do sudo -H pip3 install -r $I || true; done\n</code></pre>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#configure-cortex_1", "title": "Configure Cortex", "text": "<p>Next, you'll need to tell Cortex where to find the analyzers. Analyzers may be in different directories as shown in this dummy example of the Cortex configuration file (<code>application.conf</code>):</p> /etc/cortex/application.conf<pre><code>[..]\nanalyzer {\n  # Directory that holds analyzers\n  urls = [\n    \"/opt/Cortex-Analyzers/responders\",\n  ]\n\n  fork-join-executor {\n    # Min number of threads available for analyze\n    parallelism-min = 2\n    # Parallelism (threads) ... ceil(available processors * factor)\n    parallelism-factor = 2.0\n    # Max number of threads available for analyze\n    parallelism-max = 4\n  }\n}\n\nresponder {\n  # Directory that holds responders\n  urls = [\n    \"/opt/Cortex-Analyzers/responders\"\n  ]\n\n  fork-join-executor {\n    # Min number of threads available for analyze\n    parallelism-min = 2\n    # Parallelism (threads) ... ceil(available processors * factor)\n    parallelism-factor = 2.0\n    # Max number of threads available for analyze\n    parallelism-max = 4\n  }\n}\n[..]\n</code></pre>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#run-you-own-analyzers-responders", "title": "Run you own Analyzers &amp; Responders", "text": "<p>Either you run them from the host or with Docker images, you can also run your own custom Analyzers and Responders. </p>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#dedicated-folder", "title": "Dedicated folder", "text": "<p>Create a dedicated folder to host your programs: </p> <pre><code>cd /opt\nmkdir -p Custom-Analyzers/{analyzers,responder}\nchown -R cortex:cortex /opt/Cortex-Analyzers \n</code></pre>"}, {"location": "cortex/installation-and-configuration/analyzers-responders/#update-cortex-configuration", "title": "Update Cortex configuration", "text": "<p>Update <code>analyzer.urls</code> and <code>responders.urls</code> accordingly.</p> /etc/cortex/application.conf<pre><code>[..]\nanalyzer {\n  # Directory that holds analyzers\n  urls = [\n    \"https://catalogs.download.strangebee.com/latest/json/analyzers.json\",\n    \"/opt/Custom-Analyzers/analyzers\" \n  ]\n\n  fork-join-executor {\n    # Min number of threads available for analyze\n    parallelism-min = 2\n    # Parallelism (threads) ... ceil(available processors * factor)\n    parallelism-factor = 2.0\n    # Max number of threads available for analyze\n    parallelism-max = 4\n  }\n}\n\nresponder {\n  # Directory that holds responders\n  urls = [\n    \"https://catalogs.download.strangebee.com/latest/json/responders.json\",\n    \"/opt/Custom-Analyzers/responders\"\n  ]\n\n  fork-join-executor {\n    # Min number of threads available for analyze\n    parallelism-min = 2\n    # Parallelism (threads) ... ceil(available processors * factor)\n    parallelism-factor = 2.0\n    # Max number of threads available for analyze\n    parallelism-max = 4\n  }\n}\n[..]\n</code></pre> <p>Then restart Cortex for the changes to take effect.</p> <p>How to develop your own Analyzers or Responders ?</p> <p>Have a look at the dedicated documentation: https://thehive-project.github.io/Cortex-Analyzers/dev_guides/how-to-create-an-analyzer/</p>"}, {"location": "cortex/installation-and-configuration/authentication/", "title": "Authentication", "text": ""}, {"location": "cortex/installation-and-configuration/authentication/#authentication", "title": "Authentication", "text": "<p>Like TheHive, Cortex supports local, LDAP, Active Directory (AD), X.509 SSO and/or API keys for authentication and OAuth2.</p> <p>Please note that API keys can only be used to interact with the Cortex API (for example when TheHive is interfaced with a Cortex instance, it must use an API key to authenticate to it). API keys cannot be used to authenticate to the Web UI. By default, Cortex relies on local credentials stored in Elasticsearch.</p> <p>Authentication methods are stored in the <code>auth.provider</code> parameter, which is multi-valued. When a user logs in, each authentication method is tried in order until one succeeds. If no authentication method works, an error is returned and the user cannot log in.</p> <p>The default values within the configuration file are:</p> <pre><code>auth {\n  # \"provider\" parameter contains authentication provider. It can be multi-valued (useful for migration)\n  # available auth types are:\n  # services.LocalAuthSrv : passwords are stored in user entity (in Elasticsearch). No configuration is required.\n  # ad : use ActiveDirectory to authenticate users. Configuration is under \"auth.ad\" key\n  # ldap : use LDAP to authenticate users. Configuration is under \"auth.ldap\" key\n  # oauth2 : use OAuth/OIDC to authenticate users. Configuration is under \"auth.oauth2\" and \"auth.sso\" keys\n  provider = [local]\n\n  # By default, basic authentication is disabled. You can enable it by setting \"method.basic\" to true.\n  method.basic = false\n\n  ad {\n    # The name of the Microsoft Windows domain using the DNS format. This parameter is required.\n    #domainFQDN = \"mydomain.local\"\n\n    # Optionally you can specify the host names of the domain controllers. If not set, Cortex uses \"domainFQDN\".\n    #serverNames = [ad1.mydomain.local, ad2.mydomain.local]\n\n    # The Microsoft Windows domain name using the short format. This parameter is required.\n    #domainName = \"MYDOMAIN\"\n\n    # Use SSL to connect to the domain controller(s).\n    #useSSL = true\n  }\n\n  ldap {\n    # LDAP server name or address. Port can be specified (host:port). This parameter is required.\n    #serverName = \"ldap.mydomain.local:389\"\n\n    # If you have multiple ldap servers, use the multi-valued settings.\n    #serverNames = [ldap1.mydomain.local, ldap2.mydomain.local]\n\n    # Use SSL to connect to directory server\n    #useSSL = true\n\n    # Account to use to bind on LDAP server. This parameter is required.\n    #bindDN = \"cn=cortex,ou=services,dc=mydomain,dc=local\"\n\n    # Password of the binding account. This parameter is required.\n    #bindPW = \"***secret*password***\"\n\n    # Base DN to search users. This parameter is required.\n    #baseDN = \"ou=users,dc=mydomain,dc=local\"\n\n    # Filter to search user {0} is replaced by user name. This parameter is required.\n    #filter = \"(cn={0})\"\n  }\n\n  oauth2 {\n    # URL of the authorization server\n    #clientId = \"client-id\"\n    #clientSecret = \"client-secret\"\n    #redirectUri = \"https://my-cortex-instance.example/api/ssoLogin\"\n    #responseType = \"code\"\n    #grantType = \"authorization_code\"\n\n    # URL from where to get the access token\n    #authorizationUrl = \"https://auth-site.com/OAuth/Authorize\"\n    #tokenUrl = \"https://auth-site.com/OAuth/Token\"\n\n    # The endpoint from which to obtain user details using the OAuth token, after successful login\n    #userUrl = \"https://auth-site.com/api/User\"\n    #scope = [\"openid profile\"]\n  }\n\n  # Single-Sign On\n  sso {\n    # Autocreate user in database?\n    #autocreate = false\n\n    # Autoupdate its profile and roles?\n    #autoupdate = false\n\n    # Autologin user using SSO?\n    #autologin = false\n\n    # Name of mapping class from user resource to backend user ('simple' or 'group')\n    #mapper = group\n    #attributes {\n    #  login = \"user\"\n    #  name = \"name\"\n    #  groups = \"groups\"\n    #  organization = \"org\"\n    #}\n    #defaultRoles = [\"read\"]\n    #defaultOrganization = \"csirt\"\n    #groups {\n    #  # URL to retreive groups (leave empty if you are using OIDC)\n    #  #url = \"https://auth-site.com/api/Groups\"\n    #  # Group mappings, you can have multiple roles for each group: they are merged\n    #  mappings {\n    #    admin-profile-name = [\"admin\"]\n    #    editor-profile-name = [\"write\"]\n    #    reader-profile-name = [\"read\"]\n    #  }\n    #}\n\n    #mapper = simple\n    #attributes {\n    #  login = \"user\"\n    #  name = \"name\"\n    #  roles = \"roles\"\n    #  organization = \"org\"\n    #}\n    #defaultRoles = [\"read\"]\n    #defaultOrganization = \"csirt\"\n  }\n\n}\n\n# Maximum time between two requests without requesting authentication\nsession {\n  warning = 5m\n  inactivity = 1h\n}\n</code></pre>"}, {"location": "cortex/installation-and-configuration/authentication/#oauth2openid-connect", "title": "OAuth2/OpenID Connect", "text": "<p>To enable authentication using OAuth2/OpenID Connect, edit the <code>application.conf</code> file and supply the values of <code>auth.oauth2</code> according to your environment. In addition, you need to supply:</p> <ul> <li><code>auth.sso.attributes.login</code>: name of the attribute containing the OAuth2 user's login in retreived user info (mandatory)</li> <li><code>auth.sso.attributes.name</code>: name of the attribute containing the OAuth2 user's name in retreived user info (mandatory)</li> <li><code>auth.sso.attributes.groups</code>: name of the attribute containing the OAuth2 user's groups (mandatory using groups mappings)</li> <li><code>auth.sso.attributes.roles</code>: name of the attribute containing the OAuth2 user's roles in retreived user info (mandatory using simple mapping)</li> </ul> <p>Important note</p> <p>Authenticate the user using an external OAuth2 authenticator server. The configuration is:</p> <ul> <li>clientId (string) client ID in the OAuth2 server.</li> <li>clientSecret (string) client secret in the OAuth2 server.</li> <li>redirectUri (string) the url of TheHive AOuth2 page (.../api/ssoLogin).</li> <li>responseType (string) type of the response. Currently only \"code\" is accepted.</li> <li>grantType (string) type of the grant. Currently only \"authorization_code\" is accepted.</li> <li>authorizationUrl (string) the url of the OAuth2 server.</li> <li>authorizationHeader (string) prefix of the authorization header to get user info: 'Bearer' by default</li> <li>tokenUrl (string) the token url of the OAuth2 server.</li> <li>userUrl (string) the url to get user information in OAuth2 server.</li> <li>scope (list of string) list of scope.</li> </ul> <p>Example configuration for SSO w/ Oauth2 &amp; Github</p> <pre><code>auth {\n\n  provider = [local, oauth2]\n\n  [..]\n\n  sso {\n    autocreate: false\n    autoupdate: false\n    mapper: \"simple\"\n    attributes {\n      login: \"login\"\n      name: \"name\"\n      roles: \"role\"\n    }\n    defaultRoles: [\"read\", \"analyze\"]\n    defaultOrganization: \"demo\"\n  }  \n  oauth2 {\n    name: oauth2\n    clientId: \"Client_ID\"\n    clientSecret: \"Client_ID\"\n    redirectUri: \"http://localhost:9001/api/ssoLogin\"\n    responseType: code\n    grantType: \"authorization_code\"\n    authorizationUrl: \"https://github.com/login/oauth/authorize\"\n    tokenUrl: \"https://github.com/login/oauth/access_token\"\n    userUrl: \"https://api.github.com/user\"\n    scope: [\"user\"]\n  }\n\n  [..]  \n}\n</code></pre>"}, {"location": "cortex/installation-and-configuration/database/", "title": "Database configuration", "text": ""}, {"location": "cortex/installation-and-configuration/database/#database-configuration", "title": "Database configuration", "text": "/etc/cortex/application.conf<pre><code>[..]\n## ElasticSearch\nsearch {\n  index = cortex\n  # For cluster, join address:port with ',': \"http://ip1:9200,ip2:9200,ip3:9200\"\n  uri = \"http://127.0.0.1:9200\"\n\n  ## Advanced configuration\n  # Scroll keepalive.\n  #keepalive = 1m\n  # Scroll page size.\n  #pagesize = 50\n  # Number of shards\n  #nbshards = 5\n  # Number of replicas\n  #nbreplicas = 1\n  # Arbitrary settings\n  #settings {\n  #  # Maximum number of nested fields\n  #  mapping.nested_fields.limit = 100\n  #}\n\n  ## Authentication configuration\n  #user = \"\"\n  #password = \"\"\n\n  ## SSL configuration\n  #keyStore {\n  #  path = \"/path/to/keystore\"\n  #  type = \"JKS\" # or PKCS12\n  #  password = \"keystore-password\"\n  #}\n  #trustStore {\n  #  path = \"/path/to/trustStore\"\n  #  type = \"JKS\" # or PKCS12\n  #  password = \"trustStore-password\"\n  #}\n}\n</code></pre>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/", "title": "Deploy Cortex on Kubernetes", "text": ""}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#deploy-cortex-on-kubernetes", "title": "Deploy Cortex on Kubernetes", "text": "<p>Deploy Cortex on a Kubernetes cluster using the StrangeBee Helm chart repository.</p> <p>Dependency image</p> <p>The default Elasticsearch image used by the dependency Helm chart comes from Bitnami.  </p> <p>Following Bitnami decision to stop maintaining multiple freely available image versions, StrangeBee Helm charts now reference the <code>bitnamilegacy</code> repository for Elasticsearch. Bitnami latest public images ship Elasticsearch 9, which isn't compatible with Cortex.</p> <p>This has important consequences:</p> <ul> <li>This legacy image won't receive security updates and will become increasingly vulnerable over time. You may continue to use it at your own risk, but it isn't production-ready.</li> <li>You can pay Bitnami for access to updated images and configure the Helm chart to reference them.</li> <li>Alternatively, you can deactivate the dependency Helm charts and bring your own Elasticsearch deployment.</li> </ul>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#architecture-overview", "title": "Architecture overview", "text": "<p>The default deployment includes:</p> <ul> <li>Cortex application pods</li> <li>A two-node Elasticsearch cluster for search indexing</li> <li>Shared storage for analyzer job data</li> </ul>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#infrastructure-requirements", "title": "Infrastructure requirements", "text": "<ul> <li>Kubernetes cluster v1.23.0 or later</li> <li>Helm v3.8.0 or later</li> <li>Minimum resources per node: see Cortex Installation System Requirements</li> <li>StorageClass supporting <code>ReadWriteMany</code> access mode</li> <li>Network policies allowing inter-pod communication</li> </ul>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#step-1-ensure-all-users-can-access-files-on-the-shared-filesystem", "title": "Step 1: Ensure all users can access files on the shared filesystem", "text": "<p>Configuration errors</p> <p>Improperly configured shared filesystems can cause errors when running jobs with Cortex.</p> <p>Why a shared filesystem</p> <p>When running on Kubernetes, Cortex launches a new pod for each analyzer or responder execution. After the job completes and Cortex retrieves the result, the pod is terminated. Without a shared filesystem accessible by both the Cortex pod and these analyzer and responder pods, they can't access the data they need to operate, causing the jobs to fail.</p> <p>Kubernetes supports several methods for sharing filesystems between pods, including:</p> <ul> <li>PV using an NFS server </li> <li>Dedicated storage solutions like Longhorn or Rook</li> </ul> <p>This guide focuses on configuring a PV using an NFS server, with an example for AWS Elastic File System (EFS).</p> <p>At runtime, Cortex and its jobs run on different pods and may use different user IDs (UIDs) and group IDs (GIDs):</p> <ul> <li>Cortex defaults to uid:gid <code>1001:1001</code>.</li> <li>Analyzers may use different uid:gid, such as <code>1000:1000</code> or <code>0:0</code> if running as root.</li> </ul> <p>To prevent permission errors when reading or writing files on the shared filesystem, configure the NFS server with the <code>all_squash</code> parameter. This ensures all filesystem operations use uid:gid <code>65534:65534</code>, regardless of the user's actual UID and GID.</p>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#step-2-deploy-cortex", "title": "Step 2: Deploy Cortex", "text": ""}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#deploy-with-default-configuration", "title": "Deploy with default configuration", "text": "<p>Service account</p> <p>A service account (SA) allows a pod to authenticate and interact with the Kubernetes API, enabling it to perform specific actions within the cluster. When deploying Cortex, a dedicated SA is essential for creating and managing Kubernetes jobs that run analyzers and responders. Without proper configuration, Cortex can't execute these jobs.</p> <p>Using an existing PV</p> <p>The <code>cortex</code> Helm Chart can operate without creating a new PV, provided that an existing PV\u2014created by the cluster administrator\u2014matches the PVC configuration specified in the Helm Chart.</p> <p>Use the <code>cortex</code> Helm chart to automate the creation of the PV, PVC, and SA during deployment. </p> <p>The default configuration is designed for development environments and requires modifications for production use. See Production configuration for required adjustments.</p> <ol> <li> <p>Add the StrangeBee Helm repository</p> <pre><code>helm repo add strangebee https://strangebeecorp.github.io/helm-charts\n</code></pre> </li> <li> <p>Update your local Helm repositories</p> <pre><code>helm repo update\n</code></pre> </li> <li> <p>Create a release using the <code>cortex</code> Helm chart</p> <pre><code>helm install &lt;release_name&gt; strangebee/cortex\n</code></pre> </li> </ol> <p>First start</p> <p>At first start, you must access the Cortex web page to update the Elasticsearch database.</p> <p>For more options, see the Helm documentation for installation.</p> <p>Dependency</p> <p>The <code>cortex</code> Helm chart relies on the Bitnami Elasticsearch Stack by default as the search index.</p> <p>Upgrades</p> <p>To upgrade your release to the latest version of the <code>cortex</code> Helm chart, run: </p><pre><code>helm upgrade &lt;release_name&gt; strangebee/cortex\n</code></pre> For additional options and best practices, see the Helm upgrade documentation.<p></p>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#production-configuration", "title": "Production configuration", "text": "<p>The default <code>cortex</code> Helm chart bundles all dependencies for quick deployment but uses development-oriented configurations. Production deployments require adjustments to Cortex and its dependencies for security, performance, and reliability.</p> <p>Use the following command to view all available configuration options for the <code>cortex</code> Helm chart:</p> <pre><code>helm show values strangebee/cortex\n</code></pre> <p>For more information on customization, see the dedicated Helm documentation. You can also review the available options for the dependency.</p>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#storage-configuration", "title": "Storage configuration", "text": "<p>Shared storage requirement</p> <p>Cortex requires a shared PVC with <code>ReadWriteMany</code> access mode to allow multiple pods to read and write data simultaneously\u2014essential for job inputs and outputs.</p> <p>By default, this chart attempts to create such a PVC using your cluster\u2019s default StorageClass. Ensure this StorageClass supports <code>ReadWriteMany</code> to avoid deployment issues or target a StorageClass in your cluster compatible with this access mode.</p> <p>Common solutions include:</p> <ul> <li>Running an NFS server reachable from your cluster and creating a PV targeting it</li> <li>Using dedicated storage solutions like Longhorn or Rook</li> <li>Leveraging cloud provider-specific solutions like AWS EFS with the EFS CSI Driver</li> </ul> <p>Also note that Cortex stores data in Elasticsearch. Regular backups are strongly recommended to prevent data loss, especially when deploying Elasticsearch on Kubernetes using the Bitnami Elasticsearch Stack.</p>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#elasticsearch", "title": "Elasticsearch", "text": "<p>By default, this chart deploys an Elasticsearch cluster with two nodes, both master-eligible and general-purpose.</p> <p>You can review the Bitnami Elasticsearch Helm chart for available configuration options.</p> <p>Same Elasticsearch instance for both TheHive and Cortex</p> <p>Using the same Elasticsearch instance for both TheHive and Cortex isn't recommended. If this setup is necessary, ensure proper connectivity and configuration for both pods and use Elasticsearch version 7.x. Be aware that sharing an Elasticsearch instance creates an interdependency that may lead to issues during updates or downtime.</p>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#cortex-server-in-thehive", "title": "Cortex server in TheHive", "text": "<p>See Add a Cortex Server for detailed instructions.</p> <p>When TheHive and Cortex deploy in the same Kubernetes cluster, use the Cortex service DNS as the server URL.</p> <pre><code>http://cortex.&lt;namespace&gt;.svc:9001\n</code></pre>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#example-deploy-cortex-using-aws-efs", "title": "Example: Deploy Cortex using AWS EFS", "text": ""}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#prerequisites", "title": "Prerequisites", "text": "<p>Before setting up the PV for AWS EFS, complete the following steps:</p> <ul> <li>Create an Identity and Access Management (IAM) role to allow the EFS CSI driver to interact with EFS.</li> <li>Install the EFS CSI driver on your Kubernetes cluster using one of the following methods:<ul> <li>EKS add-ons (recommended)</li> <li>Official Helm chart</li> </ul> </li> <li>Create an EFS filesystem and note the associated EFS filesystem ID.</li> </ul>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#1-create-a-storageclass-for-efs", "title": "1. Create a StorageClass for EFS", "text": "<p>Reference example</p> <p>The following manifests are based on the EFS CSI driver multiple pods example.</p> <p>Create a StorageClass that references your EFS filesystem:    </p> <pre><code>kind: StorageClass\napiVersion: storage.k8s.io/v1\nmetadata:\n  name: efs-sc\nprovisioner: efs.csi.aws.com\n# https://github.com/kubernetes-sigs/aws-efs-csi-driver?tab=readme-ov-file#storage-class-parameters-for-dynamic-provisioning\nparameters:\n  provisioningMode: efs-ap # EFS access point provisioning mode\n  fileSystemId: fs-01234567 # Replace with your EFS filesystem ID\n  directoryPerms: \"700\" # Permissions for newly created directories\n  uid: 1001 # User ID to set file permissions\n  gid: 1001 # Group ID to set file permissions\n  ensureUniqueDirectory: \"false\" # Set to false to allow shared folder access between Cortex and job containers\n  subPathPattern: \"${.PVC.namespace}/${.PVC.name}\" # Optional subfolder structure inside the NFS filesystem\n</code></pre>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#2-create-a-pvc-using-the-efs-storageclass", "title": "2. Create a PVC using the EFS StorageClass", "text": "<p>Kubernetes automatically creates a PV when defining a PVC with the EFS StorageClass.</p> <p>Use the <code>cortex</code> Helm chart to configure the storageClass value in the chart settings. This ensures the PVC is created automatically during deployment. To do so, open the <code>values.yaml</code> file and look for the <code>persistentVolumeClaim</code> section.</p>"}, {"location": "cortex/installation-and-configuration/deploy-cortex-on-kubernetes/#next-steps", "title": "Next steps", "text": "<ul> <li>Analyzers &amp; Responders</li> <li>Advanced Configuration</li> </ul>"}, {"location": "cortex/installation-and-configuration/parameters-docker/", "title": "Parameters for Docker", "text": ""}, {"location": "cortex/installation-and-configuration/parameters-docker/#parameters-for-docker", "title": "Parameters for Docker", "text": "<p>This topic lists the configuration keys available in Cortex\u2019s <code>application.conf</code> file that control Docker-related behavior. These settings are usually set indirectly by providing command-line parameters or environment variables when running the Cortex Docker container. The container entrypoint translates those inputs into this configuration file.</p> <p>Use this reference to understand and fine-tune the internal configuration options that govern how Cortex interacts with Docker containers, resource limits, networking, and registry authentication.</p>"}, {"location": "cortex/installation-and-configuration/parameters-docker/#docker-container-configuration-options", "title": "Docker container configuration options", "text": "<ul> <li><code>docker.container.capAdd</code> (array of strings): Add Linux capabilities to the container.</li> <li><code>docker.container.capDrop</code> (array of strings): Remove Linux capabilities from the container.</li> <li><code>docker.container.cgroupParent</code> (string): Specify the cgroup under which the container runs.</li> <li><code>docker.container.cpuPeriod</code> (integer): Limit the CPU CFS (Completely Fair Scheduler) period.</li> <li><code>docker.container.cpuQuota</code> (integer): Limit the CPU CFS quota.</li> <li><code>docker.container.dns</code> (array of strings): Custom DNS servers for the container.</li> <li><code>docker.container.dnsSearch</code> (array of strings): DNS search domains for host name lookup.</li> <li><code>docker.container.extraHosts</code> (array of strings): Add extra entries to <code>/etc/hosts</code> (format: <code>host:IP</code>)</li> <li><code>docker.container.kernelMemory</code> (integer): Kernel memory limit.</li> <li><code>docker.container.memoryReservation</code> (integer): Soft memory limit.</li> <li><code>docker.container.memory</code> (integer): Hard memory limit.</li> <li><code>docker.container.memorySwap</code> (integer): Total memory limit (memory + swap).</li> <li><code>docker.container.memorySwappiness</code> (integer, 0-100): Adjust container\u2019s memory swappiness behavior.</li> <li><code>docker.container.networkMode</code> (string): Network mode for the container.</li> <li><code>docker.container.privileged</code> (boolean): Grant extended privileges to the container.</li> <li><code>docker.host</code> (string): Docker socket URL by Cortex to launch job containers.</li> <li><code>docker.tlsVerify</code> (boolean): Turn on or turn off TLS certificate verification for the Docker socket.</li> <li><code>docker.certPath</code> (string): Path to the TLS certificate for verifying the Docker socket.</li> <li><code>docker.registry.user</code> (string): Username for Docker registry authentication.</li> <li><code>docker.registry.password</code> (string): Password for Docker registry authentication.</li> <li><code>docker.registry.email</code> (string): Email address used for Docker registry authentication</li> <li><code>docker.registry.url</code> (string): URL of the Docker registry to authenticate with.</li> <li><code>job.directory</code> (string): Directory inside the container where Cortex shares input/output data with analyzers and responders.</li> <li><code>job.dockerDirectory</code> (string): Corresponding host directory for sharing job data with analyzers and responders.</li> </ul>"}, {"location": "cortex/installation-and-configuration/parameters-docker/#using-dockerized-analyzers-and-responders", "title": "Using dockerized analyzers and respondersNext steps", "text": "<p>To run analyzers and responders as Docker containers, register them using the StrangeBee official catalogs.</p> <p>In the Cortex configuration file, update <code>analyzer.urls</code> and <code>responder.urls</code> to specify where Cortex should find analyzers and responders. </p> <p>These settings accept:</p> <ul> <li>A path to a directory containing worker definitions</li> <li>A path or URL (http/https) to a JSON file containing all worker definitions merged in one array</li> </ul> <p>Available URLs for dockerized analyzers:</p> <ul> <li>analyzers-stable.json: Stable analyzers (no updates once used).</li> <li>analyzers.json: Updated with each new release.</li> <li>analyzers-devel.json: Updated on every commit (development builds).</li> </ul> <p>Available URLs for dockerized responders:</p> <ul> <li>responders-stable.json: Stable responders (no updates once used).</li> <li>responders.json: Updated with each new release.</li> <li>responders-devel.json: Updated on every commit (development builds).</li> </ul> <ul> <li>How to Run Cortex with Docker</li> </ul>"}, {"location": "cortex/installation-and-configuration/proxy-settings/", "title": "Proxy settings", "text": ""}, {"location": "cortex/installation-and-configuration/proxy-settings/#proxy-settings", "title": "Proxy settings", "text": ""}, {"location": "cortex/installation-and-configuration/proxy-settings/#make-cortex-use-a-http-proxy-server", "title": "Make Cortex use a HTTP proxy server", "text": "<p>Basically, Cortex required to connect to Internet, especially to gather  catalogs of docker images of public Analyzers &amp; Responders.</p> /etc/cortex/application.conf<pre><code>[..]\nplay.ws.proxy {\n  host = http://PROXYSERVERADDRESS:PORT\n  port = http://PROXYSERVERADDRESS:PORT\n}\n[..]\n</code></pre>"}, {"location": "cortex/installation-and-configuration/proxy-settings/#operating-system", "title": "Operating System", "text": "/etc/environment<pre><code>export http_proxy=http://PROXYSERVERADDRESS:PORT\nexport https_proxy=http://PROXYSERVERADDRESS:PORT  \n</code></pre> <p>Specific configuration for Debian apt application</p> /etc/apt/apt.conf.d/80proxy<pre><code>  HTTP::proxy \"http://PROXYSERVERADDRESS:PORT\";\n  HTTPS::proxy \"http://PROXYSERVERADDRESS:PORT\";\n</code></pre>"}, {"location": "cortex/installation-and-configuration/proxy-settings/#pip", "title": "pip", "text": "<p>If Analyzers and Responders requirements have to be installed on the host, and the host is behind a proxy server, configure the pip command to use the proxy server ; use the option <code>--proxy http://PROXYSERVERADDRESS:PORT\"</code>, and <code>--cert path/to/cacert.pem</code> if a custom certificate is used by the proxy.</p> <pre><code>pip3 install --proxy http://PROXYSERVERADDRESS:PORT\" -r analyzers/*/requirements.txt\n</code></pre> <p>or </p> <pre><code>pip3 install --proxy http://PROXYSERVERADDRESS:PORT\" --cert path/to/cacert.pem -r analyzers/*/requirements.txt\n</code></pre>"}, {"location": "cortex/installation-and-configuration/proxy-settings/#git", "title": "Git", "text": "<pre><code>sudo git config --global http.proxy http://PROXYSERVERADDRESS:PORT\nsudo git config --global https.proxy http://PROXYSERVERADDRESS:PORT\n</code></pre>"}, {"location": "cortex/installation-and-configuration/proxy-settings/#docker", "title": "Docker", "text": "<p>If using Analyzers &amp; Responders as docker images, setting up proxy parameters could be required to download images.</p> <p>Update Docker engine configuration by editing/creating the file <code>/etc/systemd/system/docker.service.d/http-proxy.conf</code>: </p> /etc/systemd/system/docker.service.d/http-proxy.conf<pre><code>[Service]\nEnvironment=http://PROXYSERVERADDRESS:PORT\"\nEnvironment=\"http://PROXYSERVERADDRESS:PORT\"\n</code></pre> <p>Then run: </p> <pre><code>sudo systemctl daemon-reload\nsudo systemctl restart docker\n</code></pre>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/", "title": "Run Cortex with Docker", "text": ""}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#run-cortex-with-docker", "title": "Run Cortex with Docker", "text": "<p>This topic provides step-by-step instructions for running Cortex with Docker or Podman.</p>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#prerequisites-and-alternatives", "title": "Prerequisites and alternatives", "text": "<p>To run the Docker image, you need Docker\u2014no surprises there. Alternatively, you can also use Podman as a compatible option.</p>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#default-configuration-of-the-cortex-docker-image", "title": "Default configuration of the Cortex Docker image", "text": "<p>By default, the Docker image generates a Cortex configuration file with the following settings:</p> <ul> <li>It sets the Elasticsearch URI by resolving the host name <code>elasticsearch</code>.</li> <li>It uses the official locations for analyzers and responders.</li> <li>It includes a generated secret to secure user sessions.</li> </ul>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#customizing-cortex-docker-image-behavior", "title": "Customizing Cortex Docker image behavior", "text": "<p>You can customize the behavior of the Cortex Docker image using environment variables or command-line parameters:</p> Parameter Environment variable Description <code>--no-config</code> <code>no_config=1</code> Don't configure Cortex <code>--no-config-secret</code> <code>no_config_secret=1</code> Don't add the random secret to the configuration <code>--no-config-es</code> <code>no_config_es=1</code> Don't add Elasticsearch hosts to the configuration <code>--es-uri &lt;uri&gt;</code> <code>es_uri=&lt;uri&gt;</code> Configure Elasticsearch hosts with this string (format: http(s)://host:port,host:port(/prefix)?querystring) <code>--es-hostname &lt;host&gt;</code> <code>es_hostname=host</code> Resolve this host name to locate Elasticsearch instances <code>--secret &lt;secret&gt;</code> <code>secret=&lt;secret&gt;</code> Secret used to secure sessions <code>--show-secret</code> <code>show_secret=1</code> Display the generated secret <code>--job-directory &lt;dir&gt;</code> <code>job_directory=&lt;dir&gt;</code> Directory to store job files <code>--docker-job-directory &lt;dir&gt;</code> <code>docker_job_directory=&lt;dir&gt;</code> Host directory corresponding to the job directory (outside the container) <code>--analyzer-url &lt;url&gt;</code> <code>analyzer_urls=&lt;url&gt;,&lt;url&gt;,...</code> URLs or paths where analyzers are located <code>--responder-url &lt;url&gt;</code> <code>responder_urls=&lt;url&gt;,&lt;url&gt;,...</code> URLs or paths where responders are located <code>--start-docker</code> <code>start_docker=1</code> Start an internal Docker daemon inside the container to run analyzers/responders <code>--daemon-user &lt;user&gt;</code> <code>daemon_user=&lt;user&gt;</code> Run Cortex using this user <p>The command-line parameters and environment variables documented here are used to customize Cortex when the container starts. These are converted into settings inside the <code>application.conf</code> configuration file, whose available options and structure are documented separately in Parameters for Docker.</p>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#overriding-configuration-with-a-custom-file", "title": "Overriding configuration with a custom file", "text": "<p>The generated configuration includes the file <code>/etc/cortex/application.conf</code> at the end. You can override any setting by mounting your own <code>application.conf</code> file to this path.</p> <pre><code>docker run --volume /path/to/my/application.conf:/etc/cortex/application.conf thehiveproject/cortex:latest --es-uri http://&lt;elasticsearch-host&gt;:9200\n</code></pre> <p>Cortex uses Docker to run analyzers and responders. When running Cortex inside a Docker container, you can:</p> <ul> <li>Grant Cortex access to the Docker or Podman service (recommended approach)</li> <li>Start a Docker service inside the Cortex Docker container</li> </ul> <p>If your environment requires Docker registry authentication, add the following block to your Cortex <code>application.conf</code> file:</p> <pre><code>docker {\n  host = \"&lt;docker-host-url&gt;\"\n  tlsVerify = true \n  certPath = \"/path/to/ca/certificates\"\n  registry {\n    user = \"&lt;registry-username&gt;\"\n    password = \"&lt;registry-password&gt;\"\n  }\n}\n</code></pre> <p>Only configure the <code>host</code>, <code>tlsVerify</code>, and <code>certPath</code> parameters if you're connecting to a remote Docker daemon. You don't need to set them for local Docker setups.</p> <p>Use the <code>registry</code> section only when you pull images from a private Docker registry that requires authentication.</p> <p>Registry behavior</p> <ul> <li>Public registries like Docker Hub typically don\u2019t need credentials. Adding authentication to public pulls may cause failures.</li> <li>Cortex supports only one registry credentials set for all image pulls. It can't handle different credentials for different registries.</li> <li>The target registry is determined by the FQDN, such as <code>harbor.example.com/project/image:tag</code>.</li> </ul>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#running-cortex-with-docker", "title": "Running Cortex with Docker", "text": ""}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#using-the-host-docker-service", "title": "Using the host Docker service", "text": "<p>To allow Cortex to use the Docker service, you must bind the Docker socket into the Cortex container. Since Cortex shares job files with analyzers, you also need to bind a shared folder between Cortex and the analyzers.</p> <pre><code>docker run --volume /var/run/docker.sock:/var/run/docker.sock --volume /var/run/cortex/jobs:/tmp/cortex-jobs thehiveproject/cortex:latest --job-directory /tmp/cortex-jobs --docker-job-directory /var/run/cortex/jobs\n</code></pre> <p>Cortex creates Docker containers via the Docker socket <code>/var/run/docker.sock</code>. The directory <code>/var/run/cortex/jobs</code> stores temporary job files on the host, and <code>/tmp/cortex-jobs</code> is the corresponding path inside the container. Cortex requires both paths via <code>--job-directory</code> (inside container) and <code>--docker-job-directory</code> (host path) so job files are available to analyzers. Usually, when host and container paths are the same, <code>--docker-job-directory</code> can be omitted.</p> <p>On Windows, Docker service is accessible through the named pipe <code>\\\\.\\pipe\\docker_engine</code>. The command changes accordingly:</p> <pre><code>docker run --volume //./pipe/docker_engine://./pipe/docker_engine --volume C:\\\\CORTEX\\\\JOBS:/tmp/cortex-jobs thehiveproject/cortex:latest --job-directory /tmp/cortex-jobs --docker-job-directory C:\\\\CORTEX\\\\JOBS\n</code></pre>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#running-docker-inside-cortex-container-docker-in-docker", "title": "Running Docker inside Cortex container (Docker-in-Docker)", "text": "<p>You can also run a Docker service inside the Cortex container itself\u2014essentially Docker within Docker\u2014by using the <code>--start-docker</code> parameter. Note that you must start the container in privileged mode.</p> <pre><code>docker run --privileged thehiveproject/cortex:latest --start-docker\n</code></pre> <p>In this mode, you don\u2019t need to bind any job directories since the Docker daemon runs inside the container.</p>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#using-docker-compose-to-start-cortex-and-elasticsearch", "title": "Using Docker Compose to start Cortex and Elasticsearch", "text": "<p>Cortex requires Elasticsearch to run. You can use Docker Compose to start both services together, or install and configure Elasticsearch manually.</p> <p>Docker Compose enables you to launch multiple containers and link them.</p> <p>The following docker-compose.yml file starts Elasticsearch and Cortex:</p> <pre><code>version: \"2\"\nservices:\n  elasticsearch:\n    image: elasticsearch:7.9.1\n    environment:\n      - http.host=0.0.0.0\n      - discovery.type=single-node\n      - script.allowed_types=inline\n      - thread_pool.search.queue_size=100000\n      - thread_pool.write.queue_size=10000\n    volumes:\n      - /path/to/data:/usr/share/elasticsearch/data\n  cortex:\n    image: thehiveproject/cortex:3.1.1\n    environment:\n      - job_directory=${job_directory}\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ${job_directory}:${job_directory}\n    depends_on:\n      - elasticsearch\n    ports:\n      - \"0.0.0.0:9001:9001\"\n</code></pre> <p>Place this Docker Compose file and the corresponding .env file in an empty folder, then run <code>docker-compose up</code>. Cortex is available on port 9001/tcp by default, which you can customize in the compose file.</p> <p>Advanced configuration</p> <p>For advanced configuration, visit the StrangeBee Docker Templates repository.</p>"}, {"location": "cortex/installation-and-configuration/run-cortex-with-docker/#running-cortex-with-podman", "title": "Running Cortex with PodmanNext steps", "text": "<p>Podman is an open-source container engine designed as a drop-in replacement for Docker. It allows you to run containers without requiring a daemon and can run in rootless mode for improved security.</p> <p>Like Docker, Podman can run the Cortex container image as well as its analyzers. The examples below assume you run the containers in rootful mode.</p> <p>For Cortex to interact with Podman, it requires access to the Podman socket. On some systems, Podman automatically installs and enables this socket service.</p> <p>You can check whether the Podman socket service is running on your system with this command:</p> <pre><code>systemctl status podman.socket\n</code></pre> <p>By default, the Podman socket resides at <code>/run/podman/podman.sock</code>. This path may vary depending on your system configuration.</p> <p>Configuring Cortex to run analyzers with Podman</p> <p>To allow Cortex to run analyzers with Podman, mount the Podman socket inside the container at <code>/var/run/docker.sock</code>:</p> <pre><code>podman run \\\n  --rm \\\n  --name cortex \\\n  -p 9001:9001 \\\n  -v /var/run/cortex/jobs:/tmp/cortex-jobs \\\n  -v /run/podman/podman.sock:/var/run/docker.sock \\\n  docker.io/thehiveproject/cortex:3.1.7 \\\n  --job-directory /tmp/cortex-jobs \\\n  --docker-job-directory /var/run/cortex/jobs \\\n  --es-uri http://&lt;elasticsearch-ip&gt;:9200\n</code></pre> <p>With this setup, Cortex will use Podman to run analyzers inside the container.</p> <p>Image not found</p> <p>Podman may encounter issues pulling Cortex analyzer images from the default Docker registry. To fix this, add <code>docker.io</code> as an unqualified registry in your Podman configuration.</p> <p>Edit <code>/etc/containers/registries.conf</code> and add:</p> <pre><code>unqualified-search-registries = ['docker.io']\n</code></pre> <p>After making this change, restart the Podman socket service to apply the update.</p> <p>Docker in Podman</p> <p>You can run Docker inside a Podman container by using the <code>--privileged</code> flag:</p> <pre><code>podman run \\\n  --privileged \\\n  --rm \\\n  --name cortex \\\n  -p 9001:9001 \\\n  docker.io/thehiveproject/cortex:3.1.7 \\\n  --es-uri http://&lt;elasticsearch-ip&gt;:9200 \\\n  --start-docker\n</code></pre> <ul> <li>Parameters for Docker</li> </ul>"}, {"location": "cortex/installation-and-configuration/secret/", "title": "Secret key configuration", "text": ""}, {"location": "cortex/installation-and-configuration/secret/#secret-key-configuration", "title": "Secret key configuration", "text": "<p>Setup a secret key for this instance: </p> <pre><code>cat &gt; /etc/cortex/secret.conf &lt;&lt; _EOF_\nplay.http.secret.key=\"$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 64 | head -n 1)\"\n_EOF_\n</code></pre> <p>Then, in the file <code>/etc/cortex/application.conf</code>, replace the line including <code>play.http.secret.key=</code> by:</p> /etc/cortex/application.conf<pre><code>[..]\ninclude \"/etc/cortex/secret.conf\"\n[..]\n</code></pre>"}, {"location": "cortex/installation-and-configuration/ssl/", "title": "Configure SSL", "text": ""}, {"location": "cortex/installation-and-configuration/ssl/#configure-ssl", "title": "Configure SSL", "text": ""}, {"location": "cortex/installation-and-configuration/ssl/#connect-cortex-using-https", "title": "Connect Cortex using HTTPS", "text": "<p>We recommend using a reverse proxy to manage SSL layer; for example, Nginx.</p> Nginx <p>Reference: Configuring HTTPS servers on nginx.org</p> /etc/nginx/sites-available/cortex.conf<pre><code>server {\n  listen 443 ssl http2;\n  server_name cortex;\n\n  ssl on;\n  ssl_certificate       path-to/cortex-server-chained-cert.pem;\n  ssl_certificate_key   path-to/cortex-server-key.pem;\n\n  proxy_connect_timeout   600;\n  proxy_send_timeout      600;\n  proxy_read_timeout      600;\n  send_timeout            600;\n  client_max_body_size    2G;\n  proxy_buffering off;\n  client_header_buffer_size 8k;\n\n  location / {\n    add_header              Strict-Transport-Security \"max-age=31536000; includeSubDomains\";\n    proxy_pass              http://127.0.0.1:9001/;\n    proxy_http_version      1.1;\n  }\n}\n</code></pre>"}, {"location": "cortex/installation-and-configuration/ssl/#certificate-manager", "title": "Certificate manager", "text": "<p>Certificate manager is used to store client certificates and certificate authorities.</p>"}, {"location": "cortex/installation-and-configuration/ssl/#use-custom-certificate-authorities", "title": "Use custom certificate authorities", "text": "<p>The prefered way to use custom certificate authorities is to use the system configuration. </p> <p>If setting up a custom certificate authority (to connect web proxies, remote services like LPAPS server ...) is required globally in the application, the better solution consists of installing it on the OS and restarting Cortex. </p> DebianRPM <p>Ensure the package <code>ca-certificates-java</code> is installed , and copy the CA certificate in the right folder. Then run <code>dpkg-reconfigure ca-certificates</code> and restart Cortex service. </p> <pre><code>apt-get install -y ca-certificates-java\nmkdir /usr/share/ca-certificates/extra\ncp mycustomcert.crt /usr/share/ca-certificates/extra\ndpkg-reconfigure ca-certificates\nservice cortex restart\n</code></pre> <p>No additionnal packages is required on Fedora or RHEL. Copy the CA certificate in the right folder, run <code>update-ca-trust</code> and restart Cortex service.</p> <pre><code>cp mycustomcert.crt /etc/pki/ca-trust/source/anchors\nsudo update-ca-trust \nservice cortex restart\n</code></pre>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/", "title": "Step-by-Step Guide", "text": ""}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#step-by-step-guide", "title": "Step-by-Step Guide", "text": "<p>This page is a step by step installation and configuration guide to get a Cortex instance up and running. This guide is illustrated with examples for Debian and RPM packages based systems and for installation from ZIP binary packages.</p>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#required-packages", "title": "Required packages", "text": "DEBRPM <pre><code>apt install wget curl gnupg coreutils apt-transport-https git ca-certificates ca-certificates-java software-properties-common python3-pip lsb-release unzip\n</code></pre> <pre><code>yum install wget curl gnupg2 coreutils chkconfig python3-pip git unzip\n</code></pre>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#java-virtual-machine", "title": "Java Virtual Machine", "text": "<p>Manual installation required</p> <p>Starting with Cortex 3.2, the Java Virtual Machine is no longer installed automatically. You must manually install it before running Cortex.</p> <p>Install Java</p> <p>For enhanced security and long-term support, use Amazon Corretto, an OpenJDK build provided and maintained by Amazon. Corretto 11 or higher is required to install Cortex.</p> DEBRPMOther <ol> <li>Open a terminal window.</li> <li> <p>Execute the following commands:</p> <pre><code>wget -qO- https://apt.corretto.aws/corretto.key | sudo gpg --dearmor -o /usr/share/keyrings/corretto.gpg\necho \"deb [signed-by=/usr/share/keyrings/corretto.gpg] https://apt.corretto.aws stable main\" | sudo tee -a /etc/apt/sources.list.d/corretto.sources.list\nsudo apt update\nsudo apt install java-common java-11-amazon-corretto-jdk\necho JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\" | sudo tee -a /etc/environment\nexport JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\"\n</code></pre> </li> <li> <p>Verify the installation by running:</p> <pre><code>java -version\n</code></pre> </li> <li> <p>You should see output similar to the following:</p> <pre><code>openjdk version \"11.0.12\" 2022-07-19\nOpenJDK Runtime Environment Corretto-11.0.12.7.1 (build 11.0.12+7-LTS)\nOpenJDK 64-Bit Server VM Corretto-11.0.12.7.1 (build 11.0.12+7-LTS, mixed mode)\n</code></pre> </li> </ol> <ol> <li>Open a terminal window.</li> <li> <p>Execute the following commands:</p> <pre><code>sudo rpm --import https://yum.corretto.aws/corretto.key &amp;&gt; /dev/null\nwget -qO- https://yum.corretto.aws/corretto.repo | sudo tee -a /etc/yum.repos.d/corretto.repo\nyum install java-11-amazon-corretto-devel &amp;&gt; /dev/null\necho JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\" | sudo tee -a /etc/environment\nexport JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\"\n</code></pre> </li> <li> <p>Verify the installation by running:</p> <pre><code>java -version\n</code></pre> </li> <li> <p>You should see output similar to the following:</p> <pre><code>openjdk version \"11.0.12\" 2022-07-19\nOpenJDK Runtime Environment Corretto-11.0.12.7.1 (build 11.0.12+7-LTS)\nOpenJDK 64-Bit Server VM Corretto-11.0.12.7.1 (build 11.0.12+7-LTS, mixed mode)\n</code></pre> </li> </ol> <p>The installation requires Java 11, so refer to your system documentation to install it.</p>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#elasticsearch", "title": "Elasticsearch", "text": "<p>Elasticsearch supported versions</p> <p>Cortex supports only Elasticsearch version 7.x.</p> DEBRPM <pre><code>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch |  sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg\necho \"deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/7.x/apt stable main\" |  sudo tee /etc/apt/sources.list.d/elastic-7.x.list \nsudo apt install elasticsearch   \n</code></pre> /etc/yum.repos.d/elasticsearch.repo<pre><code>[elasticsearch]\nname=Elasticsearch repository for 7.x packages\nbaseurl=https://artifacts.elastic.co/packages/7.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=0\nautorefresh=1\ntype=rpm-md\n</code></pre> <pre><code>sudo yum install --enablerepo=elasticsearch elasticsearch\n</code></pre>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#configuration", "title": "Configuration", "text": "<p>Example</p> /etc/elasticsearch/elasticsearch.yml<pre><code>http.host: 127.0.0.1\ntransport.host: 127.0.0.1\ncluster.name: hive\nthread_pool.search.queue_size: 100000\npath.logs: \"/var/log/elasticsearch\"\npath.data: \"/var/lib/elasticsearch\"\nxpack.security.enabled: &lt;boolean&gt;\nscript.allowed_types: \"inline,stored\"\n</code></pre> <p>Set <code>&lt;boolean&gt;</code> to <code>false</code> to turn off authentication, or <code>true</code> to enable it.</p> <p>Adjust this file according to the amount of RAM available on your server: </p> /etc/elasticsearch/jvm.options.d/jvm.options<pre><code>-Dlog4j2.formatMsgNoLookups=true\n-Xms4g\n-Xmx4g\n</code></pre> <p>If authentication is enabled, configure the credentials service after starting Elasticsearch, using the instructions in Set a user with the right permissions.</p>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#docker", "title": "Docker", "text": "<p>If using Docker images of analyzers and responders, Docker engine is required on the operating system:</p> DEBRPM <pre><code>. /etc/os-release\ncurl -fsSL https://download.docker.com/linux/${ID}/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\necho \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/${ID} ${VERSION_CODENAME:-$UBUNTU_CODENAME} stable\" | sudo tee /etc/apt/sources.list.d/docker.list\nsudo apt update\nsudo apt install docker-ce\n</code></pre> <pre><code>. /etc/os-release\nsudo yum remove -yq docker \\\n          docker-client \\\n          docker-client-latest \\\n          docker-common \\\n          docker-latest \\\n          docker-latest-logrotate \\\n          docker-logrotate \\\n          docker-engine\nsudo dnf -yq install dnf-plugins-core\nsudo dnf config-manager --add-repo https://download.docker.com/linux/${ID}/docker-ce.repo\nsudo dnf install -yq docker-ce docker-ce-cli containerd.io docker-compose-plugin\n</code></pre>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#cortex-installation-and-configuration", "title": "Cortex installation and configuration", "text": "<p>This section provides step-by-step instructions to install Cortex and configure it properly.</p>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#installation", "title": "Installation", "text": "<p>Cortex packages are distributed as RPM and DEB files available for direct download via tools like Wget or cURL, with installation performed manually.</p> <p>All packages are hosted on an HTTPS-secured website and come with a SHA256 checksum and a GPG signature for verification.</p> DEBRPMZIP binary packages <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/cortex_3.2.1-2_all.deb https://cortex.download.strangebee.com/3.2/deb/cortex_3.2.1-2_all.deb\nwget -O /tmp/cortex_3.2.1-2_all.deb.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex_3.2.1-2_all.deb.sha256\nwget -O /tmp/cortex_3.2.1-2_all.deb.asc https://cortex.download.strangebee.com/3.2/asc/cortex_3.2.1-2_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.deb https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\nwget -O /tmp/&lt;file_name&gt;.deb.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\nwget -O /tmp/&lt;file_name&gt;.deb.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex_3.1.8-1_all</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/cortex_3.2.1-2_all.deb https://cortex.download.strangebee.com/3.2/deb/cortex_3.2.1-2_all.deb\ncurl -o /tmp/cortex_3.2.1-2_all.deb.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex_3.2.1-2_all.deb.sha256\ncurl -o /tmp/cortex_3.2.1-2_all.deb.asc https://cortex.download.strangebee.com/3.2/asc/cortex_3.2.1-2_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.deb https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\ncurl -o /tmp/&lt;file_name&gt;.deb.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\ncurl -o /tmp/&lt;file_name&gt;.deb.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex_3.1.8-1_all</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/cortex_3.2.1-2_all.deb\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/cortex_3.2.1-2_all.deb.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/cortex_3.2.1-2_all.deb.asc /tmp/cortex_3.2.1-2_all.deb\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>apt-get</code> to manage dependencies automatically:</p> <pre><code>sudo apt-get install /tmp/cortex_3.2.1-2_all.deb\n</code></pre> </li> <li> <p>Using <code>dpkg</code>:</p> <pre><code>sudo dpkg -i /tmp/cortex_3.2.1-2_all.deb\n</code></pre> </li> </ul> </li> </ol> <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/cortex-3.2.1-2.noarch.rpm https://cortex.download.strangebee.com/3.2/rpm/cortex-3.2.1-2.noarch.rpm\nwget -O /tmp/cortex-3.2.1-2.noarch.rpm.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.noarch.rpm.sha256\nwget -O /tmp/cortex-3.2.1-2.noarch.rpm.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.noarch.rpm https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/cortex-3.2.1-2.noarch.rpm https://cortex.download.strangebee.com/3.2/rpm/cortex-3.2.1-2.noarch.rpm\ncurl -o /tmp/cortex-3.2.1-2.noarch.rpm.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.noarch.rpm.sha256\ncurl -o /tmp/cortex-3.2.1-2.noarch.rpm.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.noarch.rpm https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/cortex-3.2.1-2.noarch.rpm.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/cortex-3.2.1-2.noarch.rpm.asc /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>yum</code> to manage dependencies automatically:</p> <pre><code>sudo yum install /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>dnf</code> to manage dependencies automatically:</p> <pre><code>sudo dnf install /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>rpm</code>:</p> <pre><code>sudo rpm -ivh /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> </ul> </li> </ol> <p>If you prefer more control over where Cortex is installed, need to use it in environments without package managers, or want to avoid dependency issues, you can install Cortex by downloading a ZIP binary package.</p> <p>Destination path</p> <p>The commands below use <code>/opt/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the binary package along with its SHA256 checksum and signature files. You can install Cortex anywhere on your filesystem.</p> <ul> <li> <p>Using Wget</p> <pre><code>wget -O /opt/cortex/cortex-3.2.1-2.zip https://cortex.download.strangebee.com/3.2/zip/cortex-3.2.1-2.zip\nwget -O /opt/cortex/cortex-3.2.1-2.zip.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.zip.sha256\nwget -O /opt/cortex/cortex-3.2.1-2.zip.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.zip.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /opt/&lt;file_name&gt;.zip cortex.download.strangebee.com/&lt;major.minor_version&gt;/zip/&lt;file_name&gt;.zip\nwget -O /opt/&lt;file_name&gt;.zip.sha256 cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.zip.sha256\nwget -O /opt/&lt;file_name&gt;.zip.asc cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.zip.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> <li> <p>Using cURL</p> <pre><code>curl -o /opt/cortex/cortex-3.2.1-2.zip https://cortex.download.strangebee.com/3.2/zip/cortex-3.2.1-2.zip\ncurl -o /opt/cortex/cortex-3.2.1-2.zip.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.zip.sha256\ncurl -o /opt/cortex/cortex-3.2.1-2.zip.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.zip.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /opt/&lt;file_name&gt;.zip cortex.download.strangebee.com/&lt;major.minor_version&gt;/zip/&lt;file_name&gt;.zip\ncurl -o /opt/&lt;file_name&gt;.zip.sha256 cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.zip.sha256\ncurl -o /opt/&lt;file_name&gt;.zip.asc cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.zip.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /opt/cortex-3.2.1-2.zip\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /opt/cortex-3.2.1-2.zip.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with unzipping or installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <pre><code>wget -O /opt/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /opt/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /opt/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /opt/cortex-3.2.1-2.zip.asc /opt/cortex-3.2.1-2.zip\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Unzip the package.</p> <p>Unzip paths</p> <ul> <li>Replace <code>/opt/cortex-3.2.1-2.zip</code> with the full path to the ZIP file you downloaded.</li> <li>Replace <code>/opt/</code> after <code>-d</code> with the directory where you want to extract the contents of the archive.</li> </ul> <pre><code>unzip /opt/cortex-3.2.1-2.zip -d /opt/\nsudo ln -s /opt/cortex-3.2.1-2 /opt/cortex\n</code></pre> </li> <li> <p>Make the Cortex binary executable.</p> <pre><code>cd /opt/\nchmod +x cortex\n</code></pre> </li> </ol>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#post-installation-configuration", "title": "Post-installation configuration", "text": ""}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#running-analyzers-responders-with-docker", "title": "Running analyzers &amp; responders with Docker", "text": "<p>If you plan to use Cortex with Analyzers &amp; Responders running in Docker, ensure the <code>cortex</code> service account has appropriate permissions to interact with Docker:</p> <pre><code>sudo usermod -a -G docker cortex\n</code></pre>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#verify-installation", "title": "Verify installation", "text": "<p>After installation, you can check if Cortex is properly installed by running:</p> <pre><code>cortex --version\n</code></pre> <p>This should return the installed version of Cortex.</p>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#configuration_1", "title": "Configuration", "text": "<p>Following settings are required to start Cortex successfully:</p> <ul> <li>Secret key configuration</li> <li>Database configuration</li> <li>Authentication</li> <li>Analyzers &amp; Responders configuration</li> </ul> <p>Advanced configuration settings might be added to run the application successfully: </p> <ul> <li>Specific Docker parameters</li> <li>Proxy settings</li> <li>SSL configuration</li> </ul>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#start-cortex-service", "title": "Start Cortex service", "text": "<p>Warning</p> <p>Before starting the service, ensure to have configured accordingly the application. Start by setting up the secret key.</p> <p>Save configuration file and run the service:</p> <pre><code>systemctl start cortex\n</code></pre> <p>Please note that the service may take some time to start. Once it is started, you may launch your browser and connect to <code>http://YOUR_SERVER_ADDRESS:9001/</code>. </p>"}, {"location": "cortex/installation-and-configuration/step-by-step-guide/#first-start", "title": "First start", "text": "<p>Refer to the First start guide for the next steps.</p>"}, {"location": "cortex/operations/backup-restore/", "title": "Backup & Restore", "text": ""}, {"location": "cortex/operations/backup-restore/#backup-and-restore-data", "title": "Backup and restore data", "text": "<p>All persistent data is stored in an Elasticsearch database. The backup and restore procedures are the ones that are detailed in Elasticsearch documentation.</p> <p>Note: you may have to adapt your indices in the examples below. To find the right index, use the following command :</p> <pre><code>curl 'localhost:9200/_cat/indices?v'\n</code></pre> <p>To save all your data you only need to backup the last indice. For example, if the previous command gives you the following results, all your data belongs to cortex_1.</p> <p>In the rest of this document, ensure to change  to your own last index in order to backup or restore all your data.</p>"}, {"location": "cortex/operations/backup-restore/#1-create-a-backup-repository", "title": "1. Create a backup repository", "text": "<p>First you must define a location in local filesystem (where Elasticsearch instance runs) where the backup will be written. This repository must be declared in the Elasticsearch configuration. Edit elasticsearch.yml file by adding:</p> <pre><code>path.repo: [\"/absolute/path/to/backup/directory\"]\n</code></pre> <p>Then, restart the Elasticsearch service.</p> <p>Note: Be careful if you run Elasticsearch in Docker, the directory must be mapped in host filesystem using <code>--volume</code> parameter (cf. Docker documentation).</p>"}, {"location": "cortex/operations/backup-restore/#2-register-a-snapshot-repository", "title": "2. Register a snapshot repository", "text": "<p>Create an Elasticsearch snapshot point named cortex_backup with the following command (set the same path in the location setting as the one set in the configuration file):</p> <pre><code>$ curl -XPUT 'http://localhost:9200/_snapshot/cortex_backup' -d '{\n    \"type\": \"fs\",\n    \"settings\": {\n        \"location\": \"/absolute/path/to/backup/directory\",\n        \"compress\": true\n    }\n}'\n</code></pre> <p>The result of the command should look like this :</p> <pre><code>{\"acknowledged\":true}\n</code></pre> <p>Since, everything is fine to backup and restore data.</p>"}, {"location": "cortex/operations/backup-restore/#3-backup-your-data", "title": "3. Backup your data", "text": "<p>Create a backup named snapshot_1 of all your data by executing the following command :</p> <p></p><pre><code>$ curl -XPUT 'http://localhost:9200/_snapshot/cortex_backup/snapshot_1?wait_for_completion=true&amp;pretty' -d '{\n  \"indices\": \"&lt;INDEX&gt;\"\n}'\n</code></pre> This command terminates only when the backup is complete and the result of the command should look like this:<p></p> <pre><code>{\n  \"snapshots\": [{\n    \"snapshot\": \"snapshot_1\",\n    \"uuid\": \"ZQ3kv5-FQoeN3NFIhfKgMg\",\n    \"version_id\": 5060099,\n    \"version\": \"5.6.0\",\n    \"indices\": [\"cortex_1\"],\n    \"state\": \"SUCCESS\",\n    \"start_time\": \"2018-01-29T14:41:51.580Z\",\n    \"start_time_in_millis\": 1517236911580,\n    \"end_time\": \"2018-01-29T14:42:05.216Z\",\n    \"end_time_in_millis\": 1517236925216,\n    \"duration_in_millis\": 13636,\n    \"failures\": [],\n    \"shards\": {\n      \"total\": 41,\n      \"failed\": 0,\n      \"successful\": 41\n    }\n  }]\n}\n</code></pre> <p>Note: You can backup the last index of Cortex (you can list indices in your Elasticsearch cluster with <code>curl -s http://localhost:9200/_cat/indices | cut -d ' '  -f3</code> ) or all indices with <code>_all</code> value.</p>"}, {"location": "cortex/operations/backup-restore/#4-restore-data", "title": "4. Restore data", "text": "<p>Restore will do the reverse actions : it reads the backup in your snapshot directory and loads indices into the Elasticsearch cluster. This operation is done with the following command : </p><pre><code>$ curl -XPOST 'http://localhost:9200/_snapshot/cortex_backup/snapshot_1/_restore' -d '\n{\n  \"indices\": \"&lt;INDEX&gt;\"\n}'\n</code></pre><p></p> <p>The result of the command should look like this :</p> <pre><code>{\"accepted\":true}\n</code></pre> <p>Note: be sure to restore data from the same version of Elasticsearch.</p>"}, {"location": "cortex/operations/backup-restore/#5-moving-data-from-one-server-to-another", "title": "5. Moving data from one server to another", "text": "<p>If you want to move your data from one server from another: - Create your backup on the origin server (steps 1, 2, 3) - copy your backup directory from the origin server to the destination server - On the destination server :     - Register your backup repository in the Elasticsearch configuration (step 1)     - Register your snapshot repository with the same snapshot name (step 2)     - Restore your data (step 4)</p>"}, {"location": "cortex/operations/input-output/", "title": "Analyzers/Responders input and output", "text": ""}, {"location": "cortex/operations/input-output/#analyzers-responders-communication", "title": "Analyzers / Responders communication", "text": "<p>From version 3, cortexutils 2.x is required because communication between Cortex and the analyzers/responders has changed. Analyzers and responders doesn't need to be rewritten if they use cortexutils. Cortex 2 send data using stdin and receive result from stdout.</p> <p>Cortex 3 uses files: a job is stored in a folder with the following structure:</p> <pre><code>job_folder\n  \\_ input\n   |    \\_ input.json    &lt;- input data, equivalent to stdin with Cortex 2.x\n   |    |_ attachment    &lt;- optional extra file when analysis concerns a file\n   |_ output\n        \\_ output.json   &lt;- report of the analysis (generated by analyzer or responder)\n        |_ extra_file(s) &lt;- optional extra files linked to report (generated by analyzer)\n</code></pre> <p>Job folder is provided to analyzer/responder as argument. Currently, only one job is acceptable but in future release, analyzer/responder will accept several job at a time (bulk mode) in order to increase performance.</p>"}, {"location": "cortex/operations/switch-to-manual-download-installation-cortex/", "title": "Switch to Manual Download and Installation", "text": ""}, {"location": "cortex/operations/switch-to-manual-download-installation-cortex/#switch-to-manual-download-and-installation-for-cortex", "title": "Switch to Manual Download and Installation for Cortex", "text": "<p>This topic provides step-by-step instructions for switching from APT and YUM repositories to a manual process for installing and upgrading Cortex, following the APT and YUM repositories deprecation notice.</p> <p>For instructions on performing the same process for TheHive, see Switch to Manual Download and Installation for TheHive.</p> <p>Are you concerned?</p> <p>Use this procedure if you currently install or update Cortex on Linux distributions using <code>apt-get install</code>, <code>apt-get upgrade</code>, <code>yum install</code>, or <code>yum update</code>.</p> <p>You aren't affected if you run Cortex through Docker deployments.</p> <p>If you are a new user, follow the instructions in the step-by-step installation guide.</p> <p>Dependencies</p> <p>Before starting this procedure, run the following commands:</p> Procedure"}, {"location": "cortex/operations/switch-to-manual-download-installation-cortex/#for-deb-based-systems", "title": "For DEB-based systems:", "text": "<pre><code>sudo apt update\nsudo apt install wget curl gnupg coreutils\n</code></pre>"}, {"location": "cortex/operations/switch-to-manual-download-installation-cortex/#for-rpm-based-systems", "title": "For RPM-based systems:", "text": "<pre><code>sudo yum update\nsudo yum install wget curl gnupg coreutils\n</code></pre>"}, {"location": "cortex/operations/switch-to-manual-download-installation-cortex/#step-1-manually-install-cortex", "title": "Step 1: Manually install Cortex", "text": "DEBRPM <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/cortex_3.2.1-2_all.deb https://cortex.download.strangebee.com/3.2/deb/cortex_3.2.1-2_all.deb\nwget -O /tmp/cortex_3.2.1-2_all.deb.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex_3.2.1-2_all.deb.sha256\nwget -O /tmp/cortex_3.2.1-2_all.deb.asc https://cortex.download.strangebee.com/3.2/asc/cortex_3.2.1-2_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.deb https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\nwget -O /tmp/&lt;file_name&gt;.deb.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\nwget -O /tmp/&lt;file_name&gt;.deb.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex_3.1.8-1_all</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/cortex_3.2.1-2_all.deb https://cortex.download.strangebee.com/3.2/deb/cortex_3.2.1-2_all.deb\ncurl -o /tmp/cortex_3.2.1-2_all.deb.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex_3.2.1-2_all.deb.sha256\ncurl -o /tmp/cortex_3.2.1-2_all.deb.asc https://cortex.download.strangebee.com/3.2/asc/cortex_3.2.1-2_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.deb https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\ncurl -o /tmp/&lt;file_name&gt;.deb.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\ncurl -o /tmp/&lt;file_name&gt;.deb.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex_3.1.8-1_all</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/cortex_3.2.1-2_all.deb\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/cortex_3.2.1-2_all.deb.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/cortex_3.2.1-2_all.deb.asc /tmp/cortex_3.2.1-2_all.deb\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>apt-get</code> to manage dependencies automatically:</p> <pre><code>sudo apt-get install /tmp/cortex_3.2.1-2_all.deb\n</code></pre> </li> <li> <p>Using <code>dpkg</code>:</p> <pre><code>sudo dpkg -i /tmp/cortex_3.2.1-2_all.deb\n</code></pre> </li> </ul> </li> </ol> <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/cortex-3.2.1-2.noarch.rpm https://cortex.download.strangebee.com/3.2/rpm/cortex-3.2.1-2.noarch.rpm\nwget -O /tmp/cortex-3.2.1-2.noarch.rpm.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.noarch.rpm.sha256\nwget -O /tmp/cortex-3.2.1-2.noarch.rpm.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.noarch.rpm https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/cortex-3.2.1-2.noarch.rpm https://cortex.download.strangebee.com/3.2/rpm/cortex-3.2.1-2.noarch.rpm\ncurl -o /tmp/cortex-3.2.1-2.noarch.rpm.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.noarch.rpm.sha256\ncurl -o /tmp/cortex-3.2.1-2.noarch.rpm.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.noarch.rpm https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/cortex-3.2.1-2.noarch.rpm.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/cortex-3.2.1-2.noarch.rpm.asc /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>yum</code> to manage dependencies automatically:</p> <pre><code>sudo yum install /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>dnf</code> to manage dependencies automatically:</p> <pre><code>sudo dnf install /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>rpm</code>:</p> <pre><code>sudo rpm -ivh /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> </ul> </li> </ol>"}, {"location": "cortex/operations/switch-to-manual-download-installation-cortex/#step-2-remove-the-old-repository", "title": "Step 2: Remove the old repository", "text": "<p>Then, remove or deactivate the old repository to avoid stale configurations.</p> <p>Why you should remove or deactivate the old repository</p> <p>Keeping the old repository configuration can cause your system to download outdated or conflicting packages during updates, potentially breaking your installation or causing unexpected behavior.</p> DEBRPM <p>Run the following commands:</p> <pre><code>sudo rm /etc/apt/sources.list.d/strangebee.list\nsudo apt-get update\n</code></pre> <p>a. Deactivate the repository.</p> <pre><code>sudo yum-config-manager --disable strangebee\n</code></pre> <p>b. Optional: Remove the repository file.</p> <pre><code>sudo rm /etc/yum.repos.d/strangebee.repo\nsudo yum clean all\n</code></pre> Next steps <ul> <li>Switch to Manual Download and Installation for TheHive</li> </ul>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/", "title": "Upgrade to Cortex 3.1", "text": ""}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#migration-from-elasticsearch-682-to-es-7x", "title": "Migration from Elasticsearch 6.8.2 to ES 7.x", "text": "<p>\u26a0\ufe0f IMPORTANT NOTE</p> <ul> <li>This migration process is intended for single node of Elasticsearch database</li> <li>The current version of this document is provided for testing purpose ONLY! </li> <li>This guide has been written and tested to migrate data from ES 6.8.2 to ES 7.8.1, and Cortex 3.0.1 to Cortex 3.1.0 only!</li> <li>This guide starts with Elasticsearch version 6.8.2  up and running, indexes and data. To test this guide, we recommend using a backup of you production server. (see Backup and Restore page for more information)</li> <li>This guide is illustrated with Cortex index. The process is identical for Cortex, you just have to adjust index names.</li> </ul>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#prerequisite", "title": "Prerequisite", "text": "<p>The software <code>jq</code> is required to manipulate JSON and create new indexes. More information at https://stedolan.github.io/jq/. </p>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#identify-if-your-index-should-be-reindexed", "title": "Identify if your index should be reindexed", "text": "<p>You can easily identify if indexes should be reindexed or not. On the index named <code>cortex_4</code> run the following command: </p> <pre><code>curl -s http://127.0.0.1:9200/cortex_4?human | jq '.cortex_4.settings.index.version.created'\n</code></pre> <p>if the output is similar to <code>\"5xxxxxx\"</code>  then reindexing is required, you should follow this guide. </p> <p>If it is   <code>\"6xxxxxx\"</code> then the index can be read by Elasticsearch 7.8.x. Upgrade Elasticsearch, and Cortex 3.1.0.</p>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#migration-guide", "title": "Migration guide", "text": ""}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#current-status", "title": "Current status", "text": "<p>Current context is:  - Elasticsearch 6.8.2 - Cortex 3.0.1</p> <p>All up and running. </p> <p>Start by identifying indices on you Elasticsearch instance.</p> <pre><code>curl  http://localhost:9200/_cat/indices\\?v\n</code></pre> <p>The output should look like this: </p> <pre><code>health status index           uuid                   pri rep docs.count docs.deleted store.size pri.store.size\ngreen  open   cortex_4    Y5rDTO23RBC_n6pjFP0-Qw   5   0       8531            8       13mb           13mb \n</code></pre> <p>The index name is <code>cortex_4</code>. Record this somewhere.</p>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#stop-services", "title": "Stop services", "text": "<p>Before starting updating the database, lets stop applications:</p> <pre><code>sudo service cortex stop \n</code></pre>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#create-a-new-index", "title": "Create a new index", "text": "<p>The First operation lies in creating a new index named <code>new_cortex_4</code> with settings from current index <code>cortex_4</code> (ensure to keep index version, needed for future upgrade).</p> <pre><code>curl -XPUT 'http://localhost:9200/new_cortex_4' \\\n  -H 'Content-Type: application/json' \\\n  -d \"$(curl http://localhost:9200/cortex_4 |\\\n   jq '.cortex_4 |\n   del(.settings.index.provided_name,\n    .settings.index.creation_date,\n    .settings.index.uuid,\n    .settings.index.version,\n    .settings.index.mapping.single_type,\n    .mappings.doc._all)'\n    )\"\n</code></pre> <p>Check the new index is well created: </p> <pre><code>curl -XGET http://localhost:9200/_cat/indices\\?v\n</code></pre> <p>The output should look like this: </p> <pre><code>health status index           uuid                   pri rep docs.count docs.deleted store.size pri.store.size\ngreen  open   new_cortex_4    wRX6rhzXTuW_F2wLNxqVyg   5   0          0            0      1.1kb          1.1kb\ngreen  open   cortex_4        Y5rDTO23RBC_n6pjFP0-Qw   5   0       8531            8       13mb           13mb\n</code></pre>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#proceed-to-reindex", "title": "Proceed to reindex", "text": "<p>Next operation lies in running the reindex command in the newly created index:</p> <pre><code>curl -XPOST -H 'Content-Type: application/json' http://localhost:9200/_reindex -d '{\n  \"conflicts\": \"proceed\",\n  \"source\": {\n    \"index\": \"cortex_4\"\n  },\n  \"dest\": {\n    \"index\": \"new_cortex_4\"\n  }\n}'\n</code></pre> <p>After a moment, you should get a similar output:  </p> <pre><code>{\n    \"took\": 5119,\n    \"timed_out\": false,\n    \"total\": 5889,\n    \"updated\": 0,\n    \"created\": 5889,\n    \"deleted\": 0,\n    \"batches\": 6,\n    \"version_conflicts\": 0,\n    \"noops\": 0,\n    \"retries\": {\n        \"bulk\": 0,\n        \"search\": 0\n    },\n    \"throttled_millis\": 0,\n    \"requests_per_second\": -1.0,\n    \"throttled_until_millis\": 0,\n    \"failures\": []\n}\n</code></pre>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#ensure-new-index-has-been-created", "title": "Ensure new index has been created", "text": "<p>Run the following command, and ensure the new index is like the current one (size can vary):</p> <pre><code>curl -XGET http://localhost:9200/_cat/indices\\?v\n</code></pre> <p>The output should look like this: </p> <pre><code>health status index           uuid                   pri rep docs.count docs.deleted store.size pri.store.size\ngreen  open   new_cortex_4    wRX6rhzXTuW_F2wLNxqVyg   5   0       8531            0     12.6mb         12.6mb\ngreen  open   cortex_4        Y5rDTO23RBC_n6pjFP0-Qw   5   0       8531            8       13mb           13mb\n</code></pre>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#delete-old-indices", "title": "Delete old indices", "text": "<p>This is the thrilling part.  Now the new index <code>new_cortex_4</code> is created and similar to <code>cortex_4</code>,  older indexes should be completely deleted from the database. To delete index named <code>cortex_4</code>, run the following command:  </p> <pre><code>curl -XDELETE http://localhost:9200/cortex_4\n</code></pre> <p>Run the same command for older indexes if exist (cortex_3, cortex_2....). Elasticsearch 7.x cannot run with index created with Elasticsearch 5.x.</p>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#create-an-alias", "title": "Create an alias", "text": "<p>Before stopping Elasticsearch service, let\u2019s create an alias to keep index names in the future.  </p> <pre><code>curl -XPOST -H 'Content-Type: application/json'  'http://localhost:9200/_aliases' -d '{\n    \"actions\": [\n        {\n            \"add\": {\n                \"index\": \"new_cortex_4\",\n                \"alias\": \"cortex_4\"\n            }\n        }\n    ]\n}'\n</code></pre> <p>Doing so will allow Cortex 3.1.0  to find the index without updating the configuration file. </p> <p>Check the alias has been well created by running the following command</p> <pre><code>curl -XGET http://localhost:9200/_alias?pretty\n</code></pre> <p>The output should look like:</p> <pre><code>{\n  \"new_cortex_4\" : {\n    \"aliases\" : {\n      \"cortex_4\" : { }\n    }\n  }\n}\n</code></pre>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#stop-elasticsearch-version-682", "title": "Stop Elasticsearch version 6.8.2", "text": "<pre><code>sudo service elasticsearch stop \n</code></pre>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#update-elasticsearch", "title": "Update Elasticsearch", "text": "<p>Update the configuration of Elastisearch. Configuration file should look like this:</p> <pre><code>[..]\nhttp.host: 127.0.0.1\ndiscovery.type: single-node\ncluster.name: hive\nscript.allowed_types: inline\nthread_pool.search.queue_size: 100000\nthread_pool.write.queue_size: 10000    \n</code></pre> <p>Now, upgrade Elasticsearch to version 7.x following the documentation for your operating system, and ensure the service start successfully.</p>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#install-or-update-to-cortex-310", "title": "Install or update to Cortex 3.1.0", "text": "DEBRPMDocker <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/cortex_3.2.1-2_all.deb https://cortex.download.strangebee.com/3.2/deb/cortex_3.2.1-2_all.deb\nwget -O /tmp/cortex_3.2.1-2_all.deb.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex_3.2.1-2_all.deb.sha256\nwget -O /tmp/cortex_3.2.1-2_all.deb.asc https://cortex.download.strangebee.com/3.2/asc/cortex_3.2.1-2_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.deb https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\nwget -O /tmp/&lt;file_name&gt;.deb.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\nwget -O /tmp/&lt;file_name&gt;.deb.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex_3.1.8-1_all</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/cortex_3.2.1-2_all.deb https://cortex.download.strangebee.com/3.2/deb/cortex_3.2.1-2_all.deb\ncurl -o /tmp/cortex_3.2.1-2_all.deb.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex_3.2.1-2_all.deb.sha256\ncurl -o /tmp/cortex_3.2.1-2_all.deb.asc https://cortex.download.strangebee.com/3.2/asc/cortex_3.2.1-2_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.deb https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\ncurl -o /tmp/&lt;file_name&gt;.deb.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\ncurl -o /tmp/&lt;file_name&gt;.deb.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex_3.1.8-1_all</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/cortex_3.2.1-2_all.deb\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/cortex_3.2.1-2_all.deb.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/cortex_3.2.1-2_all.deb.asc /tmp/cortex_3.2.1-2_all.deb\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>apt-get</code> to manage dependencies automatically:</p> <pre><code>sudo apt-get install /tmp/cortex_3.2.1-2_all.deb\n</code></pre> </li> <li> <p>Using <code>dpkg</code>:</p> <pre><code>sudo dpkg -i /tmp/cortex_3.2.1-2_all.deb\n</code></pre> </li> </ul> </li> </ol> <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/cortex-3.2.1-2.noarch.rpm https://cortex.download.strangebee.com/3.2/rpm/cortex-3.2.1-2.noarch.rpm\nwget -O /tmp/cortex-3.2.1-2.noarch.rpm.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.noarch.rpm.sha256\nwget -O /tmp/cortex-3.2.1-2.noarch.rpm.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.noarch.rpm https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/cortex-3.2.1-2.noarch.rpm https://cortex.download.strangebee.com/3.2/rpm/cortex-3.2.1-2.noarch.rpm\ncurl -o /tmp/cortex-3.2.1-2.noarch.rpm.sha256 https://cortex.download.strangebee.com/3.2/sha256/cortex-3.2.1-2.noarch.rpm.sha256\ncurl -o /tmp/cortex-3.2.1-2.noarch.rpm.asc https://cortex.download.strangebee.com/3.2/asc/cortex-3.2.1-2.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.noarch.rpm https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.asc https://cortex.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>cortex-3.1.8-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>3.1</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/cortex-3.2.1-2.noarch.rpm.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/cortex-3.2.1-2.noarch.rpm.asc /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>yum</code> to manage dependencies automatically:</p> <pre><code>sudo yum install /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>dnf</code> to manage dependencies automatically:</p> <pre><code>sudo dnf install /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>rpm</code>:</p> <pre><code>sudo rpm -ivh /tmp/cortex-3.2.1-2.noarch.rpm\n</code></pre> </li> </ul> </li> </ol> <p>Docker images are also provided on Docker Hub.</p> <pre><code>docker pull thehiveproject/cortex:3.1.0-1\n</code></pre> <p>\u26a0\ufe0f  Starting from this version, Docker images don't contain analyzers anymore. Analyzers__/__Responders and Cortex have different life-cycles, their update including their dependencies should not be correlated to Cortex update. </p> <p>It is recommended to use Docker version of analyzers : this can be done by binding Docker service docket inside Cortex container (run with <code>-v /var/run/docker.sock:/var/run/docker.sock</code>).</p>"}, {"location": "cortex/operations/upgrade_to_cortex_3_1_and_es7_x/#update-database", "title": "Update database", "text": "<p>Connect to TheHive (and Cortex), the maintenance page should ask to update. </p> <p>Once updated, ensure a new index named <code>cortex_5</code> has been created.</p> <pre><code>curl -XGET http://localhost:9200/_cat/indices\\?v\n</code></pre> <p>The output should look like this: </p> <pre><code>health status index           uuid                   pri rep docs.count docs.deleted store.size pri.store.size\ngreen  open   new_cortex_4 GV-3Y8QjTjWw0F-p2sjW6Q   5   0      30977            0       26mb           26mb\nyellow open   cortex_5     Nz0vCKqhRK2xkx1t_WF-0g   5   1      30977            0     26.1mb         26.1mb\n</code></pre>"}, {"location": "cortex/user-guides/first-start/", "title": "First start", "text": ""}, {"location": "cortex/user-guides/first-start/#quick-start-guide", "title": "Quick Start Guide", "text": "<p>This is the quick start guide for Cortex 3. It assumes that Cortex has been installed, and that the analyzers have been installed as well.</p>"}, {"location": "cortex/user-guides/first-start/#step-1-connect-to-cortex", "title": "Step 1: Connect to Cortex", "text": "<p>One Cortex is installed and configured, open your web browser and connect to http://cortexaddress:9001. </p>"}, {"location": "cortex/user-guides/first-start/#step-2-update-the-database", "title": "Step 2: Update the database", "text": "<p>Cortex uses ElasticSearch to store users, organizations and analyzers configuration. The first time you connect to the Web UI (<code>http://&lt;CORTEX_IP&gt;:9001</code> by default), you have to create the database by clicking the <code>Update Database</code> button.</p> <p></p>"}, {"location": "cortex/user-guides/first-start/#step-3-create-the-cortex-super-administrator", "title": "Step 3: Create the Cortex Super Administrator", "text": "<p>You are then invited to create the first user. This is a Cortex global administration user or <code>superAdmin</code>. This user account will be able to create Cortex organizations and users.</p> <p></p> <p>You will then be able to log in using this user account. You will note that the default <code>cortex</code> organization has been created and that it includes your user account, a Cortex global admininistrator.</p> <p></p>"}, {"location": "cortex/user-guides/first-start/#step-4-create-an-organization", "title": "Step 4: Create an organization", "text": "<p>The default <code>cortex</code> organization cannot be used for any other purpose than managing global administrators (users with the <code>superAdmin</code> role), organizations and their associated users. It cannot be used to enable/disable or configure analyzers. To do so, you need to create your own organization inside Cortex by clicking on the <code>Add organization</code>  button.</p> <p></p>"}, {"location": "cortex/user-guides/first-start/#step-5-create-a-organization-administrator", "title": "Step 5: Create a organization Administrator", "text": "<p>Create the organization administrator account (user with an <code>orgAdmin</code> role).</p> <p></p> <p>Then, specify a password for this user. After doing so,  log out and log in with that new user account.</p>"}, {"location": "cortex/user-guides/first-start/#step-6-enable-and-configure-analyzers", "title": "Step 6: Enable and configure Analyzers", "text": "<p>Enable the analyzers you need, configure them using the Organization &gt; Configuration and Organization &gt; Analyzers tabs. All analyzer configuration is done using the Web UI, including adding API keys and configuring rate limits.</p>"}, {"location": "cortex/user-guides/first-start/#step-7-optional-create-an-account-for-thehive-integration", "title": "Step 7 (Optional): Create an account for TheHive integration", "text": "<p>If you are using TheHive, create a new account inside your organization with the <code>read, analyze</code> role and generate an API key that you will need to add to TheHive configuration.</p> <p></p>"}, {"location": "cortex/user-guides/roles/", "title": "User roles", "text": ""}, {"location": "cortex/user-guides/roles/#user-roles", "title": "User Roles", "text": "<p>Cortex defines four roles:</p> <ul> <li><code>read</code>: the user can access all the jobs that have been performed by the Cortex 2 instance, including their results. However, this role cannot submit jobs. Moreover, this role cannot be used in the default <code>cortex</code> organization. This organization can only contain super administrators.</li> <li><code>analyze</code>: the <code>analyze</code> role implies the <code>read</code> role, described above. A user who has a <code>analyze</code> role can submit a new job using one of the configured analyzers for their organization. This role cannot be used in the default <code>cortex</code> organization. This organization can only contain super administrators.</li> <li><code>orgAdmin</code>: the <code>orgAdmin</code> role implies the <code>analyze</code> role. A user who has an <code>analyze</code> role can manage users within their organization. They can add users and give them <code>read</code>, <code>analyze</code> and/or <code>orgAdmin</code> roles. This role also permits to configure analyzers for the organization. This role cannot be used in the default  <code>cortex</code> organization. This organization can only contain super administrators.</li> <li><code>superAdmin</code>: this role is incompatible with all the other roles listed above (see chart below for examples). It can be used solely for managing organizations and their associated users. When you install Cortex, the first user that is created will have this role. Several users can have it as well but only in the default <code>cortex</code> organization, which is automatically created during installation.</li> </ul> <p>The chart below lists the roles and what they can and cannot do:</p> Actions read analyze orgAdmin superAdmin Read reports X X X Run jobs X X Enable/Disable analyzer X Configure analyzer X Create org analyst X X Delete org analyst X X Create org admin X X Delete org admin X X Create Org X Delete Org X Create Cortex admin user X"}, {"location": "resources/", "title": "Resources", "text": ""}, {"location": "resources/#resources", "title": "Resources", "text": "<p>In this section, you can find a collection of valuable resources regarding the applications.</p>"}, {"location": "resources/#demo-virtual-machine", "title": "Demo virtual machine", "text": "<p>Learn how to download and use our demo virtual machine</p>"}, {"location": "resources/#iaas-environment", "title": "IaaS environment", "text": "<p>Your have your own cloud infrastruture and wish to manage and include TheHive and Cortex ; learn how to deploy our dedicated images by reading our usage instructions:</p> <ul> <li> Amazon AWS environment:<ul> <li>for TheHive and Cortex</li> <li>or Infra as Code deployment</li> </ul> </li> <li> Microsoft Azure environment:<ul> <li>for TheHive and Cortex</li> <li>or Infra as Code deployment</li> </ul> </li> </ul> <p>Resources for the official cloud distributions of TheHive and Cortex</p> <p>This documentation contains sample Terraform and cloud-init code to easily launch and update TheHive and Cortex instances.</p>"}, {"location": "resources/#main-features-of-the-cloud-distributions-of-thehive-and-cortex", "title": "Main features of the cloud distributions of TheHive and Cortex", "text": ""}, {"location": "resources/#easy-to-use-and-deploy", "title": "Easy to use and deploy", "text": "<p>The cloud distributions were built with operations and automation in mind. We wanted DevSecOps-friendly products that would fit in most organizations, no matter how simple or complex their infrastructure.</p>"}, {"location": "resources/#always-up-to-date", "title": "Always up-to-date", "text": "<p>The images are updated whenever a new TheHive or Cortex version is released. No need to bother updating your instances anymore, just launch a new one with a fresh image as if it were a container!</p>"}, {"location": "resources/#production-ready", "title": "Production-ready", "text": "<ul> <li>Dedicated data volumes: All persistent data is stored on dedicated volumes, not in the root filesystem. </li> <li>Easy-resizing: Resizing independent data volumes is a lot easier as no action is required within the instance at the operating system level.</li> <li>Ubuntu-based: Our images are based on the official Ubuntu 20.04 LTS distributions from Canonical.</li> <li>Hardened OS: The underlying Ubuntu OS is hardened to comply with CSL1 - that's Common Sense Level 1. Ok that's not a real thing (yet) but the OS really was carefully configured to be as secured as possible by default while remaining usable in most contexts. Note that there are no iptables surprises inside the image to avoid conflicting behaviour with security groups of firewalls.</li> <li>Application only: The images include either the TheHive or Cortex application only. They are not meant to be public-facing on their own and should be deployed within your VPC and exposed with the public facing system of your choice (load balancer, reverse proxy). More information on the recommended reference architecture is provided in each cloud distribution user guide.</li> </ul>"}, {"location": "resources/cortex4py/", "title": "Cortex4py", "text": ""}, {"location": "resources/cortex4py/#cortex4py", "title": "Cortex4py", "text": "<p>Cortex4py is a Python API client for Cortex.</p> <p></p> <p> </p> <ul> <li>Sources: https://github.com/TheHive-Project/Cortex4py</li> <li>Documentation: https://github.com/TheHive-Project/Cortex4py</li> </ul>"}, {"location": "resources/cortexutils/", "title": "Cortexutils", "text": ""}, {"location": "resources/cortexutils/#cortexutils", "title": "Cortexutils", "text": "<p>Cortexutils is a Python library containing a set of classes that aims to make users write Cortex analyzers and responders easier.</p> <p></p> <p> </p> <ul> <li>Sources: https://github.com/TheHive-Project/Cortexutils</li> <li>Documentation: https://github.com/TheHive-Project/Cortexutils</li> </ul>"}, {"location": "resources/demo/", "title": "How to download the VM", "text": ""}, {"location": "resources/demo/#download-the-demo-virtual-machine", "title": "Download the Demo Virtual Machine", "text": "<p>Testing only</p> <p>This virtual machine (VM) is provided for testing purposes only. Don't use it in production.</p> <p>Download the ready-to-use VM from the StrangeBee website.</p> <p>This VM is prepared and updated by StrangeBee and includes the latest versions of:</p> <ul> <li>TheHive: Security incident response and case management platform</li> <li>Cortex: Extendable analysis, enrichment, and response automation framework</li> </ul> <p>For detailed instructions, see Use the Demo Virtual Machine.</p>"}, {"location": "resources/howto-vm-demo/", "title": "Use the Demo Virtual Machine", "text": ""}, {"location": "resources/howto-vm-demo/#use-the-demo-virtual-machine", "title": "Use the Demo Virtual Machine", "text": "<p>Memory requirement</p> <p>Allocate at least 6 GB of RAM to this virtual machine (VM) for stable performance. Assigning less may cause errors or degraded performance.</p> <p>Platinum trial</p> <p>The VM installation of TheHive with Cortex includes a 14-day Platinum trial license. After the trial ends, TheHive switches to read-only mode.</p>"}, {"location": "resources/howto-vm-demo/#start-the-virtual-machine", "title": "Start the virtual machine", "text": "Using VMWareUsing VirtualBox <ol> <li>Start the VM and follow the on-screen instructions.</li> <li>In your browser, open the URL displayed by the VM.</li> </ol> <ol> <li>During import, set the Guest OS type information. </li> <li>After import, update the network settings of the VM before starting it. </li> <li>Add the required port forwarding rules (adjust as needed) and save. </li> <li>Start the VM and open the following URL in your browser: http://127.0.0.1:8888</li> <li>If needed, adjust the Display settings and set the graphical controller to <code>VMSVGA</code> before starting the VM.</li> </ol>"}, {"location": "resources/howto-vm-demo/#quick-connect", "title": "Quick connect", "text": "<p>Following instructions are also available on the web page displayed by the virtual machine</p> <p></p> <p>TheHive credentials</p> <p>This VM comes with two accounts in TheHive:</p> <p>Administrator:</p> <ul> <li>Login: <code>admin@thehive.local</code></li> <li>Password: <code>secret</code></li> </ul> <p>A user named <code>thehive</code> has been created and is <code>org-admin</code> of the organization named <code>demo</code>: </p> <ul> <li>Login: <code>thehive@thehive.local</code></li> <li>Password: <code>thehive1234</code></li> </ul> <p>TheHive database comes with several samples of data, like custom fields, MISP taxonomies, MITRE Att&amp;ck data, a case template and an alert.</p> <p></p> <p>Cortex credentials</p> <p>This VM comes with 2 accounts in Cortex:</p> <p>Administrator: </p> <ul> <li>Login: <code>admin</code></li> <li>Password: <code>thehive1234</code> </li> </ul> <p>An organization is also created with an <code>orgadmin</code> account: </p> <ul> <li>Login: <code>thehive</code></li> <li>Password: <code>thehive1234</code></li> </ul> <p>Testing only</p> <p>This virtual machine (VM) is provided for testing purposes only. Don't use it in production.</p>"}, {"location": "resources/howto-vm-demo/#content", "title": "Content", "text": "<p>The VM runs Ubuntu 24.04 and includes:</p> <ul> <li>TheHive 5.5.10, with Cassandra, Elasticsearch, and local file storage</li> <li>Cortex 3.2.1, with Elasticsearch</li> <li>TheHive4py</li> <li>Cortex4py</li> <li>Public Cortex analyzers and responders running in Docker</li> </ul>"}, {"location": "resources/howto-vm-demo/#configuration-details", "title": "Configuration details", "text": "<p>Applications are launched with Docker Compose as containers, with volumes attached under <code>/opt/thp</code>.</p> <p>Directory structure</p> <pre><code>.\n\u251c\u2500\u2500 cassandra\n\u251c\u2500\u2500 cortex\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 elasticsearch\n\u251c\u2500\u2500 nginx\n\u2514\u2500\u2500 thehive\n</code></pre>"}, {"location": "resources/howto-vm-demo/#thehive", "title": "TheHive", "text": "<p>TheHive is configured to use Cassandra as its database and Elasticsearch to index data. Files are stored locally on disk.</p> <p>TheHive directory structure</p> <pre><code>thehive\n\u251c\u2500\u2500 config\n\u251c\u2500\u2500 files\n\u2514\u2500\u2500 log\n</code></pre> <ul> <li><code>config</code>: configuration files</li> <li><code>files</code>: files storage</li> <li><code>log</code>: application logs</li> </ul>"}, {"location": "resources/howto-vm-demo/#cortex", "title": "Cortex", "text": "<p>Cortex uses Elasticsearch as its database, which also runs as a Docker Compose container. Dedicated volumes are configured for Elasticsearch: <code>/opt/thp/elasticsearch/data</code> to store data, and <code>/opt/thp/elasticsearch/log</code> for logs.</p> <p>Cortex directory structure</p> <pre><code>cortex\n\u251c\u2500\u2500 config\n\u251c\u2500\u2500 jobs\n\u2514\u2500\u2500 log\n</code></pre> <ul> <li><code>config</code>: Cortex configuration files</li> <li><code>jobs</code>: shared volume for analyzers and responders jobs</li> <li><code>log</code>: application logs</li> </ul>"}, {"location": "resources/howto-vm-demo/#operations", "title": "Operations", "text": ""}, {"location": "resources/howto-vm-demo/#vm", "title": "VM", "text": "<p>You can use the system account <code>thehive/thehive1234</code> to operate the VM.</p> <p>All applications run as Docker containers managed with Docker Compose. The <code>docker-compose.yml</code> file is located in <code>/opt/thp</code>.</p>"}, {"location": "resources/howto-vm-demo/#thehive_1", "title": "TheHive", "text": "<p>After modifying TheHive configuration, restart the service.</p> <ul> <li> <p>Configuration file: <code>/opt/thp/thehive/config/application.conf</code></p> </li> <li> <p>Restart command:</p> </li> </ul> <pre><code>cd /opt/thp\ndocker compose restart thehive\n</code></pre>"}, {"location": "resources/howto-vm-demo/#cortex_1", "title": "Cortex", "text": "<p>After modifying Cortex configuration, restart the service.</p> <ul> <li> <p>Configuration file: <code>/opt/thp/cortex/config/application.conf</code></p> </li> <li> <p>Restart command:</p> </li> </ul> <pre><code>cd /opt/thp\ndocker compose restart cortex\n</code></pre>"}, {"location": "resources/howto-vm-demo/#documentation", "title": "Documentation", "text": "<p>You can find the full documentation for TheHive at https://docs.strangebee.com.</p>"}, {"location": "resources/howto-vm-demo/#troubleshooting", "title": "Troubleshooting", "text": "<ul> <li>TheHive service logs: <code>/opt/thp/thehive/log/application.log</code></li> <li>Cortex service logs: <code>/opt/thp/cortex/log/application.log</code></li> </ul>"}, {"location": "resources/security/", "title": "Security", "text": ""}, {"location": "resources/security/#security", "title": "Security", "text": "<p>Find our Responsible Vulnerability Disclosure policy and Security advisories on our dedicated repository: </p> <ul> <li>https://github.com/StrangeBeeCorp/Security</li> </ul>"}, {"location": "resources/templates/", "title": "TheHive Templates", "text": ""}, {"location": "resources/templates/#thehive-templates", "title": "TheHive Templates", "text": "<p>A repository dedicated to the sharing of TheHive templates. Contributions are welcome!</p> <p>Discover case, dashboard, and function templates ready for TheHive.</p> <p></p> <p> </p> <ul> <li>Sources: https://github.com/StrangeBeeCorp/thehive-templates</li> <li>Documentation:<ul> <li>Case templates</li> <li>Dashboards</li> <li>Functions</li> </ul> </li> </ul> <p>If you'd like to contribute and share your templates with TheHive users community, feel free to create a pull request on the GitHub repository.</p>"}, {"location": "resources/thehive4py/", "title": "TheHive4py", "text": ""}, {"location": "resources/thehive4py/#thehive4py", "title": "TheHive4py", "text": "<p>TheHive4py is a Python API client for TheHive.</p> <p></p> <p> </p> <ul> <li>Sources: https://github.com/TheHive-Project/TheHive4py</li> <li>Documentation: https://thehive-project.github.io/TheHive4py/</li> </ul>"}, {"location": "resources/iaas/aws/", "title": "Main Features", "text": ""}, {"location": "resources/iaas/aws/#aws-iaas-images", "title": "AWS IaaS images", "text": ""}, {"location": "resources/iaas/aws/#thehive-main-feature", "title": "TheHive main feature", "text": ""}, {"location": "resources/iaas/aws/#easy-to-use-and-deploy", "title": "Easy to use and deploy", "text": "<p>The AMI was built with operations and automation in mind. We wanted a DevSecOps-friendly product that would fit in most organizations, no matter how simple or complex their infrastructure.</p>"}, {"location": "resources/iaas/aws/#always-up-to-date", "title": "Always up-to-date", "text": "<p>The AMI is updated whenever a new Cortex version is released. No need to bother updating Cortex anymore, just launch a new instance as if it were a container!</p>"}, {"location": "resources/iaas/aws/#production-ready", "title": "Production-ready", "text": "<ul> <li>Dedicated data and Docker volumes: Cortex data is stored on a dedicated EBS volume, not in the root filesystem. With that in mind, the AMI will create a persistent 30GB EBS volume at launch that will not be deleted when the instance is terminated so that your Cortex data isn't accidentally lost. Docker images for analyzers and responders are also stored on a dedicated volume so you can adjust its size to your needs, the AMI will create a 20GB volume by default. Both volumes will be encrypted with your default KMS key. You can of course change the default volume size and encryption key.</li> <li>Ubuntu-based: The AMI is based on the official Ubuntu 20.04 LTS AMI from Canonical.</li> <li>Hardened OS: The underlying Ubuntu OS is hardened to comply with CSL1 - that's Common Sense Level 1. Ok that's not a real thing (yet) but the OS really was carefully configured to be as secured as possible by default while remaining usable in most contexts. Note that there are no iptables surprises inside the image to avoid conflicting behavior with security groups.</li> <li>Application only: The AMI includes Cortex application only. It is not meant to be public-facing on its own and should be deployed within your VPC and exposed with the public facing system of your choice (load balancer, reverse proxy). More information on the recommended reference architecture is provided in this user guide.</li> </ul>"}, {"location": "resources/iaas/aws/#cortex-main-features", "title": "Cortex main Features", "text": ""}, {"location": "resources/iaas/aws/#easy-to-use-and-deploy_1", "title": "Easy to use and deploy", "text": "<p>The AMI was built with operations and automation in mind. We wanted a DevSecOps-friendly product that would fit in most organizations, no matter how simple or complex their infrastructure.</p>"}, {"location": "resources/iaas/aws/#always-up-to-date_1", "title": "Always up-to-date", "text": "<p>The AMI is updated whenever a new Cortex version is released. No need to bother updating Cortex anymore, just launch a new instance as if it were a container!</p>"}, {"location": "resources/iaas/aws/#production-ready_1", "title": "Production-ready", "text": "<ul> <li>Dedicated data and Docker volumes: Cortex data is stored on a dedicated EBS volume, not in the root filesystem. With that in mind, the AMI will create a persistent 30GB EBS volume at launch that will not be deleted when the instance is terminated so that your Cortex data isn't accidentally lost. Docker images for analyzers and responders are also stored on a dedicated volume so you can adjust its size to your needs, the AMI will create a 20GB volume by default. Both volumes will be encrypted with your default KMS key. You can of course change the default volume size and encryption key.</li> <li>Ubuntu-based: The AMI is based on the official Ubuntu 20.04 LTS AMI from Canonical.</li> <li>Hardened OS: The underlying Ubuntu OS is hardened to comply with CSL1 - that's Common Sense Level 1. Ok that's not a real thing (yet) but the OS really was carefully configured to be as secured as possible by default while remaining usable in most contexts. Note that there are no iptables surprises inside the image to avoid conflicting behavior with security groups.</li> <li>Application only: The AMI includes Cortex application only. It is not meant to be public-facing on its own and should be deployed within your VPC and exposed with the public facing system of your choice (load balancer, reverse proxy). More information on the recommended reference architecture is provided in this user guide.</li> </ul>"}, {"location": "resources/iaas/aws/cortex/", "title": "Deploy Cortex AMI", "text": ""}, {"location": "resources/iaas/aws/cortex/#usage-instructions-for-the-official-ami-version-of-cortex", "title": "Usage instructions for the official AMI version of Cortex", "text": "<p> Official AMI This is the official Cortex v3 release for the AWS Marketplace.</p> <p>The AMI can be used to set up a shiny-new Cortex install or to launch an instance with existing data and configuration (for update / migration / restore purposes).</p>"}, {"location": "resources/iaas/aws/cortex/#introduction", "title": "Introduction", "text": "<ul> <li>Based on the official Ubuntu 20.04 AMI from Canonical</li> <li>The AMI is updated whenever a new Cortex version is released - no need to bother updating Cortex anymore, just launch a new instance as if it were a container!</li> <li>Cortex data and Docker images (for analyzers and responders) are stored on two dedicated EBS volumes, not in the root filesystem. With that in mind, the AMI will create two persistent EBS data volume at launch that will not be deleted when the instance is terminated so that your data isn't accidentally lost. The volumes will be encrypted with your default KMS key.<ul> <li>The Cortex data volume (/dev/sdh) is sized at 30GB by default</li> <li>The Docker volume (/dev/sdi) is sized at 20GB by default</li> </ul> </li> <li>The underlying Ubuntu OS is hardened to comply with CSL1 (that's Common Sense Level 1!) minus the network filtering. There are no iptables surprises inside the image to avoid conflicting behavior with security groups.</li> </ul>"}, {"location": "resources/iaas/aws/cortex/#run-context", "title": "Run context", "text": "<ul> <li>The Cortex app runs as unprivileged user cortex and is available on port http 9001 (that's http and NOT https). Needless to say we encourage you never to open that port outside your VPC and use a public-facing load balancer and / or reverse proxy to handle the TLS sessions with end-users. Since many Cortex users also run TheHive and MISP instances alongside and since the right load balancer / reverse proxy is obviously the one you know best, we elected not to include yet another one in this AMI. We provide more information on using the AWS Application Load Balancer or reverse proxies in our detailed Cortex AMI user guide.</li> <li>The default sudoer user is ubuntu and the ssh service listens on port 22.</li> <li>The Cortex configuration is set to look for custom analyzers under <code>/opt/cortexneurons/analyzers</code> and for custom responders under <code>/opt/cortexneurons/responders</code>.</li> <li>A cronjob for user cortex runs every night (@daily) to backup the application configuration and custom analyzers / custom responders to the data volume (/var/lib/elasticsearch/cortex/). If you wish to launch a new instance from existing data, this job must have run at least once after the initial install in order to restore the application's configuration  and custom analyzers / responders as well. </li> </ul>"}, {"location": "resources/iaas/aws/cortex/#launching-an-instance-with-no-existing-data-new-cortex-install", "title": "Launching an instance with no existing data (new Cortex install)", "text": "<ol> <li>Launch an instance from the AMI.</li> <li>SSH into the instance with the ubuntu user.</li> <li>Initialize and format the additional EBS volumes (/dev/sdh and /dev/sdi). Note that in Nitro-based instances, /dev/sdh and /dev/sdi might be available as something like /dev/nvme1n1 and /dev/nvme2n1. More information is available in Amazon EBS and NVMe on Linux Instances documentation.</li> <li>Launch the application initialization script with the EBS data volume block device names as arguments, which is /dev/sdh and /dev/sdi if you are using a default AMI setup. If you are using a Nitro-based instance, do not use the nvme names (like /dev/nvme1n1). Example: <code>/opt/cortex/ops/scripts/ops-cortex-init.sh /dev/sdh /dev/sdi</code></li> <li>That's it! Cortex is now available on port 9001. You can create the admin account on the first connection to the app.</li> </ol> <p>Alternatively, you can easily perform steps 3 and 4 by providing cloud-init user data to the AMI at launch. In the following example using an m5 instance (Nitro-based), we:</p> <ul> <li>launch a script that will expose the external volumes, seen by the instance as /dev/nvme1n1 and /dev/nvme2n1, with their block device mapping names (/dev/sdh, /dev/sdi)</li> <li>partition and format the EBS volumes using their block device mapping names (/dev/sdh, /dev/sdi)</li> <li>launch the initialisation script with the EBS block mapping names as arguments (/dev/sdh and /dev/sdi - not /dev/nvme0n1 and /dev/nvme1n1)</li> </ul> <pre><code>#cloud-config \nbootcmd:\n    - [ /usr/sbin/nvme-to-block-mapping ]\nfs_setup:\n    - filesystem: ext4\n      device: '/dev/sdh'\n      partition: auto\n      overwrite: false\n    - filesystem: ext4\n      device: '/dev/sdi'\n      partition: auto\n      overwrite: false\nruncmd:\n    - [ /opt/cortex/ops/scripts/ops-cortex-init.sh, /dev/sdh, /dev/sdi ]\n</code></pre> <p>You can also provision the whole thing using Terraform; check our GitHub repository for detailed sample code.</p>"}, {"location": "resources/iaas/aws/cortex/#launching-an-instance-with-existing-data-cortex-update-migration-restore", "title": "Launching an instance with existing data (Cortex update, migration, restore)", "text": "<ol> <li>Launch an instance from the AMI and base the additional EBS volumes (/dev/sdh and /dev/sdi by default) on existing Cortex data and Docker volume snapshots.</li> <li>SSH into the instance with the ubuntu user.</li> <li>Launch the Cortex restore script with the EBS data volume block device names as arguments, which are /dev/sdh and /dev/sdi if you are using a default AMI setup. If you are using a Nitro-based instance, do not use the nvme names (like /dev/nvme1n1). Example: <code>/opt/cortex/ops/scripts/ops-cortex-restore.sh /dev/sdh /dev/sdi</code>.</li> <li>That's it! Cortex is now available on port 9001 (or on the custom port you had configured) with all your existing configuration, users and data. Custom analyzers and responders stored under /opt/cortexneurons are also automatically restored and their pip requirements reinstalled.</li> </ol> <p>Alternatively, you can easily perform step 3 by providing cloud-init user data to the AMI at launch. In the following example using an m5 instance (Nitro-based), we:</p> <p>launch the restore script with the EBS block mapping names as arguments (/dev/sdh and /dev/sdi - not /dev/nvme1n1 and /dev/nvme2n1)</p> <pre><code>#cloud-config \nruncmd:\n    - [ /opt/cortex/ops/scripts/ops-cortex-restore.sh, /dev/sdh, /dev/sdi ]\n</code></pre> <p>You can also provision the whole thing using Terraform; check our GitHub repository for detailed sample code.</p>"}, {"location": "resources/iaas/aws/thehive/", "title": "Deploy TheHive AMI", "text": ""}, {"location": "resources/iaas/aws/thehive/#usage-instructions-for-the-official-thehive-v5-ami", "title": "Usage instructions for the official TheHive v5 AMI", "text": "<p> Official AMI</p> <p>The AMI can be used to set up a shiny-new TheHive v5 install or to launch an instance with existing data and configuration (for update / migration / restore purposes).</p>"}, {"location": "resources/iaas/aws/thehive/#introduction", "title": "Introduction", "text": "<ul> <li>You can easily initialise a new instance or restore a previous TheHive v5 instance using scripts included in the image.</li> <li>Data is stored on three dedicated volumes: one for the Cassandra database (/var/lib/cassandra), another one for storage attachments (/opt/thp_data/files) and a final one for indexes (/opt/thp_data/index).</li> <li>The AMI is based on the official Ubuntu 20.04 LTS AMI from Canonical .</li> <li>The default OS hardening has been further improved compared to our previous Ubuntu 18.04 based AMIs.</li> <li>The AMI is updated whenever a new TheHive version is released - no need to bother updating TheHive anymore, just launch a new instance as if it were a container!</li> <li>Migration from TheHive v3 is a manual operation detailed at length in the documentation: https://docs.strangebee.com/thehive/installation/migration/.</li> <li>Upgrading from TheHive v4 AMI is not yet automated or documented (it will be very soon in a coming AMI update). If you are in a hurry, the overall upgrade process is documented here: https://docs.strangebee.com/thehive/installation/upgrade-from-4.x/</li> </ul>"}, {"location": "resources/iaas/aws/thehive/#run-context", "title": "Run context", "text": "<ul> <li>TheHive app runs as an unprivileged user named thehive and is available on port http 9000 (that's http and NOT https). Needless to say we encourage you never to open that port outside your VPC and use a public-facing load balancer and / or reverse proxy to handle the TLS sessions with end-users. Since many TheHive users also run Cortex and MISP instances alongside and since the right load balancer / reverse proxy is obviously the one you know best, we elected not to include yet another one in this AMI.</li> <li>As an incentive to use https, TheHive is configured to use secure cookies by default. Connecting to the UI in http will fail. An override to this remains possible in the configuration: set <code>play.http.session.secure = false</code> in <code>/etc/thehive/application.conf</code>. You must restart the <code>thehive</code> service for the change to be effective.</li> <li>The default sudoer user is ubuntu and the ssh service listens on port 22.</li> <li>A cronjob for user thehive runs every night (@daily) to backup the application configuration to the data volume (/var/lib/cassandra/thehive/). If you wish to launch a new instance from existing data, this job must have run at least once after the initial install in order to restore the application's configuration as well.</li> </ul>"}, {"location": "resources/iaas/aws/thehive/#launching-an-instance-with-no-existing-data-new-thehive-install", "title": "Launching an instance with no existing data (new TheHive install)", "text": "<ol> <li>Launch an instance from the AMI.</li> <li>SSH into the instance with the ubuntu user.</li> <li>Initialize and format the additional EBS volumes (<code>/dev/sdh</code>, <code>/dev/sdi</code> and <code>/dev/sdj</code>). Note that in Nitro-based instances, <code>/dev/sdh</code> might be available as something like <code>/dev/nvme1n1</code>. More information is available in Amazon EBS and NVMe on Linux Instances documentation.</li> <li>Launch the application initialization script with the EBS data volumes block device names as arguments, which are <code>/dev/sdh</code>, <code>/dev/sdi</code> and <code>/dev/sdj</code> if you are using a default AMI setup. If you are using a Nitro-based instance, do not use the nvme names (like /dev/nvme0n1). Example: <code>/opt/thehive/ops/scripts/ops-thehive-init.sh /dev/sdh /dev/sdi /dev/sdj</code></li> <li>That's it! TheHive is now available on port 9000. The default admin account is \"admin@thehive.local\" with password \"secret\" (change it!).</li> </ol> <p>Alternately, you can easily perform steps 3 and 4 by providing cloud-init user data to the AMI at launch. In the following example using an m5 instance (Nitro-based), we: * launch a script that will expose the external volumes, seen by the instance as /dev/nvme1n1 and /dev/nvme2n1, with their block device mapping names (/dev/sdh, /dev/sdi) * partition and format the EBS volumes using their block device mapping names (/dev/sdh, /dev/sdi) *  launch the initialisation script with the EBS block mapping names as argument (<code>/dev/sdh</code>, <code>/dev/sdi</code> and <code>/dev/sdj</code>)</p> <pre><code>#cloud-config\nbootcmd:\n    - [ /usr/sbin/nvme-to-block-mapping ]\nfs_setup:\n    - filesystem: ext4\n      device: '/dev/sdh'\n      partition: auto\n      overwrite: false\n    - filesystem: ext4\n      device: '/dev/sdi'\n      partition: auto\n      overwrite: false\n    - filesystem: ext4\n      device: '/dev/sdj'\n      partition: auto\n      overwrite: false\nruncmd:\n    - [ /opt/thehive/ops/scripts/ops-thehive-init.sh, /dev/sdh, /dev/sdi, /dev/sdj ]\n</code></pre> <p>You can also provision the whole thing using Terraform; check our GitHub repository for detailed sample code.</p>"}, {"location": "resources/iaas/aws/thehive/#launching-an-instance-with-existing-data-thehive-update-migration-restore", "title": "Launching an instance with existing data (TheHive update, migration, restore)", "text": "<ol> <li>Launch an instance from the AMI and base the additional EBS volumes (<code>/dev/sdh</code>, <code>/dev/sdi</code> and <code>/dev/sdj</code> by default) on existing TheHive EBS volume snapshots for the Cassandra database (<code>/dev/sdh</code>), the storage attachments (<code>/dev/sdi</code>) and the database index (<code>/dev/sdj</code>).</li> <li>SSH into the instance with the ubuntu user.</li> <li>Launch the TheHive restore script with the EBS data volumes block device names as arguments, which are <code>/dev/sdh</code>, <code>/dev/sdi</code> and <code>/dev/sdj</code> if you are using a default AMI setup. If you are using a Nitro-based instance, do not use the nvme names (like /dev/nvme1n1). Example: <code>/opt/thehive/ops/scripts/ops-thehive-restore.sh /dev/sdh /dev/sdi /dev/sdj</code>.</li> <li>That's it! TheHive is now available on port 9000 (or on the custom port you had configured) with all your existing configuration, users and data.</li> </ol> <p>Alternately, you can easily perform step 3 by providing cloud-init user data to the AMI at launch. In the following example using an m5 instance (Nitro-based), we:</p> <ul> <li>launch the restore script with the EBS block mapping names as arguments (<code>/dev/sdh</code>, <code>/dev/sdi</code> and <code>/dev/sdj</code>)</li> </ul> <pre><code>#cloud-config\nruncmd:\n    - [ /opt/thehive/ops/scripts/ops-thehive-restore.sh, /dev/sdh, /dev/sdi, /dev/sdj ]\n</code></pre> <p>You can also provision the whole thing using Terraform; check our GitHub repository for detailed sample code.</p>"}, {"location": "resources/iaas/aws/infra-as-code/", "title": "AWS sample code", "text": ""}, {"location": "resources/iaas/aws/infra-as-code/#aws-sample-code", "title": "AWS sample code", "text": ""}, {"location": "resources/iaas/aws/infra-as-code/#overview", "title": "Overview", "text": "<p>The sample Terraform code in this repository allows the creation of a complete SecOps VPC to host your TheHive and Cortex instances and expose them using a load balancer.</p> <p></p> <p>The sample code is organised in two Terraform projects:</p> <ul> <li>ug-secops-vpc --&gt; to create and manage the SecOps VPC</li> <li>ug-secops-instances --&gt; to launch and manage TheHive v5 and Cortex instances within a SecOps VPC</li> </ul> <p>This code organization allows the creation of all required VPC resources if you do not already operate a VPC (or if you want to create a new one for your SecOps needs), independently from TheHive and Cortex deployments.</p> <p>The sample code to launch TheHive and Cortex instances defaults to this new VPC but can easily be adapted to fit your existing VPC by customising a few variables. Unless your architecture significantly differs from our reference VPC, you should not be required to modify the Terraform code itself.</p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/", "title": "TheHive v5 and Cortex within a SecOps VPC", "text": ""}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#deploying-thehive-v5-and-cortex-with-terraform", "title": "Deploying TheHive v5 and Cortex with Terraform", "text": "<p>This code will work out of the box with the reference SecOps VPC created with our sample code. You can nonetheless use it to deploy TheHive and Cortex within your own preexisting VPC with minimal adjustments (only a few variables to update if your setup is similar to our reference architecture).</p> <p>Our sample code can handle two use-cases:</p> <ul> <li>Deploying brand new TheHive and Cortex instances with empty databases - this is useful for an initial deployment.</li> <li>Deploying TheHive and Cortex instances while restoring existing databases - this is to be used for all other use-cases: AMI updates, instance type upgrades or downgrades, database restore, etc.</li> </ul> <p>Tip</p> <p>To switch between both use-cases, simply update the <code>secops_thehive_init</code> and/or <code>secops_cortex_init</code> variable values between <code>true</code> and <code>false</code> (<code>true</code> being the empty database, initialisation use-case).</p> <p>Files</p> <ul> <li>main.cf</li> <li>providers.cf</li> <li>outputs.cf</li> <li>variables.cf</li> <li>samples.tfvars</li> <li>files/bastion-cloud-config-new.tpl</li> </ul>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#tldr", "title": "TL;DR;", "text": "<ul> <li>Download all files</li> <li>Set the required variables</li> <li><code>terraform init</code> &amp;&amp; <code>terraform apply</code></li> <li>Once the <code>terraform apply</code> is over, wait up to 5 minutes for both instances to be fully operational. You can check the initiatisation or restore progress by tailing the <code>/var/log/cloud-init-output.log</code> file on each instance.</li> </ul>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#overview", "title": "Overview", "text": "<p>This is an overview of the resulting TheHive and Cortex instances when deployed with our Terraform sample code in our reference SecOps VPC.</p> <p></p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#information-on-the-default-data-volumes-configuration", "title": "Information on the default data volumes configuration", "text": "<p>All data is stored on dedicated EBS volumes, not in the root EBS volume. This approach has many advantages:</p> <ul> <li>Your root volume is disposable, you can replace your instances in seconds to update TheHive and Cortex by launching a fresh AMI or to migrate to a more (or less) powerful instance.</li> <li>Your data volumes can be of any size while keeping the root volume to its default size. </li> <li>Increasing (or decreasing) the size of data volumes on an existing instance is a lot easier than changing the root volume size.</li> <li>You can easily restore your data from a previous states using volume snapshots. </li> </ul>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#about-ebs-volume-management-on-nitro-based-instances", "title": "About EBS volume management on Nitro based instances", "text": "<p>In Nitro-based instances, block devide mappings such as <code>/dev/sdh</code> will be seen by the instance as something like <code>/dev/nvme1n1</code>. You need to take this into consideration for everything that is executed inside the instance. As far as the EC2 APIs are concerned, the volume is still known as <code>/dev/sdh</code>. More information on this is available in Amazon EBS and NVMe on Linux Instances documentation.</p> <p>To illustrate this important aspect, consider the automated deployment of an instance using Terraform and some cloud-init user data code. In Terraform, you may want to change the default volume size or base your EBS volume on an existing snapshot. Since Terraform is interacting with the EC2 APIs, the EBS volume will alway be <code>/dev/sdh</code>. However, if you want to partition and format the volume using cloud-init, you need to adapt your code to how the instance \"sees\" the volume. In pre-Nitro instances the volume will remain <code>/dev/sdh</code> but in Nitro instances, it will be known as something like <code>/dev/nvme1n1</code>. </p> <p>To mount the volumes, the included initialisation and restore cloud-init bootstrap scripts were designed to be \"Nitro-aware\". These scripts expect the block device mapping as argument (such as <code>/dev/sdh</code>, <code>/dev/sdi</code> and <code>/dev/sdj</code>) and will then mount the volume based on its UUID to avoid any confusion going forward.</p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#deploying-new-thehive-and-cortex-instances", "title": "Deploying new TheHive and Cortex instances", "text": "<p>When the <code>secops_thehive_init</code> and/or <code>secops_cortex_init</code> variable are set to <code>true</code>, the AMIs will create new empty EBS data volumes at launch that will not be deleted when the instances are terminated so that your data isn't accidentally lost.</p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#replacing-existing-thehive-and-cortex-instances-to-use-a-new-ami-version", "title": "Replacing existing TheHive and Cortex instances to use a new AMI version", "text": "<p>When the <code>secops_thehive_init</code> and/or <code>secops_cortex_init</code> variable are set to <code>false</code>, the AMIs will create new EBS volumes at launch based on snapshots of volumes from the previous instances. The original volumes (from previous instances) are not automatically deleted. We recommend you keep them at least until the upgrade to the new AMI is completed.</p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#restoring-data-from-earlier-snapshots-instead-of-latest-instance-volume-snapshots", "title": "Restoring data from earlier snapshots instead of latest instance volume snapshots", "text": "<p>If for any reason you wish to restore from specific snapshots and not from the latest volume state, you can edit the code and set the snapshot id for each volume. </p> <p>For example, to restore the TheHive data volume from a specific snapshot, the sample code should be edited to update the <code>snapshot_id</code> value.</p> <p>Original sample code:</p> <pre><code>  ebs_block_device {\n    device_name = \"/dev/sdh\"\n    snapshot_id = aws_ebs_snapshot.secops-thehive-data-snapshot[count.index].id\n    volume_type = \"gp2\"\n    volume_size = var.secops_thehive_instance_data_volume_size\n    delete_on_termination = false\n    tags = {\n      Name = \"${var.secops_thehive_instance_name}-data\"\n      SourceInstance = var.secops_thehive_instance_name\n      SourceInstanceVolume = \"/dev/sdh\"\n      Environment = var.secops_vpc_name\n    }  \n  } \n</code></pre> <p>Update code:</p> <pre><code>  ebs_block_device {\n    device_name = \"/dev/sdh\"\n    snapshot_id = \"snap-1234567890\"\n    volume_type = \"gp2\"\n    volume_size = var.secops_thehive_instance_data_volume_size\n    delete_on_termination = false\n    tags = {\n      Name = \"${var.secops_thehive_instance_name}-data\"\n      SourceInstance = var.secops_thehive_instance_name\n      SourceInstanceVolume = \"/dev/sdh\"\n      Environment = var.secops_vpc_name\n    }  \n  } \n</code></pre>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-instances/#connecting-to-your-instances-with-ssh", "title": "Connecting to your instances with SSH", "text": "<p>Since our TheHive and Cortex instance are located in a private subnet, we cannot directly SSH into them using their private IP addresses. If you have set up a bastion host configuration similarly to our reference architecture, you can seamlessly connect to private instances using the proxyjump functionality of the ssh client. The bastion host will be able to perform the hostname resolution with the private DNS zone we have set up in the VPC.</p> <p>The easiest way to do that is to create (or update) the <code>~/.ssh/config</code> file. Use the example below as a reference and replace the ip addresses and private key information.</p> <p>The default username is <code>ubuntu</code> in all our AMIs.</p> <pre><code>Host bastion\n        HostName 1.2.3.4 (public ip)\n        User ubuntu\n        Port 22\n        IdentityFile ~/.ssh/id_rsa_private_key_for_bastion\n\nHost thehive\n        HostName thehive.secops0.privatevpc\n        User ubuntu\n        Port 22\n        ProxyJump bastion\n        IdentityFile ~/.ssh/id_rsa_private_key_for_thehive\n\nHost cortex\n        HostName cortex.secops0.privatevpc\n        User ubuntu\n        Port 22\n        ProxyJump bastion\n        IdentityFile ~/.ssh/id_rsa_private_key_for_cortex\n</code></pre> <p>We use the secops0.privatevpc domain as an example but the best security practice is to use a domain name you own even for private DNS resolution in split-horizon.</p> <p>You will now be able to SSH into your instances directly using the bastion host as a proxy:</p> <p></p><pre><code>ssh thehive\n</code></pre> or <pre><code>ssh cortex\n</code></pre><p></p> <p>Tip</p> <p>Remember to autorize your local public IP address in the bastion SSH security group. In our sample code for the SecOps VPC, this is the <code>secops0-public-ssh-sg</code> security group.</p> <p>Terraform compatibility: v1.x</p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-vpc/", "title": "Create and manage the SecOps VPC", "text": ""}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-vpc/#creating-a-new-secops-vpc", "title": "Creating a new SecOps VPC", "text": "<p>If you do not already have a VPC at hand to deploy TheHive and Cortex into, using our sample code will allow you to build a production-ready VPC very easily.</p> <p>Files</p> <ul> <li>main.cf</li> <li>providers.cf</li> <li>outputs.cf</li> <li>variables.cf</li> <li>samples.tfvars</li> <li>files/bastion-cloud-config-new.tpl</li> </ul>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-vpc/#overview", "title": "Overview", "text": "<p>The reference architecture VPC consists of the following resources</p> <p></p> <p>The VPC will include:</p> <ul> <li>Two public subnets (only one is depicted - two public subnets will be created in different availability zones since they are required for the Application Load Balancer configuration)</li> <li>Two private subnets (only one is depicted - we will not be using the second private subnet but it will be ready to use if you need it and it does not incur additional costs)</li> <li>Five security groups </li> <li>An internet gateway (IG)</li> <li>A NAT gateway in the first public subnet</li> <li>Route tables for both public and private subnets</li> <li>An Application Load Balancer (ALB) with a listener on port 443  using ACM-managed public certificates and two target groups for TheHive and Cortex</li> <li>Public Route53 DNS records for TheHive and Cortex to point to the ALB</li> <li>A private Route53 DNS zone for internal VPC name resolution</li> <li>A bastion host for remote SSH administration</li> </ul> <p>Since we will be building a new VPC from scratch, we will use AWS-managed services to expose our TheHive and Cortex instances:</p> <ul> <li>Application Load Balancer to handle secured TLS sessions with end-users. A single load balancer with a single listener on port 443 can forward traffic to both TheHive and Cortex instances based on forward rules.</li> <li>AWS Certificate Manager to issue and renew valid public certificates to enable TLS sessions between end-users and the load balancer. Once attached to an AWS-managed service such as the Application Load Balancer, public certificates are automatically renewed when nearing expiration. If you operate both TheHive and Cortex, you can share a single certificate for both services by including multiple hostnames in the certificate. You can also use separate certificates as the ALB supports attaching several certificates to a listener.</li> <li>Amazon Route53 to manage your public DNS records. You will need Route53 to manage at least one public DNS zone, but not necessarily a whole domain name. It can be a subdomain of an existing domain, such as aws.mydomain.com. Having Route53 manage your DNS records enables a lot of automation such as automatic certificate validation and renewal, automatic DNS registration of your load balancer and so on. We also recommend you use Route53 to manage a private DNS zone attached to your VPC to enable local name resolution within the private subnet (this is how TheHive can easily find its Cortex instance and it allows to SSH into private instances without having to bother with their private IPs).</li> </ul>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-vpc/#security-groups", "title": "Security Groups", "text": "<p>There are no default iptables rules implemented in the AMIs for either TheHive or Cortex (no OS-based IP filtering). Since we built the AMIs to be replaceable at each application update, somewhat like containers, we recommend limiting OS customisations to benefit from the easy update process. For that reason, filtering should be based on security groups or Network ACLs only.</p> <p>Keep in mind that the applications are listening on http, not https. Even though the default AMI security groups allow incoming traffic on the http ports (TCP 9000 for TheHive, TCP 9001 for Cortex), be careful not to expose them on a public-facing network interface.</p> <p>The required security groups depicted above are created automatically along with the SecOps VPC.</p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-vpc/#bastion-host", "title": "Bastion host", "text": "<p>We launch a small instance to act as a bastion host. Bastion host hardening is not performed automatically but you should definitely harden this host going forward if you will use it in a production context. We do however strictly limit access to and from this host.</p> <p>The bastion host will run the latest Ubuntu AMI from Canonical. The default sudoer user is ubuntu.</p>"}, {"location": "resources/iaas/aws/infra-as-code/ug-secops-vpc/#secops-vpc-prerequisites", "title": "SecOps VPC prerequisites", "text": "<p>While most VPC resources will be provisioned with Terraform, there is one exception that should be created beforehand:</p> <ul> <li>The Route53 public DNS zone to register the load balancer and to automatically validate the ACM certificates</li> </ul> <p>You must provide the DNS hosted zone name before creating the VPC (set the <code>secops_r53_public_dns_zone_name</code> Terraform variable with the zone name).</p> <p>Info</p> <p>We will use a single load balancer, a single https listener and a single certificate for both TheHive and Cortex. Since the default configuration is to route TheHive and Cortex queries based on the host name, make sure you provide both TheHive and Cortex host names in the <code>secops_r53_records_san</code> Terraform variable so they are provisionned both in the load balancer listener certificate and DNS records.</p> <p>Terraform compatibility: v1.x</p>"}, {"location": "resources/iaas/azure/", "title": "Main Features", "text": ""}, {"location": "resources/iaas/azure/#thehive-azure-images", "title": "TheHive Azure images", "text": ""}, {"location": "resources/iaas/azure/#easy-to-use-and-deploy", "title": "Easy to use and deploy", "text": "<p>The Azure images were built with operations and automation in mind. We wanted DevSecOps-friendly products that would fit in most organizations, no matter how simple or complex their infrastructure.</p>"}, {"location": "resources/iaas/azure/#always-up-to-date", "title": "Always up-to-date", "text": "<p>The images are updated whenever a new TheHive version is released. No need to bother updating TheHive anymore, just launch a new instance as if it were a container!</p>"}, {"location": "resources/iaas/azure/#production-ready", "title": "Production-ready", "text": "<ul> <li>Dedicated data disks: TheHive data is stored on dedicated disks, not in the root filesystem.</li> <li>Ubuntu-based: The images are based on the official Ubuntu 20.04 LTS distribution from Canonical.</li> <li>Hardened OS: The underlying Ubuntu OS is hardened to comply with CSL1 (that's Common Sense Level 1!) minus the network filtering. There are no iptables surprises inside the image to avoid conflicting behavior with security groups.</li> <li>Application only: The images include the applications only. They are not meant to be public-facing on their own and should be deployed within your virtual network and exposed with the public facing system of your choice (load balancer, reverse proxy).</li> </ul>"}, {"location": "resources/iaas/azure/#cortex-azure-images", "title": "Cortex Azure images", "text": ""}, {"location": "resources/iaas/azure/#easy-to-use-and-deploy_1", "title": "Easy to use and deploy", "text": "<p>The image was built with operations and automation in mind. We wanted a DevSecOps-friendly product that would fit in most organizations, no matter how simple or complex their infrastructure.</p>"}, {"location": "resources/iaas/azure/#always-up-to-date_1", "title": "Always up-to-date", "text": "<p>The image is updated whenever a new Cortex version is released. No need to bother updating Cortex anymore, just launch a new instance as if it were a container!</p>"}, {"location": "resources/iaas/azure/#production-ready_1", "title": "Production-ready", "text": "<ul> <li>Dedicated data disks: Cortex data is stored on dedicated disks, not in the root filesystem. With that in mind, you must attach two persistent data disks on LUN 0 and LUN 1 at launch (30 GB each recommended).</li> <li>Ubuntu-based: The image is based on the official Ubuntu 20.04 LTS distribution from Canonical.</li> <li>Hardened OS: The underlying Ubuntu OS is hardened to comply with CSL1 (that's Common Sense Level 1!) minus the network filtering. There are no iptables surprises inside the image to avoid conflicting behavior with security groups.</li> <li>Application only: The image includes Cortex application only. It is not meant to be public-facing on its own and should be deployed within your virtual network and exposed with the public facing system of your choice (load balancer, reverse proxy).</li> </ul>"}, {"location": "resources/iaas/azure/cortex/", "title": "Deploy Cortex Azure image", "text": ""}, {"location": "resources/iaas/azure/cortex/#usage-instructions-for-the-official-azure-distribution-of-cortex", "title": "Usage instructions for the official Azure distribution of Cortex", "text": "<p> Official Azure image This is the official Cortex v3 release for the AWS Marketplace.</p> <p>The image can be used to set up a shiny-new Cortex install or to launch an instance with existing data and configuration (for update / migration / restore purposes).</p>"}, {"location": "resources/iaas/azure/cortex/#introduction", "title": "Introduction", "text": "<ul> <li>Based on the official Ubuntu 18.04 image from Canonical</li> <li>The image is updated whenever a new Cortex version is released - no need to bother updating Cortex anymore, just launch a new instance as if it were a container!</li> <li>Cortex data is stored on dedicated disks, not in the root filesystem. With that in mind, you must attach two persistent data disks on LUN 0 (for the database) and LUN 1 (for Docker images) at launch (30 GB each recommended).</li> <li>The underlying Ubuntu OS is hardened to comply with CSL1 (that's Common Sense Level 1!) minus the network filtering. There are no iptables surprises inside the image to avoid conflicting behavior with security groups.</li> </ul>"}, {"location": "resources/iaas/azure/cortex/#run-context", "title": "Run context", "text": "<ul> <li>The Cortex app runs as unprivileged user cortex and is available on port http 9001 (that's http and NOT https). Needless to say we encourage you never to open that port outside your virtual network and use a public-facing load balancer and / or reverse proxy to handle the TLS sessions with end-users. Since many Cortex users also run TheHive and MISP instances alongside and since the right load balancer / reverse proxy is obviously the one you know best, we elected not to include yet another one in this image. </li> <li>The Cortex configuration is set to look for custom analyzers under <code>/opt/cortexneurons/analyzers</code> and for custom responders under <code>/opt/cortexneurons/responders</code>.</li> <li>A cronjob for user cortex runs every night (@daily) to backup the application configuration and custom analyzers / custom responders to the data volume (/var/lib/elasticsearch/cortex/). If you wish to launch a new instance from existing data, this job must have run at least once after the initial install in order to restore the application's configuration  and custom analyzers / responders as well.  </li> </ul>"}, {"location": "resources/iaas/azure/cortex/#launching-an-instance-with-no-existing-data-new-cortex-install", "title": "Launching an instance with no existing data (new Cortex install)", "text": "<ol> <li>Launch an instance from the image and attach two data disks on LUN 0 and LUN 1.</li> <li>SSH into the instance with a sudoer user.</li> <li>Initialize and format the additional data disks (LUN O and LUN 1). </li> <li>Launch the application initialization script with the target data disk names as arguments. Example: <code>/opt/cortex/ops/scripts/ops-cortex-init.sh /dev/sdh /dev/sdi</code> (the script will automatically mount the LUN 0 and LUN 1 disks at /dev/sdh and /dev/sdi)</li> <li>That's it! Cortex is now available on port 9001. You can create the admin account on the first connection to the app.</li> </ol> <p>Alternatively, you can easily perform steps 3 and 4 by providing a cloud-init bootstrap script at launch. In the following example, we:</p> <ul> <li>partition and format the data disks attached on LUN 0 and LUN 1 </li> <li>improve the random seed with pollinate (because we will generate a secret key in the initialisation process)</li> <li>and finally we launch the initialisation script with the target data disk mapping names as arguments (/dev/sdh and /dev/sdi) - the script will automatically mount the LUN 0 disk at /dev/sdh and LUN 1 at /dev/sdi</li> </ul> <pre><code>#cloud-config \ndisk_setup:\n  /dev/disk/azure/scsi1/lun0:\n    table_type: gpt\n    layout: True\n    overwrite: True\n  /dev/disk/azure/scsi1/lun1:\n    table_type: gpt\n    layout: True\n    overwrite: True\nfs_setup:\n  - device: /dev/disk/azure/scsi1/lun0\n    partition: none\n    filesystem: ext4\n  - device: /dev/disk/azure/scsi1/lun1\n    partition: none\n    filesystem: ext4\nrandom_seed:\n    file: /dev/urandom\n    command: [\"pollinate\", \"--server=https://entropy.ubuntu.com/\"]\n    command_required: true\nruncmd:\n    - /opt/cortex/ops/scripts/ops-cortex-init.sh /dev/sdh /dev/sdi\n</code></pre> <p>You can also provision the whole thing using Terraform - check our GitHub repository for sample initialisation code.</p>"}, {"location": "resources/iaas/azure/cortex/#launching-an-instance-with-existing-data-cortex-update-migration-restore", "title": "Launching an instance with existing data (Cortex update, migration, restore)", "text": "<ol> <li>Launch an instance from the image and attach existing Cortex data disks on LUN 0 and LUN 1 (we recommend you always create disk snapshots first).</li> <li>SSH into the instance with a sudoer user.</li> <li>Launch the Cortex restore script with the data disk names as argument, which are /dev/sdh and /dev/sdi if you are using the default setup. Example: <code>/opt/cortex/ops/scripts/ops-cortex-restore.sh /dev/sdh /dev/sdi</code>.</li> <li>That's it! Cortex is now available on port 9001 (or on the custom port you had configured) with all your existing configuration, users and data. Custom analyzers and responders stored under /opt/cortexneurons are also automatically restored and their pip requirements reinstalled.</li> </ol> <p>Alternatively, you can easily perform step 3 by providing a cloud-init bootstrap script at launch. In the following example, we:</p> <p>launch the restore script with the data disk names as arguments (/dev/sdh and /dev/sdi)</p> <pre><code>#cloud-config \nruncmd:\n    - /opt/cortex/ops/scripts/ops-cortex-restore.sh /dev/sdh /dev/sdi\n</code></pre> <p>You can also provision the whole thing using Terraform - check our GitHub repository for sample update / migration / restore code.</p>"}, {"location": "resources/iaas/azure/thehive/", "title": "Deploy TheHive Azure image", "text": ""}, {"location": "resources/iaas/azure/thehive/#usage-instructions-for-the-official-azure-distribution-of-thehive-v5", "title": "Usage instructions for the official Azure distribution of TheHive v5", "text": "<p> Official Azure image</p> <p>The image can be used to set up a shiny-new TheHive v5 install or to launch an instance with existing data and configuration (for update / migration / restore purposes). The same image can also be used to launch Cortex on the same instance or on a separate, dedicated instance.</p>"}, {"location": "resources/iaas/azure/thehive/#introduction", "title": "Introduction", "text": "<ul> <li>Based on the official Ubuntu 20.04 LTS image from Canonical</li> <li>The image is updated whenever a new TheHive version is released - no need to bother updating TheHive anymore, just launch a new instance as if it were a container!</li> <li>TheHive / Cortex data is stored on two dedicated disks, not in the root filesystem. For that purpose, you must attach two persistent data disks at launch on LUN 0 (for the data) and LUN 1 (for Docker). The recommended minimal volume size are 32 GB per volume. If you install Cortex on a separate instance, simply apply the same configuration on the second instance.</li> <li>The underlying Ubuntu OS is hardened to comply with CSL1 (that's Common Sense Level 1!) minus the network filtering. There are no iptables surprises inside the image to avoid conflicting behaviour with security groups.</li> <li>Migration from TheHive v4 is possible using our migration script baked in the image (to be documented soon).</li> </ul>"}, {"location": "resources/iaas/azure/thehive/#run-context", "title": "Run context", "text": "<ul> <li>TheHive is available on port http 9000 and Cortex, when deployed alongside, is available on port http 9001 (that's http and NOT https). Needless to say we encourage you never to open these ports outside your virtual network and use a public-facing load balancer and / or reverse proxy to handle the TLS sessions with end-users. </li> <li>As an incentive to use https, both TheHive and Cortex are configured to use secure cookies by default. Connecting to their respective UIs in http will fail. An override to this remains possible in the configuration (for TheHive, set <code>play.http.session.secure = false</code> in <code>/opt/thp_data/nomad/tasks/thehive/application.conf</code> - for Cortex, set <code>play.http.session.secure = false</code> and <code>play.filters.csrf.cookie.secure = false</code> in <code>/opt/thp_data/nomad/tasks/cortex/application.conf</code>). You must restart the <code>thehive</code> and/or <code>cortex</code> service(s) for the change to be effective.</li> </ul>"}, {"location": "resources/iaas/azure/thehive/#launching-an-instance", "title": "Launching an instance", "text": "<ol> <li>Launch an instance from the image and attach two persistent disks: the data disk on LUN 0 and the docker disk LUN 1</li> <li>Set the admin username to be azureuser</li> <li>Provide the following cloud-init bootstrap script to configure the instance (you must update at least the <code>application.baseUrl</code> value for TheHive in this example):</li> </ol> <pre><code>#cloud-config \ndisk_setup:\n  /dev/disk/azure/scsi1/lun0:\n    table_type: gpt\n    layout: True\n    overwrite: True\n  /dev/disk/azure/scsi1/lun1:\n    table_type: gpt\n    layout: True\n    overwrite: True\nfs_setup:\n  - device: /dev/disk/azure/scsi1/lun0\n    partition: auto\n    filesystem: ext4\n  - device: /dev/disk/azure/scsi1/lun1\n    partition: auto\n    filesystem: ext4\nwrite_files:\n    - path: /opt/strangebee/ops/templates/nomad/tasks/thehive/application.conf.d/service.conf\n      content: |\n          application.baseUrl=\"https://thehive.mydomain.com/thehive\"\n          play.http.context=\"/thehive\"\n    - path: /opt/strangebee/ops/templates/nomad/tasks/cortex/application.conf.d/service.conf\n      content: |\n          play.http.context=\"/cortex\"\nruncmd:\n    - [ /opt/strangebee/ops/scripts/ops-launch.sh, \"-t 1\", \"-c 0\", \"-p /dev/sdh\", \"-d /dev/sdi\" ]\n</code></pre> <p>You can further customize this script as needed. In the example above we:</p> <ul> <li>partition and format the data disks attached on LUN 0 and LUN 1 </li> <li>launch the initialisation script with the target data disk mapping names as argument (/dev/sdh and /dev/sdi) - the script will automatically mount the LUN 0 disk at /dev/sdh and the LUN 1 disk at /dev/sdi</li> <li>install TheHive only (because of parameters <code>\"-t 1\", \"-c 0\"</code> when calling the <code>ops-launch.sh</code> script)</li> </ul> <p>Tip</p> <ol> <li>To install both TheHive and Cortex on the same instance, use <code>\"-t 1\", \"-c 1\"</code></li> <li>To install Cortex only on another instance, use <code>\"-t 0\", \"-c 1\"</code></li> </ol> <p>That's it! TheHive is now available (for your load balancer or reverse proxy) on port 9000 and Cortex on port 9001, if also installed. The default admin account on both applications is <code>admin</code> with password <code>secret</code> (change them!). </p> <p>Remember to access the apps through an internet-facing https system such as a reverse proxy or load balancer. In our example, TheHive is available at <code>https://thehive.mydomain.com/thehive</code> and Cortex at <code>https://thehive.mydomain.com/cortex</code>.</p>"}, {"location": "resources/iaas/azure/thehive/#even-easier-using-terraform", "title": "Even easier using Terraform", "text": "<p>You can also provision the whole thing using Terraform.</p> <p>Check our GitHub repository for turnkey deployment code, including a full SecOps vnet with an https Application Gateway.</p>"}, {"location": "resources/iaas/azure/infra-as-code/", "title": "Azure sample code", "text": ""}, {"location": "resources/iaas/azure/infra-as-code/#azure-sample-code", "title": "Azure sample code", "text": ""}, {"location": "resources/iaas/azure/infra-as-code/#overview", "title": "Overview", "text": "<p>The sample Terraform code in this repository allows the creation of a complete SecOps virtual network (vnet) to host your TheHive and Cortex instances and expose them using an Application Gateway.</p> <p></p> <p>The sample code is organised in two Terraform projects:</p> <ul> <li>ug-secops-vnet --&gt; to create and manage the SecOps virtual network and TheHive / Cortex data disks</li> <li>ug-secops-instances --&gt; to launch and manage TheHive v5 and Cortex instances within a SecOps vnet</li> </ul> <p>This code organization allows the creation of all required vnet resources if you do not already operate a vnet (or if you want to create a new one for your SecOps needs), independently from TheHive and Cortex deployments.</p> <p>The sample code to launch TheHive and Cortex instances defaults to this new vnet but can easily be adapted to fit your existing vnet by customising a few variables. Unless your architecture significantly differs from our reference vnet, you should not be required to modify the Terraform code itself.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/", "title": "Deploying TheHive v5 and Cortex with Terraform", "text": ""}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#deploying-thehive-v5-and-cortex-with-terraform", "title": "Deploying TheHive v5 and Cortex with Terraform", "text": "<p>This code will work out of the box with the reference SecOps vnet created with our sample code. You can nonetheless use it to deploy TheHive and Cortex within your own pre-existing vnet with minimal adjustments (only a few variables to update if your setup is similar to our reference architecture).</p> <p>Our sample code can handle two use-cases:</p> <ul> <li>Deploying brand new TheHive and Cortex instances with empty databases - this is useful for an initial deployment.</li> <li>Deploying TheHive and Cortex instances while restoring existing databases - this is to be used for all other use-cases: image updates, instance size upgrades or downgrades, database restore, etc.</li> </ul> <p>Note</p> <pre><code>The instance initialization script will automatically detect if the persistent disks already contain data and will behave accordingly (initial setup or restore).\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#files", "title": "Files", "text": "<p>Files</p> <pre><code>Terraform files are available on [Github](https://github.com/StrangeBeeCorp/cloud-distrib-resources/blob/master/azure/ug-secops-instances/):\n</code></pre> <ul> <li>000-provider.tf</li> <li>005-runcontext.tf</li> <li>040-securitygroup-th.tf</li> <li>040-securitygroup-th.tf</li> <li>090-instance-cortex.tf</li> <li>090-instance-th.tf</li> <li>output.tf</li> <li>variables.tf</li> <li>tarreform.tfvars</li> <li>files/cloud-config.tpl</li> </ul>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#tldr", "title": "TL;DR;", "text": "<ul> <li>Download the files</li> <li>Set / update the required variables</li> <li><code>terraform init</code> &amp;&amp; <code>terraform apply</code></li> <li>Once the <code>terraform apply</code> is over, wait up to 5 minutes for both instances to be fully operational. You can check the initialisation or restore progress by tailing the <code>/var/log/cloud-init-output.log</code> and <code>/opt/strangebee/ops/logs/ops-launch.sh.log</code> files on each instance.</li> </ul>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#overview", "title": "Overview", "text": "<p>This is an overview of the resulting TheHive and Cortex instances when deployed with our Terraform sample code in our reference SecOps vnet.</p> <p></p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#information-on-the-default-data-disks-configuration", "title": "Information on the default data disks configuration", "text": "<p>All TheHive and Cortex data is stored on dedicated data disks, not in the OS disks. This approach has many advantages:</p> <ul> <li>Your OS disk is disposable, you can replace your instances in seconds to update TheHive or Cortex by launching a fresh image or to migrate to a more (or less) powerful instance.</li> <li>Your data disks can be of any size while keeping the OS disk to its default size. </li> <li>Increasing (or decreasing) the size of a data disk on an existing instance is a lot easier than changing the OS disk size.</li> <li>You can restore your database from a previous state using disk snapshots.</li> </ul> <p>By default, the sample code expects the four persistent data disks to already exist (two for each instance):</p> <ul> <li>TheHive data volume - <code>lun0</code> - mounted at <code>/opt/thp_data</code> on TheHive instance</li> <li>TheHive Docker volume - <code>lun1</code> - mounted at <code>/var/lib/docker</code> on TheHive instance</li> <li>Cortex data volume - <code>lun0</code> - mounted at <code>/opt/thp_data</code> on Cortex instance</li> <li>Cortex Docker volume - <code>lun1</code> - mounted at <code>/var/lib/docker</code> on Cortex instance</li> </ul> <p>We created these persistent disks along with the vnet, so if you are using a custom or existing vnet, create them first and input their names in the associated variables. This way, the disks will not be deleted when the instances are terminated. This ensures that your data isn't accidentally lost.</p> <p>Note</p> <pre><code>Note that the disks are automatically managed if you use our sample Terraform code, you do not need to partition, format and mount the volumes, everything is taken care of for you!\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#connecting-to-your-instances-with-ssh", "title": "Connecting to your instances with SSH", "text": "<p>Since our TheHive and Cortex instance are located in a private subnet, we cannot directly SSH into them using their private IP addresses. If you have set up a bastion host configuration similarly to our reference architecture, you can seamlessly connect to private instances using the proxyjump functionality of the ssh client. The bastion host will be able to perform the hostname resolution with the private DNS zone we have set up in the VPC.</p> <p>The easiest way to do that is to create (or update) the <code>~/.ssh/config</code> file. Use the example below as a reference and replace the ip addresses and private key information.</p> <p>The default username for both the bastion host and TheHive instance is <code>azureuser</code>.</p> <pre><code>```\nHost bastion\n    HostName 1.2.3.4 (public ip)\n    User azureuser\n    Port 22\n    IdentityFile ~/.ssh/id_rsa_private_key_for_bastion\n\nHost thehive\n    HostName thehive.secops.cloud\n    User azureuser\n    Port 22\n    ProxyJump bastion\n    IdentityFile ~/.ssh/id_rsa_private_key_for_thehive\n\nHost cortex\n    HostName cortex.secops.cloud\n    User azureuser\n    Port 22\n    ProxyJump bastion\n    IdentityFile ~/.ssh/id_rsa_private_key_for_cortex\n```\n</code></pre> <p>Note</p> <p>We use the <code>secops.cloud</code> domain as an example but the best security practice is to use a domain name you own even for private DNS resolution in split-horizon.</p> <p>You will now be able to SSH into your instances directly using the bastion host as a proxy:</p> <pre><code>`$ ssh thehive`\n\nor\n\n`$ ssh cortex`\n</code></pre> <p>Note</p> <pre><code>Remember to whitelist your local public IP address in the bastion network security group.\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#accessing-the-nomad-ui", "title": "Accessing the Nomad UI", "text": "<p>It can sometimes be useful to access the Nomad UI to control the running application stack or to easily access the container console logs for each running task.</p> <p></p> <p>Since we are running Nomad in a standalone mode, without ACLs being implemented, we do not automatically expose the UI outside the instance itself (in other words, it will not be reachable from the Application Gateway using our sample Terraform code).</p> <p>Note</p> <p>Starting with image version 5.1.4, basic Nomad ACLs have been enabled. The default anonymous access provides some <code>read</code> permissions and full access is possible using the <code>admin</code> token. The admin token is automatically created the first time the Nomad ACLs are bootstraped and is stored under <code>/opt/thp_data/nomad/nomad.mgmt</code>. This token is stored on the persistent data volume and will be reused when updating (replacing) the instance while keeping the same persistent data volume.</p> <p>If you need occasional Nomad UI access, you can simply set a temporary SSH tunnel to the instance and forward a local port to the UI (which listens locally on port 4646 on each TheHive / Cortex instance).</p> <p>Note</p> <pre><code>if you wish to access the Nomad UI for multiple instances this way, you must use a different local port for each instance.\n</code></pre> <p>The following examples show how to launch these tunnels using an openSSH client in a vnet where the application instances are on a private subnet that can be reached only through a bastion host (jump host).</p> <p>access the Nomad UI for your TheHive instance - locally on port 46461</p> <pre><code>`$ ssh -L 46461:localhost:4646 azureuser@your_thehive_instance -J azureuser@your_bastion_instance`\n\nThe Nomad UI for your TheHive instance can now be opened in your browser at `http://localhost:46461/ui/`\n</code></pre> <p>Access the Nomad UI for your Cortex instance - locally on port 46462</p> <pre><code>`$ ssh -L 46462:localhost:4646 azureuser@your_cortex_instance -J azureuser@your_bastion_instance`\n\nThe Nomad UI for your Cortex instance can now be opened in your browser at `http://localhost:46462/ui/`\n</code></pre> <p>The same configuration can be achieved by updating your <code>SSH config</code> file to include a <code>LocalForward</code> statement for each remote instance:</p> <pre><code>```\nHost bastion\n    HostName 1.2.3.4 (public ip)\n    User azureuser\n    Port 22\n    IdentityFile ~/.ssh/id_rsa_private_key_for_bastion\n\nHost thehive\n    HostName thehive.secops.cloud\n    User azureuser\n    Port 22\n    ProxyJump bastion\n    IdentityFile ~/.ssh/id_rsa_private_key_for_thehive\n    LocalForward 46461 localhost:4646\n\nHost cortex\n    HostName cortex.secops.cloud\n    User azureuser\n    Port 22\n    ProxyJump bastion\n    IdentityFile ~/.ssh/id_rsa_private_key_for_cortex\n    LocalForward 46462 localhost:4646\n```\n</code></pre> <p>Note</p> <pre><code>Setting up an SSH tunnel between your computer and the remote instances requires that tunnelling and TCP forwarding be allowed on all hosts involved in the process. When you use the sample Terraform code in this repository, this is possible OOTB.\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/#updating-thehive-and-cortex-over-time", "title": "Updating TheHive and Cortex over time", "text": "<p>Once your instances are deployed, you can easily update TheHive and / or Cortex. In a nutshell, the process consists in replacing the image versions in a variable file and restarting the application stack on each instance. This process it detailed at length in this dedicated documentation page.</p> <p>Terraform compatibility: v1.x</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/", "title": "Upgrading your Azure instances", "text": ""}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#upgrading-your-azure-instances", "title": "Upgrading your Azure instances", "text": "<p>This documentation page describes how to upgrade the application stack on your instance (TheHive, Cortex and related services such as Cassandra and ElasticSearch).</p> <p>It does not cover operating system level updates such as Ubuntu patches, Docker updates, Nomad updates, etc. We recommend replacing your instance and using a fresh Azure Marketplace image to update all OS-level components to avoid any software version inconsistency / incompatibility.</p> <p>To avoid data loss / data corruption, you should ALWAYS backup or snapshot your persistent data volumes before performing any kind of update process.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#tldr", "title": "TL;DR;", "text": "<p>All actions on the instances are to be performed as root</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#1-stop-the-running-nomad-job", "title": "1. Stop the running Nomad job", "text": "<pre><code>$ . /opt/strangebee/ops/scripts/ops-common.cfg &amp;&amp; stop_nomad_job thehive-job\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#2-backup-your-nomad-job-specifications-and-var-files", "title": "2. Backup your Nomad job specifications and var files", "text": "<pre><code>$ /opt/strangebee/ops/scripts/ops-config-backup.sh -n nomad-jobs -f /opt/thp_data/nomad/jobs/\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#3-backup-snapshot-your-instance-persistent-data-volume-using-the-azure-console-or-cli", "title": "3. Backup / snapshot your instance persistent data volume (using the Azure console or CLI)", "text": ""}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#4-edit-the-nomad-job-var-file-matching-the-running-job-on-the-instance-and-update-the-image-versions-you-wish-to-use-from-now-on", "title": "4. Edit the Nomad job var file matching the running job on the instance and update the image versions you wish to use from now on.", "text": "<p>All job specifications and var files are located under <code>/opt/thp_data/nomad/jobs</code> ex: <code>$ vi /opt/thp_data/nomad/jobs/thehive-job.vars</code></p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#5-schedule-the-nomad-job-dont-forget-to-set-the-matching-var-file", "title": "5. Schedule the Nomad job (don't forget to set the matching var file)", "text": "<pre><code>$ . /opt/strangebee/ops/scripts/ops-common.cfg &amp;&amp; run_nomad_job thehive-job\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#context", "title": "Context", "text": "<p>The Azure Marketplace image for TheHive v5 can be used to deploy both TheHive v5 and / or Cortex v3. The image itself includes a hardened version of the official Ubuntu image from Canonical and a preconfigured Hashicorp Nomad engine. The image launch-time configuration you applied determined if TheHive or Cortex or both got installed on a given instance (as Nomad service jobs).</p> <p>To make things simpler for Azure admins with varying level of Hashicorp Nomad experience (including first-time Nomad users), we provide three different job specifications baked in the image to allow three instance deployment scenarios (instead of a more complex, dynamic one, that can adapt to all use-cases).</p> <p>The job specifications are named as follow:</p> <ul> <li>TheHive only --&gt; <code>thehive-job</code></li> <li>Cortex only --&gt; <code>cortex-job</code></li> <li>TheHive and Cortex on the same instance --&gt; <code>thehive-cortex-job</code></li> </ul> <p>Once your instances are deployed, you can check which profile is applied on a given instance with the following command (to be run on the instance):</p> <pre><code>$ nomad status\n</code></pre> <p>If you deployed TheHive only, the output is the following:</p> <pre><code>ID           Type     Priority  Status   Submit Date\nthehive-job  service  50        running  ***\n</code></pre> <p>Likewise, if you deployed Cortex only, the output is:</p> <pre><code>ID          Type     Priority  Status   Submit Date\ncortex-job  service  50        running  ***\n</code></pre> <p>And finally, if you deployed both TheHive and Cortex, the output is predictably:</p> <pre><code>ID                  Type     Priority  Status   Submit Date\nthehive-cortex-job  service  50        running  ***\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#marketplace-image-storage-vs-persistent-instance-storage", "title": "Marketplace image storage vs. persistent instance storage", "text": "<p>Before we go any further, a quick note on image vs. persistent storage.</p> <p>As mentioned in the README, persistent data gets stored on a dedicated volume, not on the root filesystem. By default, your persistent data volume will be mounted at <code>/opt/thp_data</code>.</p> <pre><code>$ lsblk\n\nNAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT\nloop0     7:0    0 67.8M  1 loop /snap/lxd/22753\nloop1     7:1    0   62M  1 loop /snap/core20/1587\nloop2     7:2    0   47M  1 loop /snap/snapd/16292\nloop3     7:3    0   48M  1 loop /snap/snapd/17029\nloop4     7:4    0 63.2M  1 loop /snap/core20/1623\nsda       8:0    0   16G  0 disk\n\u2514\u2500sda1    8:1    0   16G  0 part /opt/thp_data\nsdb       8:16   0   32G  0 disk\n\u2514\u2500sdb1    8:17   0   32G  0 part /var/lib/docker\nsdc       8:32   0   30G  0 disk\n\u251c\u2500sdc1    8:33   0 29.9G  0 part /\n\u251c\u2500sdc14   8:46   0    4M  0 part\n\u2514\u2500sdc15   8:47   0  106M  0 part /boot/efi\nsr0      11:0    1  638K  0 rom\n</code></pre> <p>The Docker volume mounted at <code>/var/lib/docker</code> is also persistent but contains no persistent data and does not need to be backed-up. We use a dedicated Docker volume only for size adaptability since Docker images could require a lot of storage space (say if you were to use all available Cortex analyzer / responder images) or not that much if you only run TheHive on the instance.</p> <p>We provide templates for the Nomad job specifications within the image. The templates are located at: <code>/opt/strangebee/ops/templates/nomad/jobs</code>. All files under the <code>templates</code> folder are only meant as templates to be used somewhere else (most likely on your persistent storage). So, the only time window where it can be useful to modify the templates is at first instance launch, before initialising the instance (and thus before copying them to the persistent storage).</p> <p>Every time you replace an instance and use a fresh Azure Marketplace image, the root filesystem gets completely reset based on the new image, including the <code>templates</code> folder.</p> <p>The effective runtime configuration files used to launch Nomad jobs are all located on the persistent storage at: <code>/opt/thp_data/nomad/jobs</code>.</p> <p>When you replace an instance and use a fresh Azure Marketplace image, the persistent storage remains exactly as you left it when you stopped the previous instance.</p> <p>To proceed with TheHive / Cortex updates, we will only modify files on the persistent volume, all located under <code>/opt/thp_data/nomad/jobs</code>.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#update-step-13-stop-the-apps-and-perform-some-backups", "title": "Update step 1/3: stop the apps and perform some backups", "text": ""}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#stop-the-running-nomad-job", "title": "Stop the running Nomad job", "text": "<p>Before performing configuration and data backups, we will stop the running Nomad job on each instance (use the appropriate job name on each instance as identified earlier in the Context section). This will stop TheHive and / or Cortex along with all depending services such as Cassandra and ElasticSearch.</p> <p>Note</p> <p>All actions on the instances during the entire update process are to be performed as root**. Once connected to the instance, you can switch to the root context using the <code>sudo su</code> command.</p> <pre><code>$ . /opt/strangebee/ops/scripts/ops-common.cfg &amp;&amp; stop_nomad_job thehive-job\n\n[INFO] Stopping Nomad job: thehive-job\n[INFO] Fetching Nomad ACL management token\n</code></pre> <p>You can check the job is now stopped:</p> <pre><code>$ nomad status\n\nID           Type     Priority  Status          Submit Date\nthehive-job  service  50        dead (stopped)  ***\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#backup-existing-nomad-job-specifications-and-variable-files", "title": "Backup existing Nomad job specifications and variable files", "text": "<p>We will now backup the existing Nomad job specifications and variable files before updating them. A script to do so is baked into the image, use it with the <code>-n</code> flag to set the backup name and <code>-f</code> flag to set the folder to backup. All backups will get stored on your persistent volume under <code>/opt/thp_data/backup</code>.</p> <pre><code>$ /opt/strangebee/ops/scripts/ops-config-backup.sh -n nomad-jobs -f /opt/thp_data/nomad/jobs/\n\n[INFO] Initial checks\n[INFO] Backup of /opt/thp_data/nomad/jobs/\n\n--- START of nomad-jobs config backup - Mon Oct 10 14:45:48 UTC 2022 ---\n\ntar: Removing leading `/' from member names\n/opt/thp_data/nomad/jobs/\n/opt/thp_data/nomad/jobs/thehive-job.nomad\n/opt/thp_data/nomad/jobs/thehive-db-init-job.nomad\n/opt/thp_data/nomad/jobs/thehive-cortex-job.nomad\n/opt/thp_data/nomad/jobs/thehive-db-init-job.vars\n/opt/thp_data/nomad/jobs/cortex-job.nomad\n/opt/thp_data/nomad/jobs/thehive-cortex-job.vars\n/opt/thp_data/nomad/jobs/cortex-job.vars\n/opt/thp_data/nomad/jobs/thehive-job.vars\n[INFO] Purging backups older than 7 days\n\n--- END of nomad-jobs config backup - Mon Oct 10 14:45:48 UTC 2022 ---\n</code></pre> <p>You can now check the resulting archive.</p> <pre><code>$ ll /opt/thp_data/backup\n\ntotal 16\ndrwxr-xr-x  2 root root 4096 Oct 10 14:45 ./\ndrwxr-xr-x 12 root root 4096 Oct 10 10:59 ../\n-rw-r-----  1 root root 3261 Oct 10 14:45 nomad-jobs.conf.backup.2022-10-10.tar.gz\n-rw-r-----  1 root root 3261 Oct 10 14:45 nomad-jobs.conf.latest.tar.gz\n</code></pre> <p>Note</p> <p>using the configuration backup script, the latest backup gets copied with the <code>latest</code> suffix. The latest backups never get deleted when older backups get purged.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#backup-or-snapshot-your-persistent-data-volume", "title": "Backup or snapshot your persistent data volume", "text": "<p>Using the Azure console or CLI, snapshot your persistent data volume before performing any update:</p> <p></p> <p>Snapshot the persistent data volume for each instance you are updating.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#update-step-23-update-the-image-versions-in-the-nomad-job-variable-file", "title": "Update step 2/3: update the image versions in the Nomad job variable file", "text": "<p>To make the update process easier, we have stored the image versions used in the Nomad job specifications in an external variables file. In most cases, it is not necessary to ever update the job specifications file unless you wish to fine tune some technical settings, such as the resources allocated to each task (CPU &amp; RAM).</p> <p>For example, we will update TheHive along with its dependencies on an instance running the <code>thehive-job</code> Nomad job. This job is described in two files:</p> <ul> <li>The job specifications file located at: <code>/opt/thp_data/nomad/jobs/thehive-job.nomad</code></li> <li>The job variables file located at: <code>/opt/thp_data/nomad/jobs/thehive-job.vars</code></li> </ul> <p>To update the image versions, we need to edit the variables file:</p> <ul> <li><code>$ vi /opt/thp_data/nomad/jobs/thehive-job.vars</code></li> </ul> /opt/thp_data/nomad/jobs/thehive-job.vars<pre><code>thehivecontext = \"/thehive\"\nimage_cassandra = \"cassandra:4.0.6\"\nimage_elasticsearch = \"elasticsearch:7.17.6\"\nimage_nginx = \"nginx:1.23.1\"\nimage_thehive = \"strangebee/thehive:5.0.16-1\"\n</code></pre> <p>Our instance was running TheHive v5.0.16 along with Cassandra v4.0.6 and ElasticSearch v7.17.6. </p> <p>Let's update the image versions (this is just an example, use the actual versions you wish to deploy):</p> <ul> <li><code>$ vi /opt/thp_data/nomad/jobs/thehive-job.vars</code></li> </ul> /opt/thp_data/nomad/jobs/thehive-job.vars<pre><code>thehivecontext = \"/thehive\"\nimage_cassandra = \"cassandra:4.1.0\"\nimage_elasticsearch = \"elasticsearch:7.17.9\"\nimage_nginx = \"nginx:1.24.0\"\nimage_thehive = \"strangebee/thehive:5.1.4-1\"\n</code></pre> <p>Tip</p> <p>We recommend never using the <code>:latest</code> tag and always using specific image versions to avoid problems or inconsistencies.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#image-references", "title": "Image references", "text": "<p>You can find the available image versions for each component at the following links:</p> <ul> <li>TheHive images</li> <li>Cortex images</li> <li>Cassandra images</li> <li>ElasticSearch images</li> <li>Nginx images</li> </ul> <p>TheHive v5 is not yet compatible with ElasticSearch v8.x - only the 7.x versions are supported for the time being.</p> <p>You can find the changelog for TheHive and Cortex at the following links:</p> <ul> <li>TheHive changelog</li> <li>Cortex changelog</li> </ul>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-instances/docs/upgrade/#update-step-33-schedule-the-nomad-job", "title": "Update step 3/3: Schedule the Nomad job", "text": "<p>You can now schedule the Nomad job to start TheHive and / or Cortex. Do not forget to set the variable file we just modified when running the job, otherwise it will fail.</p> <pre><code>$ . /opt/strangebee/ops/scripts/ops-common.cfg &amp;&amp; run_nomad_job thehive-job\n\n[INFO] Scheduling Nomad job: thehive-job\n[INFO] Fetching Nomad ACL management token\n</code></pre> <p>To check the job is now running again:</p> <pre><code>$ nomad status\n\nID           Type     Priority  Status   Submit Date\nthehive-job  service  50        running  ***\n</code></pre> <p>To check the updated TheHive version:</p> <pre><code>$ . /opt/strangebee/ops/scripts/ops-common.cfg &amp;&amp; check_rp $(get_host_ip) thehive\n\n[INFO] Checking local reverse proxy on /thehive/api/status\n{\"versions\":{\"Scalligraph\":\"5.1.4-1\",\"TheHive\":\"5.1.4-1\",\"Play\":\"2.8.x\"},\"config\":{\"protectDownloadsWith\":\"malware\",\"authType\":[\"session\",\"local\",\"key\"],\"capabilities\":[\"changePassword\",\"setPassword\",\"authByKey\",\"mfa\"],\"ssoAutoLogin\":false,\"pollingDuration\":1000,\"freeTagDefaultColour\":\"#000000\"}}\n</code></pre> <p>To check the updated Cortex version:</p> <pre><code>$ . /opt/strangebee/ops/scripts/ops-common.cfg &amp;&amp; check_rp $(get_host_ip) cortex\n\n[INFO] Checking local reverse proxy on /cortex/api/status\n{\"versions\":{\"Cortex\":\"3.1.7-1\",\"Elastic4Play\":\"1.13.6\",\"Play\":\"2.8.16\",\"Elastic4s\":\"7.17.2\",\"ElasticSearch client\":\"7.17.1\"},\"config\":{\"protectDownloadsWith\":\"malware\",\"authType\":[\"key\",\"local\"],\"capabilities\":[\"authByKey\",\"changePassword\",\"setPassword\"],\"ssoAutoLogin\":false}}\n</code></pre>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/", "title": "Creating a new SecOps Virtual Network", "text": ""}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#creating-a-new-secops-virtual-network", "title": "Creating a new SecOps Virtual Network", "text": "<p>If you do not already have a virtual network (vnet) at hand to deploy TheHive and Cortex into, using our sample code will allow you to build a production-ready vnet very easily.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#files", "title": "Files", "text": "<p>Files</p> <p>Terraform files are available on Github: </p> <ul> <li>000-provider.tf</li> <li>010-vnet.tf</li> <li>030-certificate-identity.tf</li> <li>050-bastion.tf</li> <li>060-nva.tf</li> <li>070-appgw-securitygroup.tf</li> <li>075-public-securitygroup.tf</li> <li>080-nva-nic-securitygroup.tf</li> <li>085-routes.tf</li> <li>085-routes.tf</li> <li>090-instance-disks.tf</li> <li>200-appgw.tf</li> <li>output.tf</li> <li>variables.tf</li> <li>tarreform.tfvars</li> <li>files/nva-nat-cloud-config.yaml</li> </ul>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#overview", "title": "Overview", "text": "<p>The reference architecture vnet consists of the following resources</p> <p></p> <p>The vnet will include:</p> <ul> <li>Two public subnets (one for the Application Gateway, the other for the bastion and network virtual appliance hosts)</li> <li>One backend private subnet to host our TheHive and Cortex instances</li> <li>An Application Gateway to securely handle the public-facing traffic to our TheHive and Cortex instances</li> <li>All required Network Security Groups</li> <li>Public DNS records for TheHive and Cortex to point to the Application Gateway </li> <li>A bastion host to SSH into our TheHive and Cortex instance hosted in the private subnet</li> <li>A Network Virtual Appliance to allow Internet access for our instances in the private subnet through a NAT gateway</li> <li>Four storage disks to store the persistent TheHive and Cortex data. These disks could be created alongside the instances but creating them with the vnet further limits the risk of accidental destruction and data loss when updating or replacing the instances.</li> </ul>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#network-security-groups", "title": "Network Security Groups", "text": "<p>There are no default iptables rules implemented in the images for either TheHive or Cortex (no OS-based IP filtering). Since we built them to be replaceable at each application update, somewhat like containers, we recommend limiting OS customisations to benefit from the easy update process. For that reason, filtering should be based on network security groups only.</p> <p>Keep in mind that the applications are listening on http, not https. Even though the default network security groups allow incoming traffic on the http ports (TCP 9000 for TheHive, TCP 9001 for Cortex), be careful not to expose them on a public-facing network interface.</p> <p>While all required security groups depicted above are automatically deployed with Terraform, please note the following:</p> <p>For secops-public-subnet Network Security Group (NSG) and secops-backend-private-subnet NSGs:</p> <ul> <li>All default Azure rules allowing internal Virtual Network traffic, AzureLoadBalancer traffic and Internet traffic are blocked.</li> </ul> <p>For secops-appgw-subnet NSG: </p> <ul> <li>Default Azure inbound rules allowing internal Virtual Network traffic and AzureLoadBalancer traffic are blocked.</li> <li>Inbound traffic with source address GatewayManager or AzureLoadBalancer (destination port TCP 65200-65535) is allowed as recommended by Azure for the Application Gateway.</li> <li>Default Azure outbound rules are allowed.</li> </ul>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#bastion-host", "title": "Bastion host", "text": "<p>We launch an instance to act as a bastion host (defaults to B2s - 2 vCPUs / 4 GiB RAM). Bastion host hardening is not performed automatically but you should definitely harden this host going forward if you will use it in a production context. We do however strictly limit access to and from this host.</p> <p>The bastion host will run the latest Ubuntu image from Canonical. The default sudoer user is azureuser.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#mynva-host", "title": "myNVA host", "text": "<p>We launch an instance to act as a network virtual appliance (NVA - defaults to DS2_v2 - 2 vCPUs / 7 GiB RAM / Accelerated networking supported). This instances makes it possible to NAT outgoing traffic from the private subnet. NVA host hardening is not performed automatically but you should definitely harden this host going forward if you will use it in a production context. We do however strictly limit access to and from this host.</p> <p>The NVA host will run the latest Ubuntu image from Canonical. The default sudoer user is azureuser.</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#secops-vnet-prerequisites", "title": "SecOps vnet prerequisites", "text": "<p>While most vnet resources will be provisioned with Terraform, there are some exceptions that must be created beforehand:</p> <ul> <li>The Azure account and subscription must already exist, along with the target resource group</li> <li>The public DNS zone to register the Application Gateway</li> <li>The service principal to build the environment (e.g app-name) with Owner Azure Role on the subscription</li> <li>The keyvault and associated certificate for the https listener</li> </ul> <p>You must provide the information for these resources before creating the vnet (populate the Terraform variables with the associated values).</p>"}, {"location": "resources/iaas/azure/infra-as-code/ug-secops-vnet/#providing-credentials-to-terraform", "title": "Providing credentials to Terraform", "text": "<p>Terraform requires Azure credentials in order to build the vnet and its associated resources. </p> <p>We highly recommend you never store your Azure credentials in the Terraform code or even in the same directory tree to avoid sharing / commiting the file accidentally. One way to provide the required credentials to Terraform is to create a file to set some environment variables and to source the file prior to running Terraform.</p> <p>Again, store this file in a secure location outside your Terraform project directory tree.</p> <p>Sample file:</p> <pre><code>export ARM_SUBSCRIPTION_ID=\"xxxx-xxxx-xxxx-xxxx-xxxx\"\nexport ARM_CLIENT_ID=\"xxxx-xxxx-xxxx-xxxx-xxxx\"\nexport ARM_CLIENT_SECRET=\"xxxx-xxxx-xxxx-xxxx-xxxx\"\nexport ARM_TENANT_ID=\"xxxx-xxxx-xxxx-xxxx-xxxx\"\nexport TF_VAR_thehive_key_vault_certificate_secret_id=\"xxxx-xxxx-xxxx-xxxx-xxxx\"\n</code></pre> <p>Where to find the associated values:</p> <ul> <li>ARM_SUBSCRIPTION_ID: The subscription ID (under Subscriptions --&gt; )</li> <li>ARM_CLIENT_ID: application ID (under Azure Active Directory --&gt; App registrations --&gt; All applications --&gt; app-name)</li> <li>ARM_CLIENT_SECRET: app-name Secret Key (under Azure Active Directory --&gt; App registrations --&gt; All applications --&gt; app-name --&gt; Certificates &amp; secrets)</li> <li>ARM_TENANT_ID: Active Directory tenant ID (under Azure Active Directory)</li> <li>TF_VAR_thehive_key_vault_certificate_secret_id: thehive certificate secret ID (under Keyvault --&gt; Certificates --&gt; thehive-certificate --&gt; CURRENT VERSION )</li> </ul> <p>Terraform compatibility: v1.x</p>"}, {"location": "thehive/", "title": "TheHive", "text": ""}, {"location": "thehive/#thehive", "title": "TheHive", "text": ""}, {"location": "thehive/administration/add-a-global-endpoint/", "title": "Add a Global Endpoint", "text": ""}, {"location": "thehive/administration/add-a-global-endpoint/#add-a-global-endpoint", "title": "Add a Global Endpoint", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for adding a global endpoint in TheHive.</p> <p>Once created, this global endpoint becomes available to all organizations you choose to share it with.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Global endpoints tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>Select the connector for which you want to create an endpoint.</p> </li> <li> <p>Follow the instructions in the local endpoints topics, starting from step 5.</p> <ul> <li>Add a Local HttpRequest Endpoint</li> <li>Add a Local Mattermost Endpoint</li> <li>Add a Local Slack Endpoint</li> <li>Add a Local Teams Endpoint</li> <li>Add a Local Webhook Endpoint</li> </ul> </li> <li> <p>Use the Choose the filter on TheHive organizations dropdown to select the organizations to share your global endpoint with.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure the HttpRequest notifier</li> <li>Configure the Mattermost notifier</li> <li>Configure the Slack notifier</li> <li>Configure the Teams notifier</li> <li>Configure the Webhook notifier</li> </ul>"}, {"location": "thehive/administration/customize-thehive-branding/", "title": "Customize Branding", "text": ""}, {"location": "thehive/administration/customize-thehive-branding/#customize-thehive-branding", "title": "Customize TheHive Branding", "text": "<p><code>[admin] managePlatform</code> Platinum</p> <p>This topic provides step-by-step instructions for customizing TheHive branding.</p> <p>Use this procedure to personalize the application with your brand name and logo.</p>"}, {"location": "thehive/administration/customize-thehive-branding/#customize-the-login-page-tab-title", "title": "Customize the login page tab title", "text": "<ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Branding tab.</p> <p></p> </li> <li> <p>Enter a new title in the Title field.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/administration/customize-thehive-branding/#customize-the-login-page-logo", "title": "Customize the login page logo", "text": "<ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Branding tab.</p> <p></p> </li> <li> <p>Select a login page logo.</p> <p>Accepted formats: JPEG, JPG, and PNG.</p> <p>Recommended size: 200x200 pixels.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/administration/customize-thehive-branding/#customize-the-navigation-bar-logo", "title": "Customize the navigation bar logo", "text": "<ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Branding tab.</p> <p></p> </li> <li> <p>Select a navigation bar logo.</p> <p>Accepted formats: JPEG, JPG, and PNG.</p> <p>Recommended size: 84x84 pixels.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/administration/customize-thehive-branding/#customize-the-tab-favicon", "title": "Customize the tab faviconNext steps", "text": "<ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Branding tab.</p> <p></p> </li> <li> <p>Select a favicon.</p> <p>Accepted formats: JPEG, JPG, PNG, and ICO.</p> <p>Recommended size: 42x42 pixels.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Change a Status Color</li> </ul>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/", "title": "First Start", "text": ""}, {"location": "thehive/administration/perform-initial-setup-as-admin/#perform-initial-login-and-setup-as-an-admin", "title": "Perform Initial Login and Setup as an Admin", "text": "<p>This topic provides step-by-step instructions for performing the initial login and setup as an administrator in TheHive.</p> <p>Use this procedure at first start, before granting access to other users.</p>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/#step-1-log-in-with-the-default-credentials", "title": "Step 1: Log in with the default credentials", "text": "TheHive On-premTheHive Cloud Platform <p>Requirements</p> <p>This procedure assumes that you have already installed TheHive and that TheHive is up and running.</p> <ol> <li> <p>Open your web browser.</p> </li> <li> <p>Browse to the URL you configured in the <code>application.baseUrl</code> setting inside the <code>/etc/thehive/application.conf</code> file.</p> </li> <li> <p>Enter the username and default password.</p> <p>Login: <code>admin@thehive.local</code> Password: <code>secret</code></p> </li> <li> <p>Select Let me in.</p> </li> </ol> <ol> <li> <p>Retrieve your URL, administrator username, and default administrator password from the PDF available via the SendSafely link sent to you.</p> </li> <li> <p>Open the provided URL in your browser.</p> </li> <li> <p>Enter the credentials.</p> </li> <li> <p>Select Let me in.</p> </li> </ol>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/#step-2-change-your-default-password", "title": "Step 2: Change your default password", "text": "<p>Critical security risk</p> <p>Change the default password immediately after your first login to protect your TheHive instance. Leaving them unchanged allows unauthorized access, risking sensitive data and system integrity.</p> <p>See Edit your Password for detailed instructions.</p>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/#optional-step-3-request-and-activate-your-license", "title": "(Optional) Step 3: Request and activate your license", "text": "<p>5.3 Installing TheHive On-prem or using TheHive Cloud Platform for the first time includes a 14-day Platinum trial license. If you complete the setup within this period, the license is already activated, and you don\u2019t need to take further action.</p> <p>After this trial period, TheHive transitions to read-only mode. To maintain full functionality, request a free or paid license and activate it. For details, see About Licenses.</p>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/#step-4-configure-thehive", "title": "Step 4: Configure TheHive", "text": ""}, {"location": "thehive/administration/perform-initial-setup-as-admin/#configure-an-smtp-server", "title": "Configure an SMTP server", "text": "<p>See Configure an SMTP server for detailed instructions.</p>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/#create-organizations", "title": "Create organizations", "text": "<p>Trial limitation</p> <p>During the Platinum trial period, you can create up to two organizations.</p> <p>See Create an Organization for detailed instructions.</p>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/#create-users", "title": "Create users", "text": "<p>Trial limitation</p> <p>During the Platinum trial period, you can create up to five users.</p> <p>See Create a User Account for detailed instructions.</p>"}, {"location": "thehive/administration/perform-initial-setup-as-admin/#customize-entities", "title": "Customize entities", "text": "<p>Customize the following elements for all your organizations:</p> <ul> <li>Profiles</li> <li>Custom fields</li> <li>Observable types</li> <li>Case and alert statuses</li> <li>Analyzer templates</li> <li>Taxonomies</li> <li>TTPs</li> </ul> Next steps <ul> <li>Configure Authentication</li> <li>Connect a MISP Server</li> <li>Add a Cortex Server</li> <li>Connect a Mailbox</li> </ul>"}, {"location": "thehive/administration/analyzer-templates/about-analyzer-templates/", "title": "About Analyzer Templates", "text": ""}, {"location": "thehive/administration/analyzer-templates/about-analyzer-templates/#about-analyzer-templates", "title": "About Analyzer Templates", "text": "<p>This topic explains what analyzer templates are in TheHive.</p>"}, {"location": "thehive/administration/analyzer-templates/about-analyzer-templates/#purpose", "title": "Purpose", "text": "<p>Analyzer templates define how analyzer reports are displayed after running an analyzer on an observable.</p>"}, {"location": "thehive/administration/analyzer-templates/about-analyzer-templates/#format", "title": "Format", "text": "<p>TheHive requires analyzer templates to be in HTML format.</p>"}, {"location": "thehive/administration/analyzer-templates/about-analyzer-templates/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePlatform</code> permission can manage analyzer templates in TheHive.</p> <ul> <li>Import Analyzer Templates</li> <li>Customize an Analyzer Template</li> </ul>"}, {"location": "thehive/administration/analyzer-templates/customize-an-analyzer-template/", "title": "Customize an Analyzer Template", "text": ""}, {"location": "thehive/administration/analyzer-templates/customize-an-analyzer-template/#customize-an-analyzer-template", "title": "Customize an Analyzer Template", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for customizing an analyzer template in TheHive.</p> <p>Use this procedure to customize templates for reports generated after running an analyzer on an observable.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Analyzer templates tab.</p> <p></p> </li> <li> <p>Select  next to the analyzer template you want to customize.</p> <p>Can't find an analyzer template?</p> <p>Analyzer templates are displayed only if the corresponding analyzer is activated in Cortex and available from TheHive.</p> </li> <li> <p>Select Edit.</p> </li> <li> <p>Modify the HTML code as needed.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Import Analyzer Templates</li> </ul>"}, {"location": "thehive/administration/analyzer-templates/import-analyzer-templates/", "title": "Import Analyzer Templates", "text": ""}, {"location": "thehive/administration/analyzer-templates/import-analyzer-templates/#import-analyzer-templates", "title": "Import Analyzer Templates", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for importing analyzer templates in TheHive.</p> <p>Use this procedure to define templates for reports generated after running an analyzer on an observable.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Analyzer templates tab.</p> <p></p> </li> <li> <p>Select Import templates archive.</p> <p></p> </li> <li> <p>In the Import templates archive drawer, download the official templates archive.</p> </li> <li> <p>Drop the ZIP file directly into the Templates archive section or select the ZIP file from your computer.</p> </li> <li> <p>Select Import.</p> </li> </ol> Next steps <ul> <li>Customize an Analyzer Template</li> </ul>"}, {"location": "thehive/administration/authentication/ad/", "title": "Active Directory (AD)", "text": ""}, {"location": "thehive/administration/authentication/ad/#configure-an-ad-authentication-provider", "title": "Configure an AD Authentication Provider", "text": "<p><code>managePlatform</code> Platinum</p> <p>Configure an AD authentication provider in TheHive.</p> Procedure <p>Local account</p> <p>Users must have an existing account in TheHive local database to authenticate successfully. Configure an LDAP server to automate account creation, updates, deletion, and assignment of user accounts to organizations and permission profiles within TheHive.</p> <p>Prerequisites</p> <ul> <li>Users must have an existing account in TheHive local database to authenticate successfully.</li> <li>These steps assume that you have already followed the instructions to configure the authentication settings.</li> </ul> <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Authentication tab.</p> <p></p> </li> <li> <p>Select Directories authentication in the Authentication providers section.</p> </li> <li> <p>In the Directories authentication drawer, turn on the Enable directory toggle.</p> </li> <li> <p>Select ad from the dropdown list.</p> </li> <li> <p>Enter the following information:</p> <p>- The addresses of the domain controllers</p> <p>The IP addresses or host names of the domain controllers responsible for handling authentication requests within the network.</p> <p>- The Windows domain name</p> <p>The name of the Windows domain that manages user accounts and permissions. This is typically the NetBIOS name used within the Windows network.</p> <p>Example: DOMAIN</p> <p>- The DNS domain name</p> <p>The FQDN associated with the Windows domain (for example, corp.example.com). This is used for resolving network resources through the DNS.</p> <p>Example: domain.local</p> </li> <li> <p>To secure communication between TheHive and the domain controllers using SSL/TLS encryption, turn on the Use SSL toggle.</p> <p>This encrypts authentication requests and responses, protecting sensitive data from interception during transmission.</p> <p>For more information about configuring SSL/TLS, refer to Configure JVM Trust for SSL/TLS Certificates.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure Authentication</li> <li>Configure JVM Trust for SSL/TLS Certificates</li> </ul>"}, {"location": "thehive/administration/authentication/configure-authentication/", "title": "Configure Authentication", "text": ""}, {"location": "thehive/administration/authentication/configure-authentication/#configure-authentication", "title": "Configure Authentication", "text": "<p><code>managePlatform</code></p> <p>Authentication in TheHive controls how users and services sign in. You can use the built-in local database, integrate with enterprise directories such as LDAP or AD, or enable SSO through SAML or OpenID providers. Additional options include API key authentication, basic authentication, HTTP header authentication, multi-factor authentication, and configurable session management.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Authentication tab.</p> <p></p> </li> <li> <p>Enter the values for each session setting:</p> <p>- Session expiration autologout</p> <p>The amount of time before users are automatically signed out, regardless of activity. This is based on the total duration of the session.</p> <p>- Session expiration warning time</p> <p>The amount of time remaining before session expiration when users receive a warning. This must be equal to or less than the session expiration autologout time.</p> <p>- Inactivity autologout</p> <p>The amount of time before users are automatically signed out due to inactivity. If users interact with the interface, the timer is reset.</p> <p>- Inactivity warning time</p> <p>The amount of time remaining before automatic sign-out due to inactivity when users receive a warning. This must be equal to or less than the inactivity autologout time.</p> </li> <li> <p>Turn the toggles on or off for advanced settings based on your preferences:</p> <p>- Enable API key authentication</p> <p>Authenticates HTTP requests using an API key.</p> <p>- Enable basic authentication</p> <p>Authenticates HTTP requests using a login and password. When enabled, you must provide a realm\u2014a string that defines a protected space on the server.</p> <p>- Enable HTTP header authentication</p> <p>Authenticates HTTP requests using a HTTP header that contains a user login. When enabled, you must provide the header name that the server will use to extract the login information from incoming requests.</p> <p>- Enable multi-factor authentication</p> <p>Enables MFA, allowing users to activate it.</p> <p>- Default domain for user login</p> <p>By default, logins use email addresses. This feature lets users sign in without specifying the email domain. Instead of entering user@example.com, they only need to enter user.</p> </li> <li> <p>Select the authentication providers you want to configure.</p> <p>Paid license required</p> <p>A paid license is required to configure authentication providers other than the local database managed by TheHive. A Platinum license is required to configure Active Directory, OAuth 2.0, OpenID, and SAML authentication.</p> <p>- Local authentication</p> <p>Authenticates users against a local database managed by TheHive. You can configure password policies, including complexity requirements, expiration periods, and account lockout settings.</p> <p>For more information, see the Configure a Local Authentication Provider topic.</p> <p>- Directories authentication</p> <p>Prerequisite</p> <p>Users must have an existing account in TheHive local database to authenticate successfully. Configure an LDAP server to automate account creation, updates, deletion, and assignment of user accounts to organizations and permission profiles within TheHive.</p> <p>Authenticates users using an LDAP server or an AD service, such as Microsoft Active Directory or OpenLDAP. This allows integration with existing enterprise directories for centralized user management.</p> <p>For more information, see the Configure an Active Directory Authentication Provider and Configure an LDAP Authentication Provider topics.</p> <p>- OAuth 2.0 authentication (deprecated)</p> <p>Deprecated</p> <p>The OAuth 2.0 is deprecated and will be removed in a future release. Use the OpenID authentication provider instead.</p> <p>Enables SSO through an external OAuth 2.0 provider, such as Keycloak, Okta, GitHub, Microsoft 365, or Google. This simplifies authentication by allowing users to sign in using their existing credentials from supported platforms.</p> <p>For more information, see the Configure an OAuth 2.0 Authentication Provider topic.</p> <p>- SSO authentication</p> <p>Enables SSO through one or more SAML providers or OpenID providers, such as Okta or Microsoft Entra ID. This method supports secure, federated identity management for large organizations.</p> <p>For more information, see the Configure a SAML Authentication Provider and Configure an OpenID Authentication Provider topics.</p> </li> <li> <p>If you enabled multiple providers, adjust the priority order using the arrows.</p> <p>Set the most secure or frequently used provider first to define the priority order. TheHive then attempts authentication starting with the highest priority and continues down the list until it authenticates the user or checks all providers.</p> </li> </ol> Next steps <ul> <li>Configure a Local Authentication Provider</li> <li>Configure an Active Directory Authentication Provider</li> <li>Configure an LDAP Authentication Provider</li> <li>Configure an OAuth 2.0 Authentication Provider</li> <li>Configure a SAML Authentication Provider</li> <li>Configure an OpenID Authentication Provider</li> <li>Configure JVM Trust for SSL/TLS Certificates</li> </ul>"}, {"location": "thehive/administration/authentication/ldap/", "title": "LDAP", "text": ""}, {"location": "thehive/administration/authentication/ldap/#configure-an-ldap-authentication-provider", "title": "Configure an LDAP Authentication Provider", "text": "<p><code>managePlatform</code> Gold Platinum</p> <p>Configure an LDAP authentication provider in TheHive.</p> Procedure <p>Local account</p> <p>Users must have an existing account in TheHive local database to authenticate successfully. Configure an LDAP server to automate account creation, updates, deletion, and assignment of user accounts to organizations and permission profiles within TheHive.</p> <p>Prerequisites</p> <ul> <li>Users must have an existing account in TheHive local database to authenticate successfully.</li> <li>These steps assume that you have already followed the instructions to configure the authentication settings.</li> </ul> <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Authentication tab.</p> <p></p> </li> <li> <p>Select Directories authentication in the Authentication providers section.</p> </li> <li> <p>In the Directories authentication drawer, turn on the Enable directory toggle.</p> </li> <li> <p>Select ldap from the dropdown list.</p> </li> <li> <p>Enter the servers host name or IP address.</p> <p>Example: ldap.company.com</p> </li> <li> <p>Turn on the Auth-use SSL toggle to encrypt communication between TheHive and the authentication provider.</p> <p>For more information about configuring SSL/TLS, refer to Configure JVM Trust for SSL/TLS Certificates.</p> </li> <li> <p>Enter the following information:</p> <p>- DN of the service account</p> <p>The Distinguished Name (DN) of the service account used for authentication. This account is responsible for binding to the LDAP directory and performing search operations.</p> <p>Example: cn=thehive,ou=users,dc=company,dc=com</p> <p>- Bind password</p> <p>The password associated with the service account. This password authenticates the service account to allow LDAP queries.</p> <p>- Users base DN</p> <p>The base DN from which the search for user accounts will begin. This limits the search scope to a specific branch of the directory.</p> <p>Example: ou=users,dc=company,dc=com</p> <p>- Filter used to search users</p> <p>The LDAP filter to locate user accounts. This filter helps narrow down search results to relevant users.</p> <p>Example: (&amp;(uid={0})(objectClass=inetOrgPerson))</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure Authentication</li> <li>Configure JVM Trust for SSL/TLS Certificates</li> </ul>"}, {"location": "thehive/administration/authentication/local/", "title": "Local", "text": ""}, {"location": "thehive/administration/authentication/local/#configure-a-local-authentication-provider", "title": "Configure a Local Authentication Provider", "text": "<p><code>managePlatform</code></p> <p>Configure a local authentication provider in TheHive.</p> <p>By default, TheHive manages authentication with its own local database, where usernames and passwords are stored directly in the application.</p> Procedure <p>Prerequisites</p> <ul> <li>Users must have an existing account in TheHive local database to authenticate successfully.</li> <li>These steps assume that you have already followed the instructions to configure the authentication settings.</li> </ul> <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Authentication tab.</p> <p></p> </li> <li> <p>Select Local authentication in the Authentication providers section.</p> </li> <li> <p>In the Local authentication drawer, enter:</p> <ul> <li>The number of failed authentication attempts before temporarily blocking the user</li> <li>The duration for automatic user unblocking</li> </ul> </li> <li> <p>To define a password policy, enable the Enabled password policy toggle and enter the following password requirements:</p> <ul> <li>Minimum length</li> <li>Minimum number of lowercase characters</li> <li>Minimum number of uppercase characters</li> <li>Minimum number of digits</li> <li>Minimum number of special characters</li> </ul> </li> <li> <p>To prevent users from using their login as a password, enable the Disallow using usernames as passwords toggle.</p> </li> </ol> Next steps <ul> <li>Configure Authentication</li> </ul>"}, {"location": "thehive/administration/authentication/oauth2/", "title": "OAUTH 2.0", "text": ""}, {"location": "thehive/administration/authentication/oauth2/#configure-an-oauth-20-authentication-provider", "title": "Configure an OAuth 2.0 Authentication Provider", "text": "<p><code>managePlatform</code> Platinum</p> <p>Configure an OAuth 2.0 authentication provider\u2014such as Keycloak, Okta, GitHub, Microsoft 365, and Google\u2014in TheHive.</p> <p>Deprecated since version 5.5</p> <p>5.5 The OAuth 2.0 authentication provider is deprecated and will be removed in a future release. It's recommended to use the OpenID authentication provider instead.</p> Procedure <p>Prerequisites</p> <ul> <li>Users must have an existing account in TheHive local database to authenticate successfully.</li> <li>These steps assume that you have already followed the instructions to configure the authentication settings.</li> </ul> <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Authentication tab.</p> <p></p> </li> <li> <p>Select OAuth 2 authentication in the Authentication providers section.</p> </li> <li> <p>In the OAuth 2 authentication drawer, turn on the Enable OAuth 2 provider toggle.</p> </li> <li> <p>Enter the following information:</p> <p>- Client ID</p> <p>The unique identifier assigned to TheHive by the OAuth 2.0 provider when you register the application. TheHive uses this identifier to authenticate with the OAuth server during the authorization process.</p> <p>- Client secret</p> <p>A confidential string issued by the OAuth 2.0 provider, used along with the client ID to authenticate TheHive securely.</p> <p>- TheHive redirect URL</p> <p>The URL where the OAuth 2.0 server redirects users after authentication.</p> <p>Format: https:///api/ssoLogin</p> <p>- Grant type</p> <p>Specifies the OAuth 2.0 authorization flow used for authentication. </p> <p>Common types include:</p> <ul> <li>Authorization code (recommended for server-side apps)</li> <li>Client credentials (used for machine-to-machine authentication)</li> <li>Implicit (used for browser-based apps, though less secure)</li> </ul> <p>- Authorization URL</p> <p>The endpoint of the OAuth 2.0 provider where users are redirected to authenticate and authorize access.</p> <p>- Prefix of the authorization header</p> <p>Defines the type of token to pass in the authorization header, typically:</p> <ul> <li>Bearer (most common)</li> <li>Basic (used for basic authentication)</li> </ul> <p>- Token URL</p> <p>The endpoint used by TheHive to exchange the authorization code for an access token.</p> <p>- User information URL</p> <p>The endpoint that TheHive calls using the access token to retrieve user details (such as ID, email, or name).</p> <p>- List of scope</p> <p>Specifies the access permissions that TheHive requests from the OAuth 2.0 server.</p> <p>Examples include:</p> <ul> <li>openid: Access to basic user information</li> <li>email: Access to the user\u2019s email address</li> <li>profile: Access to profile information</li> </ul> <p>- Field that contains the id of the user in user info</p> <p>The specific field in the user information response that holds the user's unique identifier. TheHive uses this field to map authenticated users.</p> </li> <li> <p>Turn on the Enable user auto creation to automatically create a user account in TheHive when a new user successfully authenticates through the OAuth 2.0 provider.</p> <p>Then enter the following information:</p> <ul> <li>Field that contains the name of the user in user info</li> <li>Field that contains the name of the organization in user info</li> <li>Default organization used to create TheHive user</li> <li>Default profile used to create TheHive user</li> </ul> <p>Turn on the Allow admin user auto creation to automatically assign administrative privileges to newly created users upon successful authentication.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/administration/authentication/oauth2/#examples", "title": "ExamplesNext steps", "text": "KeycloakOktaGitHubMicrosoft 365Google Parameter Value Client ID Client secret TheHive redirect URL https:///api/ssoLogin Grant type authorization_code Authorization URL http://KEYCLOAK/auth/realms/TENANT/protocol/openid-connect/auth Prefix of the authorization header Bearer Token URL http://KEYCLOAK/auth/realms/TENANT/protocol/openid-connect/token User information URL http://KEYCLOAK/auth/realms/TENANT/protocol/openid-connect/userinfo List of scope [\"openid\", \"email\"] Field that contains the id of the user in user info \"email\" Parameter Value Client ID Client secret TheHive redirect URL http:///api/ssoLogin Grant type authorization_code Authorization URL https://OKTA/oauth2/v1/authorize Prefix of the authorization header Bearer Token URL http://OKTA/oauth2/v1/token User information URL http://OKTA/oauth2/v1/userinfo List of scope [\"openid\", \"email\"] Field that contains the id of the user in user info \"email\" Parameter Value Client ID Client secret TheHive redirect URL https:///api/ssoLogin Grant type authorization_code Authorization URL https://github.com/login/oauth/authorize Prefix of the authorization header Bearer Token URL https://github.com/login/oauth/access_token User information URL https://api.github.com/user List of scope [\"user\"] Field that contains the id of the user in user info \"email\" <p>GitHub configuration</p> <ul> <li>Generate the <code>&lt;client_id&gt;</code> and <code>&lt;client_secret&gt;</code> in the OAuth Apps section at GitHub Developer Settings.</li> <li>Ensure users set a public email address in their profile at GitHub Profile Settings for this configuration to work correctly.</li> </ul> Parameter Value Client ID Client secret TheHive redirect URL https:///api/ssoLogin Grant type authorization_code Authorization URL https://login.microsoftonline.com//oauth2/v2.0/authorize Prefix of the authorization header Bearer Token URL https://login.microsoftonline.com//oauth2/v2.0/token User information URL https://graph.microsoft.com/v1.0/me List of scope [\"User.Read\"] Field that contains the id of the user in user info \"mail\" <p>Microsoft configuration</p> <p>To generate the <code>&lt;client_id&gt;</code>, <code>&lt;client_secret&gt;</code> and <code>&lt;tenant&gt;</code>, register a new application in the Azure Active Directory App Registrations portal.</p> Parameter Value Client ID Client secret TheHive redirect URL https:///api/ssoLogin Grant type authorization_code Authorization URL https://accounts.google.com/o/oauth2/v2/auth Prefix of the authorization header Bearer Token URL https://oauth2.googleapis.com/token User information URL https://openidconnect.googleapis.com/v1/userinfo List of scope [\"email\", \"profile\", \"openid\"] Field that contains the id of the user in user info \"email\" <p>Google configuration</p> <ul> <li>Generate the <code>&lt;client_id&gt;</code> and <code>&lt;client_secret&gt;</code> in the APIs &amp; Services &gt; Credentials section of the Google Cloud Console.</li> <li>Follow the Google OAuth 2.0 credentials guide for step-by-step instructions.</li> <li>Refer to Google OpenID Connect configuration for the latest authentication URLs.            </li> </ul> <ul> <li>Configure Authentication</li> <li>Configure JVM Trust for SSL/TLS Certificates</li> </ul>"}, {"location": "thehive/administration/authentication/openid/", "title": "OpenID", "text": ""}, {"location": "thehive/administration/authentication/openid/#configure-an-openid-authentication-provider", "title": "Configure an OpenID Authentication Provider", "text": "<p>5.5 <code>managePlatform</code> Platinum</p> <p>Configure an OpenID authentication provider in TheHive.</p> Procedure <p>Prerequisites</p> <ul> <li>Users must have an existing account in TheHive local database to authenticate successfully.</li> <li>These steps assume that you have already followed the instructions to configure the authentication settings.</li> </ul> <p>Login flow with multiple OpenID providers</p> <p>You can configure multiple OpenID providers in TheHive. When a user attempts to log in, TheHive queries each provider sequentially, following the defined order. The process stops as soon as a provider grants authorization.</p> <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Authentication tab.</p> <p></p> </li> <li> <p>Select SSO authentication in the Authentication providers section.</p> </li> <li> <p>In the SSO authentication drawer, turn on the Enable SSO toggle.</p> </li> <li> <p>Select Add a provider or select .</p> </li> <li> <p>Select OpenID from the dropdown list.</p> </li> <li> <p>Enter the following information:</p> <p>- Name *</p> <p>A recognizable name for the IdP in TheHive.</p> <p>Example: Microsoft Entra ID</p> <p>- Client ID *</p> <p>The unique identifier for the OpenID application registered with the IdP.</p> <p>- Secret *</p> <p>The secret key associated with the Client ID.</p> <p>- Identity provider metadata type *</p> <p>Select how TheHive retrieves configuration information for the IdP\u2014either from an JSON file or a URL.</p> <ul> <li> <p>If you choose url, provide the full link to the metadata document.</p> <p>Example: https://login.microsoftonline.com/{tenant-id}/.well-known/openid-configuration</p> </li> <li> <p>If you choose json, paste the JSON content directly into the field.</p> <p>Example: </p> <pre><code>{\n    \"issuer\": \"https://login.microsoftonline.com/&lt;tenant-id&gt;/v2.0\",\n    \"authorization_endpoint\": \"https://login.microsoftonline.com/&lt;tenant-id&gt;/oauth2/v2.0/authorize\",\n    \"token_endpoint\": \"https://login.microsoftonline.com/&lt;tenant-id&gt;/oauth2/v2.0/token\",\n    \"userinfo_endpoint\": \"https://graph.microsoft.com/oidc/userinfo\"\n}\n</code></pre> </li> </ul> <p>- User login attribute</p> <p>The name of the attribute from the IdP that contains the user's login information (such as email or username).</p> </li> </ol> Next steps <ul> <li>Configure Authentication</li> </ul>"}, {"location": "thehive/administration/authentication/saml/", "title": "SAML", "text": ""}, {"location": "thehive/administration/authentication/saml/#configure-a-saml-authentication-provider", "title": "Configure a SAML Authentication Provider", "text": "<p><code>managePlatform</code> Platinum</p> <p>Configure a SAML authentication provider in TheHive.</p> Procedure <p>Prerequisites</p> <ul> <li>Users must have an existing account in TheHive local database to authenticate successfully.</li> <li>These steps assume that you have already followed the instructions to configure the authentication settings.</li> </ul> <p>Login flow with multiple SAML providers</p> <p>You can configure multiple SAML providers in TheHive. When a user attempts to log in, TheHive queries each provider sequentially, following the defined order. The process stops as soon as a provider grants authorization.</p> <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Authentication tab.</p> <p></p> </li> <li> Version 5.4 and earlierSince version 5.5 <ol> <li> <p>Select SAML authentication in the Authentication providers section.</p> </li> <li> <p>In the SAML authentication drawer, turn on the Enable SAML toggle.</p> </li> <li> <p>Select Add a provider or select .</p> </li> </ol> <ol> <li> <p>Select SSO authentication in the Authentication providers section.</p> </li> <li> <p>In the SSO authentication drawer, turn on the Enable SSO toggle.</p> </li> <li> <p>Select Add a provider or select . Then select SAML from the dropdown list.</p> </li> </ol> </li> <li> <p>Enter the following information:</p> <p>- Name *</p> <p>A recognizable name for the IdP in TheHive.</p> <p>Example: Microsoft Entra ID</p> <p>- Identity provider metadata type *</p> <p>Select how TheHive retrieves configuration information for the IdP\u2014either from an XML file or a URL.</p> <ul> <li> <p>If you choose url, provide the full link to the metadata document.</p> <p>Example: https://login.microsoftonline.com/{tenant-id}/federationmetadata/2007-06/federationmetadata.xml</p> </li> <li> <p>If you choose xml, paste the XML metadata content directly into the field.</p> <p>Example: </p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;md: EntityDescriptor entityID=\"http://www.okta.com/&lt;entity-id&gt;\"               xmlns=\"urn:oasis:names:tc:SAML:2.0:metadata\"&gt;\n    &lt;md:IDPSSODescriptor WantAuthnRequestsSigned=\"false\" protocolSupportEnumeration=\"urn:oasis:names:tc:SAML:2.0:protocol\"&gt;\n        &lt;md:KeyDescriptor use=\"signing\"&gt;\n            &lt;ds:KeyInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\"&gt;\n            &lt;!-- Replace with your key information --&gt;\n</code></pre> </li> </ul> <p>- User login attribute</p> <p>The name of the attribute from the IdP that contains the user's login information (such as email or username).</p> <p>- Maximum authentication life time *</p> <p>The maximum session duration for user authentication. This value must align with the session timeout configured on the IdP to ensure consistent session behavior.</p> <p>If you're unsure of the value set in your IdP, we recommend setting it to 90 days, as this is the default for most IdPs.</p> </li> </ol> Next steps <ul> <li>Configure Authentication</li> </ul>"}, {"location": "thehive/administration/cortex/about-cortex/", "title": "About Cortex", "text": ""}, {"location": "thehive/administration/cortex/about-cortex/#about-cortex", "title": "About Cortex", "text": "<p>Cortex is an open-source analysis and response engine designed for SOCs, CSIRTs, and security researchers to automate threat intelligence gathering and incident response. Through its RESTful API, it allows teams to analyze observables\u2014such as IP addresses, hashes, and domains\u2014at scale and automate response actions.</p> <p>This topic explains what Cortex is and the benefits of using it with TheHive.</p> <p>Not connected by default</p> <p>By default, TheHive isn't connected to any Cortex server.</p> <p>Cortex support</p> <p>5.5 Cortex 3.1.5 and earlier are no longer supported since version 5.5.</p>"}, {"location": "thehive/administration/cortex/about-cortex/#cortex-features", "title": "Cortex features", "text": "<p>Cortex addresses two common challenges faced by SOCs, CSIRTs, and security researchers in threat intelligence, digital forensics, and incident response:</p> <ul> <li>Efficient observable analysis: Instead of manually querying multiple tools, Cortex enables centralized, automated analysis.</li> <li>Automated threat response: Teams can take active measures against threats and interact with other teams or external services.</li> </ul> <p>Cortex offers the following features:</p> <ul> <li>Comprehensive analysis: Leverage a wide range of analyzers to enrich observables.</li> <li>Automated security response: Use responders to take action on alerts, cases, tasks, and observables.</li> <li>Scalability: Analyze large volumes of data efficiently.</li> <li>Multi-tenancy support: Manage multiple organizations with role-based access control.</li> <li>Performance optimization: Avoid redundant analysis with configurable caching.</li> <li>Rate limiting: Prevent excessive API usage by defining quotas per organization.</li> </ul>"}, {"location": "thehive/administration/cortex/about-cortex/#connecting-cortex-to-thehive", "title": "Connecting Cortex to TheHive", "text": "<p>Cortex connection requirements</p> <p>Establishing a connection with Cortex requires an existing account and a valid API key on a Cortex server.</p> <p>Support for multiple Cortex instances</p> <p>TheHive supports connecting to one or more Cortex instances simultaneously. Connecting to multiple instances requires a paid license.</p> <p>Connect TheHive to Cortex to gather intelligence on observables with analyzers and automate actions using responders:</p> <ul> <li>Analyzers enrich observables with detailed, contextual intelligence, generating a report with the results.</li> <li>Responders execute actions on cases, alerts, observables, tasks, and task logs to support investigations and incident response, generating a report with the results.</li> </ul>"}, {"location": "thehive/administration/cortex/about-cortex/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePlatform</code> permission can manage the Cortex connection in TheHive.</p> <ul> <li>Add a Cortex Server</li> <li>Remove a Cortex Server</li> <li>Import Analyzer Templates</li> <li>Customize an Analyzer Template</li> </ul>"}, {"location": "thehive/administration/cortex/add-a-cortex-server/", "title": "Add a Cortex Server", "text": ""}, {"location": "thehive/administration/cortex/add-a-cortex-server/#add-a-cortex-server", "title": "Add a Cortex Server", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for adding a Cortex server in TheHive.</p> <p>Cortex is an open-source analysis and response engine designed for SOCs, CSIRTs, and security researchers to automate threat intelligence gathering and incident response.</p> <p>Requirements</p> <p>Before adding a Cortex server, you must install and configure Cortex. For instructions, refer to the Installation and Configuration Guides.</p> <p>Multiple Cortex servers</p> <p>TheHive supports connecting multiple Cortex servers only with a paid license.</p> <p>Cortex support</p> <p>5.5 Cortex 3.1.5 and earlier are no longer supported since version 5.5.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the Cortex tab.</p> </li> <li> <p>In the Servers section, select .</p> </li> <li> <p>In the Set up a new server drawer, enter the following information:</p> <p>- Server name</p> <p>The name of the connection. If you have multiple connections, use explicit names for clarity.</p> <p>- Server URL</p> <p>The URL of the Cortex server to connect to.</p> <p>Example: https://cortex.mycompany.com</p> <p>- API key</p> <p>The API key associated with the dedicated Cortex account.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select the organizations to share your connection with using the Choose the filter on TheHive organizations dropdown.</p> <p>By default, all analyzers and responders provided by Cortex are available to all organizations.</p> </li> <li> <p>Select Test server connection to verify your connection.</p> </li> <li> <p>Select Add.</p> </li> </ol> Next steps <ul> <li>Remove a Cortex Server</li> </ul>"}, {"location": "thehive/administration/cortex/remove-a-cortex-server/", "title": "Remove a Cortex Server", "text": ""}, {"location": "thehive/administration/cortex/remove-a-cortex-server/#remove-a-cortex-server", "title": "Remove a Cortex Server", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for removing a Cortex server in TheHive.</p> <p>Cortex support</p> <p>5.5 Cortex 3.1.5 and earlier are no longer supported since version 5.5.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the Cortex tab.</p> </li> <li> <p>In the Servers section, select  next to the server you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add a Cortex Server</li> </ul>"}, {"location": "thehive/administration/custom-fields/about-custom-fields/", "title": "About Custom Fields", "text": ""}, {"location": "thehive/administration/custom-fields/about-custom-fields/#about-custom-fields", "title": "About Custom Fields", "text": "<p>Custom fields provide a way to extend the default set of fields available in cases and alerts, allowing additional, organization-specific information to be recorded.</p> <p>This topic provides a general overview of custom field usage in TheHive.</p>"}, {"location": "thehive/administration/custom-fields/about-custom-fields/#use-cases", "title": "Use cases", "text": "<p>In TheHive, custom fields add structure and flexibility to cases and alerts in the following ways:</p> <ul> <li>Provide context to cases or alerts, such as the geographic location of an incident or its severity level</li> <li>Support organizational alignment by specifying the relevant business unit or team</li> <li>Enable integration with external tools by including identifiers, adding related data, or linking directly to external resources</li> <li>Streamline processes by indicating internal classification levels</li> <li>Manage checklists to validate specific steps when handling a case or alert</li> <li>Enhance data analysis through tagging, for example, identifying incidents involving VIPs</li> </ul>"}, {"location": "thehive/administration/custom-fields/about-custom-fields/#types", "title": "Types", "text": "<p>Custom fields support the following types:</p> <ul> <li>String: Text input</li> <li>Boolean: True/false values</li> <li>Integer: Whole numbers</li> <li>Float: Decimal numbers</li> <li>Date: Specific dates</li> <li>URL: Web links</li> </ul>"}, {"location": "thehive/administration/custom-fields/about-custom-fields/#expected-values", "title": "Expected values", "text": "<p>Custom fields support two types of input values:</p> <ul> <li>Free text: Accepts manually entered values without restrictions.</li> <li>Dropdown list: Offers a predefined set of selectable options.</li> </ul>"}, {"location": "thehive/administration/custom-fields/about-custom-fields/#completion-rules", "title": "Completion rules", "text": "<p>Custom fields can be configured as either optional or mandatory. Mandatory fields must be completed before a case or an alert can be closed.</p>"}, {"location": "thehive/administration/custom-fields/about-custom-fields/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>manageCustomField</code> permission can create, edit, or delete custom fields in TheHive.</p> <p>Only users with the <code>manageCase/update</code> or <code>manageAlert/update</code> permission can add, remove, or enter values in custom fields in cases and alerts in TheHive.</p> <ul> <li>Create a Custom Field</li> <li>Manage Custom Fields</li> <li>Delete a Custom Field</li> <li>Add Custom Fields</li> <li>Remove Custom Fields</li> <li>Enter Values in Custom Fields</li> </ul>"}, {"location": "thehive/administration/custom-fields/create-a-custom-field/", "title": "Create a Custom Field", "text": ""}, {"location": "thehive/administration/custom-fields/create-a-custom-field/#create-a-custom-field", "title": "Create a Custom Field", "text": "<p><code>[admin] manageCustomField</code></p> <p>This topic provides step-by-step instructions for creating a custom field in TheHive.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom fields tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>Enter the following information:</p> <p>- Display name *</p> <p>The name users will see when adding this custom field to their cases or alerts.</p> <p>- Technical name *</p> <p>By default, the technical name is automatically generated from the display name, but you can adjust it if needed. Users don't see the technical name when adding a custom field, but it's used when accessing the custom field via the API.</p> <p>- Description *</p> <p>A description to help users understand and use this custom field appropriately. It appears when users hover over the  symbol next to the custom field in a case or alert.</p> <p>- Group *</p> <p>Select an existing group name or enter a new one to create a group. It organizes related custom fields when searching and appears as a tab in cases and alerts.</p> <p>- Type *</p> <p>The type of data the custom field contains:</p> <ul> <li>String: Text input</li> <li>Boolean: True/false values</li> <li>Integer: Whole numbers</li> <li>Float: Decimal numbers</li> <li>Date: Specific dates</li> <li>URL: Web links</li> </ul> <p>Predefined values</p> <p>For the string, integer, and float types, you can define predefined values by entering each value on a separate line in the Options field. If you choose to do this, users will only be able to select from the predefined values you specify. This helps maintain data consistency for reporting purposes.</p> <p>- Mandatory </p> <p>Turn on the toggle to require users to enter a value in this custom field.</p> <p>Set a custom field as mandatory if you use it in dashboards or any automation workflow.</p> </li> <li> <p>Select Confirm custom field creation.</p> </li> </ol> Next steps <ul> <li>Manage Custom Fields</li> <li>Delete a Custom Field</li> <li>Add Custom Fields</li> <li>Remove Custom Fields</li> <li>Enter Values in Custom Fields</li> </ul>"}, {"location": "thehive/administration/custom-fields/delete-a-custom-field/", "title": "Delete a Custom Field", "text": ""}, {"location": "thehive/administration/custom-fields/delete-a-custom-field/#delete-a-custom-field", "title": "Delete a Custom Field", "text": "<p><code>[admin] manageCustomField</code></p> <p>This topic provides step-by-step instructions for deleting a custom field in TheHive.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom fields tab.</p> <p></p> </li> <li> <p>Select  next to the custom field you want to edit.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Custom Field</li> <li>Manage Custom Fields</li> <li>Add Custom Fields</li> <li>Remove Custom Fields</li> <li>Enter Values in Custom Fields</li> </ul>"}, {"location": "thehive/administration/custom-fields/manage-a-custom-field/", "title": "Manage Custom Fields", "text": ""}, {"location": "thehive/administration/custom-fields/manage-a-custom-field/#manage-custom-fields", "title": "Manage Custom Fields", "text": "<p><code>[admin] manageCustomField</code></p> <p>This topic provides step-by-step instructions for managing custom fields in TheHive.</p>"}, {"location": "thehive/administration/custom-fields/manage-a-custom-field/#set-a-custom-field-as-mandatory-or-optional", "title": "Set a custom field as mandatory or optional", "text": "<p>It is recommended to set a custom field as mandatory if it is used in dashboards or any automation workflow.</p> <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom fields tab.</p> <p></p> </li> <li> <p>Select  next to the custom field you want to edit.</p> </li> <li> <p>Select Edit.</p> </li> <li> <p>Turn the Mandatory toggle on or off.</p> </li> <li> <p>Select Confirm custom field edition.</p> </li> </ol>"}, {"location": "thehive/administration/custom-fields/manage-a-custom-field/#enter-predefined-values-into-a-custom-field", "title": "Enter predefined values into a custom field", "text": "<p>For the string, integer, and float types, you can define predefined values. If you choose to do this, users are only able to select from the predefined values you specify. This helps maintain data consistency for reporting purposes.</p> <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom fields tab.</p> <p></p> </li> <li> <p>Select  next to the custom field you want to edit.</p> </li> <li> <p>Select Edit.</p> </li> <li> <p>Enter each predefined value on a separate line in the Options field.</p> </li> <li> <p>Select Confirm custom field edition.</p> </li> </ol>"}, {"location": "thehive/administration/custom-fields/manage-a-custom-field/#assign-multiple-custom-fields-to-the-same-group", "title": "Assign multiple custom fields to the same groupNext steps", "text": "<ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom fields tab.</p> <p></p> </li> <li> <p>Select  next to the custom fields you want to edit.</p> </li> <li> <p>Select .</p> </li> <li> <p>Enter the new group to apply.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Create a Custom Field</li> <li>Delete a Custom Field</li> <li>Add Custom Fields</li> <li>Remove Custom Fields</li> <li>Enter Values in Custom Fields</li> </ul>"}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/", "title": "About Email Intake Connectors", "text": ""}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/#about-email-intake-connectors", "title": "About Email Intake Connectors", "text": "<p>Gold Platinum</p> <p>This topic explains what email intake connectors are in TheHive.</p> <p>Organizations that receive alert data by email can use email intake connectors to automate the creation of alerts in TheHive.</p>"}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/#usage", "title": "Usage", "text": "<p>Email intake connectors integrate mailboxes that receive alerts. </p> <p>It automatically processes incoming emails, extracts relevant information, and creates alerts within TheHive platform. The email itself, its sender, and any attached files are automatically added as observables within the respective alerts.</p> <p>Parsing emails</p> <p>The content of the email itself isn't automatically parsed when creating the alert. To enable observable extraction, a notification must trigger a FilteredEvent that runs the EmlParser analyzer.</p> <p>Below is an example of the FilteredEvent trigger:</p> <pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"action\": \"create\"\n            }\n        },\n        {\n            \"_is\": {\n                \"objectType\": \"Observable\"\n            }\n        },\n        {\n            \"_is\": {\n                \"object.alert.type\": \"email-intake\"\n            }\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/#data-mapping", "title": "Data mapping", "text": ""}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/#alerts", "title": "Alerts", "text": "Alert field API Alert field UI Alert value <code>title</code> Title The subject of the email. If empty, displays no subject. <code>type</code> Type email-intake <code>source</code> Source The formatted name of the email intake connector. <code>sourceRef</code> Reference <code>{message-id}</code>, or <code>{lastUidValidity}.{uidEmail}</code> if the <code>message-id</code> is inaccessible. <code>date</code> Occurred date The date the email was received. <code>severity</code> Severity low <code>tlp</code> TLP amber <code>pap</code> PAP amber <code>follow</code> Track new updates false <code>tags</code> Tags [email-intake, <code>{source}</code>, <code>{provider name}</code>, <code>{inbox folder name}</code>] <code>status</code> Status new <code>description</code> Description The content of the email. <p>Modification restrictions</p> <p>Only the prefilled values for the <code>tags</code>, <code>source</code>, and <code>type</code> fields allow modification. Changes to other fields aren't allowed.</p>"}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/#observables", "title": "Observables", "text": "Observable field API Observable field UI Observable value <code>message</code> Description Automatically created from email followed by <code>{alert.id}</code> and either <code>{sender}</code> or <code>{file}</code>. <code>tlp</code> TLP <code>{alert.tlp}</code> <code>pap</code> PAP <code>{alert.pap}</code> <code>ioc</code> IOC false <code>sighted</code> Sighted false <code>ignoreSimilarity</code> Ignore similarity false <code>dataType</code> Data type file for the email or mail for the sender's email address. <code>tags</code> Tags <code>{alert.tags}</code>"}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/#authorized-email-providers", "title": "Authorized email providers", "text": "<p>The following email providers are available in TheHive:</p> <ul> <li>Google Workspace</li> <li>IMAP server</li> <li>Microsoft 365</li> <li>5.5 Microsoft Graph API</li> </ul>"}, {"location": "thehive/administration/email-intake-connector/about-email-intake-connectors/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePlatform</code> permission can manage email intake connectors in TheHive.</p> <ul> <li>Connect a Mailbox</li> <li>Delete a Mailbox</li> <li>Manually Trigger Email Fetch in a Mailbox</li> </ul>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/", "title": "Connect a Mailbox", "text": ""}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#connect-a-mailbox", "title": "Connect a Mailbox", "text": "<p><code>[admin] managePlatform</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for connecting a mailbox in TheHive.</p> <p>Use this procedure if your organization receives alerts via email and you want to automatically convert them into alerts within TheHive.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the Email intake tab.</p> <p></p> </li> <li> <p>Enter the time interval between refresh attempts. This setting applies to all connected mailboxes.</p> <p>Manual refresh</p> <p>If needed, you can also manually trigger an email fetch for a mailbox.</p> </li> <li> <p>Select .</p> </li> <li> <p>Configure your email intake connector by following these steps. IMAP configuration is required if your email provider is neither Google nor Microsoft.</p> Google WorkspaceMicrosoft 365Microsoft Graph APIIMAP server <p>Platinum</p> <p>Prerequisites</p> <p>You must have administrator access to the Google Cloud Console, with the necessary permissions to create projects and configure OAuth 2.0 credentials.</p> <p>Platinum</p> <p>Prerequisites</p> <p>You must have:</p> <ul> <li>Administrator access to Microsoft 365</li> <li>PowerShell installed and properly configured</li> <li>A shared mailbox already created in Microsoft 365</li> </ul> <p>5.5 Platinum</p> <p>Microsoft Graph API is the recommended standard API for all interactions with Microsoft services.</p> <p>Prerequisites</p> <p>You must have:</p> <ul> <li>Administrator access to Microsoft 365</li> <li>PowerShell installed and properly configured</li> <li>A shared mailbox already created in Microsoft 365</li> </ul> <p>Gold Platinum</p> <ol> <li> <p>In the Provider section, enter the following information:</p> <p>- Name</p> <p>A name for your connector.</p> <p>- Provider</p> <p>Select IMAP server from the dropdown.</p> <p>- Host</p> <p>The host address of the IMAP server.</p> <p>- Port</p> <p>The port number of the IMAP server.</p> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>In the Authentication section, enter the following information:</p> <p>- Login</p> <p>The email address or account username associated with your account.</p> <p>- Password</p> <p>The password associated with your account.</p> </li> </ol> </li> <li> <p>In the Settings section, enter the following information:</p> <p>- Organization</p> <p>The TheHive organization where the alerts are sent.</p> <p>- Folder</p> <p>The folder from which emails are fetched.</p> <p>- Action in mailbox</p> <p>The action to perform in the mailbox when receiving an email.</p> </li> <li> <p>5.5 In the Alert properties section, enter the following information:</p> <p>- Type</p> <p>The type of the alerts created through the email intake connector.</p> <p>- Source</p> <p>The source of the alerts created through the email intake connector.</p> <p>- Tags</p> <p>The tags to apply to the alerts created through the email intake connector.</p> </li> <li> <p>Select Test connection to verify your connection.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Delete a Mailbox Connection</li> <li>Manually Trigger Email Fetch in a Mailbox</li> </ul>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-1-create-a-project-in-the-google-cloud-console", "title": "Step 1: Create a project in the Google Cloud Console", "text": "<ol> <li> <p>Go to the Google Admin Console.</p> </li> <li> <p>Select APIs &amp; Services.</p> <p></p> </li> <li> <p>Select Create project.</p> <p></p> </li> <li> <p>Enter a name for the project, an organization, and a location.</p> </li> <li> <p>Select Create.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-2-configure-oauth-consent", "title": "Step 2: Configure OAuth consent", "text": "<ol> <li> <p>Select OAuth consent screen from the left pane.</p> <p></p> </li> <li> <p>Select Get started to configure Google Auth Platform.</p> <p></p> </li> <li> <p>In the App information section, enter information about your application.</p> </li> <li> <p>In the Audience section, select Internal.</p> </li> <li> <p>In the Contact information section, enter the email address that will receive any updates related to the project.</p> </li> <li> <p>Select Create.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-3-add-a-scope-in-the-google-auth-platform", "title": "Step 3: Add a scope in the Google Auth Platform", "text": "<ol> <li> <p>Select Data access from the left pane.</p> <p></p> </li> <li> <p>Select Add or remove scopes.</p> <p></p> </li> <li> <p>In the Manually add scopes section, enter https://mail.google.com/.</p> </li> <li> <p>Select Add to table.</p> </li> <li> <p>Make sure the new scope is selected, then select Update.</p> </li> <li> <p>Make sure the scope is added to the Your restricted scopes section, then select Save.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-4-create-oauth-credentials", "title": "Step 4: Create OAuth credentials", "text": "<ol> <li> <p>Enter credentials in the search bar at the top of the screen.</p> </li> <li> <p>Select Credentials from the APIs &amp; Services results.</p> </li> <li> <p>Select Create credentials, then OAuth Client ID.</p> <p></p> </li> <li> <p>Select Web application as the application type.</p> </li> <li> <p>Enter an internal name for the OAuth 2.0 client.</p> </li> <li> <p>Select Add URI in the Authorized JavaScript origins section.</p> </li> <li> <p>Enter a URI following this format: https://.org.</p> </li> <li> <p>Enter the same URI in the Authorized redirect URIs section.</p> </li> <li> <p>Select Create.</p> </li> <li> <p>Copy the Client ID and Client Secret values from the dialog for use in TheHive configuration.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-5-configure-the-email-intake-connector-in-thehive", "title": "Step 5: Configure the email intake connector in TheHive", "text": "<ol> <li> <p>Return to your TheHive application.</p> </li> <li> <p>In the Provider section, enter the following information:</p> <p>- Name</p> <p>A name for your connector.</p> <p>- Provider</p> <p>Select Google Workspace from the dropdown.</p> </li> <li> <p>In the Authentication section, enter the following information:</p> <p>- Email</p> <p>The email address associated with your account.</p> <p>- ClientId</p> <p>Paste the Client ID value you obtained from Google.</p> <p>- Secret</p> <p>Paste the Client Secret value you obtained from Google.</p> </li> </ol> <p>Then, select Connect to authorize TheHive to access your Google Workspace account for use with the application.</p>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-1-create-a-mail-enabled-security-group", "title": "Step 1: Create a mail-enabled security group", "text": "<p>Create a security group that includes the shared mailbox. This group will be used to restrict access to the application, ensuring it is available only to the shared mailbox.</p> <ol> <li> <p>Go to your Microsoft Exchange admin center.</p> </li> <li> <p>Follow the Microsoft instructions to create a mail-enabled security group and add the shared mailbox as a member.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-2-register-a-new-application", "title": "Step 2: Register a new application", "text": "<ol> <li> <p>Follow the Microsoft instructions to register an application.</p> </li> <li> <p>Copy the Application (client) ID and Directory (tenant) ID for use in TheHive configuration.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-3-add-a-secret", "title": "Step 3: Add a secret", "text": "<ol> <li> <p>Select Certificates &amp; secrets from the left pane.</p> </li> <li> <p>Follow the Microsoft instructions to add a client secret.</p> </li> <li> <p>Copy the secret's value for use in TheHive configuration.</p> <p>One-time display</p> <p>This secret value is never displayed again after you leave this page.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-4-assign-api-permissions", "title": "Step 4: Assign API permissions", "text": "<ol> <li> <p>Select API permissions from the left pane.</p> </li> <li> <p>Follow the Microsoft instructions and add the IMAP.AccessAsApp permission for Office 365 Exchange Online.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-5-configure-powershell-access", "title": "Step 5: Configure PowerShell access", "text": "<ol> <li> <p>Define the necessary values for the configuration:</p> <pre><code>$AppID = '{ClientID}'\n$TenantID = '{TenantID}'\n$ObjectID = '{ObjectID}'\n$SecurityGroup = '{SecurityGroup}'  # The mail-enabled security group\n$MailBox = '{MailBox}'  # The shared mailbox\n</code></pre> </li> <li> <p>Run the following PowerShell commands to configure access.</p> <p>a. Define app permissions:</p> <pre><code>New-ServicePrincipal -AppId $AppID -ServiceId $ObjectID\n</code></pre> <p>b. Grant security group full access to the mailbox:</p> <pre><code>Add-MailboxPermission -Identity $MailBox -User $SecurityGroup -AccessRights FullAccess\n</code></pre> <p>c. Restrict access to members of the security group only:</p> <pre><code>New-ApplicationAccessPolicy -AppId $AppID -PolicyScopeGroupId $SecurityGroup -AccessRight RestrictAccess -Description \"Restrict this app to members of distribution group {$SecurityGroup}\"\n</code></pre> </li> <li> <p>Test the configuration.</p> <p>a. Run the following command to test if the application access policy is properly configured:</p> <pre><code>Test-ApplicationAccessPolicy -AppId $AppID -Identity $MailBox\n</code></pre> <p>b. The expected output should be similar to:</p> <pre><code>AppId             : 9367xxxx\nMailbox           : test-shared-mailbox20231107190659\nAccessCheckResult : Granted\n</code></pre> <p>c. Running the command with a different mailbox should return <code>AccessCheckResult: Denied</code>.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-6-configure-the-email-intake-connector-in-thehive", "title": "Step 6: Configure the email intake connector in TheHive", "text": "<ol> <li> <p>Return to your TheHive application.</p> </li> <li> <p>In the Provider section, enter the following information:</p> <p>- Name</p> <p>A name for your connector.</p> <p>- Provider</p> <p>Select Microsoft 365 from the dropdown.</p> </li> <li> <p>In the Authentication section, enter the following information:</p> <p>- Email</p> <p>The email address associated with your account.</p> <p>- TenantId</p> <p>Paste the Tenant ID value you obtained from Microsoft.</p> <p>- ClientId</p> <p>Paste the Client ID value you obtained from Microsoft.</p> <p>- Secret</p> <p>Paste the Client Secret value you obtained from Microsoft.</p> </li> </ol> <p>Then, select Connect to authorize TheHive to access your Microsoft 365 account for use with the application.</p>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-1-create-a-mail-enabled-security-group_1", "title": "Step 1: Create a mail-enabled security group", "text": "<p>Create a security group that includes the shared mailbox. This group will be used to restrict access to the application, ensuring it is available only to the shared mailbox.</p> <ol> <li> <p>Go to your Microsoft Exchange admin center.</p> </li> <li> <p>Follow the Microsoft instructions to create a mail-enabled security group and add the shared mailbox as a member.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-2-register-a-new-application_1", "title": "Step 2: Register a new application", "text": "<ol> <li> <p>Follow the Microsoft instructions to register an application.</p> </li> <li> <p>Copy the Application (client) ID and Directory (tenant) ID for use in TheHive configuration.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-3-add-a-secret_1", "title": "Step 3: Add a secret", "text": "<ol> <li> <p>Select Certificates &amp; secrets from the left pane.</p> </li> <li> <p>Follow the Microsoft instructions to add a client secret.</p> </li> <li> <p>Copy the secret's value for use in TheHive configuration.</p> <p>One-time display</p> <p>This secret value is never displayed again after you leave this page.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-4-assign-api-permissions_1", "title": "Step 4: Assign API permissions", "text": "<ol> <li> <p>Select API permissions from the left pane.</p> </li> <li> <p>Follow the Microsoft instructions to add the relevant permissions.</p> <p>Recommanded permissions</p> <p>For Microsoft Graph to work correctly with TheHive, ensure that the following permissions are added:</p> <ul> <li>Mail.Read</li> <li>Mail.ReadBasic</li> <li>Mail.ReadBasic.All</li> <li>Mail.ReadWrite</li> <li>MailboxFolder.Read.All</li> <li>User.Read.All</li> <li>User.ReadBasic.All</li> <li>User.ReadWrite.All</li> <li>UserAuthenticationMethod.Read.All</li> <li>UserAuthenticationMethod.ReadWrite.All</li> </ul> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-5-configure-powershell-access_1", "title": "Step 5: Configure PowerShell access", "text": "<ol> <li> <p>Define the necessary values for the configuration:</p> <pre><code>$AppID = '{ClientID}'\n$TenantID = '{TenantID}'\n$ObjectID = '{ObjectID}'\n$SecurityGroup = '{SecurityGroup}'  # The mail-enabled security group\n$MailBox = '{MailBox}'  # The shared mailbox\n</code></pre> </li> <li> <p>Run the following PowerShell commands to configure access.</p> <p>a. Define app permissions:</p> <pre><code>New-ServicePrincipal -AppId $AppID -ServiceId $ObjectID\n</code></pre> <p>b. Grant security group full access to the mailbox:</p> <pre><code>Add-MailboxPermission -Identity $MailBox -User $SecurityGroup -AccessRights FullAccess\n</code></pre> <p>c. Restrict access to members of the security group only:</p> <pre><code>New-ApplicationAccessPolicy -AppId $AppID -PolicyScopeGroupId $SecurityGroup -AccessRight RestrictAccess -Description \"Restrict this app to members of distribution group {$SecurityGroup}\"\n</code></pre> </li> <li> <p>Test the configuration.</p> <p>a. Run the following command to test if the application access policy is properly configured:</p> <pre><code>Test-ApplicationAccessPolicy -AppId $AppID -Identity $MailBox\n</code></pre> <p>b. The expected output should be similar to:</p> <pre><code>AppId             : 9367xxxx\nMailbox           : test-shared-mailbox20231107190659\nAccessCheckResult : Granted\n</code></pre> <p>c. Running the command with a different mailbox should return <code>AccessCheckResult: Denied</code>.</p> </li> </ol>"}, {"location": "thehive/administration/email-intake-connector/connect-a-mailbox/#step-6-configure-the-email-intake-connector-in-thehive_1", "title": "Step 6: Configure the email intake connector in TheHive", "text": "<ol> <li> <p>Return to your TheHive application.</p> </li> <li> <p>In the Provider section, enter the following information:</p> <p>- Name</p> <p>A name for your connector.</p> <p>- Provider</p> <p>Select Microsoft 365 GraphAPI from the dropdown.</p> </li> <li> <p>In the Authentication section, enter the following information:</p> <p>- Email</p> <p>The email address associated with your account.</p> <p>- TenantId</p> <p>Paste the Tenant ID value you obtained from Microsoft.</p> <p>- ClientId</p> <p>Paste the Client ID value you obtained from Microsoft.</p> <p>- Secret</p> <p>Paste the Client Secret value you obtained from Microsoft.</p> </li> </ol> <p>Then, select Connect to authorize TheHive to access your Microsoft 365 account for use with the application.</p>"}, {"location": "thehive/administration/email-intake-connector/delete-a-mailbox-connection/", "title": "Delete a Mailbox Connection", "text": ""}, {"location": "thehive/administration/email-intake-connector/delete-a-mailbox-connection/#delete-a-mailbox-connection", "title": "Delete a Mailbox Connection", "text": "<p><code>[admin] managePlatform</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for deleting a mailbox connection in TheHive.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the Email intake tab.</p> <p></p> </li> <li> <p>Select  next to the connector you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Connect a Mailbox</li> <li>Manually Trigger Email Fetch in a Mailbox</li> </ul>"}, {"location": "thehive/administration/email-intake-connector/fetch-emails/", "title": "Manually Fetch Emails", "text": ""}, {"location": "thehive/administration/email-intake-connector/fetch-emails/#manually-trigger-email-fetch-in-a-mailbox", "title": "Manually Trigger Email Fetch in a Mailbox", "text": "<p><code>[admin] managePlatform</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for manually triggering email fetch in a mailbox in TheHive.</p> <p>Use this procedure to manually fetch emails before the next scheduled refresh.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the Email intake tab.</p> <p></p> </li> <li> <p>Select  next to the connector.</p> </li> <li> <p>Select Fetch emails.</p> </li> </ol> Next steps <ul> <li>Connect a Mailbox</li> <li>Delete a Mailbox</li> </ul>"}, {"location": "thehive/administration/ldap/about-ldap/", "title": "About LDAP", "text": ""}, {"location": "thehive/administration/ldap/about-ldap/#about-ldap", "title": "About LDAP", "text": "<p>This topic explains what LDAP is and how it's used in TheHive.</p>"}, {"location": "thehive/administration/ldap/about-ldap/#whats-ldap", "title": "What's LDAP", "text": "<p>LDAP is a standard protocol used to access and manage directory information services over a network. It's commonly used for centralized authentication and user management.</p> <p>AD is Microsoft implementation of directory services. It uses LDAP as one of its core protocols, providing a comprehensive solution for identity and access management in Windows environments.</p>"}, {"location": "thehive/administration/ldap/about-ldap/#benefits-of-using-an-ldap-server", "title": "Benefits of using an LDAP server", "text": "<p>Using an LDAP server:</p> <ul> <li>Enables centralized and scalable user authentication and authorization</li> <li>Simplifies user management by syncing accounts and permissions from a single source</li> <li>Supports integration with existing directory services like Microsoft Active Directory (AD)</li> </ul>"}, {"location": "thehive/administration/ldap/about-ldap/#ldap-server-usage-in-thehive", "title": "LDAP server usage in TheHive", "text": "<p>Configure an LDAP server in TheHive to enable:</p> <ul> <li>Automatic user account creation, deletion, and updates synchronized from LDAP</li> <li>Assignment of user accounts to organizations and permission profiles</li> </ul> <p>Configure an LDAP authentication provider or an AD authentication provider to enable user authentication based on their LDAP credentials.</p>"}, {"location": "thehive/administration/ldap/about-ldap/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePlatform</code> permission can configure an LDAP server in TheHive.</p> <ul> <li>Configure an LDAP server</li> <li>Configure an LDAP authentication provider</li> <li>Configure an AD authentication provider</li> </ul>"}, {"location": "thehive/administration/ldap/configure-ldap-server/", "title": "Configure an LDAP Server", "text": ""}, {"location": "thehive/administration/ldap/configure-ldap-server/#configure-an-ldap-server", "title": "Configure an LDAP Server", "text": "<p><code>[admin] managePlatform</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring an LDAP server in TheHive, including Microsoft Active Directory (AD).</p> <p>Use this procedure to periodically synchronize your local TheHive database with LDAP, enabling automatic user account creation, updates, deletion, and assignment to organizations and permission profiles within TheHive.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the LDAP tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the LDAP configuration drawer, enter the following information under the General settings section:</p> <p>- Name of the configuration *</p> <p>A descriptive name to identify this LDAP configuration within TheHive.</p> <p>- Servers host name or IP address *</p> <p>The address of the LDAP server you want to connect to, either a host name or an IP address.</p> <p>Example: ldap.domain.local</p> <p>- Auth-Use SSL *</p> <p>Turn on this toggle to use SSL/TLS encryption when connecting to the LDAP server for secure communication.</p> <p>- DN of the service account *</p> <p>The Distinguished Name (DN) of the LDAP user account used by TheHive to bind to the LDAP server.</p> <p>Example: cn=thehive,ou=users,dc=domain,dc=local</p> <p>- Bind password *</p> <p>The password associated with the service account used for binding to the LDAP server.</p> <p>- Users base DN *</p> <p>The starting point in the LDAP directory tree from which user searches begins.</p> <p>Example: ou=users,dc=domain,dc=local</p> <p>- Filter used to search users</p> <p>The LDAP search filter used to find user entries within the directory.</p> <p>Example: (objectClass=user)</p> <p>- Search scope</p> <p>Defines how deep the LDAP search should go from the base DN.</p> <p>Typical options include base, onelevel, or subtree.</p> <p>- Page size</p> <p>The number of entries retrieved per page during LDAP queries, useful for handling large directories efficiently.</p> </li> <li> <p>Enter the following information under the Map of LDAP attributes section:</p> <p>- Login *</p> <p>The LDAP attribute that contains the user\u2019s login name or username.</p> <p>Example: uid</p> <p>- Name *</p> <p>The LDAP attribute that contains the user\u2019s full name.</p> <p>Example: cn</p> <p>- Member of *</p> <p>The LDAP attribute that lists the groups or roles the user belongs to, used to assign permission profiles and organizations in TheHive.</p> <p>Example: memberOf</p> <p>- Email</p> <p>The LDAP attribute holding the user\u2019s email address.</p> <p>Example: mail</p> <p>- Locked</p> <p>The LDAP attribute that indicates whether the user account is locked.</p> <p>Example: pwdAccountLockedTime</p> <p>- API key</p> <p>The LDAP attribute used to store the user\u2019s API key for TheHive authentication.</p> <p>- TOTP secret</p> <p>The LDAP attribute that holds the Time-Based One-Time Password (TOTP) secret for two-factor authentication (2FA).</p> <p>- Type</p> <p>The LDAP attribute indicating the user account type, which can be either normal or service.</p> </li> <li> <p>Select Add map group field under the Groups mapping section.</p> </li> <li> <p>Enter the following information:</p> <p>- Group map</p> <p>The LDAP attribute used to map groups to TheHive organizations and permission profiles.</p> <p>Example: cn=soc,ou=groups,dc=domain,dc=local</p> <p>- Organization</p> <p>The name of the organization in TheHive to which the LDAP group corresponds.</p> <p>Example: SOC</p> <p>- Profile</p> <p>The permission profile in TheHive assigned to user accounts belonging to the LDAP group.</p> <p>Example: org-admin</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure an LDAP Authentication Provider</li> <li>Configure an AD Authentication Provider</li> </ul>"}, {"location": "thehive/administration/misp-integration/about-misp-integration/", "title": "About MISP Integration", "text": ""}, {"location": "thehive/administration/misp-integration/about-misp-integration/#about-misp-integration", "title": "About MISP Integration", "text": "<p>This topic explains how the Malware Information Sharing Platform (MISP) integrates with TheHive.</p> <p>Upgrading MISP from 2.4.x to 2.5.x</p> <p>If you have upgraded MISP from version 2.4.x to 2.5.x, ensure that you update the database configuration in MISP to avoid potential issues.</p>"}, {"location": "thehive/administration/misp-integration/about-misp-integration/#whats-misp", "title": "What's MISP?", "text": "<p>MISP is an open-source threat intelligence platform designed to improve the sharing of structured threat information. This includes indicators of compromise (IOCs), tactics, techniques, procedures (TTPs), and other relevant data.</p> <p>MISP enables organizations to share, store, and correlate security information to enhance their cybersecurity efforts and collaborate with other organizations or threat intelligence communities.</p>"}, {"location": "thehive/administration/misp-integration/about-misp-integration/#connections-with-thehive", "title": "Connections with TheHive", "text": "<p>TheHive integrates with MISP in several ways:</p> <ul> <li>Default import of MISP taxonomies during TheHive installation</li> <li>Automatic connections to retrieve events from one or more MISP servers and convert them into alerts in TheHive</li> <li>Manual import of MISP events into TheHive as cases</li> <li>Manual export of cases to MISP as events for sharing observables marked as IOCs with the community</li> </ul> <p>Multiple MISP servers</p> <p>TheHive supports connecting multiple MISP servers only with a paid license.</p>"}, {"location": "thehive/administration/misp-integration/about-misp-integration/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePlatform</code> permission can manage MISP server connections in TheHive.</p> <ul> <li>Connect a MISP Server</li> <li>Delete a MISP Server Connection</li> </ul>"}, {"location": "thehive/administration/misp-integration/connect-a-misp-server/", "title": "Connect a MISP Server", "text": ""}, {"location": "thehive/administration/misp-integration/connect-a-misp-server/#connect-a-misp-server", "title": "Connect a MISP Server", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for connecting a MISP server to TheHive.</p> <p>Use this procedure if you want to automatically retrieve filtered MISP events as alerts in TheHive or manually export observables marked as indicators of compromise (IOCs) from cases to MISP.</p> <p>By default, updates are automatically synchronized between TheHive and MISP.</p> <p>You can configure multiple MISP servers in TheHive.</p> <p>To manually import a MISP event as a case in TheHive, refer to How to Create a New Case.</p> <p>Requirements</p> <p>Before proceeding with these instructions, ensure you have a MISP API key. You can find the API key under the My Profile page (/users/view/me) on your MISP instance.</p> <p>Multiple MISP servers</p> <p>TheHive supports connecting multiple MISP servers only with a paid license.</p> <p>Upgrading MISP from 2.4.x to 2.5.x</p> <p>If you have upgraded MISP from version 2.4.x to 2.5.x, ensure that you update the database configuration in MISP to avoid potential issues.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the MISP tab.</p> <p></p> </li> <li> <p>Enter the time interval between each event polling from TheHive to MISP.</p> <p>Configuration for all MISP servers</p> <p>This time interval applies to all MISP servers connected to TheHive.</p> </li> <li> <p>Select .</p> </li> <li> <p>In the Set up the new server drawer, enter the following information in the General settings section:</p> <p>- Server name</p> <p>A name for the connection. Use explicit, precise names for each connection if you have multiple servers configured in TheHive.</p> <p>- Server URL</p> <p>The URL of the MISP server to connect with. For example: https://misp.mycompany.com.</p> <p>- API key</p> <p>The API key for the dedicated MISP account. You can find the API key under the My Profile page (/users/view/me) on your MISP instance.</p> <p>- Purpose</p> <p>The purpose of this connection indicates what actions you are allowed to perform with the server:</p> <ul> <li>Import only: Automatically import events from MISP to TheHive as alerts</li> <li>Export only: Manually export observables marked as IOCs from TheHive cases to MISP</li> <li>Import and export: Allows both automatically importing events from MISP to TheHive and manually exporting observables marked as IOCs from TheHive cases to MISP</li> </ul> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>In the Advanced settings section, enter the following information:</p> <p>- Choose the filter on TheHive organizations</p> <p>By default, all your organizations in TheHive benefit from this connection.</p> <p>The following options are available:</p> <ul> <li>Include all organizations</li> <li>Include selected organizations</li> <li>Exclude selected organizations</li> </ul> <p>- Tags</p> <p>The tags to be appended to alerts when importing MISP events.</p> <p>- Export case tags</p> <p>Exports the case tags to the MISP event.</p> <p>- Export observables tags</p> <p>Exports the tags from the observables to the MISP event.</p> <p>- Export TheHive URL</p> <p>Exports the TheHive case link to the MISP event.</p> </li> <li> <p>In the Filter settings section, enter the following information:</p> <p>- Maximum age</p> <p>The maximum age, based on the creation date, for an event to be imported into TheHive.</p> <p>- Organizations to include</p> <p>Only events created by the MISP organizations defined in this field are imported.</p> <p>- Organizations to exclude</p> <p>Only events not created by the MISP organizations defined in this field are imported.</p> <p>- Maximum number of attributes</p> <p>The maximum number of MISP attributes, corresponding to observables in TheHive, per event to import.</p> <p>- List of allowed tags</p> <p>Only events containing the tags defined in this field are imported.</p> <p>- Prohibited tags list</p> <p>Only events that don't contain the tags defined in this field are imported.</p> </li> <li> <p>Select Test server connection to verify your connection.</p> </li> <li> <p>Select Add.</p> </li> </ol> Next steps <ul> <li>Delete a MISP Server Connection</li> </ul>"}, {"location": "thehive/administration/misp-integration/delete-a-misp-server/", "title": "Delete a MISP Server Connection", "text": ""}, {"location": "thehive/administration/misp-integration/delete-a-misp-server/#delete-a-misp-server-connection", "title": "Delete a MISP Server Connection", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for deleting a MISP server connection in TheHive.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the MISP tab.</p> <p></p> </li> <li> <p>Select  next to the server you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Connect a MISP Server</li> </ul>"}, {"location": "thehive/administration/observable-types/create-an-observable-type/", "title": "Create an Observable Type", "text": ""}, {"location": "thehive/administration/observable-types/create-an-observable-type/#create-an-observable-type", "title": "Create an Observable Type", "text": "<p><code>[admin] manageObservableTemplate</code></p> <p>This topic provides step-by-step instructions for creating an observable type in TheHive.</p> <p>Use this procedure to extend the predefined list of observable types with custom ones.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Observable types tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding an observable type drawer, enter the name of the observable type you want to add.</p> </li> <li> <p>Turn on the Attachment toggle if you want users to provide a file instead of a value when adding an observable of this type.</p> </li> <li> <p>Select Confirm observable type creation.</p> </li> </ol> Next steps <ul> <li>Delete an Observable Type</li> </ul>"}, {"location": "thehive/administration/observable-types/delete-an-observable-type/", "title": "Delete an Observable Type", "text": ""}, {"location": "thehive/administration/observable-types/delete-an-observable-type/#delete-an-observable-type", "title": "Delete an Observable Type", "text": "<p><code>[admin] manageObservableTemplate</code></p> <p>This topic provides step-by-step instructions for deleting an observable type in TheHive.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Observable types tab.</p> <p></p> </li> <li> <p>Select  next to the observable type you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create an Observable Type</li> </ul>"}, {"location": "thehive/administration/organizations/about-organizations-sharing-rules/", "title": "About Organizations Sharing Rules", "text": ""}, {"location": "thehive/administration/organizations/about-organizations-sharing-rules/#about-organizations-sharing-rules", "title": "About Organizations Sharing Rules", "text": "<p>Sharing rules determine how cases, along with their tasks and observables, are shared with linked organizations.</p> <p>This topic explains how sharing rules work and interact.</p>"}, {"location": "thehive/administration/organizations/about-organizations-sharing-rules/#global-sharing-rules", "title": "Global sharing rules", "text": "<p>Global sharing rules define how newly created cases and their related tasks and observables are shared at the organization level with linked organizations. The configuration determines whether this sharing occurs automatically.</p> <p>TheHive requires setting these rules:</p> <ul> <li>For cases when linking organizations</li> <li>For tasks and observables when creating an organization</li> </ul> <p>Managing sharing rules for existing cases</p> <p>Global sharing rules apply only to newly created cases. Existing cases and their related tasks and observables remain unaffected. Applying sharing rules to existing cases requires manual configuration for each case. See Local sharing rules for details.</p>"}, {"location": "thehive/administration/organizations/about-organizations-sharing-rules/#local-sharing-rules", "title": "Local sharing rules", "text": "<p>Local sharing rules customize how cases\u2014and their associated tasks and observables\u2014are shared with linked organizations. They apply to both new and existing cases and override global sharing rules defined when linking and creating organizations.</p> <p>Local sharing rules are useful in the following scenarios:</p> <ul> <li>Global sharing rules are already defined for newly created cases, but the same rules need to apply to an existing case.</li> <li>One or more cases require different sharing settings that don't follow the global sharing rules.</li> </ul> <p>Follow these step-by-step instructions to see:</p> <ul> <li>How to set up local sharing rules for an existing case</li> <li>How to set up local sharing rules for a new case</li> </ul>"}, {"location": "thehive/administration/organizations/about-organizations-sharing-rules/#manual-sharing-of-tasks-and-observables-in-a-shared-case", "title": "Manual sharing of tasks and observables in a shared case", "text": "<p>Manual sharing allows selective sharing of tasks and observables within a shared case. This approach is useful when task and observable sharing rules are set to manual, enabling users to share only the content that is relevant.</p> <p>Follow these step-by-step instructions to learn how to:</p> <ul> <li>Share a Task with Other Organizations</li> <li>Share an Observable with Other Organizations</li> </ul>"}, {"location": "thehive/administration/organizations/about-organizations-sharing-rules/#how-sharing-rules-work-together", "title": "How sharing rules work togetherNext steps", "text": "Cases \u2193 \\ Tasks and observables \u2192 manual autoShare default New cases aren't automatically shared. New cases aren't automatically shared, and neither are their tasks and observables. supervised New cases are automatically shared without their linked tasks and observables. New cases are automatically shared with their linked tasks and observables. notify New cases are automatically shared without their linked tasks and observables. New cases are automatically shared with their linked tasks and observables. <ul> <li>Link an Organization</li> <li>Share a Case</li> <li>Share a Task with Other Organizations</li> <li>Share an Observable with Other Organizations</li> </ul>"}, {"location": "thehive/administration/organizations/about-organizations/", "title": "About Organizations", "text": ""}, {"location": "thehive/administration/organizations/about-organizations/#about-organizations", "title": "About Organizations", "text": "<p>Organizations are the customers or tenants, such as separate divisions or business units, that use TheHive independently.</p> <p>This topic explains how organizations function within TheHive.</p> <p>License</p> <p>The number of organizations you can create depends on your TheHive license. Only unlocked organizations count toward the license limit.</p>"}, {"location": "thehive/administration/organizations/about-organizations/#default-setup", "title": "Default setup", "text": "<p>TheHive includes a default Admin organization for users with administrator-type permissions. This organization manages global configurations, such as organizations, users, entities, and platform settings. </p> <p>Non-Admin organizations manage operations on cases, alerts, and tasks.</p> <p>By default, organizations are isolated and can't see or share data with each other. To enable data sharing, users with the necessary permissions must link organizations.</p>"}, {"location": "thehive/administration/organizations/about-organizations/#organizations-and-users", "title": "Organizations and users", "text": "<p>A user can belong to one or more organizations. A profile is assigned for each organization, defining the user's set of permissions within that organization.</p> <p>When assigning a user to an organization, the system suggests only permission profiles that match the organization's type (Admin or Non-Admin).</p>"}, {"location": "thehive/administration/organizations/about-organizations/#permissions", "title": "PermissionsNext steps", "text": "<ul> <li>Only users with an admin-type profile that has the <code>manageOrganisation</code> permission can create, link, or lock organizations in TheHive.</li> <li>Only users with the <code>manageUser</code> permission can assign users to organizations in TheHive.</li> </ul> <ul> <li>Create an Organization</li> <li>Add or Remove an Existing User Account from an Organization</li> <li>Link an Organization</li> <li>Lock an Organization</li> </ul>"}, {"location": "thehive/administration/organizations/add-remove-an-existing-user-account-from-an-organization/", "title": "Add or Remove An Existing User Account from an Organization", "text": ""}, {"location": "thehive/administration/organizations/add-remove-an-existing-user-account-from-an-organization/#add-or-remove-an-existing-user-account-from-an-organization", "title": "Add or Remove an Existing User Account from an Organization", "text": "<p>This topic provides step-by-step instructions for adding or removing an existing user account from an organization in TheHive.</p> <p>To create a new user account and assign it to an organization, see Create a User Account.</p> <p>To permanently delete a user account from all organizations, see Delete a User Account.</p> Procedure"}, {"location": "thehive/administration/organizations/add-remove-an-existing-user-account-from-an-organization/#as-an-administrator", "title": "As an administrator", "text": "<p><code>[admin] manageUser</code></p> <ol> <li> <p>Go to the Users view from the sidebar menu.</p> <p></p> </li> <li> <p>Locate the user account you're looking for, hover over it, and select .</p> </li> <li> <p>In the drawer, go to the Organizations section. Select the organizations to assign to the user account, and choose a permission profile for each one. To remove access, deselect the corresponding organizations.</p> <p>Remove multiple user accounts in bulk from an organization</p> <p>To remove multiple user accounts from an organization, go to the Organizations view and select the target organization. Select  next to each account, then choose  and confirm with OK.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/administration/organizations/add-remove-an-existing-user-account-from-an-organization/#as-an-organization-administrator", "title": "As an organization administrator", "text": "<p><code>manageUser</code></p> <p>Adding existing users not supported</p> <p>As an organization administrator, you can remove an existing user from an organization or create a new user account, but you can't add an existing user. To do so, ask someone with an admin-type profile.</p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Users tab.</p> <p></p> </li> <li> <p>Select  next to the user account you want to remove from the organization.</p> </li> <li> <p>Select Delete.</p> <p>Possible deletion</p> <p>Removing a user account from an organization automatically deletes the account if it isn't assigned to any other organization.</p> </li> <li> <p>Select OK.</p> </li> </ol> <p>Remove multiple user accounts in bulk from an organization</p> <p>To remove multiple user accounts from an organization, select  next to each account, then choose  and confirm with OK.</p> Next steps <ul> <li>Link an Organization</li> <li>Lock an Organization</li> </ul>"}, {"location": "thehive/administration/organizations/create-an-organization/", "title": "Create an Organization", "text": ""}, {"location": "thehive/administration/organizations/create-an-organization/#create-an-organization", "title": "Create an Organization", "text": "<p><code>[admin] manageOrganisation</code></p> <p>This topic provides step-by-step instructions for creating an organization in TheHive.</p> <p>Organizations are the customers or tenants, such as separate divisions or business units, that use TheHive independently.</p> <p>License</p> <p>The number of organizations you can create depends on your TheHive license. Only unlocked organizations count toward the license limit.</p> Procedure <ol> <li> <p>Go to the Organizations view from the sidebar menu.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding an organization drawer, enter:</p> <p>- Name *</p> <p>The name of your new organization.</p> <p>- Description *</p> <p>The description of your new organization.</p> <p>- Tasks sharing rule *</p> <p>How tasks linked to a case are handled when the case is shared with another organization.</p> <p>Pick an option from the dropdown list:</p> <ul> <li>manual (default): Tasks aren't shared automatically. Users must share them manually.</li> <li>autoShare: Tasks are shared automatically.</li> </ul> <p>- Observables sharing rule *</p> <p>How observables linked to a case are handled when the case is shared with another organization.</p> <p>Pick an option from the dropdown list:</p> <ul> <li>manual (default): Observables aren't shared automatically. Users must share them manually.</li> <li>autoShare: Observables are shared automatically.</li> </ul> <p>To learn more about how sharing rules function and interact, refer to About Organizations Sharing Rules.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>Optional: In the Organizations view, locate your new organization, hover over it, select , select the default organization logo to modify it, and upload an image to set it as the new logo for your organization.</p> </li> </ol> Next steps <ul> <li>Add or Remove an Existing User Account from an Organization</li> <li>Link an Organization</li> <li>Lock an Organization</li> </ul>"}, {"location": "thehive/administration/organizations/link-an-organization/", "title": "Link an Organization", "text": ""}, {"location": "thehive/administration/organizations/link-an-organization/#link-an-organization", "title": "Link an Organization", "text": "<p><code>[admin] manageOrganisation</code></p> <p>This topic provides step-by-step instructions for linking an organization to another in TheHive.</p> <p>By default, organizations in TheHive aren't linked. Each organization operates independently and can't access others on the instance.</p> <p>Link organizations to enable data sharing and define the applicable sharing rules.</p> Procedure <ol> <li> <p>Go to the Organizations view</p> <p></p> </li> <li> <p>Select the organization to link to another, then select Linked organizations. Alternatively, hover over the organization and select .</p> <p></p> </li> <li> <p>Select Manage linked organizations.</p> </li> <li> <p>Select the organizations you want to link to your organization.</p> </li> <li> <p>Choose the case-sharing rules between the organizations in both directions using the Choose a link type dropdown lists.</p> <p>Options are the followings:  </p> <ul> <li>default: Cases aren't automatically shared with the other organization. Users must share them manually.</li> <li>supervised: Cases are automatically shared with the other organization with an analyst-type permission profile, which grants both read and write access to cases.</li> <li>notify: Cases are automatically shared with the other organization with a read-only permission profile.</li> </ul> <p>To learn more about how sharing rules function and interact, refer to About Organizations Sharing Rules.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Share a Case with Other Organizations</li> <li>Share a Task with Other Organizations</li> <li>Share an Observable with Other Organizations</li> </ul>"}, {"location": "thehive/administration/organizations/lock-an-organization/", "title": "Lock an Organization", "text": ""}, {"location": "thehive/administration/organizations/lock-an-organization/#lock-an-organization", "title": "Lock an Organization", "text": "<p><code>[admin] manageOrganisation</code></p> <p>This topic provides step-by-step instructions for locking an organization in TheHive.</p> <p>Locking an organization is useful when you want to prevent users from logging in with that organization.</p> <p>Deleting an organization</p> <p>In TheHive, users can't delete organizations to ensure database integrity and safety.</p> Procedure <ol> <li> <p>Go to the Organizations view.</p> <p></p> </li> <li> <p>Select the checkbox on the left of the organization to lock and select . Alternatively, hover over the organization, select , and turn on the Locked toggle to lock the organization.</p> <p></p> </li> <li> <p>Select OK or Confirm.</p> </li> </ol> Next steps <ul> <li>Create an Organization</li> <li>Link an Organization</li> <li>Add or Remove an Existing User Account from an Organization</li> </ul>"}, {"location": "thehive/administration/profiles/about-profiles/", "title": "About Profiles", "text": ""}, {"location": "thehive/administration/profiles/about-profiles/#about-profiles", "title": "About Profiles", "text": "<p>A profile is assigned to each user account within an organization and determines the permissions available to that user in that context.</p> <p>This topic provides a general overview of how profiles work in TheHive.</p>"}, {"location": "thehive/administration/profiles/about-profiles/#profile-types", "title": "Profile types", "text": "<p>Two types of profiles are available in TheHive:</p> <ul> <li>Administration: Reserved for users who belong to the Admin organization</li> <li>Organization: Used for all users across Non-Admin organizations</li> </ul>"}, {"location": "thehive/administration/profiles/about-profiles/#profile-permissions", "title": "Profile permissions", "text": "<p>Each profile contains a set of permissions that define what users can do within the platform.</p> <p>Permissions follow the format <code>manageEntity</code>, where <code>Entity</code> represents a specific component of the application. For example, the <code>manageCase</code> permission allows users to create, update, and delete cases.</p>"}, {"location": "thehive/administration/profiles/about-profiles/#predefined-profiles", "title": "Predefined profiles", "text": "<p>TheHive includes a set of predefined profiles:</p> <ul> <li>Analyst</li> <li>Admin</li> <li>Org-admin</li> <li>Read-only</li> </ul> <p>These profiles can't be modified or deleted\u2014except for the analyst profile.</p> <p>Gold Platinum This set can be extended by creating custom profiles tailored to specific needs.</p>"}, {"location": "thehive/administration/profiles/about-profiles/#licensed-vs-unlicensed-profiles", "title": "Licensed vs. unlicensed profiles", "text": "<p>5.4.3</p> <p>TheHive separates permissions into two types for organization-type profiles:</p> <ul> <li>Licensed: Consume a license</li> <li>Unlicensed: Don't affect license usage</li> </ul> <p>These permissions don't require a license:</p> <ul> <li><code>manageDashboard</code></li> <li><code>manageUser</code></li> <li><code>manageConfig</code></li> <li><code>manageKnowledgeBase</code></li> <li>all permissions included in administration-type profiles</li> </ul> <p>When creating or editing a profile, licensed permissions are clearly marked to help identify which ones affect license usage. When assigning a user to an organization, profiles that include at least one licensed permission are also marked accordingly.</p>"}, {"location": "thehive/administration/profiles/about-profiles/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>manageProfile</code> permission can manage permission profiles in TheHive.</p> <ul> <li>Create a Profile</li> <li>Add or Remove Permissions from a Profile</li> <li>Delete a Profile</li> </ul>"}, {"location": "thehive/administration/profiles/add-remove-permissions-from-a-profile/", "title": "Add or Remove Permissions from a Profile", "text": ""}, {"location": "thehive/administration/profiles/add-remove-permissions-from-a-profile/#add-or-remove-permissions-from-a-profile", "title": "Add or Remove Permissions from a Profile", "text": "<p><code>[admin] manageProfile</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for adding and removing permissions from a profile in TheHive.</p> <p>Predefined profiles</p> <p>You can't modify the predefined Admin, Org-Admin, and Read-Only profiles.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>In the Profiles tab, select  next to the profile you want to update.</p> </li> <li> <p>Select Edit.</p> </li> <li> <p>In the Editing a profile drawer, select or deselect the relevant permissions.</p> <p>Licensed vs. unlicensed permissions</p> <p>Permissions are divided into two categories to help you identify which ones require a paid license. If a profile includes at least one licensed permission, it is marked as license required when assigning a user to an organization.</p> </li> <li> <p>Select Confirm profile edition.</p> </li> </ol> Next steps <ul> <li>Add or Remove an Existing User Account from an Organization</li> <li>Create a Profile</li> <li>Delete a Profile</li> </ul>"}, {"location": "thehive/administration/profiles/create-a-profile/", "title": "Create a Profile", "text": ""}, {"location": "thehive/administration/profiles/create-a-profile/#create-a-profile", "title": "Create a Profile", "text": "<p><code>[admin] manageProfile</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for creating a permission profile in TheHive.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>In the Profiles tab, select .</p> </li> <li> <p>In the Adding a profile drawer, enter a name for the profile. You won't be able to change this name later.</p> </li> <li> <p>Select the profile type and the relevant permissions.</p> <p>Licensed vs. unlicensed permissions</p> <p>Permissions are divided into two categories to help you identify which ones require a paid license. If a profile includes at least one licensed permission, it is marked as license required when assigning a user to an organization.</p> </li> <li> <p>Select Confirm profile creation.</p> </li> </ol> Next steps <ul> <li>Add or Remove an Existing User Account from an Organization</li> <li>Add or Remove Permissions from a Profile</li> <li>Delete a Profile</li> </ul>"}, {"location": "thehive/administration/profiles/delete-a-profile/", "title": "Delete a Profile", "text": ""}, {"location": "thehive/administration/profiles/delete-a-profile/#delete-a-profile", "title": "Delete a Profile", "text": "<p><code>[admin] manageProfile</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for deleting a permission profile in TheHive.</p> <p>Deletion rules</p> <p>You can\u2019t delete a profile that's currently assigned to a user account, or any of the predefined Admin, Org-Admin, or Read-Only profiles.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>In the Profiles tab, select  next to the profile you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add or Remove an Existing User Account from an Organization</li> <li>Create a Profile</li> <li>Add or Remove Permissions from a Profile</li> </ul>"}, {"location": "thehive/administration/smtp/about-smtp/", "title": "About SMTP", "text": ""}, {"location": "thehive/administration/smtp/about-smtp/#about-smtp", "title": "About SMTP", "text": "<p>This topic explains what Simple Mail Transfer Protocol (SMTP) is and how it's used in TheHive.</p>"}, {"location": "thehive/administration/smtp/about-smtp/#whats-smtp", "title": "What's SMTP", "text": "<p>Simple Mail Transfer Protocol (SMTP) is the standard protocol used on the internet for sending email messages. It's responsible solely for email delivery and typically requires client authentication via credentials before granting access.</p>"}, {"location": "thehive/administration/smtp/about-smtp/#benefits-of-using-an-smtp-server", "title": "Benefits of using an SMTP server", "text": "<p>Using an SMTP server:</p> <ul> <li>Provides a secure environment for sending emails</li> <li>Offers dedicated IP addresses along with flexible API and SMTP configurations</li> <li>Includes user-friendly software for easy setup and management</li> </ul>"}, {"location": "thehive/administration/smtp/about-smtp/#smtp-server-usage-in-thehive", "title": "SMTP server usage in TheHive", "text": "<p>Configure a SMTP server in TheHive to enable sending:</p> <ul> <li>Email notifications to specific users in your organization</li> <li>Email notifications to all users in your organization</li> <li>Emails for password resets and edits</li> </ul>"}, {"location": "thehive/administration/smtp/about-smtp/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePlatform</code> permission can configure an SMTP server in TheHive.</p> <ul> <li>Configure an SMTP Server</li> </ul>"}, {"location": "thehive/administration/smtp/configure-smtp-server/", "title": "Configure an SMTP Server", "text": ""}, {"location": "thehive/administration/smtp/configure-smtp-server/#configure-an-smtp-server", "title": "Configure an SMTP Server", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for configuring an SMTP server in TheHive.</p> <p>Use this procedure to enable sending email notifications to specific users and all users in your organization, as well as emails for password resets and edits.</p> Procedure <ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the SMTP tab.</p> <p></p> </li> <li> <p>In the Server settings section, enter the following information:</p> <p>- Server name or IP address *</p> <p>The host name or IP address of your SMTP server.</p> <p>- Port *</p> <p>The port number your SMTP server uses.</p> <p>- Send emails from *</p> <p>The email address that appears as the sender of the emails.</p> </li> <li> <p>In the Security and authentication settings section, enter the following information:</p> <p>- Connection security *</p> <p>Select the security protocol to use.</p> <p>- Username</p> <p>The username required to authenticate with your SMTP server.</p> <p>- Password</p> <p>The corresponding password for the SMTP username.</p> </li> <li> <p>Select Test SMTP configuration to verify the connection settings. You should receive an email confirming the result of the test.</p> </li> <li> <p>In the Reset Password section, set the token expiration duration to control how long password reset tokens stay valid before they expire. This limits the time users have to complete a password reset and helps keep your system secure.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure the EmailerToAddr Notifier</li> <li>Configure the EmailerToUser Notifier</li> </ul>"}, {"location": "thehive/administration/status/about-statuses/", "title": "About Statuses", "text": ""}, {"location": "thehive/administration/status/about-statuses/#about-statuses", "title": "About Statuses", "text": "<p>The status represents the current state of a case or alert.</p> <p>This topic explains how statuses works in TheHive.</p> <p>Task statuses</p> <p>This page doesn't cover task statuses, which are hard-coded in TheHive. They can't be modified, deleted, or extended.</p>"}, {"location": "thehive/administration/status/about-statuses/#predefined-statuses", "title": "Predefined statuses", "text": "<p>TheHive includes a set of predefined statuses. Administrators can change their color, or hide them to encourage the use of custom statuses.</p>"}, {"location": "thehive/administration/status/about-statuses/#attributes", "title": "Attributes", "text": "<p>Each status is associated with:</p> <ul> <li> <p>A stage: TheHive includes four predefined stages\u2014New, Imported, In progress, and Closed. Stages are hard-coded and can't be modified, deleted, or extended.</p> <p>Imported stage</p> <p>The Imported stage and status aren't available for selection in the interface. The Imported status is automatically applied when an alert is merged into an existing case or merged into a new case.</p> </li> <li> <p>5.5 A visibility: The status is either displayed or hidden in TheHive interface.</p> </li> <li> <p>A color: The color helps users easily recognize the status.</p> </li> </ul>"}, {"location": "thehive/administration/status/about-statuses/#behavior", "title": "Behavior", "text": "<p>Alert status restrictions</p> <p>Alerts in a status linked to the Closed stage can't return to a New or In progress stage unless the user has permission to reopen a closed alert. The same restriction applies when trying to switch from In progress back to New.</p> <ul> <li> <p>Statuses linked to the In progress stage are available at any time for cases, but only when starting the investigation of an alert or reopening a closed alert for alerts.</p> </li> <li> <p>Statuses linked to the Closed stage are available only when closing a case or closing an alert.</p> </li> </ul>"}, {"location": "thehive/administration/status/about-statuses/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePlatform</code> permission can manage case and alert statuses in TheHive.</p> <p>After creation, statuses are available to users in cases and alerts.</p> <ul> <li>Create a Status</li> <li>Change a Status Visibility</li> <li>Change a Status Color</li> <li>Delete a Status</li> </ul>"}, {"location": "thehive/administration/status/change-color-of-a-status/", "title": "Change a Color Visibility", "text": ""}, {"location": "thehive/administration/status/change-color-of-a-status/#change-a-status-color", "title": "Change a Status Color", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for changing a status color for cases and alerts in TheHive.</p> <p>Task statuses</p> <p>This page doesn't cover task statuses, which are hard-coded in TheHive. They can't be modified, deleted, or extended.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Case status tab or the Alert status tab.</p> <p></p> </li> <li> <p>Select  next to the status you want to edit.</p> </li> <li> <p>Select Edit.</p> </li> <li> <p>In the Add a custom status drawer, enter a hex color code in the format #RRGGBB, or select  to open the color picker.</p> </li> <li> <p>Verify that the preview looks correct.</p> </li> <li> <p>Select Confirm custom status creation.</p> </li> </ol> Next steps <ul> <li>Create a Status</li> <li>Delete a Status</li> </ul>"}, {"location": "thehive/administration/status/change-visibility-of-a-status/", "title": "Change a Status Visibility", "text": ""}, {"location": "thehive/administration/status/change-visibility-of-a-status/#change-a-status-visibility", "title": "Change a Status Visibility", "text": "<p>5.5 <code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for changing a status visibility for cases and alerts in TheHive.</p> <p>Use this procedure if you want to hide TheHive\u2019s predefined statuses, so users only use the custom statuses you have created. </p> <p>No impact on API</p> <p>Changing the visibility of a status doesn't affect the API. All statuses remain available through the API.</p> <p>Task statuses</p> <p>This page doesn't cover task statuses, which are hard-coded in TheHive. They can't be modified, deleted, or extended.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Case status tab or the Alert status tab.</p> <p></p> </li> <li> <p>Select  next to the status you want to edit.</p> </li> <li> <p>Select Edit.</p> </li> <li> <p>In the Add a custom status drawer, enter the new visibility you want to apply.</p> <p>Specifies whether you want to display or hide a status in TheHive interface.</p> <p>Hiding impact on existing cases and alerts</p> <p>If you hide a status that is already applied to existing cases or alerts, it remains applied until manually changed. It is no longer available for selection in the interface. This doesn't apply to the Imported status, which is automatically assigned to alerts when they are merged into a case.</p> </li> <li> <p>Select Confirm custom status creation.</p> </li> </ol> Next steps <ul> <li>Create a Status</li> <li>Delete a Status</li> </ul>"}, {"location": "thehive/administration/status/create-a-status/", "title": "Create a Status", "text": ""}, {"location": "thehive/administration/status/create-a-status/#create-a-status", "title": "Create a Status", "text": "<p><code>[admin] managePlatform</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for creating a status for cases and alerts in TheHive.</p> <p>Use this procedure to add custom statuses in addition to the predefined ones managed by TheHive.</p> <p>Task statuses</p> <p>This page doesn't cover task statuses, which are hard-coded in TheHive. They can't be modified, deleted, or extended.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Case status tab or the Alert status tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Add a custom status drawer, enter the following information:</p> <p>- Visibility 5.5</p> <p>Specifies whether you want to display or hide a status in TheHive interface.</p> <p>- Stage</p> <p>The stage linked to the status. TheHive includes four predefined stages\u2014New, Imported, In progress, and Closed. These stages are hard-coded and you can't modify, delete, or extend them. After you link a stage to a status, you can't change it. To assign a different stage, you must delete the status and create a new one.</p> <p>Imported stage</p> <p>The Imported stage isn't available for selection in the interface. It is linked to an Imported status that is applied when an alert is merged into an existing case or merged into a new case.</p> <p>- Value</p> <p>The name of the status. After you create a status, you can't change its name. To use a different name, you must delete the status and create a new one.</p> <p>- Color</p> <p>Enter a hex color code in the format #RRGGBB, or select  to open the color picker.</p> </li> <li> <p>Verify that the preview looks correct.</p> </li> <li> <p>Select Confirm custom status creation.</p> </li> </ol> Next steps <ul> <li>Change a Status Visibility</li> <li>Change a Status Color</li> <li>Delete a Status</li> </ul>"}, {"location": "thehive/administration/status/delete-a-status/", "title": "Delete a Status", "text": ""}, {"location": "thehive/administration/status/delete-a-status/#delete-a-status", "title": "Delete a Status", "text": "<p><code>[admin] managePlatform</code> Gold Platinum</p> <p>This topic provides step-by-step instructions for deleting a status for cases and alerts in TheHive.</p> <p>Deletion conditions</p> <p>You can delete a status only if it isn't a predefined status managed by TheHive and isn't used in any case or alert. To check where a status is applied, use filters and sorting in case and alert lists. You can hide a predefined status by changing its visibility.</p> <p>Task statuses</p> <p>This page doesn't cover task statuses, which are hard-coded in TheHive. They can't be modified, deleted, or extended.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Case status tab or the Alert status tab.</p> <p></p> </li> <li> <p>Select  next to the status you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Status</li> <li>Change a Status Visibility</li> <li>Change a Status Color</li> </ul>"}, {"location": "thehive/administration/taxonomies/about-taxonomies/", "title": "About Taxonomies", "text": ""}, {"location": "thehive/administration/taxonomies/about-taxonomies/#about-taxonomies", "title": "About Taxonomies", "text": "<p>Taxonomies are catalogs of structured tags managed in TheHive. They belong to one of the tag categories available for cases, alerts, or observables.</p> <p>This topic explains how taxonomies work.</p>"}, {"location": "thehive/administration/taxonomies/about-taxonomies/#sources", "title": "Sources", "text": "<p>TheHive supports two ways to create taxonomies:</p> <ul> <li> <p>From the Malware Information Sharing Platform (MISP): TheHive imports MISP taxonomies by default during installation.</p> <p>Manual activation required</p> <p>By default, MISP taxonomies aren't activated. Administrators must activate them manually.</p> </li> <li> <p>From custom files: Administrators can import custom taxonomies as needed.</p> </li> </ul>"}, {"location": "thehive/administration/taxonomies/about-taxonomies/#actions", "title": "Actions", "text": "<p>MISP taxonomy upgrades</p> <p>TheHive includes the version of MISP taxonomies available at the time of installation. Upgrading TheHive doesn't automatically update MISP taxonomies. Updating them requires performing a manual update.</p> <p>TheHive doesn't allow modifying taxonomies or their tags. </p> <p>However, administrators can:</p> <ul> <li>Deactivate taxonomies</li> <li>Delete taxonomies</li> </ul>"}, {"location": "thehive/administration/taxonomies/about-taxonomies/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>manageTaxonomy</code> permission can manage taxonomies in TheHive.</p> <p>Once created, tags from activated taxonomies are available to add to cases, alerts, and observables.</p> <ul> <li>Activate or Deactivate a Taxonomy</li> <li>Add a Custom Taxonomy</li> <li>Update MISP Taxonomies</li> <li>Delete a Taxonomy</li> </ul>"}, {"location": "thehive/administration/taxonomies/activate-deactivate-a-taxonomy/", "title": "Activate or Deactivate a Taxonomy", "text": ""}, {"location": "thehive/administration/taxonomies/activate-deactivate-a-taxonomy/#activate-or-deactivate-a-taxonomy", "title": "Activate or Deactivate a Taxonomy", "text": "<p><code>[admin] manageTaxonomy</code></p> <p>This topic provides step-by-step instructions for activating and deactivating a taxonomy in TheHive.</p> <p>Taxonomies are catalogs of structured tags managed in TheHive.</p> <p>Manual activation required</p> <p>By default, MISP taxonomies aren't activated. You must activate them manually.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Taxonomies tab.</p> <p></p> </li> <li> <p>Select  next to the taxonomy you want to activate or deactivate.</p> </li> <li> <p>Select Activate or Deactivate, depending on the action what you want to take.</p> </li> </ol> Next steps <ul> <li>Add a Custom Taxonomy</li> <li>Update MISP Taxonomies</li> <li>Delete a Taxonomy</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/administration/taxonomies/add-a-custom-taxonomy/", "title": "Add a Custom Taxonomy", "text": ""}, {"location": "thehive/administration/taxonomies/add-a-custom-taxonomy/#add-a-custom-taxonomy", "title": "Add a Custom Taxonomy", "text": "<p><code>[admin] manageTaxonomy</code></p> <p>This topic provides step-by-step instructions for adding a custom taxonomy in TheHive.</p> <p>Use this procedure if you want to add taxonomies other than the default imported Malware Information Sharing Platform (MISP) taxonomies.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Taxonomies tab.</p> <p></p> </li> <li> <p>Select Import taxonomies.</p> </li> <li> <p>In the Import taxonomies archive drawer, drop a ZIP file into the Taxonomies archive section or select it from your computer. The ZIP file must contain at least one file named <code>machinetag.json</code> that follows the MISP JSON schema.</p> </li> <li> <p>Select Import.</p> </li> </ol> Next steps <ul> <li>Activate Deactivate a Taxonomy</li> <li>Update MISP Taxonomies</li> <li>Delete a Taxonomy</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/administration/taxonomies/delete-a-taxonomy/", "title": "Delete a Taxonomy", "text": ""}, {"location": "thehive/administration/taxonomies/delete-a-taxonomy/#delete-a-taxonomy", "title": "Delete a Taxonomy", "text": "<p><code>[admin] manageTaxonomy</code></p> <p>This topic provides step-by-step instructions for deleting a taxonomy in TheHive.</p> <p>Permanent deletion</p> <p>Deleting a taxonomy is permanent. To keep a taxonomy for future use, deactivate it instead.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Taxonomies tab.</p> <p></p> </li> <li> <p>Select  next to the taxonomy to delete.</p> </li> <li> <p>Select Delete.</p> </li> </ol> Next steps <ul> <li>Add a Custom Taxonomy</li> <li>Update MISP Taxonomies</li> <li>Activate or Deactivate a Taxonomy</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/administration/taxonomies/update-misp-taxonomies/", "title": "Update MISP Taxonomies", "text": ""}, {"location": "thehive/administration/taxonomies/update-misp-taxonomies/#update-misp-taxonomies", "title": "Update MISP Taxonomies", "text": "<p><code>[admin] manageTaxonomy</code></p> <p>This topic provides step-by-step instructions for updating the Malware Information Sharing Platform (MISP) taxonomies in TheHive.</p> <p>Use this procedure to update the MISP taxonomies included with your TheHive installation.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Taxonomies tab.</p> <p></p> </li> <li> <p>Select Import taxonomies.</p> </li> <li> <p>In the Import taxonomies archive drawer, download the latest archive of the official MISP taxonomies.</p> </li> <li> <p>Drop the downloaded ZIP file into the Taxonomies archive section or select it from your computer.</p> </li> <li> <p>Select Import.</p> </li> </ol> Next steps <ul> <li>Add a Custom Taxonomy</li> <li>Activate or Deactivate a Taxonomy</li> <li>Delete a Taxonomy</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/administration/ttps/add-a-catalog/", "title": "Add a Catalog", "text": ""}, {"location": "thehive/administration/ttps/add-a-catalog/#add-a-tactics-techniques-and-procedures-catalog", "title": "Add a Tactics, Techniques and Procedures Catalog", "text": "<p><code>[admin] managePattern</code></p> <p>This topic provides step-by-step instructions for adding a Tactics, Techniques and Procedures (TTPs) catalog in TheHive.</p> <p>TTPs describe the behaviors and methods commonly used by specific threat actors or groups.</p> <p>Use this procedure to add more MITRE catalogs than the default one included in TheHive.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attack patterns tab.</p> <p></p> </li> <li> <p>Select Import MITRE ATT&amp;CK patterns.</p> </li> <li> <p>In the Import MITRE ATT&amp;CK patterns drawer, enter a unique name for the catalog. You can\u2019t use a name that\u2019s already taken.</p> </li> <li> <p>Drop a JSON file.</p> </li> <li> <p>Select Import.</p> <p>Hang tight</p> <p>It may take a few seconds to add a TTPs catalog.</p> </li> </ol> Next steps <ul> <li>Update a Catalog</li> <li>Remove a Catalog</li> <li>View Techniques in a Catalog</li> </ul>"}, {"location": "thehive/administration/ttps/remove-a-catalog/", "title": "Remove a Catalog", "text": ""}, {"location": "thehive/administration/ttps/remove-a-catalog/#remove-a-tactics-techniques-and-procedures-catalog", "title": "Remove a Tactics, Techniques and Procedures Catalog", "text": "<p><code>[admin] managePattern</code></p> <p>This topic provides step-by-step instructions for removing a Tactics, Techniques and Procedures (TTPs) catalog in TheHive.</p> <p>TTPs describe the behaviors and methods commonly used by specific threat actors or groups.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attack patterns tab.</p> <p></p> </li> <li> <p>Select  next to the catalog you want to remove.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add a Catalog</li> <li>Update a Catalog</li> <li>View Techniques in a Catalog</li> </ul>"}, {"location": "thehive/administration/ttps/update-a-catalog/", "title": "Update a Catalog", "text": ""}, {"location": "thehive/administration/ttps/update-a-catalog/#update-a-tactics-techniques-and-procedures-catalog", "title": "Update a Tactics, Techniques and Procedures Catalog", "text": "<p><code>[admin] managePattern</code></p> <p>This topic provides step-by-step instructions for updating a Tactics, Techniques and Procedures (TTPs) catalog in TheHive.</p> <p>TTPs describe the behaviors and methods commonly used by specific threat actors or groups.</p> <p>The default and additional MITRE catalogs aren't updated automatically. Use this procedure to get the latest versions.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attack patterns tab.</p> <p></p> </li> <li> <p>In the Import MITRE ATT&amp;CK patterns drawer, select Import MITRE ATT&amp;CK patterns.</p> </li> <li> <p>Select the existing catalog you want to update.</p> </li> <li> <p>Drop a JSON file from the latest version of the Enterprise ATT&amp;CK and Mobile ATT&amp;CK MITRE matrices.</p> </li> <li> <p>Select Import.</p> </li> </ol> Next steps <ul> <li>Add a Catalog</li> <li>Remove a Catalog</li> <li>View Techniques in a Catalog</li> </ul>"}, {"location": "thehive/administration/ttps/view-techniques-in-a-catalog/", "title": "View Techniques", "text": ""}, {"location": "thehive/administration/ttps/view-techniques-in-a-catalog/#view-techniques-in-tactics-techniques-and-procedures-catalogs", "title": "View Techniques in Tactics, Techniques and Procedures Catalogs", "text": "<p><code>[admin] managePattern</code></p> <p>This topic provides step-by-step instructions for viewing techniques in a Tactics, Techniques and Procedures (TTPs) catalog in TheHive.</p> <p>TTPs describe the behaviors and methods commonly used by specific threat actors or groups.</p> Procedure <ol> <li> <p>Go to the Entities management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attack patterns tab.</p> <p></p> </li> <li> <p>Select the concerned catalog.</p> </li> <li> <p>Hover over a technique and select\u202fPreview\u202fto view its details.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> </ol> Next steps <ul> <li>Add a Catalog</li> <li>Update a Catalog</li> <li>Remove a Catalog</li> </ul>"}, {"location": "thehive/configuration/akka/", "title": "Akka (Version 5.3 and Earlier)", "text": ""}, {"location": "thehive/configuration/akka/#akka-configuration-version-53-and-earlier", "title": "Akka Configuration (Version 5.3 and Earlier)", "text": "<p>Akka is a powerful toolkit designed for building highly concurrent, distributed, and resilient message-driven applications in Java and Scala.</p> <p>Akka plays a crucial role in enabling multiple nodes of TheHive to communicate with each other seamlessly, thereby enhancing the overall user experience.</p> <p>This topic provides instructions for configuring Akka in your environment.</p> <p>Version compatibility</p> <p>This documentation applies to TheHive versions earlier than 5.4. For version 5.4 and later, refer to the Pekko Configuration topic.</p>"}, {"location": "thehive/configuration/akka/#basic-configuration", "title": "Basic configuration", "text": "<p>For a reliable cluster setup, it's essential to have a minimum of three nodes for TheHive application. Configure each node with Akka as outlined below:</p> <pre><code>## Akka server\nakka {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    canonical {\n      hostname = \"&lt;HOSTNAME OR IP_ADDRESS&gt;\"\n      port = 2551\n    }\n  }\n# seed node list contains at least one active node\n  cluster.seed-nodes = [ \"akka://application@HOSTNAME1:2551\", \"akka://application@HOSTNAME2:2551\", \"akka://application@HOSTNAME3:2551\" ]\n}\n</code></pre> <p>In this configuration:</p> <ul> <li>Set <code>remote.artery.hostname</code> to the host name or IP address of the node.</li> <li>Include the same list of Akka nodes in <code>cluster.seed-nodes</code> to ensure consistency across all nodes.</li> </ul> <p>Configuration of a cluster with three nodes</p> Node 1Node 2Node 3 <p>Akka configuration for node 1:</p> <pre><code>akka {\n    cluster.enable = on\n    actor {\n      provider = cluster\n    }\n    remote.artery {\n      canonical {\n          hostname = \"10.1.2.1\"\n          port = 2551\n      }\n    }\n    # seed node list contains at least one active node\n    cluster.seed-nodes = [ \"akka://application@10.1.2.1:2551\", \"akka://application@10.1.2.2:2551\", \"akka://application@10.1.2.3:2551\" ]\n}\n</code></pre> <p>Akka configuration for node 2:</p> <pre><code>akka {\n    cluster.enable = on\n    actor {\n    provider = cluster\n    }\n    remote.artery {\n    canonical {\n        hostname = \"10.1.2.2\"\n        port = 2551\n    }\n    }\n    # seed node list contains at least one active node\n    cluster.seed-nodes = [ \"akka://application@10.1.2.1:2551\", \"akka://application@10.1.2.2:2551\", \"akka://application@10.1.2.3:2551\" ]\n}\n</code></pre> <p>Akka configuration for node 3:</p> <pre><code>akka {\n    cluster.enable = on\n    actor {\n    provider = cluster\n    }\n    remote.artery {\n    canonical {\n        hostname = \"10.1.2.3\"\n        port = 2551\n    }\n    }\n    # seed node list contains at least one active node\n    cluster.seed-nodes = [ \"akka://application@10.1.2.1:2551\", \"akka://application@10.1.2.2:2551\", \"akka://application@10.1.2.3:2551\" ]\n}\n</code></pre>"}, {"location": "thehive/configuration/akka/#ssltls-support", "title": "SSL/TLS supportNext steps", "text": "<p>Akka offers robust support for SSL/TLS encryption, guaranteeing secure communication between nodes. Below, you'll find a standard configuration to enable SSL/TLS support:</p> <pre><code>## Akka server\nakka {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    transport = tls-tcp\n    canonical {\n      hostname = \"&lt;HOSTNAME OR IP_ADDRESS&gt;\"\n      port = 2551\n    }\n\n    ssl.config-ssl-engine {\n      key-store = \"&lt;PATH TO KEYSTORE&gt;\"\n      trust-store = \"&lt;PATH TO TRUSTSTORE&gt;\"\n\n      key-store-password = \"chamgeme\"\n      key-password = \"chamgeme\"\n      trust-store-password = \"chamgeme\"\n\n      protocol = \"TLSv1.2\"\n    }\n  }\n# seed node list contains at least one active node\n  cluster.seed-nodes = [ \"akka://application@HOSTNAME1:2551\", \"akka://application@HOSTNAME2:2551\", \"akka://application@HOSTNAME3:2551\" ]\n}\n</code></pre> <p>Remoting and security configuration</p> <p>Note that <code>akka.remote.artery.transport</code> has changed and <code>akka.ssl.config-ssl-engine</code> needs to be configured.  </p> <p>For more details, refer to Akka Remoting with Artery - Remote Security.</p> <p>Certificate considerations</p> <p>Ensure you use your internal PKI (Public Key Infrastructure) or keytool commands to generate certificates.  </p> <p>For detailed instructions, see Using Keytool for X.509 Certificate Generation.  </p> <p>Your server certificates should include the following <code>KeyUsage</code> and <code>ExtendedkeyUsage</code> extensions for proper functioning:</p> <ul> <li> <p>KeyUsage extensions</p> <ul> <li><code>nonRepudiation</code></li> <li><code>dataEncipherment</code></li> <li><code>digitalSignature</code></li> <li><code>keyEncipherment</code></li> </ul> </li> <li> <p>ExtendedkeyUsage extensions</p> <ul> <li><code>serverAuth</code></li> <li><code>clientAuth</code></li> </ul> </li> </ul> <p>Akka configuration with SSL/TLS for node 1</p> <pre><code>## Akka server\nakka {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    transport = tls-tcp\n    canonical {\n      hostname = \"10.1.2.1\"\n      port = 2551\n    }\n\n    ssl.config-ssl-engine {\n      key-store = \"/etc/thehive/application.conf.d/certs/10.1.2.1.jks\"\n      trust-store = \"/etc/thehive/application.conf.d/certs/internal_ca.jks\"\n\n      key-store-password = \"chamgeme\"\n      key-password = \"chamgeme\"\n      trust-store-password = \"chamgeme\"\n\n      protocol = \"TLSv1.2\"\n    }\n  }\n# seed node list contains at least one active node\n  cluster.seed-nodes = [ \"akka://application@10.1.2.1:2551\", \"akka://application@10.1.2.2:2551\", \"akka://application@10.1.2.3:2551\" ]\n}\n</code></pre> <p>Be sure to apply the same configuration principles to all other nodes and restart all services afterward.</p> <ul> <li>Configure JVM Trust for SSL/TLS Certificates</li> <li>Update TheHive Service Configuration</li> <li>Turn Off The Cortex Integration</li> <li>Turn Off The MISP Integration</li> <li>Update Log Configuration</li> <li>Update TheHive Service Configuration</li> <li>Enable the GDPR Compliance Feature</li> </ul>"}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/", "title": "TheHive Database and Index Connection Settings", "text": ""}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#thehive-database-and-index-connection-settings", "title": "TheHive Database and Index Connection Settings", "text": "<p>TheHive uses JanusGraph for database and index connections. These parameters configure Cassandra and Elasticsearch back ends.</p>"}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#database-storage-parameters", "title": "Database storage parameters", "text": ""}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#core-storage-settings", "title": "Core storage settings", "text": "Parameter Type Description <code>db.provider</code> string Provider name for the database back end. Must be: <code>janusgraph</code>. <code>db.janusgraph.storage.backend</code> string Storage back end type. Must be: <code>cql</code>. <code>db.janusgraph.storage.hostname</code> list of string IP addresses or host names of Cassandra nodes. Must be <code>[\"127.0.0.1\"]</code> for a standalone server deployment. <code>db.janusgraph.storage.port</code> integer Port number for Cassandra connection. Default: <code>9042</code> for CQL. Use a different port when SSL is enabled or when Cassandra is configured with a custom port."}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#cassandra-authentication", "title": "Cassandra authentication", "text": "Parameter Type Description <code>db.janusgraph.storage.username</code> string Username for Cassandra authentication. Required when authentication is enabled. <code>db.janusgraph.storage.password</code> string Password for Cassandra authentication. Required when authentication is enabled."}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#cassandra-cql-configuration", "title": "Cassandra CQL configuration", "text": "Parameter Type Description <code>db.janusgraph.storage.cql.keyspace</code> string Keyspace name for TheHive data storage in Cassandra. Must be: <code>thehive</code>. <code>db.janusgraph.storage.cql.replication-factor</code> integer Replication factor for the keyspace. Use <code>1</code> for a standalone server, <code>3</code> or higher for production clusters."}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#cassandra-ssltls-settings", "title": "Cassandra SSL/TLS settings", "text": "Parameter Type Description <code>db.janusgraph.storage.cql.ssl.enabled</code> boolean Enable SSL for Cassandra connections. Default: <code>false</code>. <code>db.janusgraph.storage.cql.ssl.truststore.location</code> string Path to the Java truststore file containing CA certificates. <code>db.janusgraph.storage.cql.ssl.truststore.password</code> string Password to access the truststore. <code>db.janusgraph.storage.cql.ssl.client-authentication-enabled</code> boolean Enable client certificate authentication. Default: <code>false</code>. <code>db.janusgraph.storage.cql.ssl.keystore.location</code> string Path to the Java keystore containing client certificate. Required when client authentication is enabled. <code>db.janusgraph.storage.cql.ssl.keystore.storepassword</code> string Password to access the keystore. <code>db.janusgraph.storage.cql.ssl.keystore.keypassword</code> string Password for the private key in the keystore. <p>For more detailed information on configuring Cassandra connection, refer to the official JanusGraph documentation..</p>"}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#index-search-parameters", "title": "Index search parameters", "text": ""}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#core-index-settings", "title": "Core index settings", "text": "Parameter Type Description <code>index.search.backend</code> string Index back end type. Must be: <code>elasticsearch</code>. <code>index.search.hostname</code> list of string IP addresses or host names of Elasticsearch nodes with optional port. Must be <code>[\"127.0.0.1\"]</code> for a standalone server deployment. <code>index.search.index-name</code> string Name of the Elasticsearch index for TheHive data. Must be: <code>thehive</code>."}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#elasticsearch-http-authentication", "title": "Elasticsearch HTTP authentication", "text": "Parameter Type Description <code>index.search.elasticsearch.http.auth.type</code> string Authentication type. Must be: <code>basic</code>. <code>index.search.elasticsearch.http.auth.basic.username</code> string Username for Elasticsearch authentication. Required when authentication is enabled. <code>index.search.elasticsearch.http.auth.basic.password</code> string Password for Elasticsearch authentication. Required when authentication is enabled. <p>Required Elasticsearch privileges</p> <p>The Elasticsearch user must have specific privileges to work with TheHive. See the detailed configuration steps in the installation guide.</p>"}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#elasticsearch-ssltls-settings", "title": "Elasticsearch SSL/TLS settings", "text": "Parameter Type Description <code>index.search.elasticsearch.ssl.enabled</code> boolean Enable SSL for Elasticsearch connections. Default: <code>false</code>. <code>index.search.elasticsearch.ssl.truststore.location</code> string Path to the Java truststore file containing CA certificates. <code>index.search.elasticsearch.ssl.truststore.password</code> string Password to access the truststore. <code>index.search.elasticsearch.ssl.keystore.location</code> string Path to the Java keystore containing client certificate for mutual TLS. <code>index.search.elasticsearch.ssl.keystore.storepassword</code> string Password to access the keystore. <code>index.search.elasticsearch.ssl.keystore.keypassword</code> string Password for the private key in the keystore. <code>index.search.elasticsearch.ssl.disable-hostname-verification</code> boolean Turn off host name verification in SSL certificates. Default: <code>false</code>. <code>index.search.elasticsearch.ssl.allow-self-signed-certificates</code> boolean Accept self-signed certificates. Default: <code>false</code>. <p>For more detailed information on configuring Elasticsearch connection, refer to the official JanusGraph documentation..</p>"}, {"location": "thehive/configuration/cassandra-elasticsearch-connection-settings/#configuration-example-with-authentication-and-ssl", "title": "Configuration example with authentication and sslNext steps", "text": "<p>Database and index configuration with authentication and ssl for a standalone server installation</p> <pre><code># Content from /etc/thehive/application.conf\n[..]\n# Database and index configuration\ndb.janusgraph {\n    storage {\n        backend = cql\n        hostname = [\"127.0.0.1\"]\n        username = \"thehive\"\n        password = \"&lt;thehive_role_password&gt;\"\n        cql {\n            keyspace = thehive\n            ssl {\n                enabled = true\n                truststore {\n                    location = /path/to/&lt;truststore_file&gt;\n                    password = &lt;truststore_password&gt;\n                }\n            }\n        }\n    }\n    index.search {\n        backend = elasticsearch\n        hostname = [\"127.0.0.1\"]\n        index-name = thehive\n        elasticsearch {\n          http {\n              auth {\n                  type = basic\n                  basic {\n                      username = \"thehive\"\n                      password = \"&lt;thehive_user_password&gt;\"\n                  }\n              }\n          }\n          ssl {\n                enabled = true\n                truststore {\n                    location = /path/to/&lt;truststore_file&gt;\n                    password = &lt;truststore_password&gt;\n                }\n            }\n        }\n    }\n}\n[..]\n</code></pre> <ul> <li>Configure Database and Index Authentication</li> <li>Configure Database and Index SSL</li> </ul>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/", "title": "Configure Database and Index Authentication", "text": ""}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#configure-database-and-index-authentication", "title": "Configure Database and Index Authentication", "text": "<p>In this tutorial, we're going to secure your TheHive installation by configuring authentication for both Cassandra and Elasticsearch. By the end, you'll have password-protected access to your database and index backends.</p> <p>Maintenance window required</p> <p>This procedure involves changing configuration files and restarting services. Schedule a maintenance window to prevent service disruption.</p>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#configure-authentication-for-cassandra", "title": "Configure authentication for Cassandra", "text": ""}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-1-stop-your-services", "title": "Step 1: Stop your services", "text": "<p>First, we need to stop your running services in the following order to avoid data corruption:</p> <ol> <li> <p>Stop TheHive service</p> </li> <li> <p>Stop Cassandra service</p> </li> </ol> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-2-update-cassandra-configuration", "title": "Step 2: Update Cassandra configuration", "text": "<p>Now we'll modify Cassandra configuration to require authentication.</p> <ol> <li> <p>Locate the <code>cassandra.yaml</code> file.</p> </li> <li> <p>Open the <code>cassandra.yaml</code> file using a text editor.</p> </li> <li> <p>In the <code>cassandra.yaml</code> file, enable authentication.</p> <p>Set the following parameters with these exact values:</p> <pre><code>authenticator: PasswordAuthenticator\nauthorizer: CassandraAuthorizer \n</code></pre> </li> <li> <p>Save your modifications in the <code>cassandra.yaml</code> file.</p> </li> <li> <p>Restart Cassandra service.</p> </li> </ol>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-3-set-a-secure-password-for-authentication", "title": "Step 3: Set a secure password for authentication", "text": "<p>By default, Cassandra uses the <code>cassandra</code> username and the password <code>cassandra</code>. For security reasons, especially in production environments, you must change this password immediately after setup.</p> <p>To do this, we'll use CQL, the Cassandra Query Language, which is similar in purpose to SQL.</p> <ol> <li> <p>Connect to Cassandra using default credentials.</p> <pre><code>cqlsh -u cassandra -p cassandra\n</code></pre> <p>Cqlsh may not be available on RPM-based systems</p> <p>On some RPM-based distributions, the <code>cqlsh</code> client isn't included with the <code>cassandra</code> package. If running cqlsh gives an error, download the official Apache Cassandra tarball that matches your server version and extract it. Then run the bundled client: <code>./bin/cqlsh -u cassandra -p cassandra</code>.</p> <p>If the connection is successful, you'll see output similar to:</p> <pre><code>Connected to xxx at xx.xx.xx.xx:xxxx\n[cqlsh 6.1.0 | Cassandra 4.1.9 | CQL spec 3.4.6 | Native protocol v5]\n</code></pre> </li> <li> <p>Change the default password.</p> <pre><code>ALTER USER cassandra WITH PASSWORD '&lt;authentication_cassandra_password&gt;';\n</code></pre> <p>Replace <code>&lt;authentication_cassandra_password&gt;</code> with the password you intend to use for the <code>cassandra</code> superuser account.</p> </li> <li> <p>Disconnect from the session.</p> <p>Press Ctrl+D to exit the <code>cqlsh</code> shell.</p> </li> <li> <p>Reconnect using your new password.</p> <pre><code>cqlsh -u cassandra\n</code></pre> </li> </ol>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-4-create-a-new-administrator-role-for-authentication", "title": "Step 4: Create a new administrator role for authentication", "text": "<p>To avoid relying on the default <code>cassandra</code> superuser account, create a new administrator role and then delete the default user.</p> <ol> <li> <p>Create the <code>admin</code> role.</p> <pre><code>CREATE ROLE admin WITH PASSWORD = '&lt;authentication_admin_password&gt;' AND LOGIN = true AND SUPERUSER = true;\n</code></pre> <p>Replace <code>&lt;authentication_admin_password&gt;</code> with the password you intend to use for the <code>admin</code> superuser account.</p> </li> <li> <p>Disconnect from the session.</p> <p>Press Ctrl+D to exit the <code>cqlsh</code> shell.</p> </li> <li> <p>Reconnect as the new admin.</p> <pre><code>cqlsh -u admin\n</code></pre> </li> <li> <p>Remove the default <code>cassandra</code> user.</p> <pre><code>DROP ROLE cassandra;\n</code></pre> </li> </ol>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-5-create-a-role-for-thehive", "title": "Step 5: Create a role for TheHive", "text": "<p>Let's create a dedicated role that TheHive will use to connect to Cassandra.</p> <ol> <li> <p>Create a dedicated role for TheHive.</p> <pre><code>CREATE ROLE thehive WITH LOGIN = true AND PASSWORD = '&lt;thehive_role_password&gt;';\n</code></pre> <p>Replace <code>&lt;thehive_role_password&gt;</code> with the password you intend to use for the <code>thehive</code> role.</p> <p>Note this password</p> <p>Keep this password secure. You will need to enter it later in TheHive configuration file so the application can connect to the Cassandra database.</p> </li> <li> <p>Grant access to the keyspace.</p> <pre><code>GRANT ALL PERMISSIONS ON KEYSPACE thehive TO 'thehive';\n</code></pre> </li> </ol>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-6-update-thehive-configuration", "title": "Step 6: Update TheHive configuration", "text": "<p>Now we'll configure TheHive to use the credentials we just created.</p> <ol> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>In the <code>application.conf</code> file, update the database configuration.</p> <p>Example of database configuration with authentication</p> <pre><code>[..]\n# Database and index configuration\ndb.janusgraph {\n    storage {\n        [..]\n        # Cassandra authentication\n        username = \"thehive\"\n        password = \"&lt;thehive_role_password&gt;\"\n        cql {\n            keyspace = thehive\n        }\n    }\n    index.search {\n        [..]\n    }\n}\n[..]\n</code></pre> <p>Replace <code>&lt;thehive_role_password&gt;</code> with the password set in Step 5.</p> <p>To set up SSL for Cassandra connections, see Configure Database and Index SSL.</p> <p>For additional connection parameters and advanced options, see TheHive Database and Index Connection Settings.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol> <p>At this point, your Cassandra database is secured with authentication.</p>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#configure-authentication-for-elasticsearch", "title": "Configure authentication for Elasticsearch", "text": ""}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-1-stop-services", "title": "Step 1: Stop services", "text": "<p>First, we need to stop your running services in the following order to avoid data corruption:</p> <ol> <li> <p>Stop TheHive service</p> </li> <li> <p>Stop Elasticsearch service</p> </li> </ol>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-2-update-elasticsearch-configuration", "title": "Step 2: Update Elasticsearch configuration", "text": "<p>Now we'll modify Elasticsearch configuration to require authentication.</p> <ol> <li> <p>Open the <code>/etc/elasticsearch/elasticsearch.yml</code> file using a text editor.</p> </li> <li> <p>In the <code>elasticsearch.yml</code> file, add the desired security parameters from the official Elasticsearch security settings documentation.</p> <p>At minimum add the following line (or edit it if it already exists):</p> <pre><code>xpack.security.enabled: true\n</code></pre> </li> <li> <p>Restart Elasticsearch service.</p> </li> </ol>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-3-set-a-user-with-the-right-permissions-for-thehive", "title": "Step 3: Set a user with the right permissions for TheHive", "text": "<ol> <li> <p>Create a <code>thehive</code> user.</p> <pre><code>sudo /usr/share/elasticsearch/bin/elasticsearch-users useradd thehive -p &lt;thehive_user_password&gt; -r superuser\n</code></pre> <p>Replace <code>&lt;thehive_user_password&gt;</code> with a secure password you choose for your TheHive user.</p> <p>Note this password</p> <p>Keep this password secure. You will need to enter it later in TheHive configuration file so the application can connect to Elasticsearch.</p> </li> <li> <p>Optional: Set a password for the <code>elastic</code> user.</p> <ul> <li>For Elasticsearch 7.x:</li> </ul> <pre><code>sudo /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive\n</code></pre> <ul> <li>For Elasticsearch 8.0:</li> </ul> <pre><code>sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password\n</code></pre> <p>Skip this step if the password is already set.</p> </li> <li> <p>Create or update a role with the privileges needed for TheHive.</p> <ul> <li>Create a role:</li> </ul> <pre><code>curl -u elastic:&lt;elastic_user_password&gt; -X POST \"http://localhost:9200/_security/role/thehive_role\" -H \"Content-Type: application/json\" -d '\n{\n  \"cluster\": [\"manage\"],\n  \"indices\": [\n    {\n      \"names\": [\"thehive*\"],\n      \"privileges\": [\"all\"]\n    }\n  ]\n}'\n</code></pre> <p>Replace <code>&lt;elastic_user_password&gt;</code> with the password you set for the <code>elastic</code> user.</p> <p>If successful, the command should return: <code>{\"role\":{\"created\":true}}</code>.</p> <p>For more details, refer to the official Elasticsearch API documentation for role creation.</p> <ul> <li>Update a role:</li> </ul> <pre><code>curl -u elastic:&lt;elastic_user_password&gt; -X PUT \"http://localhost:9200/_security/role/&lt;role&gt;\" -H \"Content-Type: application/json\" -d '\n{\n  \"cluster\": [\"manage\"],\n  \"indices\": [\n    {\n      \"names\": [\"thehive*\"],\n      \"privileges\": [\"all\"]\n    }\n  ]\n}'\n</code></pre> <p>Replace <code>&lt;role&gt;</code> with the actual role name you want to update.</p> <p>Replace <code>&lt;elastic_user_password&gt;</code> with the password you set for the <code>elastic</code> user.</p> <p>For more details, refer to the official Elasticsearch API documentation for updating roles.</p> </li> <li> <p>Assign the role to the user you'll use for TheHive.</p> <pre><code>curl -u elastic:&lt;elastic_user_password&gt; -X PUT \"http://localhost:9200/_security/user/thehive\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n    \"password\" : \"&lt;thehive_user_password&gt;\",\n    \"roles\" : [\"thehive_role\"]\n}'\n</code></pre> <p>Replace <code>&lt;thehive_user_password&gt;</code> with the password you set for the <code>thehive</code> user.</p> <p>Replace <code>&lt;elastic_user_password&gt;</code> with the password you set for the <code>elastic</code> user.</p> <p>Replace <code>thehive_role</code> with actual role name if different.</p> <p>If successful, the command should return: <code>{\"created\":true}</code>.</p> <p>For more details, refer to the official Elasticsearch API documentation for updating users.</p> </li> </ol>"}, {"location": "thehive/configuration/configure-authentication-cassandra-elasticsearch/#step-4-update-thehive-configuration", "title": "Step 4: Update TheHive configuration", "text": "<p>Now we'll configure TheHive to use the credentials we just created.</p> <ol> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>In the <code>application.conf</code> file, update the index configuration.</p> <p>Example of index configuration with authentication</p> <pre><code>[..]\n# Database and index configuration\ndb.janusgraph {\n    storage {\n        [..]\n    }\n    index.search {\n        [..]\n        # Elasticsearch authentication\n        elasticsearch {\n            http {\n                auth {\n                    type = basic\n                    basic {\n                        username = \"thehive\"\n                        password = \"&lt;thehive_user_password&gt;\"\n                    }\n                }\n            }\n        }\n    }\n}\n[..]\n</code></pre> <p>Replace <code>&lt;thehive_user_password&gt;</code> with the password set in Step 3.</p> <p>To set up SSL for Elasticsearch connections, see Configure Database and Index SSL.</p> <p>For additional connection parameters and advanced options, see TheHive Database and Index Connection Settings.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol> <p>At this point, Elasticsearch is secured and requires valid credentials for access.</p> Next steps <ul> <li>Configure Database and Index SSL</li> </ul>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/", "title": "Configure Database and Index SSL", "text": ""}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#configure-database-and-index-ssl", "title": "Configure Database and Index SSL", "text": "<p>In this tutorial, we're going to enable SSL/TLS for both Cassandra and Elasticsearch to secure communication with TheHive. By the end, all connections to the database and index backends will be encrypted in transit.</p> <p>Maintenance window required</p> <p>This procedure involves changing configuration files and restarting services. Schedule a maintenance window to prevent service disruption.</p>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#configure-ssl-for-cassandra", "title": "Configure SSL for Cassandra", "text": ""}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#step-1-stop-thehive-service", "title": "Step 1: Stop TheHive service", "text": "<p>Stop TheHive before applying changes to avoid conflicts.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#optional-step-2-configure-java-virtual-machine-jvm-trust-for-cassandra-ssl-certificates", "title": "(Optional) Step 2: Configure Java Virtual Machine (JVM) trust for Cassandra SSL certificates", "text": "<p>Java applications such as TheHive rely on a Java trust store to validate SSL/TLS certificates. By default, the JVM trusts only well-known certificate authorities (CAs).</p> <p>If you use self-signed certificates or internal CAs, you must configure the JVM to trust them.</p> <p>See Configure JVM Trust for SSL Certificates for instructions.</p>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#step-3-update-thehive-configuration", "title": "Step 3: Update TheHive configuration", "text": "<ol> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>In the <code>application.conf</code> file, update the database configuration.</p> <p>Example of database configuration with SSL</p> <pre><code>[..]\n# Database and index configuration\ndb.janusgraph {\n    storage {\n        [..]\n        cql {\n            ssl {\n                enabled = true\n                truststore {\n                    location = /path/to/&lt;truststore_file&gt;\n                    password = &lt;truststore_password&gt;\n                }\n            }\n        }\n    }\n    index.search {\n        [..]\n    }\n}\n[..]\n</code></pre> <p>For additional connection parameters and advanced options, see TheHive Database and Index Connection Settings.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> </ol>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#step-4-restart-thehive-service", "title": "Step 4: Restart TheHive service", "text": "<p>Restart TheHive to apply the new configuration.</p>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#configure-ssl-for-elasticsearch", "title": "Configure SSL for Elasticsearch", "text": ""}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#step-1-stop-thehive-service_1", "title": "Step 1: Stop TheHive service", "text": "<p>Stop TheHive before applying changes to avoid conflicts.</p>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#optional-step-2-configure-java-virtual-machine-jvm-trust-for-elasticsearch-ssl-certificates", "title": "(Optional) Step 2: Configure Java Virtual Machine (JVM) trust for Elasticsearch SSL certificates", "text": "<p>Java applications such as TheHive rely on a Java trust store to validate SSL/TLS certificates. By default, the JVM trusts only well-known certificate authorities (CAs).</p> <p>If you use self-signed certificates or internal CAs, you must configure the JVM to trust them.</p> <p>See Configure JVM Trust for SSL Certificates for instructions.</p>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#step-3-update-thehive-configuration_1", "title": "Step 3: Update TheHive configuration", "text": "<ol> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>In the <code>application.conf</code> file, update the index configuration.</p> <p>Example of index configuration with SSL</p> <pre><code>[..]\n# Database and index configuration\ndb.janusgraph {\n    storage {\n        [..]\n    }\n    index.search {\n        [..]\n        elasticsearch {\n            ssl {\n                enabled = true\n                truststore {\n                    location = /path/to/&lt;truststore_file&gt;\n                    password = &lt;truststore_password&gt;\n                }\n            }\n        }\n    }\n}\n[..]\n</code></pre> <p>For additional connection parameters and advanced options, see TheHive Database and Index Connection Settings.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> </ol>"}, {"location": "thehive/configuration/configure-ssl-cassandra-elasticsearch/#step-4-restart-thehive-service_1", "title": "Step 4: Restart TheHive service", "text": "<p>Restart TheHive to apply the new configuration.</p> Next steps <ul> <li>Configure Database and Index Authentication</li> </ul>"}, {"location": "thehive/configuration/enable-gdpr/", "title": "Enable GDPR Compliance Feature", "text": ""}, {"location": "thehive/configuration/enable-gdpr/#enable-the-gdpr-compliance-feature", "title": "Enable the GDPR Compliance Feature", "text": "<p>5.0 Platinum</p> <p>In this tutorial, we're going to configure TheHive to automatically manage data retention according to GDPR requirements. By the end, you'll have automated data cleanup running on a schedule, ensuring your organization maintains compliance with data protection regulations.</p> <p>Maintenance window required</p> <p>This procedure involves changing configuration files and restarting services. Schedule a maintenance window to prevent service disruption.</p>"}, {"location": "thehive/configuration/enable-gdpr/#step-1-choose-your-gdpr-strategy", "title": "Step 1: Choose your GDPR strategy", "text": "<p>Let's decide how TheHive should handle data that exceeds your retention period. We've two strategies available, each suited to different compliance needs.</p>"}, {"location": "thehive/configuration/enable-gdpr/#option-1-delete-strategy", "title": "Option 1: Delete strategy", "text": "<p>This strategy permanently removes documents older than the retention period.</p> <p>It affects:</p> <ul> <li>Cases and associated components (tasks, task logs, procedures in TTPs, comments, pages, custom events in timelines, custom field values, attachments, and observables)</li> <li>Alerts and associated components (procedures in TTPs, comments, custom field values, attachments, and observables)</li> <li>Audit logs</li> </ul> <p>Choose this strategy if you need complete data removal for compliance.</p>"}, {"location": "thehive/configuration/enable-gdpr/#option-2-redact-strategy", "title": "Option 2: Redact strategy", "text": "<p>This strategy replaces sensitive values with <code>&lt;redacted&gt;</code>.</p> <p>For cases, it redacts:</p> <ul> <li><code>summary</code> and <code>message</code> of the case</li> <li><code>message</code> of comments</li> <li><code>message</code> in task logs</li> <li><code>message</code> of observables: deleted if they belong to the data type included in the <code>gdpr.dataTypesToDelete</code> configuration property, otherwise replaced with <code>&lt;redacted&gt;</code>.</li> <li><code>content</code> of pages</li> <li><code>description</code> of procedures in TTPs</li> </ul> <p>Attachments not redacted</p> <p>Attachments remain visible and accessible. You must manually delete them to fully remove sensitive data.</p> <p>For alerts, it redacts:</p> <ul> <li><code>message</code> of the alert</li> <li><code>message</code> of observables: deleted if they belong to the data type included in the <code>gdpr.dataTypesToDelete</code> configuration property, otherwise replaced with <code>&lt;redacted&gt;</code>.</li> <li><code>description</code> of procedures in TTPs</li> </ul> <p>Attachments not redacted</p> <p>Attachments remain visible and accessible. You must manually delete them to fully remove sensitive data.</p> <p>For audit logs, it redacts:</p> <ul> <li><code>details</code></li> </ul>"}, {"location": "thehive/configuration/enable-gdpr/#step-2-stop-thehive-service", "title": "Step 2: Stop TheHive service", "text": "<p>Stop TheHive before applying changes to avoid conflicts.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p>"}, {"location": "thehive/configuration/enable-gdpr/#step-3-configure-gdpr-settings-in-thehive", "title": "Step 3: Configure GDPR settings in TheHive", "text": "<p>Now we'll add the GDPR configuration.</p> <ol> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>Add the GDPR configuration block.</p> <p>Here's an example using the <code>delete</code> strategy:</p> <pre><code>gdpr {\n  enabled = true\n  schedule = \"0 30 2 ? * SUN\"\n  strategy = \"delete\"\n  # dataTypesToDelete = [] ## [\"ip\", \"domain\"]\n  retentionPeriod = 730 days\n\n  ## Advanced parameters (modify only if needed)\n\n  jobTimeout = 24 days ## Maximum time the job can run before being stopped\n  batchSizeCase = 5     ## How many cases are processed per transaction\n  batchSizeAlert = 10   ## How many alerts are processed per transaction\n  batchSizeAudit = 100  ## How many audit logs are processed per transaction\n}\n</code></pre> </li> <li> <p>Customize the configuration for your needs.</p> <p>a. Adjust the schedule of the job.</p> <p>Use this Cron tutorial for more information.</p> <p>b. Choose your strategy.</p> <p>Keep <code>delete</code> for complete removal. Change to <code>redact</code> for sensitive data replacement.</p> <p>If you've chosen <code>redact</code>, uncomment the <code>dataTypesToDelete</code> parameter and enter the observable data types you want to delete. Other data types will be replaced with <code>&lt;redacted&gt;</code>.</p> <p>c. Set your retention period.</p> <p>It's calculated based on the last update date, or creation date if never updated.</p> <p>The format for <code>retentionPeriod</code> supports various time units:</p> <ul> <li>day:         <code>d</code>, <code>day</code></li> <li>hour:        <code>h</code>, <code>hr</code>, <code>hour</code></li> <li>minute:      <code>m</code>, <code>min</code>, <code>minute</code></li> <li>second:      <code>s</code>, <code>sec</code>, <code>second</code></li> <li>millisecond: <code>ms</code>, <code>milli</code>, <code>millisecond</code></li> </ul> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> </ol>"}, {"location": "thehive/configuration/enable-gdpr/#step-4-restart-thehive-service", "title": "Step 4: Restart TheHive service", "text": "<p>Restart TheHive to apply the new configuration.</p>"}, {"location": "thehive/configuration/enable-gdpr/#step-5-verify-gdpr-job-scheduling", "title": "Step 5: Verify GDPR job schedulingNext steps", "text": "<p>Let's check TheHive logs for GDPR initialization:</p> <pre><code>grep -i \"gdpr\" /var/log/thehive/application.log\n</code></pre> <p>You should see confirmation that GDPR is enabled and scheduled.</p> <ul> <li>Perform Initial Login and Setup as an Admin</li> </ul>"}, {"location": "thehive/configuration/pekko/", "title": "Pekko (Version 5.4+)", "text": ""}, {"location": "thehive/configuration/pekko/#pekko-configuration-version-54", "title": "Pekko Configuration (Version 5.4+)", "text": "<p>5.4</p> <p>With the release of version 5.4, TheHive transitioned from the Scala framework Akka to Apache Pekko. This change enhances performance and introduces several updates that may require modifications to your <code>application.conf</code> file.</p> <p>This topic provides instructions on updating your configuration to support this change.</p> <p>Version compatibility </p> <p>This documentation applies to TheHive version 5.4 and later. For instructions related to earlier versions, refer to the Akka Configuration topic.</p>"}, {"location": "thehive/configuration/pekko/#basic-configuration", "title": "Basic configuration", "text": "<p>For a reliable cluster setup, it's essential to have a minimum of three nodes for TheHive application. Configure each node with Pekko as outlined below:</p> <pre><code>## Pekko server\npekko {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    canonical {\n      hostname = \"&lt;HOSTNAME OR IP_ADDRESS&gt;\"\n      port = 7355\n    }\n  }\n\n  cluster.seed-nodes = [ \n    \"pekko://application@HOSTNAME1:7355\", \n    \"pekko://application@HOSTNAME2:7355\", \n    \"pekko://application@HOSTNAME3:7355\" \n  ]\n\n  cluster.min-nr-of-members = 2  # Set to the minimum number of nodes required\n}\n</code></pre> <p>In this configuration:</p> <ul> <li>Set <code>remote.artery.canonical.hostname</code> to the host name or IP address of the node.</li> <li>Include the same list of Pekko node addresses in <code>cluster.seed-nodes</code> to ensure the nodes start consistently. If you want a specific node to initiate the cluster, place its address at the top of the seed-nodes list. The order can vary across nodes, as long as each node contains the full list of cluster addresses.</li> </ul> <p>Configuration of a cluster with three nodes</p> Node 1Node 2Node 3 <p>Pekko configuration for node 1:</p> <pre><code>pekko {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    canonical {\n      hostname = \"10.1.2.1\"\n      port = 7355\n    }\n  }\n  cluster.seed-nodes = [\n    \"pekko://application@10.1.2.1:7355\",\n    \"pekko://application@10.1.2.2:7355\",\n    \"pekko://application@10.1.2.3:7355\"\n  ]\n\n  cluster.min-nr-of-members = 2\n}\n</code></pre> <p>Pekko configuration for node 2:</p> <pre><code>pekko {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    canonical {\n      hostname = \"10.1.2.2\"\n      port = 7355\n    }\n  }\n  cluster.seed-nodes = [\n    \"pekko://application@10.1.2.1:7355\",\n    \"pekko://application@10.1.2.2:7355\",\n    \"pekko://application@10.1.2.3:7355\"\n  ]\n\n  cluster.min-nr-of-members = 2\n}\n</code></pre> <p>Pekko configuration for node 3:</p> <pre><code>pekko {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    canonical {\n      hostname = \"10.1.2.3\"\n      port = 7355\n    }\n  }\n  cluster.seed-nodes = [\n    \"pekko://application@10.1.2.1:7355\",\n    \"pekko://application@10.1.2.2:7355\",\n    \"pekko://application@10.1.2.3:7355\"\n  ]\n\n  cluster.min-nr-of-members = 2\n}\n</code></pre>"}, {"location": "thehive/configuration/pekko/#ssltls-support", "title": "SSL/TLS supportNext steps", "text": "<p>Pekko offers robust support for SSL/TLS encryption, ensuring secure communication between nodes. Below is a standard configuration to enable SSL/TLS support:</p> <pre><code>## Pekko server with SSL/TLS\npekko {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    transport = tls-tcp\n    canonical {\n      hostname = \"&lt;HOSTNAME_OR_IP_ADDRESS&gt;\"\n      port = 7355\n    }\n    ssl.config-ssl-engine {\n      key-store = \"&lt;PATH_TO_KEYSTORE&gt;\"\n      trust-store = \"&lt;PATH_TO_TRUSTSTORE&gt;\"\n      key-store-password = \"change_me\"\n      key-password = \"change_me\"\n      trust-store-password = \"change_me\"\n      protocol = \"TLSv1.2\"\n    }\n  }\n  cluster.seed-nodes = [\n    \"pekko://application@HOSTNAME1:7355\",\n    \"pekko://application@HOSTNAME2:7355\",\n    \"pekko://application@HOSTNAME3:7355\"\n  ]\n\n  cluster.min-nr-of-members = 2\n}\n</code></pre> <p>Certificate considerations</p> <p>Ensure you use your internal PKI (Public Key Infrastructure) or keytool commands to generate certificates.</p> <p>For detailed instructions, see: Using keytool for Certificate Generation.</p> <p>Your server certificates should include the following KeyUsage and ExtendedkeyUsage extensions for proper functioning:</p> <ul> <li>KeyUsage extensions<ul> <li><code>nonRepudiation</code></li> <li><code>dataEncipherment</code></li> <li><code>digitalSignature</code></li> <li><code>keyEncipherment</code></li> </ul> </li> <li>ExtendedkeyUsage extensions<ul> <li><code>serverAuth</code></li> <li><code>clientAuth</code></li> </ul> </li> </ul> <p>Pekko configuration with SSL/TLS for node 1</p> <pre><code>## Pekko server\npekko {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\n  remote.artery {\n    transport = tls-tcp\n    canonical {\n      hostname = \"10.1.2.1\"\n      port = 7355\n    }\n\n    ssl.config-ssl-engine {\n      key-store = \"/etc/thehive/application.conf.d/certs/10.1.2.1.jks\"\n      trust-store = \"/etc/thehive/application.conf.d/certs/internal_ca.jks\"\n\n      key-store-password = \"chamgeme\"\n      key-password = \"chamgeme\"\n      trust-store-password = \"chamgeme\"\n\n      protocol = \"TLSv1.2\"\n    }\n  }\n\n  cluster.seed-nodes = [ \n    \"pekko://application@10.1.2.1:7355\", \n    \"pekko://application@10.1.2.2:7355\", \n    \"pekko://application@10.1.2.3:7355\" \n  ]\n\n  cluster.min-nr-of-members = 2\n}\n</code></pre> <p>Ensure to apply the same principle for configuring other nodes, and remember to restart all services afterward.</p> <p>Session security key requirement</p> <p>Starting with version 5.4, the <code>secret.conf</code> file must include a secret key of at least 32 characters for session security, as required by Play Framework 3. In clustered environments, all nodes must use the same key to maintain consistency across the deployment.</p> <ul> <li>Configure JVM Trust for SSL/TLS Certificates</li> <li>Update TheHive Service Configuration</li> <li>Turn Off The Cortex Integration</li> <li>Turn Off The MISP Integration</li> <li>Update Log Configuration</li> <li>Update TheHive Service Configuration</li> <li>Enable the GDPR Compliance Feature</li> </ul>"}, {"location": "thehive/configuration/proxy-settings/", "title": "Proxy Settings", "text": ""}, {"location": "thehive/configuration/proxy-settings/#proxy-settings", "title": "Proxy Settings", "text": "<p>TheHive can route HTTP connections through proxy servers for external communications. By default, TheHive inherits Java virtual machine (JVM) proxy settings, but you can configure specific proxy parameters in the application configuration.</p>"}, {"location": "thehive/configuration/proxy-settings/#global-application-proxy-parameters", "title": "Global application proxy parametersNext steps", "text": "<p>Configure these parameters in the <code>application.conf</code> file to define proxy settings for all HTTP clients in TheHive.</p> Parameter Type Description <code>wsConfig.proxy.host</code> string Host name or IP address of the proxy server. <code>wsConfig.proxy.port</code> integer Port number of the proxy server. <code>wsConfig.proxy.protocol</code> string Protocol for proxy connection (<code>http</code> or <code>https</code>). Default: <code>http</code>. <code>wsConfig.proxy.user</code> string Username for proxy authentication. <code>wsConfig.proxy.password</code> string Password for proxy authentication. <code>wsConfig.proxy.ntlmDomain</code> string Domain name for NTLM proxy authentication. <code>wsConfig.proxy.encoding</code> string Character encoding for authentication realm. <code>wsConfig.proxy.nonProxyHosts</code> list Host names or patterns that bypass the proxy. <ul> <li>Update TheHive Service Configuration</li> </ul>"}, {"location": "thehive/configuration/turn-off-cortex-connector/", "title": "Turn Off the Cortex Integration", "text": ""}, {"location": "thehive/configuration/turn-off-cortex-connector/#turn-off-the-cortex-integration", "title": "Turn Off the Cortex Integration", "text": "<p>Turn off the Cortex integration if you don't use Cortex analyzers or responders.</p> <p>Maintenance window required</p> <p>This procedure involves changing configuration files and restarting services. Schedule a maintenance window to prevent service disruption.</p> Procedure <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>Uncomment the following line:</p> <pre><code>scalligraph.disabledModules += org.thp.thehive.connector.cortex.CortexModule\n</code></pre> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol> Next steps <ul> <li>Perform Initial Login and Setup as an Admin</li> </ul>"}, {"location": "thehive/configuration/turn-off-misp-connector/", "title": "Turn Off the MISP Integration", "text": ""}, {"location": "thehive/configuration/turn-off-misp-connector/#turn-off-the-misp-integration", "title": "Turn Off the MISP Integration", "text": "<p>Turn off the MISP integration if you don't use MISP events. MISP taxonomies remain available as they're imported during TheHive installation.</p> <p>Maintenance window required</p> <p>This procedure involves changing configuration files and restarting services. Schedule a maintenance window to prevent service disruption.</p> Procedure <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>Uncomment the following line:</p> <pre><code>scalligraph.disabledModules += org.thp.thehive.connector.misp.MispModule\n</code></pre> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol> Next steps <ul> <li>Perform Initial Login and Setup as an Admin</li> </ul>"}, {"location": "thehive/configuration/update-log-configuration/", "title": "Update Log Configuration", "text": ""}, {"location": "thehive/configuration/update-log-configuration/#update-log-configuration", "title": "Update Log Configuration", "text": "<p>TheHive uses logback for logging. You can adjust log levels to control the amount of information recorded for troubleshooting and monitoring purposes. By default, logs are stored in <code>/var/log/thehive/</code>, with the current log in <code>application.log</code> and older logs compressed as <code>application.%i.log.zip</code>.</p> <p>Maintenance window required</p> <p>This procedure involves changing configuration files and restarting services. Schedule a maintenance window to prevent service disruption.</p>"}, {"location": "thehive/configuration/update-log-configuration/#adjust-log-levels", "title": "Adjust log levels", "text": "<p>Control the detail of logged information by modifying log levels in the logback configuration. Higher log levels capture more detailed information for troubleshooting.</p> <p>Docker deployment</p> <p>Docker containers write logs to both stdout and <code>/var/log/thehive/application.log</code> by default. To use custom logging settings, mount your logback configuration file to <code>/etc/thehive/logback.xml</code>.</p> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>logback.xml</code> file using a text editor.</p> </li> <li> <p>Modify the log level based on your needs.</p> <ul> <li>To set a global log level:</li> </ul> <pre><code>&lt;!-- ... --&gt;\n&lt;root level=\"&lt;log_level&gt;\"&gt;\n    &lt;!-- ... --&gt;\n&lt;/root&gt;\n</code></pre> <ul> <li>To set a specific logger level:</li> </ul> <pre><code>&lt;logger name=\"&lt;logger_name&gt;\" level=\"log_level\"/&gt;\n</code></pre> </li> <li> <p>Choose the appropriate log level from least to most verbose.</p> <ul> <li>OFF: No logging</li> <li>ERROR: Only errors</li> <li>WARN: Warnings and errors</li> <li>INFO: General information (default)</li> <li>DEBUG: Detailed debugging information</li> <li>TRACE: Very detailed trace information</li> </ul> <p>Performance impact</p> <p>Setting log levels to <code>DEBUG</code> or <code>TRACE</code> significantly increases log volume and may impact performance. Use these levels only for troubleshooting, then return to <code>INFO</code> for normal operation.</p> </li> <li> <p>Save your modifications in the <code>logback.xml</code> file.</p> </li> <li> <p>Restart TheHive service to apply the new configuration.</p> </li> </ol>"}, {"location": "thehive/configuration/update-log-configuration/#debug-logback-configuration", "title": "Debug logback configuration", "text": "<p>Enable logback debug mode to troubleshoot logging configuration issues. This displays logback internal status messages in the console during TheHive startup.</p> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>logback.xml</code> file using a text editor.</p> </li> <li> <p>Set the debug attribute to <code>true</code>.</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration debug=\"true\"&gt;\n</code></pre> </li> <li> <p>Save your modifications in the <code>logback.xml</code> file.</p> </li> <li> <p>Restart TheHive service to apply the new configuration.</p> </li> <li> <p>Check the console output for logback configuration details during startup.</p> </li> </ol>"}, {"location": "thehive/configuration/update-log-configuration/#create-an-access-log", "title": "Create an access log", "text": "<p>Separate access logs from application logs by configuring dedicated log appenders. This allows you to track API requests and user access patterns independently from system logs.</p> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>logback.xml</code> file using a text editor.</p> </li> <li> <p>Add an appender for access logs after the existing appenders:</p> <pre><code>&lt;!-- ... other appenders and settings --&gt;\n&lt;appender name=\"ACCESSFILE\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;\n    &lt;file&gt;/var/log/thehive/access.log&lt;/file&gt;\n    &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.FixedWindowRollingPolicy\"&gt;\n        &lt;fileNamePattern&gt;/var/log/thehive/access.%i.log.zip&lt;/fileNamePattern&gt;\n        &lt;minIndex&gt;1&lt;/minIndex&gt;\n        &lt;maxIndex&gt;10&lt;/maxIndex&gt;\n    &lt;/rollingPolicy&gt;\n    &lt;triggeringPolicy class=\"ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy\"&gt;\n        &lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;\n    &lt;/triggeringPolicy&gt;\n\n    &lt;encoder&gt;\n        &lt;pattern&gt;%date [%level] from %logger [%traceID] %message%n%xException&lt;/pattern&gt;\n    &lt;/encoder&gt;\n&lt;/appender&gt;\n\n&lt;appender name=\"ASYNCACCESSFILE\" class=\"ch.qos.logback.classic.AsyncAppender\"&gt;\n    &lt;appender-ref ref=\"ACCESSFILE\"/&gt;\n&lt;/appender&gt;\n&lt;root level=\"INFO\"&gt;\n    &lt;!-- other appender-refs ... --&gt;\n&lt;/root&gt;\n</code></pre> </li> <li> <p>Configure the loggers to use the access appender.</p> <pre><code>&lt;logger name=\"org.thp.scalligraph.AccessLogFilter\"&gt;\n    &lt;appender-ref ref=\"ASYNCACCESSFILE\" /&gt;\n&lt;/logger&gt;\n&lt;logger name=\"org.thp.scalligraph.controllers.Entrypoint\"&gt;\n    &lt;appender-ref ref=\"ASYNCACCESSFILE\" /&gt;\n&lt;/logger&gt;\n</code></pre> </li> <li> <p>Adjust the <code>maxFileSize</code> and <code>maxIndex</code> parameters as needed.</p> </li> <li> <p>Save your modifications in the <code>logback.xml</code> file.</p> </li> <li> <p>Restart TheHive service to apply the new configuration.</p> </li> <li> <p>Verify access logs are being written to <code>/var/log/thehive/access.log</code>.</p> </li> </ol>"}, {"location": "thehive/configuration/update-log-configuration/#send-logs-to-syslog", "title": "Send logs to syslogNext steps", "text": "<p>Forward TheHive logs to a centralized syslog server for aggregation and monitoring.</p> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>logback.xml</code> file using a text editor.</p> </li> <li> <p>Add a syslog appender after the existing appenders.</p> <pre><code>&lt;!-- ... other appenders and settings --&gt;\n&lt;appender name=\"SYSLOG\" class=\"ch.qos.logback.classic.net.SyslogAppender\"&gt;\n    &lt;syslogHost&gt;&lt;remote_host&gt;&lt;/syslogHost&gt;\n    &lt;facility&gt;AUTH&lt;/facility&gt;\n    &lt;suffixPattern&gt;[%thread] %logger %msg&lt;/suffixPattern&gt;\n&lt;/appender&gt;\n</code></pre> </li> <li> <p>Replace <code>&lt;remote_host&gt;</code> with your syslog server's host name or IP address.</p> </li> <li> <p>Add the syslog appender to the root logger.</p> <pre><code>&lt;root level=\"INFO\"&gt;\n&lt;appender-ref ref=\"SYSLOG\" /&gt;\n&lt;!-- other appender-refs ... --&gt;\n&lt;/root&gt;\n</code></pre> </li> <li> <p>Save your modifications in the <code>logback.xml</code> file.</p> </li> <li> <p>Restart TheHive service to apply the new configuration.</p> </li> </ol> <p>Limitations</p> <p>The logback syslog appender only supports UDP protocol. For TCP or TLS connections, use a third-party appender or forward logs through a local syslog daemon. See the logback documentation for alternatives.</p> <ul> <li>Perform Initial Login and Setup as an Admin</li> </ul>"}, {"location": "thehive/configuration/update-service-configuration/", "title": "Update Service Configuration", "text": ""}, {"location": "thehive/configuration/update-service-configuration/#update-thehive-service-configuration", "title": "Update TheHive Service Configuration", "text": "<p>Modify TheHive service configuration to fit your requirements.</p> <p>Maintenance window required</p> <p>This procedure involves changing configuration files and restarting services. Schedule a maintenance window to prevent service disruption.</p>"}, {"location": "thehive/configuration/update-service-configuration/#update-the-listen-address-and-port", "title": "Update the listen address and port", "text": "<p>By default, TheHive listens on <code>all network interfaces (0.0.0.0)</code> on <code>port 9000</code>. You can change these settings to control how TheHive listens internally on the host.</p> <p>Difference from the base URL</p> <p>The listen address and port are independent of the public URL defined in <code>application.baseUrl</code>.</p> <ul> <li>Use <code>http.address</code> and <code>http.port</code> to control how the service listens on the host.</li> <li>Use <code>application.baseUrl</code> to define the public URL that TheHive communicates to clients.</li> </ul> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>Add the following configuration:</p> <pre><code>http.address=127.0.0.1\nhttp.port=9000\n</code></pre> </li> <li> <p>Modify the values  according to your requirements.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol>"}, {"location": "thehive/configuration/update-service-configuration/#update-the-base-url", "title": "Update the base URL", "text": "<p>The base URL defines the public address that users access to reach TheHive. This setting tells TheHive how to generate URLs for clients.</p> <p>Role of the base URL</p> <p>The public URL defined in <code>application.baseUrl</code> is independent of the service\u2019s listening address and port.</p> <ul> <li>Use <code>http.address</code> and <code>http.port</code> to control how the service listens on the host.</li> <li>Use <code>application.baseUrl</code> to define the public URL that TheHive communicates to clients.</li> </ul> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>Update the following line:</p> <pre><code>[..]\n# Service configuration\napplication.baseUrl = \"http://localhost:9000\"\n[..]\n</code></pre> <p>Replace <code>http://localhost:9000</code> with the actual public URL that users will use to access TheHive.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol>"}, {"location": "thehive/configuration/update-service-configuration/#mandatory-elements", "title": "Mandatory elements", "text": "<ul> <li>Protocol: Either <code>http</code> or <code>https</code>, depending on whether you configured HTTPS using a reverse proxy.</li> <li>Host name: The DNS name or IP address that users enter in their browser.</li> </ul>"}, {"location": "thehive/configuration/update-service-configuration/#optional-elements", "title": "Optional elements", "text": "<ul> <li>Port: The network port where TheHive is exposed. Include a port only when the public URL uses a non-standard port. Standard ports are <code>80</code> for HTTP and <code>443</code> for HTTPS.</li> <li>Path segments: Needed if TheHive runs behind a reverse proxy under a subpath.</li> </ul> <p>Service configuration examples</p> <ul> <li> <p>Root domain:</p> <p>Without explicit port:</p> <pre><code>application.baseUrl = \"https://thehive.example.org\"\nplay.http.context = \"/\"\n</code></pre> <p>With explicit port:</p> <pre><code>application.baseUrl = \"https://thehive.example.org:9000\"\nplay.http.context = \"/\"\n</code></pre> </li> <li> <p>Custom path behind a reverse proxy:</p> <p>Without explicit port:</p> <pre><code>application.baseUrl = \"https://example.org/thehive\"\nplay.http.context = \"/thehive\"\n</code></pre> <p>With explicit port:</p> <pre><code>application.baseUrl = \"https://example.org:9000/thehive\"\nplay.http.context = \"/thehive\"\n</code></pre> </li> </ul>"}, {"location": "thehive/configuration/update-service-configuration/#set-a-context-path", "title": "Set a context path", "text": "<p>Configure a context path when TheHive runs behind a reverse proxy under a specific URL path.</p> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>Update the following line:</p> <pre><code>[..]\n# Service configuration\nplay.http.context = \"/\"\n[..]\n</code></pre> <p>Replace <code>/</code> with your desired context path.</p> <p>For example:</p> <pre><code>play.http.context: \"/thehive\"\n</code></pre> <p>Service configuration examples</p> <ul> <li> <p>Root domain:</p> <p>Without explicit port:</p> <pre><code>application.baseUrl = \"https://thehive.example.org\"\nplay.http.context = \"/\"\n</code></pre> <p>With explicit port:</p> <pre><code>application.baseUrl = \"https://thehive.example.org:9000\"\nplay.http.context = \"/\"\n</code></pre> </li> <li> <p>Custom path behind a reverse proxy:</p> <p>Without explicit port:</p> <pre><code>application.baseUrl = \"https://example.org/thehive\"\nplay.http.context = \"/thehive\"\n</code></pre> <p>With explicit port:</p> <pre><code>application.baseUrl = \"https://example.org:9000/thehive\"\nplay.http.context = \"/thehive\"\n</code></pre> </li> </ul> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol>"}, {"location": "thehive/configuration/update-service-configuration/#configure-streams-for-reverse-proxies", "title": "Configure streams for reverse proxiesNext steps", "text": "<p>Reverse proxies like Nginx can cause <code>504 Gateway Time-Out</code> errors with TheHive long-polling requests. Configure the refresh interval to prevent these timeouts.</p> <ol> <li> <p>Stop TheHive service.</p> <p>Service commands</p> <p>For stop/restart commands depending on your installation method, refer back to the relevant installation guide.</p> </li> <li> <p>Open the <code>application.conf</code> file using a text editor.</p> </li> <li> <p>Add the following configuration:</p> <pre><code>stream.longPolling.refresh: 45 seconds\n</code></pre> <p>This setting determines how often TheHive refreshes long-polling connections to prevent proxy timeouts.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive service.</p> </li> </ol> <ul> <li>Perform Initial Login and Setup as an Admin</li> <li>Configure HTTPS for TheHive With a Reverse Proxy</li> </ul>"}, {"location": "thehive/configuration/ssl/configure-https-reverse-proxy/", "title": "Configure HTTPS Using a Reverse Proxy", "text": ""}, {"location": "thehive/configuration/ssl/configure-https-reverse-proxy/#configure-https-for-thehive-with-a-reverse-proxy", "title": "Configure HTTPS for TheHive With a Reverse Proxy", "text": "<p>Use a reverse proxy like Nginx to handle SSL/TLS encryption for TheHive. This approach simplifies certificate management and improves performance compared to configuring SSL/TLS directly in TheHive.</p> <p>For detailed instructions on configuring HTTPS servers with Nginx, refer to the Nginx documentation.</p> <p>Nginx configuration file</p> /etc/nginx/sites-available/thehive.conf<pre><code>server {\n  listen 443 ssl http2;\n  server_name thehive;\n\n  ssl on;\n  ssl_certificate       /path/to/&lt;thehive_server_chained_cert&gt;.pem;\n  ssl_certificate_key   /path/to/&lt;thehive_server_key&gt;.pem;\n\n  proxy_connect_timeout   600;\n  proxy_send_timeout      600;\n  proxy_read_timeout      600;\n  send_timeout            600;\n  client_max_body_size    2G;\n  proxy_buffering off;\n  client_header_buffer_size 8k;\n\n  location / {\n    add_header              Strict-Transport-Security \"max-age=31536000; includeSubDomains\";\n    proxy_pass              http://127.0.0.1:9000/;\n    proxy_http_version      1.1;\n  }\n}\n</code></pre> <p>Configure request size limits</p> <p>The <code>client_max_body_size</code> parameter in nginx applies to all request data, including both file uploads and text content. Set this value to match or exceed the maximum file size configured in TheHive <code>application.conf</code> to prevent upload failures. For more information, see Limit File Upload Size in NGINX.</p> <p>Additional settings</p> <p>TheHive uses JVM proxy settings by default. You can configure specific proxy settings for individual HTTP clients if needed. See Proxy Settings for available parameters.</p> <p>Required actions</p> <p>After configuring the reverse proxy, you must update TheHive configuration to work correctly with HTTPS:</p> <ul> <li>Update the base URL to use HTTPS</li> <li>Set a context path if TheHive runs under a subpath</li> <li>Configure stream refresh intervals to prevent timeout errors</li> </ul> <p>See Update TheHive Service Configuration for detailed instructions.</p> Next steps <ul> <li>Update TheHive Service Configuration</li> <li>Configure JVM Trust for SSL/TLS Certificates</li> </ul>"}, {"location": "thehive/configuration/ssl/configure-ssl-jvm/", "title": "Configure JVM SSL Trust", "text": ""}, {"location": "thehive/configuration/ssl/configure-ssl-jvm/#configure-jvm-trust-for-ssltls-certificates", "title": "Configure JVM Trust for SSL/TLS Certificates", "text": "<p>Java applications such as TheHive rely on a Java truststore to validate SSL/TLS certificates. By default, the Java virtual machine (JVM) trusts only well-known certificate authorities (CAs).</p> <p>If you use self-signed certificates or internal CAs, you must configure the JVM to trust them. This configuration is essential for authentication providers and connectors used in TheHive.</p>"}, {"location": "thehive/configuration/ssl/configure-ssl-jvm/#deb-package", "title": "DEB package", "text": "Option 1: Custom truststoreOption 2: System-wide CA certificates <ol> <li> <p>Open the <code>/etc/default/thehive</code> file.</p> </li> <li> <p>Uncomment the <code>JAVA_OPTS</code> variable.</p> </li> <li> <p>Enter the path to your truststore file containing the required CA certificates.</p> <pre><code>JAVA_OPTS=\"-Djavax.net.ssl.trustStore=/path/to/&lt;truststore_file&gt; -Djavax.net.ssl.trustStorePassword=&lt;truststore_password&gt;\"\n</code></pre> </li> <li> <p>Save your modifications.</p> </li> <li> <p>Restart TheHive service.</p> <pre><code>sudo systemctl restart thehive\n</code></pre> </li> </ol> <ol> <li> <p>Ensure the <code>ca-certificates-java</code> package is installed.</p> <pre><code>sudo apt-get install -y ca-certificates-java\n</code></pre> </li> <li> <p>Copy your CA certificates to the system directory.</p> <pre><code>sudo mkdir /usr/share/ca-certificates/extra\nsudo cp &lt;custom_certificate&gt;.crt /usr/share/ca-certificates/extra/\n</code></pre> </li> <li> <p>Reconfigure and update the Java truststore.</p> <ul> <li>When using the Amazon Corretto JVM, the default truststore is a bundled file rather than a symlink to the system truststore. System CA certificates won't be recognized until you manually replace the bundled truststore with a symlink:</li> </ul> <pre><code>sudo rm $JAVA_HOME/lib/security/cacerts\nsudo ln -s /etc/ssl/certs/java/cacerts $JAVA_HOME/lib/security/cacerts\n</code></pre> <p>Amazon Corretto JVM path on DEB</p> <p>On Debian/Ubuntu, the Amazon Corretto JVM is usually installed in <code>/usr/lib/jvm/java-11-amazon-corretto</code>.</p> <ul> <li>For other JVMs, simply run:</li> </ul> <pre><code>sudo dpkg-reconfigure ca-certificates\n</code></pre> </li> <li> <p>Restart TheHive service.</p> <pre><code>sudo systemctl restart thehive\n</code></pre> </li> </ol>"}, {"location": "thehive/configuration/ssl/configure-ssl-jvm/#rpm-package", "title": "RPM package", "text": "Option 1: Custom truststoreOption 2: System-wide CA certificates <ol> <li> <p>Open the <code>/etc/default/thehive</code> file.</p> </li> <li> <p>Uncomment the <code>JAVA_OPTS</code> variable.</p> </li> <li> <p>Enter the path to your truststore file containing the CA certificates.</p> <pre><code>JAVA_OPTS=\"-Djavax.net.ssl.trustStore=/path/to/&lt;truststore_file&gt; -Djavax.net.ssl.trustStorePassword=&lt;truststore_password&gt;\"\n</code></pre> </li> <li> <p>Save your modifications.</p> </li> <li> <p>Restart TheHive service.</p> <pre><code>sudo systemctl restart thehive\n</code></pre> </li> </ol> <ol> <li> <p>Copy the CA certificate to the system trust anchors.</p> <pre><code>sudo cp &lt;custom_certificate&gt;.crt /etc/pki/ca-trust/source/anchors/\n</code></pre> </li> <li> <p>Update CA trust.</p> <ul> <li>When using the Amazon Corretto JVM, the default truststore is a bundled file rather than a symlink to the system truststore. System CA certificates won't be recognized until you manually replace the bundled truststore with a symlink:</li> </ul> <pre><code>sudo rm $JAVA_HOME/lib/security/cacerts\nsudo ln -s /etc/pki/java/cacerts $JAVA_HOME/lib/security/cacerts\n</code></pre> <p>Amazon Corretto JVM path on RPM</p> <p>On RHEL/Fedora, the Amazon Corretto JVM is usually installed in <code>/usr/lib/jvm/java-11-amazon-corretto</code>.</p> <ul> <li>For other JVMs, simply run:</li> </ul> <pre><code>sudo update-ca-trust\n</code></pre> </li> <li> <p>Restart TheHive service.</p> <pre><code>sudo systemctl restart thehive\n</code></pre> </li> </ol>"}, {"location": "thehive/configuration/ssl/configure-ssl-jvm/#docker-environment", "title": "Docker environmentNext steps", "text": "TheHive 5.5.3 and earlierTheHive 5.5.4 and later <ol> <li> <p>Place your truststore file on the host.</p> </li> <li> <p>Mount it inside the container and pass JVM options.</p> <pre><code>docker run -d \\\n  --name &lt;thehive_container&gt; \\\n  -e \"JAVA_OPTS=-Djavax.net.ssl.trustStore=/container/path/&lt;truststore_file&gt; -Djavax.net.ssl.trustStorePassword=&lt;truststore_password&gt;\" \\\n  -v /host/path/to/&lt;truststore_file&gt;:/container/path/&lt;truststore_file&gt; \\\n  &lt;thehive_image&gt;\n</code></pre> </li> <li> <p>Restart TheHive Docker container.</p> <pre><code>docker restart &lt;thehive_container&gt;\n</code></pre> </li> </ol> <p>Starting with TheHive 5.5.4, you no longer need to build or maintain a custom truststore. You can directly mount PEM-format CA certificates, and the entrypoint automatically imports them into the JVM truststore at startup.</p> <ol> <li> <p>Store your CA certificates in a host directory.</p> <p>Multiple certificates are supported. No password is required.</p> </li> <li> <p>Mount the directory into the container.</p> <pre><code>docker run -d \\\n  --name &lt;thehive_container&gt; \\\n  -v /host/path/to/&lt;ca_certificates&gt;:/container/path/&lt;ca_certificates&gt; \\\n  &lt;thehive_image&gt;\n</code></pre> </li> <li> <p>Restart TheHive Docker container.</p> <pre><code>docker restart &lt;thehive_container&gt;\n</code></pre> </li> </ol> <p>Advanced configuration</p> <p>Most SSL/TLS requirements are handled through JVM-level configuration. For rare cases requiring TheHive-specific SSL/TLS parameters, see SSL/TLS Client Configuration.</p> <ul> <li>Configure Authentication</li> <li>Configure HTTPS for TheHive With a Reverse Proxy</li> </ul>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/", "title": "SSL/TLS Client Configuration", "text": ""}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#ssltls-client-configuration", "title": "SSL/TLS Client Configuration", "text": "<p>Authentication providers and connectors may require SSL/TLS configuration to connect securely with TheHive.</p> <p>SSL/TLS trust is typically configured at the Java virtual machine (JVM) level for certificate validation. The parameters below provide additional SSL/TLS capabilities. These parameters are defined in the TheHive <code>application.conf</code> configuration file.</p>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#configuration-parameters", "title": "Configuration parameters", "text": "<p>The following parameters control SSL/TLS behavior for outbound connections from TheHive to external services.</p> Parameter Type Description <code>wsConfig.ssl.keyManager.stores</code> list Stores client certificates <code>wsConfig.ssl.trustManager.stores</code> list Stores custom certificate authorities <code>wsConfig.ssl.protocol</code> string Defines a different default protocol <code>wsConfig.ssl.enabledProtocols</code> list List of enabled protocols <code>wsConfig.ssl.enabledCipherSuites</code> list List of enabled cipher suites <code>wsConfig.ssl.loose.acceptAnyCertificate</code> boolean Accept any certificates"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#key-manager-configuration", "title": "Key manager configuration", "text": "<p>Client certificates enable certificate-based authentication when connecting to external services that require mutual TLS authentication.</p> <pre><code>    wsConfig.ssl.keyManager {\n        stores = [\n            {\n            type = \"pkcs12\" // JKS or PEM\n            path = \"path/to/&lt;certificate_file&gt;\"\n            password = \"&lt;certificate_password&gt;\"\n            }\n        ]\n    }\n</code></pre>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#trust-manager-configuration", "title": "Trust manager configuration", "text": "<p>Custom certificate authorities extend the default JVM truststore for specific TheHive connections when system-wide trust configuration isn't suitable.</p> <pre><code>wsConfig.ssl.trustManager {\n    stores = [\n        {\n        type = \"JKS\" // JKS or PEM\n        path = \"path/to/&lt;keystore_file&gt;\"\n        password = \"&lt;keystore_password&gt;\"\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#protocol-configuration", "title": "Protocol configuration", "text": "<p>Protocol settings control which SSL/TLS versions TheHive uses for outbound connections.</p>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#default-protocol", "title": "Default protocol", "text": "<pre><code>wsConfig.ssl.protocol = \"&lt;protocol_version&gt;\"\n</code></pre> <p>Example: <code>\"TLSv1.2\"</code></p>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#enabled-protocols", "title": "Enabled protocols", "text": "<pre><code>wsConfig.ssl.enabledProtocols = [\"&lt;protocol_version_1&gt;\", \"&lt;protocol_version_2&gt;\", \"&lt;protocol_version_3&gt;\"]\n</code></pre> <p>Example: <code>[\"TLSv1.2\", \"TLSv1.1\", \"TLSv1\"]</code></p>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#cipher-suites", "title": "Cipher suites", "text": "<p>Cipher suite configuration restricts the cryptographic algorithms used for SSL/TLS connections.</p> <pre><code>wsConfig.ssl.enabledCipherSuites = [\n    \"&lt;cipher_suite_1&gt;\",\n    \"&lt;cipher_suite_2&gt;\",\n    \"&lt;cipher_suite_3&gt;\",\n    \"&lt;cipher_suite_4&gt;\",\n]\n</code></pre> <p>Example: <code>\"TLS_DHE_RSA_WITH_AES_128_GCM_SHA256\"</code>, <code>\"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\"</code>, <code>\"TLS_DHE_RSA_WITH_AES_256_GCM_SHA384\"</code>, <code>\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"</code></p>"}, {"location": "thehive/configuration/ssl/ssl-thehive-configuration-settings/#debug-configuration", "title": "Debug configurationNext steps", "text": "<p>Debug flags are available to troubleshoot SSL/TLS connections:</p> <pre><code>    wsConfig.ssl.debug = {\n    ssl = true\n    trustmanager = true\n    keymanager = true\n    sslctx = true\n    handshake = true\n    verbose = true\n    data = true\n    certpath = true\n    }\n</code></pre> <ul> <li>Configure HTTPS for TheHive With a Reverse Proxy</li> </ul>"}, {"location": "thehive/how-to/alert-management/", "title": "Alert Management", "text": ""}, {"location": "thehive/how-to/alert-management/#alert-management", "title": "Alert Management", "text": ""}, {"location": "thehive/how-to/alert-management/#alert-list", "title": "Alert list", "text": "<p>Alerts received by your organization can be viewed in TheHive:</p> <p></p> <p>Every user inside the organization can view the alerts. But you will need the permission <code>manageAlert</code> to be able to edit alerts.</p> <p>A user can use predefined filter or custom filters to view only selected alerts:</p> <p></p>"}, {"location": "thehive/how-to/alert-management/#alert-details", "title": "Alert details", "text": "<p>From the alert list, an alert can be opened for more investigation. Details are filled, comments by analysts can be made on the alert too:</p> <p></p> <p>You can use tags, comments, severity, tlp, pap, custom fields and custom statuses to help categorize your alerts.</p> <p>Observables from the alert can be further analyzed either by the analysts or by using Cortex analyzers:</p> <p></p> <p></p> <p>Finally, depending on the analyst investigation, an alert can be closed (marked as \"False Positive\", \"Duplicate\", \"Ignored\" or an other custom status) or a case can be created to pursue the investigation.</p>"}, {"location": "thehive/how-to/fail2ban/", "title": "Fail2ban Configuration", "text": ""}, {"location": "thehive/how-to/fail2ban/#fail2ban", "title": "Fail2ban", "text": "<p>Fail2ban is an intrusion prevention software designed to enhance the security of Linux systems by actively monitoring logs for suspicious activity and dynamically blocking malicious IP addresses. By automatically responding to potential threats such as repeated failed login attempts or suspicious access patterns, Fail2ban acts as a proactive defense mechanism, fortifying servers against various forms of cyberattacks.</p>"}, {"location": "thehive/how-to/fail2ban/#adding-thehive-into-fail2ban", "title": "Adding TheHive into Fail2ban", "text": "<p>To integrate TheHive logs with Fail2ban, follow the steps below. Assume TheHive logs are located at <code>/var/log/thehive/application.log</code> and Fail2ban configuration files are located in <code>/etc/fail2ban</code>.</p> <ol> <li> <p>Step 1: Create a Filter File</p> <ul> <li>Create a filter file in <code>/etc/fail2ban/filter.d</code> named <code>thehive.conf</code> with the following content:</li> </ul> <pre><code>[INCLUDES]\nbefore = common.conf\n\n[Definition]\nfailregex = ^.*- &lt;HOST&gt; (?:POST \\/api\\/login|GET .*) .*returned 401.*$\nignoreregex =\n</code></pre> </li> <li> <p>Step 2: Create a Jail File</p> <ul> <li>Create a jail file in <code>/etc/fail2ban/jail.d</code> named <code>thehive.local</code> with the following content:</li> </ul> <pre><code>[thehive]\nenabled = true\nport = 80,443\nfilter = thehive\naction = iptables-multiport[name=thehive, port=\"80,443\"]\nlogpath = /var/log/thehive/application.log\nmaxretry = 5\nbantime = 14400\nfindtime = 1200\n</code></pre> <p>This configuration will ban any IP address for 4 hours after 5 failed authentication attempts within a 20-minute period.</p> </li> <li> <p>Step 3: Reload Fail2ban Configuration</p> <ul> <li>Reload the Fail2ban configuration to apply the changes:</li> </ul> <pre><code>fail2ban-client reload\n</code></pre> </li> </ol>"}, {"location": "thehive/how-to/fail2ban/#review-banned-ip-addresses", "title": "Review Banned IP Addresses", "text": "<p>Here is a step-by-step guide to reviewing banned IP addresses on Fail2ban:</p> <ol> <li> <p>Step 1: Check Fail2ban Status:</p> <p>Use the following command to get an overview of Fail2ban status and active jails:</p> <pre><code>sudo fail2ban-client status\n</code></pre> </li> <li> <p>Step 2: Review Banned IPs for a Specific Jail</p> <p>Use this command to view banned IPs in a particular jail.</p> <pre><code>sudo fail2ban-client status thehive\n</code></pre> </li> </ol>"}, {"location": "thehive/how-to/fail2ban/#unban-an-ip-address", "title": "Unban an IP Address", "text": "<p>Use the following command to remove the ban on a specific IP address. Replace <code>jail_name</code> with the jail's name and <code>IP_address</code> with the specific IP address you want to unban:</p> <pre><code>sudo fail2ban-client set thehive unbanip 1.1.1.1\n</code></pre> <p> </p>"}, {"location": "thehive/how-to/splunk-integration/", "title": "Splunk Integration Guide", "text": ""}, {"location": "thehive/how-to/splunk-integration/#introduction", "title": "Introduction", "text": "<p>This integration, available as a Threat Intelligence Add-on (TA), streamlines the process of creating alerts in TheHive from Splunk search results. The process involves several key steps:</p> <ol> <li>Search for events and collect observables and custom fields.</li> <li>Rename Splunk fields to match the field names listed in the <code>thehive_datatypes.csv</code> lookup table.</li> <li>Save the search as an alert.</li> <li>Configure the alert action \"thehive_create_a_new_alert\" to generate alerts in TheHive.</li> <li>Customize alerts by adding additional information such as TLP per observables, custom fields, titles, descriptions, and more.</li> </ol>"}, {"location": "thehive/how-to/splunk-integration/#use-cases-examples", "title": "Use Cases Examples", "text": "<p>In order to understand the practical application of this integration, several use cases (UC1 to UC5) are presented, demonstrating how to configure alerts and cases in TheHive based on various scenarios.</p> <p>Each use case provides insights into prerequisites, Splunk search configurations, Splunk screenshots, and TheHive screenshots.</p>"}, {"location": "thehive/how-to/splunk-integration/#use-cases-detailed", "title": "Use Cases Detailed", "text": "<p>For a comprehensive understanding of each use case's parameters, including title, description, TLP, PAP, severity, observables, TTPs, and more, please refer to the original documentation.</p>"}, {"location": "thehive/how-to/splunk-integration/#tips-tricks", "title": "Tips &amp; Tricks", "text": "<p>Discover valuable insights in the \"Tips &amp; Tricks\" section, where you can learn how to efficiently populate form fields, manage observables and inline fields, and make the most of tags to enhance your alerts.</p>"}, {"location": "thehive/how-to/splunk-integration/#advanced-search-results-with-additional-tags", "title": "Advanced Search Results with Additional Tags", "text": "<p>Explore advanced techniques to enrich your search results with additional tags, including the utilization of the <code>th_inline_msg</code> field and the creative renaming of fields for improved tagging.</p> <p>For comprehensive details and examples, we encourage you to explore the original documentation to set up your connector effectively.</p> <p>To integrate this connector into your workflow, please refer to the original documentation. Your success starts there!</p>"}, {"location": "thehive/how-to/splunk-integration/#support", "title": "Support", "text": "<p>Should you have any inquiries or feedback, feel free to reach out to the author on GitHub, or seek assistance from TheHive support through the portal.</p>"}, {"location": "thehive/installation/automated-installation-script-linux/", "title": "One-Command Install", "text": ""}, {"location": "thehive/installation/automated-installation-script-linux/#quick-install-on-linux-systems-one-command-setup", "title": "Quick Install on Linux Systems: One-Command Setup", "text": "<p>If you prefer a faster setup than going through the complete installation guide, you can run the automated installation script instead. It will install TheHive along with all required services and dependencies on a standalone Linux server using predefined settings.</p> <p>Before you begin</p> <p>To ensure a smooth installation process, make sure you have:</p> <ul> <li>A basic understanding of TheHive architecture</li> <li>System requirements fully met and verified for script-based installation</li> <li>Wget installed</li> </ul> <p>No authentication configured for Cassandra and Elasticsearch</p> <p>This script doesn't set up authentication for Cassandra or Elasticsearch. For security\u2014especially in production\u2014enable authentication on both services before going live. See Configure Database and Index Authentication for instructions.</p> Procedure <ol> <li> <p>Download and run the script.</p> <pre><code>wget -q -O /tmp/install_script.sh https://scripts.download.strangebee.com/latest/sh/install_script.sh ; sudo -v ; bash /tmp/install_script.sh\n</code></pre> </li> <li> <p>Enter the number corresponding to the installation option you want to run.</p> <ul> <li>1) Setup proxy settings: Configure the host to operate behind an HTTP proxy and integrate custom certificate authorities (CAs) if needed. This ensures secure and compatible communication with external services.</li> <li>2) Install TheHive: Automatically install TheHive, including its required components and dependencies, using predefined and production-ready settings.</li> </ul> </li> <li> <p>Press Enter.</p> </li> <li> <p>Once the installation is complete, select the URL shown in the final output to start using TheHive.</p> </li> <li> <p>Perform the initial setup of the application by following the instructions in Perform Initial Login and Setup as an Admin.</p> </li> </ol> <p>If you also want to use the script to install Cortex, refer to the Cortex installation guide for additional details.</p> Next steps <ul> <li>Configure JVM Trust for SSL/TLS Certificates</li> <li>Update TheHive Service Configuration</li> <li>Turn Off The Cortex Integration</li> <li>Turn Off The MISP Integration</li> <li>Update Log Configuration</li> <li>Update TheHive Service Configuration</li> <li>Enable the GDPR Compliance Feature</li> <li>Hot Backups</li> <li>Cold Backups for Physical Servers</li> <li>Cold Backups for Virtual Servers</li> <li>Monitoring</li> <li>Troubleshooting</li> </ul>"}, {"location": "thehive/installation/deploying-a-cluster/", "title": "Set Up a Cluster on Linux", "text": ""}, {"location": "thehive/installation/deploying-a-cluster/#setting-up-a-cluster-with-thehive", "title": "Setting up a Cluster with TheHive", "text": "<p>Note</p> <ul> <li>This documentation applies to TheHive versions 5.4 and later. For earlier versions, please refer to the Akka Configuration.</li> <li>This documentation applies for a fresh installation for a new instance.</li> </ul> <p>This guide presents configuration examples for setting up a fault-tolerant cluster for TheHive. Each cluster comprises three active nodes, featuring:</p> <ul> <li>Cassandra for the database</li> <li>Elasticsearch for the indexing engine</li> <li>NFS (recommended), or S3 file storage (for example MINIO)</li> <li>TheHive</li> <li>Haproxy (to demonstrate load balancing)</li> <li>Keepalived (to demonstrate virtual IP setup)</li> </ul> <p>Info</p> <p>These applications can either be installed on separate servers or on the same server. For the purpose of this documentation, we've chosen to demonstrate the setup on three distinct operating systems.</p> <p>Before you begin</p> <p>To ensure a smooth installation process, make sure you have system requirements fully met and verified for Linux installation.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#architecture-diagram", "title": "Architecture Diagram", "text": "<p>The diagram above illustrates the key components and their interactions within the cluster architecture.</p> <p>Each component fulfills a critical role in the functionality and resilience of the cluster:</p> <ul> <li>Cassandra: Acts as the primary database, ensuring robust data storage and retrieval capabilities.</li> <li>Elasticsearch: Serves as the indexing engine, facilitating efficient search operations within TheHive platform.</li> <li>MinIO: Provides S3-compatible object storage, offering scalable and resilient storage solutions for TheHive.</li> <li>TheHive: Central component responsible for incident response management and collaboration within the cluster.</li> <li>Haproxy: Functions as a load balancer, evenly distributing incoming traffic across multiple nodes for improved performance and availability.</li> <li>Keepalived: Facilitates the setup of a virtual IP address, ensuring seamless failover and high availability by redirecting traffic to a standby node in case of failure.</li> </ul> <p>The subsequent sections will provide detailed configuration examples and step-by-step instructions for setting up each component within the cluster environment.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#cassandra-setup", "title": "Cassandra Setup", "text": "<p>When configuring a Cassandra cluster, we aim to establish a setup comprising three active nodes with a replication factor of 3. This configuration ensures that all nodes are active and data is replicated across each node, thus providing tolerance to the failure of a single node, meaning that if one node experiences hardware issues or network disruptions, the other two nodes continue to store and process incident data seamlessly. This fault-tolerant configuration guarantees uninterrupted access to critical security information, enabling the SOC to effectively manage and respond to cyber threats without downtime or data loss.</p> <p>Note: Note: For the purposes of this documentation, we assume that all nodes reside within the same network environment. Ideally, the nodes should be deployed in different racks within the same data center.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#installation-instructions", "title": "Installation Instructions", "text": "<p>To ensure the successful deployment of Cassandra within your cluster, it's essential to install Cassandra on each individual node. Follow the steps outlined in the provided guide.</p> <p>A <code>node</code> in this context refers to each server or machine designated to participate in the Cassandra cluster.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#configuration-instructions", "title": "Configuration Instructions", "text": "<p>For each node in the Cassandra cluster, it's crucial to update the configuration files located at <code>/etc/cassandra/cassandra.yaml</code> with specific parameters to ensure proper functionality. Follow the steps below to modify the configuration:</p> <ol> <li> <p>Update Cassandra Configuration File: Open the <code>/etc/cassandra/cassandra.yaml</code> file on each node using a text editor.</p> /etc/cassandra/cassandra.yaml<pre><code>cluster_name: 'thp'\nnum_tokens: 4\nauthenticator: PasswordAuthenticator\nauthorizer: CassandraAuthorizer\nrole_manager: CassandraRoleManager\ndata_file_directories:\n    - /var/lib/cassandra/data\ncommitlog_directory: /var/lib/cassandra/commitlog\nsaved_caches_directory: /var/lib/cassandra/saved_caches\nseed_provider:\n    - class_name: org.apache.cassandra.locator.SimpleSeedProvider\n    parameters:\n        - seeds: \"&lt;ip node 1&gt;, &lt;ip node 2&gt;, &lt;ip node 3&gt;\"  # (1)\nlisten_interface : eth0 # (2)\nrpc_interface: eth0 # (3)\nendpoint_snitch: GossipingPropertyFileSnitch\n</code></pre> <ol> <li>Ensure to list all IP addresses of the nodes that are included in the cluster</li> <li>Ensure to setup the right interface name</li> <li>Ensure to setup the right interface name</li> </ol> <ul> <li>Cluster Name: Set the name of the Cassandra cluster.</li> <li>Number of Tokens: Configure the number of tokens for each node.</li> <li>Authentication and Authorization: Specify the authenticator, authorizer, and role manager.</li> <li>Directories: Define directories for data, commit logs, and saved caches.</li> <li>Seed Provider: List all IP addresses of nodes included in the cluster (Ensure to list all IP addresses of the nodes that are included in the cluster).</li> <li>Network Interfaces: Set up the appropriate network interfaces (Ensure to setup the right interface name).</li> <li>Endpoint Snitch: Specify the snitch for determining network topology.</li> </ul> <p>For detailed explanations of each parameter in the YAML file, refer to our article on Cassandra configuration which can be found in the following page.</p> </li> <li> <p>Delete Cassandra Topology Properties File: Remove the <code>cassandra-topology.properties</code> file to prevent any conflicts.</p> <pre><code>rm /etc/cassandra/cassandra-topology.properties\n</code></pre> <p> </p> </li> <li> <p>Configure Cassandra GossipingPropertyFileSnitch: In the <code>cassandra-rackdc.properties</code>  file assign the datacenter and rack names for each node.</p> cassandra-rackdc.properties<pre><code>## On node1, edit /etc/cassandra/cassandra-rackdc.properties and add the following conf\ndc=datacenter1\nrack=rack1\n\n## On node2, edit /etc/cassandra/cassandra-rackdc.properties and add the following conf\ndc=datacenter1\nrack=rack2\n\n## On node3, edit /etc/cassandra/cassandra-rackdc.properties and add the following conf\ndc=datacenter1\nrack=rack3\n</code></pre> <p> </p> </li> </ol>"}, {"location": "thehive/installation/deploying-a-cluster/#starting-the-nodes", "title": "Starting the Nodes", "text": "<p>To initiate the Cassandra service on each node, follow these steps:</p> <ol> <li> <p>Start Cassandra Service: Start Cassandra Service: Execute the following command on each node one at a time to start the Cassandra service::</p> <pre><code>service cassandra start\n</code></pre> </li> <li> <p>Verify Node Status: Ensure that all nodes are up and running by checking their status using the <code>nodetool status</code> command. Open a terminal and run:</p> <pre><code>root@cassandra:/# nodetool status\nDatacenter: datacenter1\n===============\nStatus=Up/Down\n|/ State=Normal/Leaving/Joining/Moving\n--  Address      Load       Tokens       Owns (effective)  Host ID                               Rack\nUN  &lt;ip node 1&gt;  776.53 KiB  256          100.0%            a79c9a8c-c99b-4d74-8e78-6b0c252abd86  rack1\nUN  &lt;ip node 2&gt;  671.72 KiB  256          100.0%            8fda2906-2097-4d62-91f8-005e33d3e839  rack1\nUN  &lt;ip node 3&gt;  611.54 KiB  256          100.0%            201ab99c-8e16-49b1-9b66-5444044fb1cd  rack1\n</code></pre> </li> </ol> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#initializing-the-database", "title": "Initializing the Database", "text": "<p>To initialize the database, perform the following steps:</p> <ol> <li> <p>Access CQL Shell: On one of the nodes, access the Cassandra Query Language (CQL) shell by running the following command, providing the IP address of the respective node:</p> <pre><code>cqlsh &lt;ip node X&gt; -u cassandra\n</code></pre> <p>Note that the default password for the cassandra account is <code>cassandra</code></p> <p>to prevent security issue, the cassandra default user will be removed from the base.</p> </li> <li> <p>Configure the system authentication replication: Before creating a new users, you have to modify the default replication factor for the keyspace system_auth using the following cql command:</p> <pre><code>ALTER KEYSPACE system_auth WITH replication = {'class': 'NetworkTopologyStrategy', 'replication_factor': 3 };\n</code></pre> </li> <li> <p>Create a custom administrator account: Create a new administrator cassandra role that will replace the default user:</p> <pre><code>CREATE ROLE admin WITH PASSWORD password = 'admin_password' AND LOGIN = true AND SUPERUSER = true;\n</code></pre> <p>After executing the query, exit the CQL shell and reconnect  using the new admin role.</p> <p>Remove the default cassandra user using the following CQL query</p> <pre><code>DROP ROLE cassandra;\n</code></pre> </li> <li> <p>Create Keyspace: Create a keyspace named thehive with a replication factor of 3 and durable writes enabled:</p> <pre><code>CREATE KEYSPACE thehive WITH replication = {'class': 'NetworkTopologyStrategy', 'replication_factor': '3' } AND durable_writes = 'true';\n</code></pre> </li> <li> <p>Create Role and Grant Permissions: Finally, create a role named thehive and grant permissions on the thehive keyspace. Choose a password for the role:</p> <pre><code>CREATE ROLE thehive WITH LOGIN = true AND PASSWORD = 'PASSWORD';\nGRANT ALL PERMISSIONS ON KEYSPACE thehive TO 'thehive';\n</code></pre> </li> </ol>"}, {"location": "thehive/installation/deploying-a-cluster/#optional-enable-encryption-for-client-and-inter-node-communication", "title": "OPTIONAL: Enable encryption for client and inter-node communication", "text": "<p>The following steps aim to enable encryption secure communication between a client machine and a database cluster and between nodes within a cluster.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#client-to-node-encryption", "title": "Client to Node Encryption", "text": "<p>Prerequisite: having configured the necessary certificates for encryption (Keystores and Truststores).</p> <ol> <li> <p>Open the <code>cassandra.yaml</code> Configuration File and edit the <code>client_encryption_options</code> section:</p> cassandra.yaml<pre><code>client_encryption_options:\nenabled: true\noptional: false\nkeystore: &lt;/path/to/node1.keystore&gt;\nkeystore_password: &lt;your_keystore_password&gt;\nrequire_client_auth: true\ntruststore: &lt;/path/to/cassandra.truststore&gt;\ntruststore_password: &lt;your_truststore_password&gt;\nprotocol: TLS\nalgorithm: SunX509\nstore_type: JKS\ncipher_suites: [TLS_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA]\n</code></pre> <ol> <li>Restart the Cassandra Service on All Nodes:</li> </ol> <pre><code>sudo service cassandra restart\n</code></pre> <ol> <li>Check Cassandra Logs: Review the Cassandra logs to ensure there are no errors related to SSL/TLS.</li> </ol> <pre><code>tail -n 100 /var/log/cassandra/system.log | grep -iE \"error|warning\"\n</code></pre> </li> </ol> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#inter-node-encryption", "title": "Inter Node Encryption", "text": "<p>!!! Prerequisite: having configured the necessary certificates for encryption (Keystores and Truststores).</p> <ol> <li> <p>Open the <code>cassandra.yaml</code> Configuration File and edit the <code>server_encryption_options</code> section:</p> cassandra.yaml<pre><code>    server_encryption_options:\n    internode_encryption: all\n    keystore: &lt;/etc/cassandra/node1.keystore&gt;\n    keystore_password: cassandra\n    truststore: &lt;/etc/cassandra/cassandra.truststore&gt;\n    truststore_password: &lt;cassandra&gt;\n    protocol: TLS\n    algorithm: SunX509\n    store_type: JKS\n    cipher_suites: [TLS_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA]\n    require_client_auth: true\n    enabled: true\n</code></pre> <ol> <li>Restart the Cassandra Service on All Nodes:</li> </ol> <pre><code>sudo service cassandra restart\n</code></pre> <ol> <li>Check Cassandra Logs: Review the Cassandra logs to ensure there are no errors related to SSL/TLS.</li> </ol> <pre><code>tail -n 100 /var/log/cassandra/system.log | grep -iE \"error|warning\"\n</code></pre> </li> </ol>"}, {"location": "thehive/installation/deploying-a-cluster/#elasticsearch-setup", "title": "Elasticsearch Setup", "text": "<p>Elasticsearch supported versions</p> <ul> <li>TheHive 5.2.x and earlier: Elasticsearch 7.x only</li> <li>TheHive 5.3.0 - 5.5.9: Elasticsearch 7.x - 8.x</li> <li>TheHive 5.5.10 and later: Elasticsearch 7.x - 9.1.x</li> </ul> <p>If using Elasticsearch for audit log storage, you must use Elasticsearch 7.17 or later.</p> <p>Cortex only supports Elasticsearch 7.x. Sharing an Elasticsearch instance between TheHive and Cortex isn't recommended, but if this setup is required, ensure you use Elasticsearch 7.x.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#installation-instructions_1", "title": "Installation Instructions", "text": "<p>To establish a cluster of 3 active Elasticsearch nodes, follow the installation instructions provided on this page for each node.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#configuration-instructions_1", "title": "Configuration Instructions", "text": "<p>For each node, update the configuration files located at <code>/etc/cassandra/elasticsearch.yml</code> with the following parameters, ensuring to adjust the network.host accordingly.</p> <pre><code>http.host:  0.0.0.0\nnetwork.bind_host:  0.0.0.0\nscript.allowed_types:  inline,stored\ncluster.name: thehive\nnode.name: 'es1'\npath.data: /usr/share/elasticsearch/data\npath.logs: /usr/share/elasticsearch/logs\nnetwork.host: 'es1' # (1)\nhttp.port: 9200\ncluster.initial_master_nodes: \n  - es1\nnode.master: true\ndiscovery.seed_hosts: # (2)\n  - 'es1'\n  - 'es2'\n  - 'es3'\nthread_pool.search.queue_size: 100000\nthread_pool.write.queue_size: 100000\nxpack.security.enabled: true\nxpack.security.http.ssl.enabled: true\nxpack.security.transport.ssl.enabled: true\nxpack.security.http.ssl.key: /usr/share/elasticsearch/config/certs/es1/es1.key\nxpack.security.http.ssl.certificate: /usr/share/elasticsearch/config/certs/es1/es1.crt\nxpack.security.http.ssl.certificate_authorities: /usr/share/elasticsearch/config/certs/ca/ca.crt\nxpack.security.transport.ssl.key: /usr/share/elasticsearch/config/certs/es1/es1.key\nxpack.security.transport.ssl.certificate: /usr/share/elasticsearch/config/certs/es1/es1.crt\nxpack.security.transport.ssl.certificate_authorities: /usr/share/elasticsearch/config/certs/ca/ca.crt\n</code></pre> <ol> <li>Replace es1 with the IP or host name of the respective node.</li> <li>Keep this parameter with the same value for all nodes to ensure proper cluster discovery.</li> </ol> <p>Warning</p> <p>When configuring Xpack and SSL with Elasticsearch, it's essential to review the documentation specific to your Elasticsearch version for accurate setup instructions. </p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#custom-jvm-options", "title": "Custom JVM Options", "text": "<p>To customize Java virtual machine (JVM) options for Elasticsearch, create a JVM Options File named jvm.options in the directory <code>/etc/elasticsearch/jvm.options.d/</code> with the following lines:</p> <pre><code>-Dlog4j2.formatMsgNoLookups=true\n-Xms4g\n-Xmx4g\n</code></pre> <p>Adjust according to Available Memory - It's important to adjust the heap size values based on the amount of memory available on your system to ensure optimal performance and resource utilization.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#starting-the-nodes_1", "title": "Starting the Nodes", "text": "<p>To start the Elasticsearch service on each node, execute the following command:</p> <pre><code>service elasticsearch start\n</code></pre> <p>This command initiates the Elasticsearch service, allowing the node to join the cluster and begin handling data requests.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#file-storage", "title": "File storage", "text": "<p>To set up a shared file storage for TheHive in a clustered environment, several options are available. The primary goal is to establish a common storage space accessible to all nodes. </p> NFSMinio <p>Using NFS is one of the simplest methods to implement shared file storage. By configuring a single NFS endpoint, all nodes in the cluster can access and share files seamlessly.</p> <ol> <li>Mount the NFS endpoint to /opt/thp/thehive/files on each node.</li> <li>Set permissions: Ensure the thehive user has both read and write access to this directory, including the ability to create subdirectories. This allows TheHive to manage files as required across the cluster.</li> </ol> <p>  MinIO is a scalable, cloud-native object storage system designed to efficiently manage data storage and retrieval in cloud-native environments. Its primary purpose is to provide seamless scalability and reliability for storing and accessing large volumes of data across distributed systems. Within TheHive, MinIO efficiently handles vast amounts of data distributed across multiple nodes, ensuring robustness and optimal performance.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#installation-instructions_2", "title": "Installation Instructions", "text": "<p>To implement MinIO with TheHive, follow the procedure outlined below on all servers in the cluster. For this example, we assume a cluster setup consisting of 3 servers named minio1, minio2, and minio3.</p> <p>Warning</p> <p>Unlike Cassandra and Elasticsearch, MinIO requires a load balancer to be installed in front of the nodes to distribute connections effectively.</p> <ol> <li> <p>Create a Dedicated System Account: First, create a dedicated user and group for MinIO:</p> <pre><code>adduser minio-user\naddgroup minio-user\n</code></pre> </li> <li> <p>Create Data Volumes: Next, create at least 2 data volumes on each server by executing the following commands:</p> <pre><code>mkdir -p /srv/minio/{1,2}\nchown -R minio-user:minio-user /srv/minio\n</code></pre> </li> <li> <p>Setting up Hosts Files: To ensure proper communication between servers in your environment, it's necessary to configure the <code>/etc/hosts</code> file on all servers:</p> /etc/hosts<pre><code>ip-minio-1     minio1\nip-minio-2     minio2\nip-minio-3     minio3\n</code></pre> <p>In the above example, replace ip-minio-1, ip-minio-2, and ip-minio-3 with the respective IP addresses of your MinIO servers. These entries map the server names (minio1, minio2, minio3) to their corresponding IP addresses, ensuring that they can be resolved correctly within your network.</p> </li> <li> <p>Install MinIO: Installing MinIO and MC Command Line Tool, by first downloading the latest DEB packages for MinIO and MC from the official MinIO website and then installing the downloaded DEB packages using the dpkg command:</p> <p>Example for DEB packages</p> <pre><code>wget https://dl.min.io/server/minio/release/linux-amd64/minio.deb\nwget https://dl.min.io/client/mc/release/linux-amd64/mcli.deb\ndpkg -i minio.deb\ndpkg -i mcli.deb\n</code></pre> </li> </ol> <p>You can find the latest versions of the required packages on the MinIO download page. Ensure that you download the appropriate packages for your system architecture and MinIO version requirements.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#configuration-instructions_2", "title": "Configuration Instructions", "text": "<p>To configure MinIO, create or edit the file <code>/etc/default/minio</code> with the following settings:</p> /etc/default/minio<pre><code>MINIO_OPTS=\"--address :9100 --console-address :9001\"\nMINIO_VOLUMES=\"http://minio{1...3}:9100/srv/minio/{1...2}\"\nMINIO_ROOT_USER=thehive\nMINIO_ROOT_PASSWORD=password\nMINIO_SITE_REGION=\"us-east-1\"\n</code></pre> <p>Ensure to replace placeholders such as <code>thehive</code>, <code>password</code>, and <code>us-east-1</code> with your desired values. These settings define the address, volumes, root user credentials, and site region for your MinIO setup.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#enable-and-start-the-service", "title": "Enable and Start the Service", "text": "<p>Once configured, enable and start the MinIO service using the following commands:</p> <pre><code>systemctl daemon-reload\nsystemctl enable minio\nsystemctl start minio.service\n</code></pre> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#prepare-the-service-for-thehive", "title": "Prepare the Service for TheHive", "text": "<p>Before proceeding, ensure that all servers are up and running. The following operations should be performed once all servers are operational, as adding a new server afterward is not supported.</p> <p>Following operations should be performed once all servers are up and running. A new server CAN NOT be added afterward.</p> <ol> <li> <p>Connect to one of the MinIO servers using your browser at port 9100: <code>http://minio:9100</code>. You will need to use the access key and secret key provided during the MinIO setup process.</p> <p></p> </li> <li> <p>Create a bucket named thehive.</p> <p></p> </li> </ol> <p>Ensure that the bucket is successfully created and available on all your MinIO servers. This ensures uniformity and accessibility across your MinIO cluster.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#thehive-setup", "title": "TheHive Setup", "text": "<p>TheHive utilizes the Pekko toolkit to effectively manage clusters and enhance scalability. Pekko facilitates efficient management of threads and multi-processing, enabling TheHive to handle concurrent tasks seamlessly.</p> <p>Note</p> <p>Apache Pekko is a toolkit designed for building highly concurrent, distributed, and resilient message-driven applications for Java and Scala.  Incorporating Pekko into TheHive configuration ensures robustness and enhances its ability to handle distributed workloads effectively.  Source: https://pekko.apache.org</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#configuration", "title": "Configuration", "text": ""}, {"location": "thehive/installation/deploying-a-cluster/#cluster", "title": "Cluster", "text": "<p>When configuring TheHive for a clustered environment, it's essential to configure Pekko to ensure efficient management of the cluster by the application.</p> <p>In this guide, we assume that node 1 serves as the master node. Begin by configuring the <code>pekko</code> component in the <code>/etc/thehive/application.conf</code> file of each node as follows:</p> /etc/thehive/application.conf<pre><code>pekko {\n  cluster.enable = on \n  actor {\n    provider = cluster\n  }\nremote.artery {\n  canonical {\n    hostname = \"&lt;My IP address&gt;\" # (1)\n    port = 2551\n  }\n}\n# seed node list contains at least one active node\ncluster.seed-nodes = [\n                      \"pekko://application@&lt;Node 1 IP address&gt;:2551\",  # (2)\n                      \"pekko://application@&lt;Node 2 IP address&gt;:2551\",\n                      \"pekko://application@&lt;Node 3 IP address&gt;:2551\"\n                    ]\ncluster.min-nr-of-members = 2    # (3)\n}\n</code></pre> <ol> <li>Set the IP address of the current node.</li> <li>Ensure consistency of this parameter across all nodes.</li> <li>Choose a value corresponding to half the number of nodes plus one (for 3 nodes, use 2).</li> </ol> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#database-and-index-engine-configuration", "title": "Database and Index Engine Configuration", "text": "<p>To ensure proper database and index engine configuration for TheHive, update the /etc/thehive/application.conf file as follows:</p> /etc/thehive/application.conf<pre><code>## Database configuration\ndb.janusgraph {\n    storage {\n    ## Cassandra configuration\n    # More information at https://docs.janusgraph.org/basics/configuration-reference/#storagecql\n        backend = cql\n        hostname = [\"&lt;ip node 1&gt;\", \"&lt;ip node 2&gt;\", \"&lt;ip node 3&gt;\"] #(1)\n        # Cassandra authentication (if configured)\n        username = \"thehive\"\n        password = \"PASSWORD\"\n        cql {\n            cluster-name = thp\n            keyspace = thehive\n        }\n    }\n    index.search {\n    ## Elasticsearch configuration\n        backend = elasticsearch\n        hostname = [\"&lt;ip node&gt;\"]\n        index-name = thehive\n        # Elasticsearch authentication (recommended)\n        elasticsearch {\n            http {\n                auth {\n                    type = basic\n                    basic {\n                        username = \"httpuser\"\n                        password = \"httppassword\"\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Consistent configuration across all TheHive nodes</p> <p>In this configuration, all TheHive nodes should have the same configuration.</p> <p>Elasticsearch configuration should use the default value for <code>script.allowed_types</code>, or contain the following configuration line: </p> <pre><code>script.allowed_types: inline,stored\n</code></pre> <p>Ensure that you replace <code>&lt;ip node 1&gt;</code>, <code>&lt;ip node 2&gt;</code>, and <code>&lt;ip node 3&gt;</code> with the respective IP addresses of your Cassandra nodes. This configuration ensures proper communication between TheHive and the Cassandra database, facilitating seamless operation of the platform. Additionally, if authentication is enabled for Cassandra, provide the appropriate username and password in the configuration.</p> <p>To learn about how to configure SSL for Cassandra and Elasticsearch, see Configure Database and Index SSL.</p> <p> </p>"}, {"location": "thehive/installation/deploying-a-cluster/#file-storage_1", "title": "File storage", "text": "<p>File storage contains attachments from cases, alerts, and organizations, as well as observables of type file. These items are stored as-is.</p> Using NFS file storageS3 file storage with MINIO (Optional) <p>All nodes should have access to the same file storage. So, ideally, all TheHive nodes should have a similar NFS mount point. Then, on each node:</p> <ol> <li> <p>Set ownership and permissions so that only the <code>thehive</code> user can read and write files.</p> <pre><code>chown -R thehive:thehive /opt/thp/thehive/files\nsudo chmod 700 /opt/thp/thehive/files\n</code></pre> </li> <li> <p>Update the application.conf TheHive configuration file </p> /etc/thehive/application.conf<pre><code># Attachment storage configuration\n# By default, TheHive is configured to store files locally in the folder.\n# The path can be updated and should belong to the user/group running thehive service. (by default: thehive:thehive)\nstorage {\nprovider = localfs\nlocalfs.location = /opt/thp/thehive/files\n}\n</code></pre> </li> </ol> <p>It you decide to go with S3 file storage, this section details how to configure your cluster.</p> <p>To enable S3 file storage for each node in TheHive cluster, add the relevant storage configuration to the <code>/etc/thehive/application.conf</code> file. Below is an example configuration for the first node:</p> /etc/thehive/application.conf with TheHive 5.0.x<pre><code>    ## Attachment storage configuration\n    storage {\n      provider: s3\n      s3 {\n        bucket = \"thehive\"\n        readTimeout = 1 minute\n        writeTimeout = 1 minute\n        chunkSize = 1 MB\n        endpoint = \"http://&lt;IP_MINIO_1&gt;:9100\"\n        accessKey = \"thehive\"\n        secretKey = \"password\"\n        region = \"us-east-1\"\n      }\n    }\n    alpakka.s3.access-style = path\n</code></pre> /etc/thehive/application.conf with TheHive &gt; 5.0<pre><code>    storage {\n      provider: s3\n      s3 {\n        bucket = \"thehive\"\n        readTimeout = 1 minute\n        writeTimeout = 1 minute\n        chunkSize = 1 MB\n        endpoint = \"http://&lt;IP_MINIO_1&gt;:9100\"\n        accessKey = \"thehive\"\n        aws.credentials.provider = \"static\"\n        aws.credentials.secret-access-key = \"password\"\n        access-style = path\n        aws.region.provider = \"static\"\n        aws.region.default-region = \"us-east-1\"\n      }\n    }\n</code></pre> <ul> <li> <p>The provided configuration is backward compatible, ensuring compatibility with existing setups.</p> </li> <li> <p>The default region is us-east-1, but it's optional if not specified in the MinIO configuration.</p> </li> <li> <p>Each TheHive server can connect to one MinIO server, or you can choose to distribute connections across all nodes of the cluster using a load balancer (refer to the example for TheHive).</p> </li> </ul>"}, {"location": "thehive/installation/deploying-a-cluster/#optional-configure-the-secret-key-for-the-play-framework", "title": "Optional: Configure the secret key for the Play Framework", "text": "<p>TheHive uses a secret key to sign session cookies and ensure secure user authentication.</p> <p>Skip this step if you installed TheHive using DEB or RPM packages\u2014they generate the key automatically.</p> <p>For other installation methods:</p> <ol> <li>Generate a secret key on the first node.</li> </ol> <pre><code>cat &gt; /etc/thehive/secret.conf &lt;&lt; _EOF_\nplay.http.secret.key=\"$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 64 | head -n 1)\"\n_EOF_\n</code></pre> <p>Minimum key length</p> <p>TheHive 5.4 and later requires a minimum 32-character secret key. The command above generates a 64-character key for enhanced security.</p> <ol> <li>Set appropriate file permissions.</li> </ol> <pre><code>chmod 400 /etc/thehive/secret.conf\nchown thehive:thehive /etc/thehive/secret.conf\n</code></pre> <ol> <li> <p>Copy the <code>/etc/thehive/secret.conf</code> file to all other nodes in the cluster.</p> </li> <li> <p>Verify the same permissions on each node.</p> </li> </ol> <p>Security requirements</p> <p>Never share or commit your secret key to version control. All nodes in a cluster must use the same key, but different environments (development, staging, production) must use different keys.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#start-the-service", "title": "Start the service", "text": "<p>Once the configuration is updated, start TheHive service using the following command:</p> <pre><code>systemctl start thehive\n</code></pre> <p>This command initiates TheHive service, enabling S3 file storage functionality as configured. Make sure to execute this command on each node of TheHive cluster to ensure proper functionality across the entire setup.</p> <p>Initial startup delay</p> <p>The initial start, or first start after configuring indexes, might take some time if the database contains a large amount of data. This time is due to the index creation process.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#load-balancing-with-haproxy", "title": "Load Balancing with HAProxy", "text": "<p>  To enhance the availability and distribution of HTTP requests across TheHive cluster, you can integrate a load balancer. The load balancer efficiently distributes incoming requests among the cluster nodes, ensuring optimal resource utilization. Notably, client affinity is not required, meaning that a client does not need to consistently connect to the same node.</p> <p>Below is a basic example of what should be added to the HAProxy configuration file, typically located at <code>/etc/haproxy/haproxy.cfg</code>. This configuration should be consistent across all HAProxy instances:</p> <pre><code># Listen on all interfaces, on port 80/tcp\nfrontend thehive-in\n        bind &lt;VIRTUAL_IP&gt;:80                # (1)\n        default_backend thehive\n# Configure all cluster node\nbackend thehive\n            balance roundrobin\n            server node1 THEHIVE-NODE1-IP:9000 check   # (2)\n            server node2 THEHIVE-NODE2-IP:9000 check\n            server node3 THEHIVE-NODE3-IP:9000 check\n</code></pre> <ol> <li>Configure the virtual IP address dedicated to the cluster.</li> <li>Specify the IP addresses and ports of all TheHive nodes to distribute traffic evenly across the cluster.</li> </ol> <p>This configuration ensures that incoming HTTP requests are efficiently distributed among the cluster nodes.</p>"}, {"location": "thehive/installation/deploying-a-cluster/#virtual-ip-with-keepalived", "title": "Virtual IP with Keepalived", "text": "<p>  If you choose to use Keepalived to set up a virtual IP address for your load balancers, this section provides a basic example of configuration.</p> <p>Keepalived is a service that monitors the status of load balancers (such as HAProxy) installed on the same system. In this setup, LB1 acts as the master, and the virtual IP address is assigned to LB1. If the HAProxy service stops running on LB1, Keepalived on LB2 takes over and assigns the virtual IP address until the HAProxy service on LB1 resumes operation.</p> <pre><code>vrrp_script chk_haproxy {     # (1)\n      script \"/usr/bin/killall -0 haproxy\"  # cheaper than pidof\n      interval 2 # check every 2 seconds\n      weight 2 # add 2 points of priority if OK\n    }\n    vrrp_instance VI_1 {\n      interface eth0\n      state MASTER\n      virtual_router_id 51\n      priority 101 # 101 on primary, 100 on secondary      # (2)\n      virtual_ipaddress {\n        10.10.1.50/24 brd 10.10.1.255 dev eth0 scope global  # (3)\n      }\n      track_script {\n        chk_haproxy\n    } \n}\n</code></pre> <ol> <li>Requires Keepalived version &gt; 1.1.13.</li> <li>Set `priority 100`` for a secondary node.</li> <li> This is an example. Replace it with your actual IP address and broadcast address.</li> </ol>"}, {"location": "thehive/installation/deploying-a-cluster/#troubleshooting", "title": "Troubleshooting", "text": "<p>Issues can be encountered during cluster deployment with TheHive. Here are some of the most commonly encountered ones and their solutions:</p> <ul> <li> <p>Example 1: InvalidRequest Error</p> <pre><code>InvalidRequest: code=2200 [Invalid query] message=\u201dorg.apache.cassandra.auth.CassandraRoleManager doesn\u2019t support PASSWORD\u201d.`\n</code></pre> <p>Resolution:</p> <p>To resolve this error, set the value <code>authenticator: PasswordAuthenticator</code> in the <code>cassandra.yaml</code> configuration file.</p> </li> </ul> <p> </p> <ul> <li> <p>Example 2: UnauthorizedException Caused by Inconsistent Replication</p> <pre><code>Caused by: java.util.concurrent.ExecutionException: com.datastax.driver.core.exceptions.UnauthorizedException: Unable to perform authorization of permissions: Unable to perform authorization of super-user permission: Cannot achieve consistency level LOCAL_ONE\n</code></pre> <p>Resolution:</p> <p>To address this issue, execute the following CQL command to adjust the replication settings for the system_auth keyspace:</p> <pre><code>ALTER KEYSPACE system_auth WITH replication = {'class': 'SimpleStrategy', 'replication_factor': 3 };\n</code></pre> <p>After making this adjustment, perform a full repair using the <code>nodetool repair -full</code> command to ensure data consistency across the cluster.</p> </li> </ul> <p> </p>"}, {"location": "thehive/installation/docker/", "title": "Deploy with Docker", "text": ""}, {"location": "thehive/installation/docker/#running-thehive-with-docker", "title": "Running TheHive with Docker", "text": "<p>TheHive fully supports Docker, allowing users to quickly deploy and manage their instance of the platform using Docker containers.</p> <p>We provides and maintain several setup profiles for TheHive and Cortex available on GitHub. This guide will walk you through choose the right profile and setting up TheHive using Docker.</p> <p>Cortex support</p> <p>5.5 Cortex 3.1.5 and earlier are no longer supported since version 5.5.</p>"}, {"location": "thehive/installation/docker/#prerequisites", "title": "Prerequisites", "text": ""}, {"location": "thehive/installation/docker/#software-requirements", "title": "Software requirements", "text": "<ul> <li>Docker Engine: Version <code>v23.0.15</code> or later. Installation instructions</li> <li>Docker Compose Plugin: Version <code>v2.20.2</code> or later. Installation instructions</li> <li>jq: jq installation instructions</li> <li>Permissions: The current user should have at least <code>sudo</code> permissions.</li> </ul>"}, {"location": "thehive/installation/docker/#hardware-requirements", "title": "Hardware requirements", "text": "<p>Hardware requirements will depend on the deployment profile being used. For example, for testing deployments, a CPU with 4 vCPUs and 8 GB RAM is recommended, while for high-performance deployments for TheHive on a dedicated server, a CPU with 8 vCPUs and 32 GB RAM is recommended. For more detailed requirements, please refer to the GitHub link provided below.</p> <p>Basically, two hardware profiles are recommended to run the full stack for TheHive on a single server (virtual of physical): </p> <ol> <li>4vCPUs, 16 GB of RAM and 100GB of storage is recommended for most use cases, </li> <li>8vCPUs, 32GB of RAM and 150GB of storage for intensive use cases.</li> </ol>"}, {"location": "thehive/installation/docker/#clone-the-repository", "title": "Clone the repository", "text": "<p>Clone the StrangeBee Docker repository to your local machine:</p> <pre><code>git clone https://github.com/StrangeBeeCorp/docker.git\n</code></pre> <p></p>"}, {"location": "thehive/installation/docker/#deployment-profiles", "title": "Deployment profiles", "text": "<p>BEFORE RUNNING ANY COMMAND</p> <p>Please, read carefully the documentation related to the profile you want to use (the <code>README.md</code> files you'll find in the GitHub repository).</p> <p>The prebuilt deployment profiles allow you to quickly set up TheHive based on your specific use case. Choose from the following deployment options:</p> Testing Environment <p>Deploys both TheHive (and Cortex) on a single server for testing purposes. Link to the testing profile</p> Production Environment #1 - TheHive <p>Single server deployment for intensive use of TheHive. Link to the production profile</p> Production Environment #2 - TheHive <p>High-performance deployment for TheHive on a dedicated server. Link to the high-performance production profile</p> <p>You can choose the scenario that best suits your needs by selecting the appropriate Docker Compose YAML file.</p>"}, {"location": "thehive/installation/docker/#starting-thehive", "title": "Starting TheHive", "text": "<p>The application stack includes several utility scripts, one of which is the <code>init.sh</code> script, which performs the following tasks for you:</p> <ul> <li>Prompt for a service name to include in the Nginx server certificate.</li> <li>Initialize the <code>secret.conf</code> files for TheHive and Cortex.</li> <li>Generate a self-signed certificate if none is found in the <code>./certificates</code> directory.</li> <li>Create a <code>.env</code> file containing user/group information and other application settings.</li> <li>Verify file and folder permissions to ensure proper access rights.</li> </ul> <p>Note</p> <p>TheHive application will run under the user account and group that execute the initialization script.</p> <p>Follow the steps below to initialize the environment.</p>"}, {"location": "thehive/installation/docker/#step-1-run-the-initialization-script", "title": "Step 1: Run the initialization script", "text": "<p>Execute the <code>init.sh</code> script to set up the necessary configurations:</p> <pre><code>bash ./scripts/init.sh\n</code></pre>"}, {"location": "thehive/installation/docker/#step-2-run-the-application-stack", "title": "Step 2: Run the application stack", "text": "<pre><code>docker compose up\n</code></pre> <p>or </p> <pre><code>docker compose up -d\n</code></pre> <p> </p> <p>How to start quickly with prod1-thehive environment?</p> <ol> <li>Clone the repository</li> <li>Open prod1-thehive folder</li> <li>Initialize the environment</li> <li>Start the application stack</li> </ol> <p></p>"}, {"location": "thehive/installation/docker/#step-3-access-the-application", "title": "Step 3: Access the application", "text": "<p>Open your browser, and navigate to:</p> <ul> <li><code>https://HOSTNAME_OR_IP/thehive</code> to connect to TheHive if using the testing profile</li> <li><code>https://HOSTNAME_OR_IP/</code> to connect to TheHive if using the production profiles</li> </ul> <p> </p> <p></p>"}, {"location": "thehive/installation/docker/#additional-configuration", "title": "Additional configuration", "text": "<p>For more detailed information on the directory structure, services, scripts, and their respective functions, please refer to the <code>README.md</code> file located within each deployment profile:</p> <ul> <li>Testing Environment</li> <li>Production Environment #1 - TheHive</li> <li>Production Environment #2 - TheHive</li> </ul>"}, {"location": "thehive/installation/docker/#thehive-docker-entrypoint-options", "title": "TheHive Docker entrypoint options", "text": "<p>To view a list of all supported options for the Docker entry point, use the -h flag:</p> <pre><code>docker run --rm strangebee/thehive:&lt;version&gt; -h\n</code></pre> <p>The output will display available options, allowing you to configure TheHive according to your requirements.</p> <p>Available Options:</p> <ul> <li><code>--config-file &lt;file&gt;</code>: Specifies the path to the configuration file.</li> <li><code>--no-config</code>: Prevents TheHive from attempting to configure itself, including adding secrets and Elasticsearch settings.</li> <li><code>--no-config-secret</code>: Excludes the addition of a randomly generated secret from the configuration.</li> <li><code>--secret &lt;secret&gt;</code>: Sets the secret used to secure sessions.</li> <li><code>--show-secret</code>: Displays the generated secret.</li> <li><code>--no-config-db</code>: Disables automatic configuration of the database.</li> <li><code>--cql-hostnames &lt;host&gt;,&lt;host&gt;,...</code>: Resolves these host names to locate Cassandra instances.</li> <li><code>--cql-username &lt;username&gt;</code>: Specifies the username for the Cassandra database.</li> <li><code>--cql-password &lt;password&gt;</code>: Specifies the password for the Cassandra database.</li> <li><code>--cql-datacenter &lt;datacenter&gt;</code>: Specifies the name of the Cassandra datacenter used by the TheHive node. This parameter is new as of version 5.4.7 and can have different values for each node in cluster mode.</li> <li><code>--no-cql-wait</code>: Skips waiting for Cassandra to become available.</li> <li><code>--bdb-directory &lt;path&gt;</code>: Defines the location of the local database if Cassandra is not used (default: /data/db).</li> <li><code>--index-backend</code>: Specifies the backend to use for index, either 'lucene' or 'elasticsearch' (default: lucene).</li> <li><code>--es-hostnames</code>: Specifies the Elasticsearch instances used for index.</li> <li><code>--es-index</code>: Specifies the Elasticsearch index name to be used (default: thehive).</li> <li><code>--no-config-storage</code>: Disables automatic configuration of storage.</li> <li><code>--storage-directory &lt;path&gt;</code>: Specifies the location of local storage if S3 is not used (default: /data/files).</li> <li><code>--s3-endpoint &lt;endpoint&gt;</code>: Specifies the endpoint of S3 or other object storage if used, with 's3.amazonaws.com' for AWS S3.</li> <li><code>--s3-region &lt;region&gt;</code>: Specifies the S3 region, optional for MinIO.</li> <li><code>--s3-bucket &lt;bucket&gt;</code>: Specifies the name of the bucket to use (default: thehive), which must already exist.</li> <li><code>--s3-access-key &lt;key&gt;</code>: Specifies the S3 access key (required for S3).</li> <li><code>--s3-secret-key &lt;key&gt;</code>: Specifies the S3 secret key (required for S3).</li> <li><code>--s3-use-path-access-style</code>: Sets this flag if using MinIO or another non-AWS S3 provider, defaulting to virtual host style.</li> <li><code>--no-config-cortex</code>: Excludes Cortex configuration.</li> <li><code>--cortex-proto &lt;proto&gt;</code>: Defines the protocol to connect to Cortex (default: http).</li> <li><code>--cortex-port &lt;port&gt;</code>: Defines the port to connect to Cortex (default: 9001).</li> <li><code>--cortex-hostnames &lt;host&gt;,&lt;host&gt;,...</code>: Resolves these host names to locate Cortex instances.</li> <li><code>--cortex-keys &lt;key&gt;,&lt;key&gt;,...</code>: Defines Cortex keys.</li> <li><code>--kubernetes</code>: Utilizes the Kubernetes API to join other nodes.</li> <li><code>--kubernetes-pod-label-selector &lt;selector&gt;</code>: Specifies the selector to use to select other pods running the app (default app=thehive).</li> <li><code>--cluster-min-nodes-count &lt;count&gt;</code>: Specifies the minimum number of nodes to form a cluster (default to 1).</li> <li><code>migrate &lt;param&gt; &lt;param&gt; ...</code>: Runs the migration tool.</li> <li><code>cloner &lt;param&gt; &lt;param&gt; ...</code>: Runs the cloner tool. </li> </ul> <p> </p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/", "title": "Install on Linux", "text": ""}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#install-thehive-on-linux-systems", "title": "Install TheHive on Linux Systems", "text": "<p>Welcome to the step-by-step guide for installing and configuring TheHive On-prem on Linux systems!</p> <p>This guide is designed for users who are comfortable with Linux system administration, but you don\u2019t need to be an infrastructure expert to follow along.</p> <p>By the end, you'll have a fully functional instance of TheHive up and running.</p> <p>If you prefer a faster setup on Linux, you can run an automated installation script to install TheHive along with its required services and dependencies using predefined settings.</p> <p>Guide scope</p> <p>This guide covers setting up a new instance of TheHive on Linux systems, with all components hosted on the same server.</p> <p>It doesn't cover:</p> <ul> <li>Docker deployments: For Docker-based setups, follow Running TheHive with Docker.</li> <li>Cluster deployments: Refer to Setting up a Cluster with TheHive for Linux, or Deploy TheHive on Kubernetes for Kubernetes deployments.</li> <li>Version upgrades: For upgrading an existing instance, see Upgrade from TheHive 5.x or Upgrade from TheHive 4.x.</li> </ul> <p>Before you begin</p> <p>To ensure a smooth installation process, make sure you have:</p> <ul> <li>A basic understanding of TheHive architecture</li> <li>System requirements fully met and verified for Linux installation</li> </ul>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-1-install-required-dependencies", "title": "Step 1: Install required dependencies", "text": "<p>Start by installing the necessary dependencies for TheHive.</p> DEB (Debian/Ubuntu)RPM (RHEL/Fedora) <p>Run the following commands:</p> <pre><code>sudo apt update\nsudo apt install wget curl gnupg coreutils apt-transport-https git ca-certificates ca-certificates-java software-properties-common python3-pip lsb-release unzip\n</code></pre> <p>Run the following commands:</p> <pre><code>sudo yum update\nsudo yum install wget curl gnupg2 coreutils chkconfig python3-pip git unzip\n</code></pre>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-2-set-up-the-java-virtual-machine-jvm", "title": "Step 2: Set up the Java virtual machine (JVM)", "text": "<p>TheHive requires Java to run its application server and to manage various processes.</p> <p>Java support</p> <ul> <li>For security and long-term support, we recommend using Amazon Corretto, which provides OpenJDK builds maintained by Amazon.</li> <li>Only Java 11 is supported. Java 8 is no longer supported.</li> </ul> DEBRPMOther installation methods <ol> <li> <p>Run the following commands:</p> <pre><code>wget -qO- https://apt.corretto.aws/corretto.key | sudo gpg --dearmor -o /usr/share/keyrings/corretto.gpg\necho \"deb [signed-by=/usr/share/keyrings/corretto.gpg] https://apt.corretto.aws stable main\" | sudo tee -a /etc/apt/sources.list.d/corretto.sources.list\nsudo apt update\nsudo apt install java-common java-11-amazon-corretto-jdk\necho JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\" | sudo tee -a /etc/environment\nexport JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\"\n</code></pre> </li> <li> <p>Verify the installation.</p> <pre><code>java -version\n</code></pre> <p>You should see output similar to the following:</p> <pre><code>openjdk version \"11.0.28\" 2025-07-15\nOpenJDK Runtime Environment Corretto-11.0.28.6.1 (build 11.0.28+6-LTS)\nOpenJDK 64-Bit Server VM Corretto-11.0.28.6.1 (build 11.0.28+6-LTS, mixed mode)\n</code></pre> <p>If a different Java version appears, set Java 11 as the default using <code>sudo update-alternatives --config java</code>.</p> </li> </ol> <ol> <li> <p>Run the following commands:</p> <pre><code>sudo rpm --import https://yum.corretto.aws/corretto.key &amp;&gt; /dev/null\nwget -qO- https://yum.corretto.aws/corretto.repo | sudo tee -a /etc/yum.repos.d/corretto.repo\nsudo yum install -y java-11-amazon-corretto-devel &gt; /dev/null\necho JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\" | sudo tee -a /etc/environment\nexport JAVA_HOME=\"/usr/lib/jvm/java-11-amazon-corretto\"\n</code></pre> <p>Adjusting for your distribution</p> <p>The exact commands may vary depending on your Linux distribution. Refer to your distribution documentation for the recommended way to install Java and adjust the steps accordingly.</p> </li> <li> <p>Verify the installation.</p> <pre><code>java -version\n</code></pre> <p>You should see output similar to the following:</p> <pre><code>openjdk version \"11.0.28\" 2025-07-15\nOpenJDK Runtime Environment Corretto-11.0.28.6.1 (build 11.0.28+6-LTS)\nOpenJDK 64-Bit Server VM Corretto-11.0.28.6.1 (build 11.0.28+6-LTS, mixed mode)\n</code></pre> <p>If a different Java version appears, set Java 11 as the default using <code>sudo alternatives --config java</code>.</p> </li> </ol> <p>If you're using a system other than DEB or RPM, refer to your system documentation for instructions on installing Java 11.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-3-install-and-configure-apache-cassandra", "title": "Step 3: Install and configure Apache Cassandra", "text": "<p>Apache Cassandra is a database system that's used in TheHive as the back-end database for storing and managing incident response data.</p> <p>Single node configuration</p> <p>In this guide, we will configure Cassandra as a single node on your server, which is fine for running TheHive. If you ever need multiple nodes later for higher performance, redundancy, or failover, refer to Setting up a Cluster with TheHive for detailed instructions.</p> <p>Cassandra supported versions</p> <p>TheHive is fully compatible with Cassandra version 4.1.x.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-31-install-cassandra", "title": "Step 3.1: Install Cassandra", "text": "DEBRPMOther installation methods <ol> <li> <p>Add Cassandra repository references.</p> <p>a. Download Cassandra repository keys.</p> <pre><code>wget -qO -  https://downloads.apache.org/cassandra/KEYS | sudo gpg --dearmor  -o /usr/share/keyrings/cassandra-archive.gpg\n</code></pre> <p>b. Check if the <code>/etc/apt/sources.list.d/cassandra.sources.list</code> file exists. If it doesn't, create it.</p> <p>c. Add the repository to your system by appending the following line to the <code>/etc/apt/sources.list.d/cassandra.sources.list</code> file.</p> <pre><code>echo \"deb [signed-by=/usr/share/keyrings/cassandra-archive.gpg] https://debian.cassandra.apache.org 41x main\" |  sudo tee -a /etc/apt/sources.list.d/cassandra.sources.list\n</code></pre> </li> <li> <p>Update your package index and install Cassandra using the following commands:</p> <pre><code>sudo apt update\nsudo apt install cassandra\n</code></pre> </li> <li> <p>Verify that Cassandra is installed.</p> <pre><code>systemctl status cassandra\n</code></pre> <p>This will show you the status of the Cassandra service. If Cassandra is installed you should see details about the service. If it's not installed, you will receive an error indicating that the service isn't found.</p> </li> <li> <p>By default, data is stored in <code>/var/lib/cassandra</code>. Set appropriate permissions for this directory to avoid any issues with data storage and access.</p> <pre><code>sudo chown -R cassandra:cassandra /var/lib/cassandra\n</code></pre> </li> </ol> <p>Refer to the official Cassandra documentation website for the most up-to-date instructions.</p> <ol> <li> <p>Add Cassandra repository references.</p> <p>a. Download Cassandra repository keys.</p> <pre><code>sudo rpm --import https://downloads.apache.org/cassandra/KEYS\n</code></pre> <p>Note</p> <p>When importing the <code>KEYS</code> file, you may see warnings such as:</p> <pre><code>error: https://downloads.apache.org/cassandra/KEYS: key 1 not an armored public key.\n</code></pre> <p>These messages are expected because the file contains multiple keys in different formats. The valid keys are still imported successfully, and you can safely continue with the installation.</p> <p>b. Check if the <code>/etc/yum.repos.d/cassandra.repo</code> file exists. If it doesn't, create it.</p> <p>c. Add the repository to your system by appending the following lines to the <code>/etc/yum.repos.d/cassandra.repo</code> file.</p> <pre><code>echo \"[cassandra]\nname=Apache Cassandra\nbaseurl=https://redhat.cassandra.apache.org/41x/\ngpgcheck=1\nrepo_gpgcheck=1\ngpgkey=https://downloads.apache.org/cassandra/KEYS\" | sudo tee /etc/yum.repos.d/cassandra.repo\n</code></pre> </li> <li> <p>Update your package index and install Cassandra using the following commands:</p> <pre><code>sudo yum update\nsudo yum install cassandra\n</code></pre> </li> <li> <p>By default, data is stored in <code>/var/lib/cassandra</code>. Set appropriate permissions for this directory to avoid any issues with data storage and access.</p> <pre><code>sudo chown -R cassandra:cassandra /var/lib/cassandra\n</code></pre> </li> </ol> <p>Refer to the official Cassandra documentation website for the most up-to-date instructions.</p> <p>Download the <code>tar.gz</code> archive from Apache Cassandra downloads and extract it into the folder of your choice. You can use utilities like Wget to download the archive.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-32-configure-cassandra", "title": "Step 3.2: Configure Cassandra", "text": "<p>Configure Cassandra by modifying settings within the <code>cassandra.yaml</code> file.</p> <ol> <li> <p>Locate the <code>cassandra.yaml</code> file.</p> </li> <li> <p>Open the <code>cassandra.yaml</code> file using a text editor.</p> </li> <li> <p>In the <code>cassandra.yaml</code> file, set the <code>cluster_name</code> parameter to the desired name. This name will help identify your Cassandra cluster.</p> <p>Replace <code>Test Cluster</code> with your new cluster name.</p> </li> <li> <p>Optional: In the <code>cassandra.yaml</code> file, change the default directory path values for the <code>data_file_directories</code>, <code>commitlog_directory</code>, <code>saved_caches_directory</code>, and <code>hints_directory</code> parameters. These tell Cassandra where to store its data, commit logs, cached files, and hint files.</p> Parameter Default directory path value <code>data_file_directories</code> /var/lib/cassandra/data <code>commitlog_directory</code> /var/lib/cassandra/commitlog <code>saved_caches_directory</code> /var/lib/cassandra/saved_caches <code>hints_directory</code> var/lib/cassandra/hints </li> <li> <p>Set the appropriate permissions on each directory path to ensure Cassandra can read and write data properly.</p> <pre><code>sudo chown -R cassandra:cassandra &lt;directory_path&gt;\n</code></pre> <p>Replace <code>&lt;directory_path&gt;</code> with the actual directory path. Do this for each directory listed in the previous step.</p> </li> <li> <p>Recommended: In the <code>cassandra.yaml</code> file, enable authentication.</p> <p>Set the following parameters with these exact values:</p> <pre><code>authenticator: PasswordAuthenticator\nauthorizer: CassandraAuthorizer \n</code></pre> <p>Danger of no authentication</p> <p>Running Cassandra without authentication is strongly discouraged\u2014especially in production environments. Doing so exposes your database to unauthorized access and can compromise the security of your entire TheHive deployment.</p> </li> <li> <p>Save your modifications in the <code>cassandra.yaml</code> file.</p> </li> </ol> <p>Example of a <code>cassandra.yaml</code> file configuration</p> <pre><code># content from cassandra.yaml\n[..]\ncluster_name: 'thp'\ndata_file_directories:\n- '/var/lib/cassandra/data'\ncommitlog_directory: '/var/lib/cassandra/commitlog'\nsaved_caches_directory: '/var/lib/cassandra/saved_caches'\nhints_directory: '/var/lib/cassandra/hints'\nauthenticator: PasswordAuthenticator\nauthorizer: CassandraAuthorizer\n[..]\n</code></pre>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-33-start-the-cassandra-service", "title": "Step 3.3: Start the Cassandra service", "text": "DEBRPM <ol> <li> <p>Check whether the Cassandra service started automatically before configuring it.</p> <pre><code>systemctl status cassandra\n</code></pre> <p>If it's running, stop it and remove existing data.</p> <pre><code>sudo systemctl stop cassandra\nsudo rm -rf /var/lib/cassandra/*\n</code></pre> </li> <li> <p>Start the Cassandra service.</p> <pre><code>sudo systemctl start cassandra\n</code></pre> </li> <li> <p>Enable the Cassandra service to restart automatically after a system reboot.</p> <pre><code>sudo systemctl enable cassandra\n</code></pre> </li> <li> <p>Verify that Cassandra is running.</p> <pre><code>systemctl status cassandra\n</code></pre> <p>If Cassandra is running, you should see an active status in green.</p> </li> </ol> <ol> <li> <p>Start the Cassandra service by running the following commands:</p> <pre><code>sudo systemctl daemon-reload\nsudo service cassandra start\n</code></pre> <p>Possible warnings</p> <p>When starting Cassandra, you may see warnings. The script will usually end with <code>Starting Cassandra: OK</code>. This only means the process was launched. </p> </li> <li> <p>Enable the Cassandra service to restart automatically after a system reboot.</p> <pre><code>sudo systemctl enable cassandra\n</code></pre> </li> <li> <p>Verify that Cassandra is running.</p> <pre><code>sudo tail -n 50 /var/log/cassandra/system.log\n</code></pre> <p>If Cassandra is running, you should see a line similar to:</p> <pre><code>INFO  [main] ... Startup complete\n</code></pre> </li> </ol> <p>Default port for Cassandra communication</p> <p>Cassandra defaults to listening on port <code>9042/tcp</code> for client communication.</p> <p>Troubleshooting Cassandra</p> <ul> <li>Service won\u2019t start \u2192 Check logs in <code>/var/log/cassandra/</code>. Look for binding or configuration errors in <code>cassandra.yaml</code>.</li> <li>Port 9042 not reachable \u2192 Verify firewall rules and confirm Cassandra is listening with <code>ss -tlnp | grep 9042</code>.</li> </ul>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-34-set-a-secure-password-for-authentication-if-you-enabled-authentication-in-step-32", "title": "Step 3.4: Set a secure password for authentication (if you enabled authentication in Step 3.2)", "text": "<p>By default, Cassandra uses the <code>cassandra</code> username and the password <code>cassandra</code>. For security reasons, especially in production environments, you must change this password immediately after setup.</p> <p>To do this, we'll use CQL, the Cassandra Query Language, which is similar in purpose to SQL.</p> <ol> <li> <p>Connect to Cassandra using default credentials.</p> <pre><code>cqlsh -u cassandra -p cassandra\n</code></pre> <p>Cqlsh may not be available on RPM-based systems</p> <p>On some RPM-based distributions, the <code>cqlsh</code> client isn't included with the <code>cassandra</code> package. If running cqlsh gives an error, download the official Apache Cassandra tarball that matches your server version and extract it. Then run the bundled client: <code>./bin/cqlsh -u cassandra -p cassandra</code>.</p> <p>If the connection is successful, you'll see output similar to:</p> <pre><code>Connected to xxx at xx.xx.xx.xx:xxxx\n[cqlsh 6.1.0 | Cassandra 4.1.9 | CQL spec 3.4.6 | Native protocol v5]\n</code></pre> </li> <li> <p>Change the default password.</p> <pre><code>ALTER USER cassandra WITH PASSWORD '&lt;authentication_cassandra_password&gt;';\n</code></pre> <p>Replace <code>&lt;authentication_cassandra_password&gt;</code> with the password you intend to use for the <code>cassandra</code> superuser account.</p> </li> <li> <p>Disconnect from the session.</p> <p>Press Ctrl+D to exit the <code>cqlsh</code> shell.</p> </li> <li> <p>Reconnect using your new password.</p> <pre><code>cqlsh -u cassandra\n</code></pre> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-35-create-a-new-administrator-role-if-you-enabled-authentication-in-step-32", "title": "Step 3.5: Create a new administrator role (if you enabled authentication in Step 3.2)", "text": "<p>To avoid relying on the default <code>cassandra</code> superuser account, create a new administrator role and then delete the default user.</p> <ol> <li> <p>Create the <code>admin</code> role.</p> <pre><code>CREATE ROLE admin WITH PASSWORD = '&lt;authentication_admin_password&gt;' AND LOGIN = true AND SUPERUSER = true;\n</code></pre> <p>Replace <code>&lt;authentication_admin_password&gt;</code> with the password you intend to use for the <code>admin</code> superuser account.</p> </li> <li> <p>Disconnect from the session.</p> <p>Press Ctrl+D to exit the <code>cqlsh</code> shell.</p> </li> <li> <p>Reconnect as the new admin.</p> <pre><code>cqlsh -u admin\n</code></pre> </li> <li> <p>Remove the default <code>cassandra</code> user.</p> <pre><code>DROP ROLE cassandra;\n</code></pre> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-36-create-the-keyspace-and-a-role-for-thehive-if-you-enabled-authentication-in-step-32", "title": "Step 3.6: Create the keyspace and a role for TheHive (if you enabled authentication in Step 3.2)", "text": "<ol> <li> <p>Create the <code>thehive</code> keyspace with basic replication.</p> <p>A keyspace is the Cassandra equivalent of a database. The replication factor defines how many copies of the data are stored across the cluster.</p> <pre><code>CREATE KEYSPACE thehive\nWITH replication = {\n'class': 'SimpleStrategy',\n'replication_factor': 1\n};\n</code></pre> </li> <li> <p>Verify that the keyspace exists.</p> <pre><code>DESCRIBE KEYSPACES;\n</code></pre> </li> <li> <p>Create a dedicated role for TheHive.</p> <pre><code>CREATE ROLE thehive WITH LOGIN = true AND PASSWORD = '&lt;thehive_role_password&gt;';\n</code></pre> <p>Replace <code>&lt;thehive_role_password&gt;</code> with the password you intend to use for the <code>thehive</code> role.</p> <p>Note this password</p> <p>Keep this password secure. You will need to enter it later in TheHive configuration file so the application can connect to the Cassandra database.</p> </li> <li> <p>Grant access to the keyspace.</p> <pre><code>GRANT ALL PERMISSIONS ON KEYSPACE thehive TO 'thehive';\n</code></pre> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-4-install-and-configure-elasticsearch", "title": "Step 4: Install and configure Elasticsearch", "text": "<p>Elasticsearch is a data indexing and search engine that's used in TheHive to manage data indices. Starting with version 5.5, it can also replace Apache Cassandra (JanusGraph) for storing audit logs.</p> <p>Single node configuration</p> <p>In this guide, we will configure Elasticsearch as a single node on your server, which is fine for running TheHive. If you ever need multiple nodes later for higher performance, redundancy, or failover, refer to Setting up a Cluster with TheHive for detailed instructions.</p> <p>Elasticsearch supported versions</p> <ul> <li>TheHive 5.2.x and earlier: Elasticsearch 7.x only</li> <li>TheHive 5.3.0 - 5.5.9: Elasticsearch 7.x - 8.x</li> <li>TheHive 5.5.10 and later: Elasticsearch 7.x - 9.1.x</li> </ul> <p>If using Elasticsearch for audit log storage, you must use Elasticsearch 7.17 or later.</p> <p>Cortex only supports Elasticsearch 7.x. Sharing an Elasticsearch instance between TheHive and Cortex isn't recommended, but if this setup is required, ensure you use Elasticsearch 7.x.</p> <p>OpenSearch support</p> <p>Starting with version 5.3, TheHive supports OpenSearch for advanced use cases, except for audit log storage.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-41-install-elasticsearch", "title": "Step 4.1: Install Elasticsearch", "text": "DEBRPMOther installation methods <ol> <li> <p>Add Elasticsearch repository references.</p> <p>a. Download Elasticsearch repository keys.</p> <pre><code>wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch |  sudo gpg --dearmor -o /usr/share/keyrings/elasticsearch-keyring.gpg\nsudo apt-get install apt-transport-https\n</code></pre> <p>b. Check if the <code>/etc/apt/sources.list.d/elastic-7.x.list</code> file exists. If it doesn't, create it.</p> <p>c. Add the repository to your system by appending the following line to the <code>/etc/apt/sources.list.d/elastic-7.x.list</code> file.</p> <pre><code>echo \"deb [signed-by=/usr/share/keyrings/elasticsearch-keyring.gpg] https://artifacts.elastic.co/packages/7.x/apt stable main\" |  sudo tee /etc/apt/sources.list.d/elastic-7.x.list \n</code></pre> </li> <li> <p>Update your package index and install Elasticsearch using the following commands:</p> <pre><code>sudo apt update\nsudo apt install elasticsearch\n</code></pre> </li> </ol> <p>Refer to the official Elasticsearch documentation website for the most up-to-date instructions.</p> <ol> <li> <p>Add Elasticsearch repository references.</p> <p>a. Download Elasticsearch repository keys.</p> <pre><code>sudo rpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch\n</code></pre> <p>b. Check if the <code>/etc/yum.repos.d/elasticsearch.repo</code> file exists. If it doesn't, create it.</p> <p>c. Add the repository to your system by appending the following line to the <code>/etc/yum.repos.d/elasticsearch.repo</code> file.</p> <pre><code>echo \"[elasticsearch]\nname=Elasticsearch repository for 7.x packages\nbaseurl=https://artifacts.elastic.co/packages/7.x/yum\ngpgcheck=1\ngpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch\nenabled=0\" | sudo tee /etc/yum.repos.d/elasticsearch.repo\n</code></pre> </li> <li> <p>Update your package index and install Elasticsearch using the following commands:</p> <pre><code>sudo yum -y update\nsudo yum install --enablerepo=elasticsearch elasticsearch\n</code></pre> </li> </ol> <p>Refer to the official Elasticsearch documentation website for the most up-to-date instructions.</p> <p>Download the tar.gz archive from http://cassandra.apache.org/download/ and extract it into the folder of your choice. You can use utilities like Wget to download the archive.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-42-configure-elasticsearch", "title": "Step 4.2: Configure Elasticsearch", "text": ""}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#configure-the-etcelasticsearchelasticsearchyml-file", "title": "Configure the <code>/etc/elasticsearch/elasticsearch.yml</code> file", "text": "<ol> <li> <p>Open the <code>/etc/elasticsearch/elasticsearch.yml</code> file using a text editor.</p> </li> <li> <p>In the <code>elasticsearch.yml</code> file, set the <code>cluster.name</code> parameter to the desired name. This name will help identify your Elasticsearch cluster.</p> <p>Replace <code>my-application</code> with your new cluster name.</p> <p>Default commented line</p> <p>This line is commented out by default. Uncomment it to ensure your new value is applied.</p> </li> <li> <p>In the <code>elasticsearch.yml</code> file, set the <code>thread_pool.search.queue_size</code> to the desired number. This parameter controls how many search requests Elasticsearch can queue at the same time. If the queue is full, new requests will wait or be rejected.</p> <p>Add the following line (or edit it if it already exists):</p> <pre><code>thread_pool.search.queue_size: &lt;requests_limit&gt;\n</code></pre> <p>Replace <code>&lt;requests_limit&gt;</code> with the number of requests you want to allow in the queue. For example, you can use <code>100000</code> for a single-node setup.</p> </li> <li> <p>Optional: In the <code>elasticsearch.yml</code> file, change the default directory path values for the <code>path.data</code> and <code>path.logs</code> parameters. That tells Elasticsearch where to store its data and logs.</p> Parameter Default directory path value <code>path.data</code> /var/lib/elasticsearch <code>path.logs</code> /var/log/elasticsearch </li> <li> <p>Recommended: Activate X-Pack security. It controls authentication, encryption, and other security features in Elasticsearch.</p> <p>In the <code>elasticsearch.yml</code> file, add the desired security parameters from the official Elasticsearch security settings documentation. </p> <p>At minimum add the following line (or edit it if it already exists):</p> <pre><code>xpack.security.enabled: true\n</code></pre> <p>Deactivating X-Pack security</p> <p>You can deactivate X-Pack security by setting <code>xpack.security.enabled: false</code>, but this is strongly discouraged\u2014especially in production environments. Doing so leaves your Elasticsearch instance unprotected against unauthorized access and compromises the security of your entire TheHive deployment.</p> </li> <li> <p>Optional: In the <code>elasticsearch.yml</code> file, set the <code>script.allowed_types</code> parameter. This controls what types of scripts Elasticsearch is allowed to run for calculations, aggregations, or custom logic on your data.</p> <p>By default, Elasticsearch allows both inline and stored scripts. For a standard single-node setup, you usually don\u2019t need to change this.</p> <p>You can restrict this if you want to allow only one type\u2014or none by adding the following line (or edit it if it already exists):</p> <pre><code>script.allowed_types: &lt;allowed_type&gt;\n</code></pre> <p>Replace <code>&lt;allowed_type&gt;</code> with the type you want to allow: <code>inline</code>, <code>stored</code>, or <code>none</code>.</p> </li> <li> <p>Save your modifications in the <code>elasticsearch.yml</code> file.</p> </li> </ol> <p>Example of a <code>elasticsearch.yml</code> file configuration</p> <pre><code># content from /etc/elasticsearch/elasticsearch.yml\n[..]\ncluster.name: hive\nthread_pool.search.queue_size: 100000\npath.logs: \"/var/log/elasticsearch\"\npath.data: \"/var/lib/elasticsearch\"\nxpack.security.enabled: true\n[..]\n</code></pre>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#configure-the-etcelasticsearchjvmoptionsdjvmoptions-file", "title": "Configure the <code>/etc/elasticsearch/jvm.options.d/jvm.options</code> file", "text": "<ol> <li> <p>Check if the <code>/etc/elasticsearch/jvm.options.d/jvm.options</code> exists. If it doesn't, create it.</p> </li> <li> <p>Open the <code>/etc/elasticsearch/jvm.options.d/jvm.options</code> file using a text editor.</p> </li> <li> <p>In the <code>jvm.options</code> file, set the Java virtual machine (JVM) options.</p> <p>The JVM is what runs Elasticsearch. The JVM options control how much memory Elasticsearch can use, how it manages that memory, and other performance-related settings.</p> <p>Heap size configuration</p> <p>Heap allocation must not exceed 50% of the total system RAM.</p> <p>Undefined heap settings may cause memory contention or out-of-memory errors.</p> <p>On a 12 GB RAM system, for example:</p> <pre><code>-Dlog4j2.formatMsgNoLookups=true\n-Xms6g\n-Xmx6g\n</code></pre> <p><code>Xms</code> defines the initial heap size allocated to the JVM, and <code>Xmx</code> sets the maximum heap size. Setting them to the same value is recommended for stable performance and predictable garbage collection.</p> </li> <li> <p>Save your modifications in the <code>jvm.options</code> file.</p> </li> </ol> <p>Index creation and management in TheHive</p> <ul> <li>Index creation occurs during TheHive initial startup, which may take some time to complete.</li> <li>Similar to data and files, include indexes in the backup policy to ensure their preservation.</li> <li>Remove and re-create indexes as needed.</li> </ul>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-43-start-the-elasticsearch-service", "title": "Step 4.3: Start the Elasticsearch service", "text": "DEBRPM <ol> <li> <p>Check whether the Elasticsearch service started automatically before configuring it.</p> <pre><code>systemctl status elasticsearch\n</code></pre> <p>If it's running, stop it and remove existing data.</p> <pre><code>sudo systemctl stop elasticsearch\nsudo rm -rf /var/lib/elasticsearch/*\n</code></pre> </li> <li> <p>Start the Elasticsearch service.</p> <pre><code>sudo systemctl start elasticsearch\n</code></pre> </li> <li> <p>Enable the Elasticsearch service to restart automatically after a system reboot.</p> <pre><code>sudo systemctl enable elasticsearch\n</code></pre> </li> <li> <p>Verify that Elasticsearch is running.</p> <pre><code>systemctl status elasticsearch\n</code></pre> <p>If Elasticsearch is running, you should see an active status in green.</p> </li> </ol> <ol> <li> <p>Check whether the Elasticsearch service started automatically before configuring it.</p> <pre><code>systemctl status elasticsearch\n</code></pre> <p>If it's running, stop it and remove existing data.</p> <pre><code>sudo systemctl stop elasticsearch\nsudo rm -rf /var/lib/elasticsearch/*\n</code></pre> </li> <li> <p>Start the Elasticsearch service by running the following commands:</p> <pre><code>sudo systemctl daemon-reload\nsudo systemctl start elasticsearch\n</code></pre> </li> <li> <p>Enable the Elasticsearch service to restart automatically after a system reboot.</p> <pre><code>sudo systemctl enable elasticsearch\n</code></pre> </li> <li> <p>Verify that Elasticsearch is running.</p> <pre><code>systemctl status elasticsearch\n</code></pre> <p>If Elasticsearch is running, you should see an active status in green.</p> </li> </ol> <p>Troubleshooting Elasticsearch</p> <ul> <li>Service not starting \u2192 Check <code>/var/log/elasticsearch/</code> for JVM errors or heap misconfiguration.</li> <li>Memory issues \u2192 Ensure heap (<code>Xms</code>/<code>Xmx</code>) is no more than 50% of system RAM.</li> </ul>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-44-permissions", "title": "Step 4.4: Set a user with the right permissions for TheHive (if you enabled X-Pack security in Step 4.2)", "text": "<ol> <li> <p>Create a <code>thehive</code> user.</p> <pre><code>sudo /usr/share/elasticsearch/bin/elasticsearch-users useradd thehive -p &lt;thehive_user_password&gt; -r superuser\n</code></pre> <p>Replace <code>&lt;thehive_user_password&gt;</code> with a secure password you choose for your TheHive user.</p> <p>Note this password</p> <p>Keep this password secure. You will need to enter it later in TheHive configuration file so the application can connect to Elasticsearch.</p> </li> <li> <p>Optional: Set a password for the <code>elastic</code> user.</p> <ul> <li>For Elasticsearch 7.x:</li> </ul> <pre><code>sudo /usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive\n</code></pre> <ul> <li>For Elasticsearch 8.0:</li> </ul> <pre><code>sudo /usr/share/elasticsearch/bin/elasticsearch-reset-password\n</code></pre> <p>Skip this step if the password is already set.</p> </li> <li> <p>Create or update a role with the privileges needed for TheHive.</p> <ul> <li>Create a role:</li> </ul> <pre><code>curl -u elastic:&lt;elastic_user_password&gt; -X POST \"http://localhost:9200/_security/role/thehive_role\" -H \"Content-Type: application/json\" -d '\n{\n  \"cluster\": [\"manage\"],\n  \"indices\": [\n    {\n      \"names\": [\"thehive*\"],\n      \"privileges\": [\"all\"]\n    }\n  ]\n}'\n</code></pre> <p>Replace <code>&lt;elastic_user_password&gt;</code> with the password you set for the <code>elastic</code> user.</p> <p>If successful, the command should return: <code>{\"role\":{\"created\":true}}</code>.</p> <p>For more details, refer to the official Elasticsearch API documentation for role creation.</p> <ul> <li>Update a role:</li> </ul> <pre><code>curl -u elastic:&lt;elastic_user_password&gt; -X PUT \"http://localhost:9200/_security/role/&lt;role&gt;\" -H \"Content-Type: application/json\" -d '\n{\n  \"cluster\": [\"manage\"],\n  \"indices\": [\n    {\n      \"names\": [\"thehive*\"],\n      \"privileges\": [\"all\"]\n    }\n  ]\n}'\n</code></pre> <p>Replace <code>&lt;role&gt;</code> with the actual role name you want to update.</p> <p>Replace <code>&lt;elastic_user_password&gt;</code> with the password you set for the <code>elastic</code> user.</p> <p>For more details, refer to the official Elasticsearch API documentation for updating roles.</p> </li> <li> <p>Assign the role to the user you'll use for TheHive.</p> <pre><code>curl -u elastic:&lt;elastic_user_password&gt; -X PUT \"http://localhost:9200/_security/user/thehive\" \\\n-H \"Content-Type: application/json\" \\\n-d '{\n    \"password\" : \"&lt;thehive_user_password&gt;\",\n    \"roles\" : [\"thehive_role\"]\n}'\n</code></pre> <p>Replace <code>&lt;thehive_user_password&gt;</code> with the password you set for the <code>thehive</code> user.</p> <p>Replace <code>&lt;elastic_user_password&gt;</code> with the password you set for the <code>elastic</code> user.</p> <p>Replace <code>thehive_role</code> with actual role name if different.</p> <p>If successful, the command should return: <code>{\"created\":true}</code>.</p> <p>For more details, refer to the official Elasticsearch API documentation for updating users.</p> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-5-install-and-configure-thehive", "title": "Step 5: Install and configure TheHive", "text": ""}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-51-install-thehive", "title": "Step 5.1: Install TheHive", "text": "<p>TheHive packages are distributed as RPM and DEB files, as well as ZIP binary packages, all available for direct download via tools like Wget or cURL, with installation performed manually.</p> <p>All packages are hosted on an HTTPS-secured website and come with a SHA256 checksum and a GPG signature for verification.</p> DEBRPMZIP binary packages <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\nwget -O /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\nwget -O /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\nwget -O /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\nwget -O /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\ncurl -o /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\ncurl -o /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\ncurl -o /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\ncurl -o /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive_5.5.10-1_all.deb.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive_5.5.10-1_all.deb.asc /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>apt-get</code> to manage dependencies automatically:</p> <pre><code>sudo apt-get install /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> <li> <p>Using <code>dpkg</code>:</p> <pre><code>sudo dpkg -i /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> </ul> </li> </ol> <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive-5.5.10-1.noarch.rpm.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive-5.5.10-1.noarch.rpm.asc /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>yum</code> to manage dependencies automatically:</p> <pre><code>sudo yum install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>dnf</code> to manage dependencies automatically:</p> <pre><code>sudo dnf install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>rpm</code>:</p> <pre><code>sudo rpm -ivh /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> </ul> </li> </ol> <p>If you prefer more control over where TheHive is installed, need to use it in environments without package managers, or want to avoid dependency issues, you can install TheHive by downloading a ZIP binary package.</p> <p>Destination path</p> <p>The commands below use <code>/opt/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the binary package along with its SHA256 checksum and signature files. You can install TheHive anywhere on your filesystem.</p> <ul> <li> <p>Using Wget</p> <pre><code>wget -O /opt/thehive-5.5.10-1.zip https://thehive.download.strangebee.com/5.5/zip/thehive-5.5.10-1.zip\nwget -O /opt/thehive-5.5.10-1.zip.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.zip.sha256\nwget -O /opt/thehive-5.5.10-1.zip.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.zip.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /opt/&lt;file_name&gt;.zip thehive.download.strangebee.com/&lt;major.minor_version&gt;/zip/&lt;file_name&gt;.zip\nwget -O /opt/&lt;file_name&gt;.zip.sha256 thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.zip.sha256\nwget -O /opt/&lt;file_name&gt;.zip.asc thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.zip.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL</p> <pre><code>curl -o /opt/thehive-5.5.10-1.zip https://thehive.download.strangebee.com/5.5/zip/thehive-5.5.10-1.zip\ncurl -o /opt/thehive-5.5.10-1.zip.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.zip.sha256\ncurl -o /opt/thehive-5.5.10-1.zip.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.zip.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /opt/&lt;file_name&gt;.zip thehive.download.strangebee.com/&lt;major.minor_version&gt;/zip/&lt;file_name&gt;.zip\ncurl -o /opt/&lt;file_name&gt;.zip.sha256 thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.zip.sha256\ncurl -o /opt/&lt;file_name&gt;.zip.asc thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.zip.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /opt/thehive-5.5.10-1.zip\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /opt/thehive-5.5.10-1.zip.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with unzipping or installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <pre><code>wget -O /opt/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /opt/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /opt/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /opt/thehive-5.5.10-1.zip.asc /opt/thehive-5.5.10-1.zip\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Unzip the package.</p> <p>Unzip paths</p> <ul> <li>Replace <code>/opt/thehive-5.5.10-1.zip</code> with the full path to the ZIP file you downloaded.</li> <li>Replace <code>/opt/</code> after <code>-d</code> with the directory where you want to extract the contents of the archive.</li> </ul> <pre><code>unzip /opt/thehive-5.5.10-1.zip -d /opt/\nsudo ln -s /opt/thehive-5.5.10-1 /opt/thehive\n</code></pre> </li> <li> <p>Prepare the system by creating a dedicated, non-privileged user account to run TheHive. Ensure this user has permission to create log files in <code>/opt/thehive/logs</code>.</p> <pre><code>sudo addgroup thehive\nsudo adduser --system thehive\nsudo chown -R thehive:thehive /opt/thehive\nsudo mkdir /etc/thehive\nsudo touch /etc/thehive/application.conf\nsudo chown root:thehive /etc/thehive\nsudo chgrp thehive /etc/thehive/application.conf\nsudo chmod 640 /etc/thehive/application.conf\n</code></pre> </li> <li> <p>Copy the systemd script into <code>/etc/systemd/system/thehive.service</code>.</p> <pre><code>cd /tmp\nwget https://raw.githubusercontent.com/TheHive-Project/TheHive/master/package/thehive.service\nsudo cp thehive.service /etc/systemd/system/thehive.service\n</code></pre> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-52-configure-thehive", "title": "Step 5.2: Configure TheHive", "text": "<p>Standalone server configuration</p> <p>In this guide, we will configure TheHive for a standalone server, with all components hosted on a single server. This setup is suitable for testing and production environments. For cluster deployments, refer to Setting up a Cluster with TheHive.</p> <ol> <li> <p>Open the <code>/etc/thehive/application.conf</code> file using a text editor.</p> </li> <li> <p>In the <code>application.conf</code> file, configure the service.</p> <p>To ensure TheHive works correctly\u2014especially with authentication mechanisms such as SSO\u2014configure the <code>application.baseUrl</code> and <code>play.http.context</code> parameters. If required, you can also adjust <code>http.address</code> and <code>http.port</code>.</p> <p>Default configuration:</p> <pre><code>[..]\n# Service configuration\napplication.baseUrl = \"http://localhost:9000\"\nplay.http.context = \"/\"\n[..]\n</code></pre> </li> <li> <p>Optional: Configure the secret key for the Play Framework.</p> <p>TheHive uses a secret key to sign session cookies and ensure secure user authentication.</p> <p>Skip this step if you installed TheHive using DEB or RPM packages\u2014they generate the key automatically.</p> <p>a. For other installation methods, generate and configure a secret key.</p> <pre><code>cat &gt; /etc/thehive/secret.conf &lt;&lt; _EOF_\nplay.http.secret.key=\"$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 64 | head -n 1)\"\n_EOF_\n</code></pre> <p>Minimum key length</p> <p>TheHive 5.4 and later requires a minimum 32-character secret key. The command above generates a 64-character key for enhanced security.</p> <p>b. Set appropriate file permissions.</p> <pre><code>chmod 400 /etc/thehive/secret.conf\nchown thehive:thehive /etc/thehive/secret.conf\n</code></pre> <p>Security requirements</p> <p>Never share or commit your secret key to version control. Use different keys for each environment (development, staging, production).</p> </li> <li> <p>In the <code>application.conf</code> file, configure the database and index.</p> <p>Example of database and index configuration with authentication</p> <pre><code># Content from /etc/thehive/application.conf\n[..]\n# Database and index configuration\ndb.janusgraph {\n    storage {\n        backend = cql\n        hostname = [\"127.0.0.1\"]\n        # Cassandra authentication (recommended)\n        username = \"thehive\"\n        password = \"&lt;thehive_role_password&gt;\"\n        cql {\n            keyspace = thehive\n        }\n    }\n    index.search {\n        backend = elasticsearch\n        hostname = [\"127.0.0.1\"]\n        index-name = thehive\n        # Elasticsearch authentication (recommended)\n        elasticsearch {\n            http {\n                auth {\n                    type = basic\n                    basic {\n                        username = \"thehive\"\n                        password = \"&lt;thehive_user_password&gt;\"\n                    }\n                }\n            }\n        }\n    }\n}\n[..]\n</code></pre> <p>Replace <code>&lt;thehive_role_password&gt;</code> with the password set in Step 3.6.</p> <p>Replace <code>&lt;thehive_user_password&gt;</code> with the password set in Step 4.4.</p> <p>You can remove the lines under <code># Cassandra authentication (recommended)</code> and <code># Elasticsearch authentication (recommended)</code> if you didn\u2019t enable authentication for Cassandra or Elasticsearch.</p> <p>To set up SSL for Cassandra and Elasticsearch connections, see Configure Database and Index SSL.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#applicationbaseurl", "title": "application.baseUrl", "text": "<p>Replace <code>http://localhost:9000</code> with the actual public URL that users will use to access TheHive.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#mandatory-elements", "title": "Mandatory elements", "text": "<ul> <li>Protocol: Either <code>http</code> or <code>https</code>, depending on whether you configured HTTPS with a reverse proxy.</li> <li>Host name: The DNS name or IP address that users enter in their browser.</li> </ul>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#optional-elements", "title": "Optional elements", "text": "<ul> <li>Port: The network port where TheHive is exposed. Include a port only when the public URL uses a non-standard port. Standard ports are <code>80</code> for HTTP and <code>443</code> for HTTPS.</li> <li>Path segments: Needed if TheHive runs behind a reverse proxy under a subpath.</li> </ul> <p>Listen address and port</p> <p>By default, TheHive listens on all network interfaces (<code>0.0.0.0</code>) at port <code>9000</code>. These settings control how TheHive listens internally on the host and are independent of the public URL defined in <code>application.baseUrl</code>.</p> <ul> <li>Use <code>http.address</code> and <code>http.port</code> to control how the service listens on the host.</li> <li>Use <code>application.baseUrl</code> to define the public URL that TheHive communicates to clients.</li> </ul> <p>To customize the listen address and port, see Update TheHive Service Configuration.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#playhttpcontext", "title": "play.http.context", "text": "<p>If TheHive is served under a subpath when running behind a reverse proxy, set <code>play.http.context</code> to the matching path segment.</p> <p>For configuration details, see Update TheHive Service Configuration.</p> <p>For additional guidance on proxy usage, see Configure HTTPS for TheHive With a Reverse Proxy.</p> <p>Service configuration examples</p> <ul> <li> <p>Root domain:</p> <p>Without explicit port:</p> <pre><code>application.baseUrl = \"https://thehive.example.org\"\nplay.http.context = \"/\"\n</code></pre> <p>With explicit port:</p> <pre><code>application.baseUrl = \"https://thehive.example.org:9000\"\nplay.http.context = \"/\"\n</code></pre> </li> <li> <p>Custom path behind a reverse proxy:</p> <p>Without explicit port:</p> <pre><code>application.baseUrl = \"https://example.org/thehive\"\nplay.http.context = \"/thehive\"\n</code></pre> <p>With explicit port:</p> <pre><code>application.baseUrl = \"https://example.org:9000/thehive\"\nplay.http.context = \"/thehive\"\n</code></pre> </li> </ul>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-53-audit-log-storage", "title": "(Optional) Step 5.3: 5.5 Configure audit log storage", "text": "<p>By default, TheHive stores audit logs in Apache Cassandra via JanusGraph. However, if your organization generates a large volume of audit logs, you can switch to Elasticsearch.</p> <p>Elasticsearch offers better performance, reduced latency, and advanced search capabilities.</p> <p>Audit logs visibility</p> <ul> <li>With Elasticsearch, audit logs retain the visibility they had at the time of creation, regardless of the current visibility of the case. This means that even if you set restricted visibility for a case, audit logs remain visible to all users who originally had access.</li> <li>With the default configuration using Apache Cassandra (JanusGraph), audit logs immediately become private if the visibility of the associated case is restricted. This means that even if audit logs were originally public, they will be hidden from all users once the case visibility is restricted.</li> </ul> <p>Backups required</p> <p>Regularly back up your Elasticsearch indices to ensure you can recover audit logs in the event of an incident. This is critical for maintaining the integrity and availability of your data.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#activate-audit-log-storage", "title": "Activate audit log storage", "text": "<ol> <li> <p>Open the <code>/etc/thehive/application.conf</code> file.</p> </li> <li> <p>In the <code>application.conf</code> file, activate audit log storage in Elasticsearch by adding the following lines:</p> <pre><code>audit {\n  storage = elasticsearch\n}\n</code></pre> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#optional-configure-index-template-and-index-lifecycle-management-ilm", "title": "Optional: Configure index template and Index Lifecycle Management (ILM)", "text": "<p>Adjust the <code>application.conf</code> file to configure the index template and Index Lifecycle Management (ILM) policy for the <code>thehive-audits</code> index. These settings control how Elasticsearch stores, rolls over, and deletes audit logs.</p> <p>Supported configuration keys:</p> <ul> <li><code>index-name</code>: Name of the Elasticsearch index for audit logs (default: <code>thehive-audits</code>)</li> <li><code>health-request-timeout</code>: Timeout for checking cluster health</li> <li><code>create.ext.number_of_replicas</code>: Number of index replicas</li> <li><code>create.ext.number_of_shards</code>: Number of index shards</li> <li><code>request-timeout</code>: Timeout for Elasticsearch requests</li> <li><code>hot.rollover.maxAge</code>: Maximum age of an index before rollover</li> <li><code>hot.rollover.maxSize</code>: Maximum size of an index before rollover</li> <li><code>delete.minAge</code>: Minimum age before an index is deleted</li> </ul> <p>Example</p> <p>To create a new index every day or when it reaches 1 GB, and retain it for 7 days, use the following configuration:</p> <pre><code>audit {\n    storage = elasticsearch\n    elasticsearch {\n        hot.rollover {\n            maxAge = 1d\n            maxSize = 1g\n        }\n        delete.minAge = 7d\n    }\n}\n</code></pre> <p>Index name conflict</p> <p>The index name shouldn't be the same as the one used in JanusGraph. If you don\u2019t configure a specific name, TheHive uses the JanusGraph index name appended with the suffix <code>-audits</code>.</p> <p>Based on the configuration above, TheHive automatically generates the index template and ILM policy when it first writes audit data to Elasticsearch.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#index-template", "title": "Index template", "text": "<p>Default generated index template:</p> <pre><code>{\n  \"index\": {\n    \"lifecycle\": {\n      \"name\": \"thehive-audits\"\n    },\n    \"number_of_shards\": \"1\",\n    \"number_of_replicas\": \"1\"\n  }\n}\n</code></pre>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#ilm", "title": "ILM", "text": "<p>Default generated ILM:</p> <pre><code>{\n  \"policy\": {\n    \"phases\": {\n      \"hot\": {\n        \"min_age\": \"0ms\",\n        \"actions\": {\n          \"set_priority\": {\n            \"priority\": 100\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre> <p>ILM generated from the example configuration</p> <p>Based on the example configuration, TheHive will generate the following ILM policy:</p> <pre><code>{\n  \"policy\": {\n      \"phases\": {\n          \"hot\": {\n              \"min_age\": \"0ms\",\n              \"actions\": {\n                  \"set_priority\": {\n                      \"priority\": 100\n                  },\n                  \"rollover\": {\n                      \"max_primary_shard_size\": \"1gb\",\n                      \"max_age\": \"1d\"\n                  }\n              }\n          },\n          \"delete\": {\n              \"min_age\": \"7d\",\n              \"actions\": {\n                  \"delete\": {\n                      \"delete_searchable_snapshot\": true\n                  }\n              }\n          }\n      }\n  }\n}\n</code></pre> <p>API calls changes</p> <p>After migrating to Elasticsearch, the following Query API calls no longer work with audit logs stored in Elasticsearch:</p> <ul> <li><code>listAudit</code></li> <li><code>listAuditFromObject</code></li> <li><code>getAudit</code></li> </ul> <p>Instead, use the following API endpoints:</p> <ul> <li><code>/api/v1/audit/list</code></li> <li><code>/api/v1/audit/count</code></li> <li><code>/api/v1/audit/$ID</code></li> </ul> <p>These API calls are currently available but not yet officially documented and may change in future releases.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-54-create-the-file-storage-directory", "title": "Step 5.4: Create the file storage directory", "text": "<p>Standalone server configuration</p> <p>In this guide, we will configure local file storage for TheHive running on a standalone server, with all components hosted on the same server. This setup is suitable for testing and production environments. For cluster deployments, refer to Setting up a Cluster with TheHive.</p> <p>File storage contains attachments from cases, alerts, and organizations, as well as observables of type file. These items are stored as-is.</p> <p>On a standalone server, these files are stored on the local filesystem. By default, TheHive uses <code>/opt/thp/thehive/files</code> as the storage path.</p> <ol> <li> <p>Create the storage directory.</p> <pre><code>sudo mkdir -p /opt/thp/thehive/files\n</code></pre> </li> <li> <p>Set ownership and permissions so that only the <code>thehive</code> user can read and write files.</p> <pre><code>sudo chown -R thehive:thehive /opt/thp/thehive/files\nsudo chmod 700 /opt/thp/thehive/files\n</code></pre> </li> </ol> <p>Storage location</p> <p>You can change this default location by updating the <code>localfs.location</code> parameter in the <code>application.conf</code> file.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-55-configure-cortex-and-misp-integration", "title": "Step 5.5: Configure Cortex and MISP integration", "text": "<p>Cortex support</p> <p>5.5 Cortex 3.1.5 and earlier are no longer supported since version 5.5.</p> <p>By default, TheHive enables both the Cortex and the Malware Information Sharing Platform MISP integration modules.</p> <p>When you connect TheHive to Cortex, you can use analyzers to look up extra information about observables and get clear reports with the results. You can also use responders to take automatic actions on cases, alerts, or tasks to help with investigations and incident response.</p> <p>When you connect TheHive to MISP, you can bring in threat intelligence by importing MISP events as alerts or cases to support your investigations. You can also share your findings back to MISP by exporting observables marked as indicators of compromise (IOCs) so other teams and communities can benefit.</p> <p>If you don't plan to use either of these services, you can deactivate the corresponding module by uncommenting the related configuration line in the <code>application.conf</code> file.</p> <ul> <li>To deactivate the Cortex module:</li> </ul> <pre><code>scalligraph.disabledModules += org.thp.thehive.connector.cortex.CortexModule\n</code></pre> <ul> <li>To deactivate the MISP module:</li> </ul> <pre><code>scalligraph.disabledModules += org.thp.thehive.connector.misp.MispModule\n</code></pre>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#step-56-start-thehive-service", "title": "Step 5.6: Start TheHive service", "text": "<ol> <li> <p>Start TheHive service and enable it at boot.</p> <pre><code>sudo systemctl start thehive\nsudo systemctl enable thehive\n</code></pre> </li> <li> <p>Verify that TheHive is running.</p> <pre><code>systemctl status thehive\n</code></pre> <p>If TheHive is running, you should see an active status in green.</p> <p>Service startup delay</p> <p>Be aware that the service may take some time to start initially.</p> <p>Troubleshooting TheHive</p> <p>If you run into issues, see the Troubleshooting page for guidance.</p> </li> <li> <p>Open your web browser and go to the URL you configured in the <code>application.baseUrl</code> setting inside the <code>/etc/thehive/application.conf</code> file.</p> <p>Port and path segment</p> <p>If you configured <code>application.baseUrl</code> with an explicit port or a path segment, be sure to include them in the URL.</p> </li> <li> <p>Perform the initial setup of the application by following the instructions in Perform Initial Login and Setup as an Admin.</p> </li> </ol>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#advanced-configuration", "title": "Advanced configuration", "text": "<p>For additional customization, see the Configuration and Operations sections of this documentation.</p> <p>To enable HTTPS, follow the instructions in Configure HTTPS for TheHive With a Reverse Proxy.</p> <p>To enable GDPR compliance, follow the instructions in Enable the GDPR Compliance Feature.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#backup", "title": "Backup", "text": "<p>Choose between cold backups or hot backups depending on your operational requirements.  </p> <p>See detailed steps in the Backup &amp; Restore Operations section.</p>"}, {"location": "thehive/installation/installation-guide-linux-standalone-server/#monitoring", "title": "MonitoringNext steps", "text": "<p>We recommend setting up monitoring to track key performance metrics such as request latency, CPU usage, and memory consumption.  </p> <p>See the Monitoring page for detailed instructions.</p> <ul> <li>Turn Off The Cortex Integration</li> <li>Turn Off The MISP Integration</li> <li>Update Log Configuration</li> <li>Update TheHive Service Configuration</li> <li>Enable the GDPR Compliance Feature</li> <li>Configure HTTPS for TheHive With a Reverse Proxy</li> <li>Update TheHive Service Configuration</li> <li>Hot Backups</li> <li>Cold Backups for Physical Servers</li> <li>Cold Backups for Virtual Servers</li> <li>Monitoring</li> <li>Troubleshooting</li> </ul>"}, {"location": "thehive/installation/installation-methods/", "title": "Installation Methods", "text": ""}, {"location": "thehive/installation/installation-methods/#thehive-installation-methods", "title": "TheHive Installation Methods", "text": "<p>TheHive can be installed on a standalone server or deployed in a clustered environment, depending on your infrastructure requirements. Choose the best approach for your use case.</p>"}, {"location": "thehive/installation/installation-methods/#single-server-installation", "title": "Single server installation", "text": "<p>Install TheHive and all required components on a standalone server. See the architecture overview for details.</p>"}, {"location": "thehive/installation/installation-methods/#debian-ubuntu", "title": "Debian /  Ubuntu", "text": "<p>For Debian- or Ubuntu-based OS, follow the installation guide using the DEB tab to install and configure TheHive.</p>"}, {"location": "thehive/installation/installation-methods/#redhat-enterprise-linux-fedora", "title": "RedHat Enterprise Linux /  Fedora", "text": "<p>For RedHat- or Fedora-based OS, follow the installation guide using the RPM tab to install and configure TheHive.</p>"}, {"location": "thehive/installation/installation-methods/#zip-binary-packages", "title": "ZIP binary packages", "text": "<p>For manual installation or environments without package managers, follow the installation guide using the ZIP binary packages tab to install and configure TheHive.</p>"}, {"location": "thehive/installation/installation-methods/#docker", "title": "Docker", "text": "<p>TheHive image is available on Docker Hub. To deploy TheHive with all required services using Docker Compose, see Running TheHive with Docker.</p>"}, {"location": "thehive/installation/installation-methods/#cluster-deployment", "title": "Cluster deployment", "text": "<p>Deploy TheHive and all required components across multiple nodes to achieve scalability and high availability. See the architecture overview for details.</p>"}, {"location": "thehive/installation/installation-methods/#linux", "title": "Linux", "text": "<p>Configure a multi-node cluster with TheHive and its components running on dedicated hosts. See Setting Up a Cluster with TheHive for instructions.</p>"}, {"location": "thehive/installation/installation-methods/#kubernetes", "title": "Kubernetes", "text": "<p>Deploy TheHive on Kubernetes using the official Helm chart. See Deploy TheHive on Kubernetes for instructions.</p>"}, {"location": "thehive/installation/kubernetes/", "title": "Deploy on Kubernetes", "text": ""}, {"location": "thehive/installation/kubernetes/#deploy-thehive-on-kubernetes", "title": "Deploy TheHive on Kubernetes", "text": "<p>Deploy TheHive on a Kubernetes cluster using the StrangeBee Helm chart repository.</p> <p>License</p> <p>The Community license supports only a single node. To deploy multiple TheHive nodes, you must upgrade to a Gold or Platinum license. A fresh deployment of TheHive on an empty database includes a 14-day Platinum trial, allowing you to test multi-node setups.</p> <p>Dependency images</p> <p>The default Cassandra and Elasticsearch images used by the dependency Helm charts come from Bitnami.  </p> <p>Following Bitnami decision to stop maintaining multiple freely available image versions, StrangeBee Helm charts now reference the <code>bitnamilegacy</code> repository for Cassandra and Elasticsearch. Bitnami latest public images ship Cassandra 5, which isn't compatible with TheHive, and Elasticsearch 9.</p> <p>This has important consequences:</p> <ul> <li>These legacy images won't receive security updates and will become increasingly vulnerable over time. You may continue to use them at your own risk, but they aren't production-ready.</li> <li>You can pay Bitnami for access to updated images and configure the Helm chart to reference them.</li> <li>Alternatively, you can deactivate the dependency Helm charts and bring your own Cassandra and Elasticsearch deployments.</li> </ul>"}, {"location": "thehive/installation/kubernetes/#architecture-overview", "title": "Architecture overview", "text": "<p>The default deployment includes:</p> <ul> <li>TheHive application pods</li> <li>A two-node Cassandra cluster for data storage</li> <li>A two-node Elasticsearch cluster for search indexing</li> <li>A MinIO instance for S3-compatible object storage</li> </ul>"}, {"location": "thehive/installation/kubernetes/#infrastructure-requirements", "title": "Infrastructure requirements", "text": "<ul> <li>Kubernetes cluster v1.23.0 or later</li> <li>Helm v3.8.0 or later</li> <li>Minimum resources per node: see TheHive Installation System Requirements</li> <li>StorageClass with dynamic provisioning</li> <li>Network policies allowing inter-pod communication</li> </ul>"}, {"location": "thehive/installation/kubernetes/#deploy-with-default-configuration", "title": "Deploy with default configuration", "text": "<p>TheHive provides an official Helm chart for Kubernetes deployments. The default configuration is designed for development environments and requires modifications for production use. See Production configuration for required adjustments.</p> <ol> <li> <p>Add the StrangeBee Helm repository.</p> <pre><code>helm repo add strangebee https://strangebeecorp.github.io/helm-charts\n</code></pre> </li> <li> <p>Update your local Helm repositories.</p> <pre><code>helm repo update\n</code></pre> </li> <li> <p>Create a release using the <code>thehive</code> Helm chart.</p> <pre><code>helm install &lt;release_name&gt; strangebee/thehive\n</code></pre> <p>For more options, see the Helm documentation for installation.</p> </li> </ol> <p>Dependencies</p> <p>The <code>thehive</code> Helm chart relies on the following charts by default:</p> <ul> <li>Bitnami Apache Cassandra-used as the database (uses legacy images by default)</li> <li>Bitnami Elasticsearch Stack-used as the search index (uses legacy images by default)</li> <li>MinIO Community Helm Chart-used as S3-compatible object storage</li> </ul> <p>Upgrades</p> <p>To upgrade your release to the latest version of the <code>thehive</code> Helm chart, run: </p><pre><code>helm upgrade &lt;release_name&gt; strangebee/thehive\n</code></pre> For additional options and best practices, see the Helm upgrade documentation.<p></p>"}, {"location": "thehive/installation/kubernetes/#production-configuration", "title": "Production configuration", "text": "<p>The default <code>thehive</code> Helm chart bundles all dependencies for quick deployment but uses development-oriented configurations. Production deployments require adjustments to TheHive and its dependencies for security, performance, and reliability.</p> <p>Use the following command to view all available configuration options for the <code>thehive</code> Helm chart:</p> <pre><code>helm show values strangebee/thehive\n</code></pre> <p>For more information on customization, see the dedicated Helm documentation. You can also review the available options for each dependency.</p>"}, {"location": "thehive/installation/kubernetes/#resource-allocation", "title": "Resource allocation", "text": "<p>Default pod resources are optimized for production workloads. If you need to adjust these values, especially memory limits, make sure you update the <code>JVM_OPTS</code> environment variable accordingly to avoid OOM crashes.</p> <pre><code># JVM_OPTS variable for TheHive\nthehive:\n  jvmOpts: \"-Xms2g -Xmx2g -Xmn300m\"\n\n# JVM_OPTS variable for Cassandra dependency chart\ncassandra:\n  jvm:\n    extraOpts: \"-Xms2g -Xmx2g -Xmn200m\"\n    maxHeapSize: \"2g\"\n    newHeapSize: \"200m\"\n\n# JVM_OPTS variable for Elasticsearch dependency chart\nelasticsearch:\n  master:\n    heapSize: \"2g\"\n    extraEnvVars:\n      - name: JVM_OPTS\n        value: \"-Xms2g -Xmx2g -Xmn200m\"\n</code></pre> <p>Refer to the official Cassandra and Elasticsearch documentation to learn how to optimize these values.</p>"}, {"location": "thehive/installation/kubernetes/#storage-configuration", "title": "Storage configuration", "text": "<p>By default, this chart uses your cluster's default StorageClass to create PVs.</p> <p>You can customize the StorageClass to suit your environment. In all cases, whether you use the default or a custom configuration, make sure it meets the following criteria:</p> <ul> <li>It's regularly backed up to prevent data loss. Tools like Velero can help automate this process.</li> <li>It has an appropriate <code>reclaimPolicy</code> to minimize the risk of data loss when volumes are deleted or released.</li> <li>It provides sufficient performance to ensure reliable operation of databases and applications.</li> </ul> <p>To configure StorageClasses based on your needs, refer to the relevant CSI drivers for your infrastructure. For example, use the EBS CSI driver for AWS or the Persistent Disk CSI driver for Google Cloud Platform.</p>"}, {"location": "thehive/installation/kubernetes/#cassandra", "title": "Cassandra", "text": "<p>This chart deploys two Cassandra pods to store TheHive data.</p> <p>You can review the Bitnami Cassandra Helm chart for available configuration options.</p>"}, {"location": "thehive/installation/kubernetes/#elasticsearch", "title": "Elasticsearch", "text": "<p>This chart deploys an Elasticsearch cluster with two nodes, both master-eligible and general-purpose.</p> <p>You can review the Bitnami Elasticsearch Helm chart for available configuration options.</p> <p>Same Elasticsearch instance for both TheHive and Cortex</p> <p>Using the same Elasticsearch instance for both TheHive and Cortex isn't recommended. If this setup is necessary, ensure proper connectivity and configuration for both pods and use Elasticsearch version 7.x. Be aware that sharing an Elasticsearch instance creates an interdependency that may lead to issues during updates or downtime.</p>"}, {"location": "thehive/installation/kubernetes/#object-storage", "title": "Object storage", "text": "<p>To support multiple replicas of TheHive, this chart defines an object storage in the configuration and deploys a single instance of MinIO.</p> <p>For production environments, use a managed object storage service to ensure optimal performance and resilience, such as:</p> <ul> <li>AWS S3</li> <li>Google Cloud Storage</li> </ul> <p>Network shared filesystems, like NFS, are supported but can be more complex to implement and may offer lower performance.</p>"}, {"location": "thehive/installation/kubernetes/#cortex-server-in-thehive", "title": "Cortex server in TheHive", "text": "<p>No Cortex server is defined by default in TheHive configuration.</p> <p>There are two main ways to add Cortex servers to TheHive:</p> <ul> <li>Add them directly through TheHive interface.</li> <li>Define them in the Helm chart\u2019s <code>values.yaml</code> file.</li> </ul> <p>For the second method, here's an example configuration:</p> <pre><code>cortex:\n  enabled: true\n  protocol: \"http\"\n  hostnames:\n    - \"cortex.default.svc\" # Assuming Cortex is deployed in the \"default\" namespace\n  port: 9001\n  api_keys:\n    - \"&lt;cortex_api_key&gt;\" # Or even better, use an existing secret using the parameters below\n  #k8sSecretName: \"\"\n  #k8sSecretKey: \"api-keys\"\n</code></pre> <p>When TheHive and Cortex are deployed in the same Kubernetes cluster, use the Cortex service DNS as the server URL:</p> <pre><code>http://cortex.&lt;namespace&gt;.svc:9001\n</code></pre> Next steps <ul> <li>Monitoring TheHive</li> <li>Troubleshooting</li> </ul>"}, {"location": "thehive/installation/migration/", "title": "Migration from TheHive 3.x", "text": ""}, {"location": "thehive/installation/migration/#migration-from-thehive-3x", "title": "Migration from TheHive 3.x", "text": "<p>This documentation outlines the supported versions, prerequisites, configuration steps, and the migration process.</p> <p>The migration from TheHive 3.x to TheHive 5.x involves transferring data stored in Elasticsearch. TheHive 5.x is provided with a tool to help you migrate your data.</p> <p>The migration tool is located in <code>/opt/thehive/bin/migrate</code>.</p>"}, {"location": "thehive/installation/migration/#supported-versions", "title": "Supported versions", "text": "<p>The migration tool facilitates the transition from both TheHive 3.4.x and 3.5.x versions.</p>"}, {"location": "thehive/installation/migration/#pre-requisites", "title": "Pre-requisites", "text": "<p>Before initiating the migration, ensure the following:</p> <ul> <li> <p>TheHive v5.x must be installed on the system where the migration tool will run.</p> </li> <li> <p>TheHive must be properly configured, including database, index, and file storage settings.</p> </li> <li> <p>Stop the <code>thehive</code> service on the target server using the command: service thehive stop.</p> </li> <li> <p>Ensure the migration tool has access to the Elasticsearch database used by TheHive 3.x and the configuration file of TheHive 3.x instance.</p> </li> </ul>"}, {"location": "thehive/installation/migration/#configuration-of-thehive", "title": "Configuration of TheHive", "text": ""}, {"location": "thehive/installation/migration/#user-domain-configuration", "title": "User Domain Configuration", "text": "<p>Users in TheHive are identified by their email addresses. To migrate users from TheHive 3, a domain must be appended to usernames. By default, TheHive v5.x includes a domain named <code>thehive.local</code>. Starting the migration without explicitly specifying a domain name will result in migrating all users with a username formatted like  <code>user@thehive.local</code>. </p> <p>To specify a custom domain, update the <code>auth.defaultUserDomain</code> setting in the configuration file (<code>/etc/thehive/application.conf</code>):</p> <pre><code>    auth.defaultUserDomain: \"mydomain.com\"\n</code></pre> <p>This ensures that imported users from TheHive 3.x are formatted as <code>user@mydomain.com</code>.</p>"}, {"location": "thehive/installation/migration/#running-the-migration", "title": "Running the migration", "text": "<p>Follow the steps below to execute the migration:</p> <ol> <li> <p>Prepare, install, and configure TheHive v5.x as per the associated guide</p> </li> <li> <p>Ensure TheHive 5 is not running before initiating the migration for optimal performance.</p> </li> <li> <p>Execute the <code>migrate</code> command:</p> </li> </ol> <pre><code>  /opt/thehive/bin/migrate\n</code></pre> <p>Warning</p> <p>The migration tool works on a single node only, thus the configuration file must not contain cluster configuration (<code>akka.cluster</code>).</p> <p>Info</p> <p>It is recommended to execute this program under the user responsible for running TheHive service (thehive if you are installing the application using DEB or RPM packages).</p> <p> </p>"}, {"location": "thehive/installation/migration/#thehive-migration-tool-options", "title": "TheHive migration tool options", "text": "<p>The migration tool for TheHive offers a comprehensive set of options to facilitate the migration process. Below is a detailed list of available options:</p> <ul> <li><code>-v, --version</code>: Displays the version of the migration tool.</li> <li><code>-h, --help</code>: Displays the help message detailing the usage of the migration tool.</li> <li><code>-l, --logger-config &lt;file&gt;</code>: Specifies the path to the logback configuration file.</li> <li><code>-c, --config &lt;file&gt;</code>: Specifies the global configuration file for TheHive.</li> <li><code>-i, --input &lt;file&gt;</code>: Specifies the path to the configuration file of TheHive 3.</li> <li><code>-o, --output &lt;file&gt;</code>: Specifies the path to the configuration file for TheHive 5.</li> <li><code>-d, --drop-database</code>: Drops TheHive 5 database before migration.</li> <li><code>-r, --resume</code>: Resumes migration or migrates on an existing database.</li> <li><code>-m, --main-organisation &lt;organisation&gt;</code>: Specifies the main organization for migration.</li> <li><code>-u, --es-uri http://ip1:port,ip2:port</code>: Specifies the Elasticsearch URIs for TheHive 3.</li> <li><code>-x, --es-index &lt;index&gt;</code>: Specifies the Elasticsearch index name for TheHive 3.</li> <li><code>-x, --es-index-version &lt;index&gt;</code>: Specifies the version number for the Elasticsearch index name (default: autodetect).</li> <li><code>-a, --es-keep-alive &lt;duration&gt;</code>: Specifies the Elasticsearch keep-alive duration, which defines how long the scroll context remains active between requests. The value must include a unit, such as <code>2s</code> for 2 seconds, <code>3m</code> for 3 minutes, or <code>4h</code> for 4 hours.</li> <li><code>-p, --es-pagesize &lt;value&gt;</code>: Specifies the page size for Elasticsearch queries.</li> <li><code>-s, --es-single-type &lt;bool&gt;</code>: Specifies whether Elasticsearch uses a single type.</li> <li><code>-y, --transaction-pagesize &lt;value&gt;</code>: Specifies the page size for each transaction.</li> <li><code>-t, --thread-count &lt;value&gt;</code>: Specifies the number of threads for migration.</li> <li><code>-k, --integrity-checks</code>: Runs integrity checks after migration.</li> <li><code>--max-case-age &lt;duration&gt;</code>: Migrates cases younger than the specified duration.</li> <li><code>--min-case-age &lt;duration&gt;</code>: Migrates cases older than the specified duration.</li> <li><code>--case-from-date &lt;date&gt;</code>: Migrates cases created from the specified date.</li> <li><code>--case-until-date &lt;date&gt;</code>: Migrates cases created until the specified date.</li> <li><code>--case-from-number &lt;number&gt;</code>: Migrates cases starting from the specified case number.</li> <li><code>--case-until-number &lt;number&gt;</code>: Migrates cases up to the specified case number.</li> <li><code>--max-alert-age &lt;duration&gt;</code>: Migrates alerts younger than the specified duration.</li> <li><code>--min-alert-age &lt;duration&gt;</code>: Migrates alerts older than the specified duration.</li> <li><code>--alert-from-date &lt;date&gt;</code>: Migrates alerts created from the specified date.</li> <li><code>--alert-until-date &lt;date&gt;</code>: Migrates alerts created until the specified date.</li> <li><code>--include-alert-types &lt;type&gt;,&lt;type&gt;...</code>: Migrates only alerts with the specified types.</li> <li><code>--exclude-alert-types &lt;type&gt;,&lt;type&gt;...</code>: Excludes alerts with the specified types from migration.</li> <li><code>--include-alert-sources &lt;source&gt;,&lt;source&gt;...</code>: Migrates only alerts with the specified sources.</li> <li><code>--exclude-alert-sources &lt;source&gt;,&lt;source&gt;...</code>: Excludes alerts with the specified sources from migration.</li> <li><code>--max-audit-age &lt;duration&gt;</code>: Migrates audits younger than the specified duration.</li> <li><code>--min-audit-age &lt;duration&gt;</code>: Migrates audits older than the specified duration.</li> <li><code>--audit-from-date &lt;date&gt;</code>: Migrates audits created from the specified date.</li> <li><code>--audit-until-date &lt;date&gt;</code>: Migrates audits created until the specified date.</li> <li><code>--include-audit-actions &lt;value&gt;</code>: Migrates only audits with the specified actions (Update, Creation, Delete).</li> <li><code>--exclude-audit-actions &lt;value&gt;</code>: Excludes audits with the specified actions from migration.</li> <li><code>--include-audit-objectTypes &lt;value&gt;</code>: Migrates only audits with the specified object types (case, case_artifact, case_task, etc.).</li> <li><code>--exclude-audit-objectTypes &lt;value&gt;</code>: Excludes audits with the specified object types from migration.</li> <li><code>--case-number-shift &lt;value&gt;</code>: Transposes case numbers by adding the specified value.</li> </ul> <p> </p>"}, {"location": "thehive/installation/migration/#usage-examples", "title": "Usage examples", "text": "<ul> <li>Import Cases/Alerts not older than X days/hours.</li> <li>Import Cases/Alerts with specific ID numbers.</li> <li>Import a portion of the Audit trail.</li> <li>...</li> </ul>"}, {"location": "thehive/installation/migration/#basic-migration-command", "title": "Basic migration command", "text": "<p>To migrate data to a new instance of TheHive, use the following command:</p> <pre><code>/opt/thehive/bin/migrate \\\n  --output /etc/thehive/application.conf \\\n  --main-organisation myOrganisation \\\n  --es-uri http://ELASTICSEARCH_IP_ADDRESS:9200 \\\n  --es-index the_hive\n</code></pre> <p>Options Description:</p> <ul> <li>--output: Specifies the configuration file path for TheHive 5, which must include database and file storage configurations.</li> <li>--main-organisation: Specifies the organization to create during migration.</li> <li>--es-uri: Specifies the URL of the Elasticsearch server. If Elasticsearch authentication is enabled, a configuration file for TheHive3 (--input) is required.</li> <li>--es-index: Specifies the Elasticsearch index used for migration.</li> </ul> Option Description <code>--output</code> Specifies the configuration file path for TheHive 5, which must include database and file storage configurations; <code>--main-organisation</code> Specifies the organization to create during migration; <code>--es-uri</code> Specifies the URL of the Elasticsearch server. If Elasticsearch authentication is enabled, a configuration file for TheHive3 (--input) is required; <code>--es-index</code> Specifies the Elasticsearch index used for migration; <p>Info</p> <p>The migration process duration varies significantly based on data volume, ranging from several hours to days. It is strongly advised not to start TheHive application during migration to ensure data integrity.</p>"}, {"location": "thehive/installation/migration/#resuming-an-incomplete-migration", "title": "Resuming an Incomplete Migration", "text": "<p>If your migration process has been interrupted or only a portion of the data has been migrated, you can resume the migration using the tool with the <code>--resume</code> parameter. This parameter ensures that data is not duplicated if it already exists in the destination system.</p>"}, {"location": "thehive/installation/migration/#merging-multiple-thehive-3-data-into-one-thehive-5-instance", "title": "Merging multiple TheHive 3 data into one TheHive 5 instance", "text": "<p>The migration tool supports multiple executions to merge different TheHive 3 datasets into a single TheHive 5 instance. Each migration execution can specify a different target organization. To avoid conflicts in case numbers, where a case with the same number already exists, you can use the <code>--case-number-shift</code> parameter to adjust the case numbers accordingly.</p>"}, {"location": "thehive/installation/migration/#using-authentication-on-cassandra", "title": "Using authentication on Cassandra", "text": "<p>If you're utilizing a dedicated account on Cassandra to access TheHive 4 data, ensure that the user has permissions to create keyspaces in the database.</p> <pre><code>GRANT CREATE on ALL KEYSPACES to username;\n</code></pre>"}, {"location": "thehive/installation/migration/#migration-logs", "title": "Migration logs", "text": "<p>During the migration process, the tool generates logs to provide insights into the progress. By default, a log is generated approximately every 10 seconds, detailing various aspects of the migration, including the status of cases, alerts, and other entities.</p> <pre><code>[info] o.t.t.m.Migrate - [Migrate cases and alerts] CaseTemplate/Task:32 Organisation:1/1 Case/Task:160/201 Case:31/52 Job:103/138 ObservableType:3/17 Alert:25/235 Audit:3207/2986 CaseTemplate:6/6 Alert/Observable:700(52ms) Case/Observable:1325/1665 User:9/9 CustomField:13/13 Case/Task/Log:20/27\n</code></pre> <p>Please note that the numbers of observables, cases, and other entities are estimations and may not represent exact values due to the complexity of computation involved.</p> <p>Files from MISP imported with TheHive 2.13 and earlier</p> <p>It is important to notice that migrating Cases/Alerts containing MISP event that were imported with TheHive 2.13 (Sept 2017) or older will cause observable files not being imported in TheHive 5.</p> <p>Indeed, until this version, TheHive referenced the file to the <code>AttributeId</code> in MISP and was not automatically downloaded. It then could generate a log like this: </p> <pre><code>[warn] o.t.t.m.t.Input - Pre 2.13 file observables are ignored in MISP alert ffa3a8503ab0cd4f99fc6937a8e9b827\n</code></pre>"}, {"location": "thehive/installation/migration/#starting-thehive", "title": "Starting TheHive", "text": "<p>Once the migration process has successfully completed, you can start TheHive. However, during the initial startup, data indexing occurs, and the service may not be immediately available. This indexing process may take some time.</p> <p>Warning</p> <p>During the initial startup, refrain from stopping or restarting TheHive service until the indexing process is complete to ensure data integrity and service availability.</p> <p> </p>"}, {"location": "thehive/installation/software-requirements/", "title": "Software Requirements", "text": ""}, {"location": "thehive/installation/software-requirements/#thehive-installation-software-requirements", "title": "TheHive Installation Software Requirements", "text": "<p>TheHive requires specific software versions depending on the installation method.</p> <p>The tables below list the supported versions for Linux installations, Docker Compose deployments, and Kubernetes environments.</p> Linux installationDocker Compose deploymentKubernetes deployment with Helm TheHive version Java Cassandra Elasticsearch OpenSearch Cortex support Notes 5.5.10+ 11 3.11.x, 4.0.x, 4.1.x 7.x - 9.1.x Supported \u2014except for audit logs 3.1.6+ \u2022 ES 7.17+ required for audit log storage\u2022 ES 7.x required if shared with Cortex 5.5.0 - 5.5.9 11 3.11.x, 4.0.x, 4.1.x 7.x - 8.x Supported \u2014except for audit logs 3.1.6+ \u2022 ES 7.17+ required for audit log storage\u2022 ES 7.x required if shared with Cortex 5.3.0 - 5.4.10 11 3.11.x, 4.0.x, 4.1.x 7.x - 8.x Supported All versions ES 7.x required if shared with Cortex 5.0.0 - 5.2.16 11 3.11.x, 4.0.x, 4.1.x 7.x Not supported All versions --- TheHive version Docker Engine Docker Compose plugin 5.0.0 - 5.5.10+ v23.0.15+ v2.20.2+ TheHive version Kubernetes cluster Helm 5.0.0 - 5.5.10+ v1.23.0+ v3.8.0+ Next steps <ul> <li>System Requirements</li> <li>Quick Install on Linux Systems: One-Command Setup</li> <li>Install TheHive on Linux Systems</li> <li>Running TheHive with Docker</li> <li>Deploy TheHive on Kubernetes</li> <li>Setting up a Cluster with TheHive</li> </ul>"}, {"location": "thehive/installation/system-requirements/", "title": "System Requirements", "text": ""}, {"location": "thehive/installation/system-requirements/#thehive-installation-system-requirements", "title": "TheHive Installation System Requirements", "text": "<p>TheHive requires supported operating systems, along with sufficient hardware resources and data storage, to ensure stable and efficient operation.</p>"}, {"location": "thehive/installation/system-requirements/#hardware-requirements", "title": "Hardware requirements", "text": "<p>Estimated resource recommendations are provided to offer guidance based on typical usage scenarios.</p> <p>Hardware sizing guidance</p> <p>The listed hardware values represent typical usage scenarios. However, hardware sizing for TheHive installation depends on several factors:</p> <ul> <li>Usage intensity: Number of users accessing the system at the same time, including service accounts and external integrations</li> <li>Data volume: Amount of data ingested, processed, and stored</li> <li>Performance expectations: Expected system responsiveness under typical and peak loads</li> <li>Deployment method: Installation via Linux packages or Docker containers</li> </ul> <p>Initial deployments can start with minimal configurations and be scaled based on observed performance. Hardware adjustments should be guided by ongoing monitoring of system resource utilization.</p> Linux installationDocker Compose deploymentKubernetes deployment with Helm <p>The following table lists recommended CPU and memory allocations per service when TheHive, Apache Cassandra, and Elasticsearch are hosted on a single machine, based on the number of concurrent users.</p> Number of concurrent users TheHive Cassandra Elasticsearch  &lt; 10 3 CPU cores / 4 GB RAM 3 CPU cores / 4 GB RAM 3 CPU cores / 4 GB RAM  &lt; 20 3-4 CPU cores / 6 GB RAM 3-4 CPU cores / 6 GB RAM 3-4 CPU cores / 6 GB RAM  &lt; 50 4-6 CPU cores / 8 GB RAM 4-6 CPU cores / 8 GB RAM 4-6 CPU cores / 8 GB RAM <p>For Docker deployments of TheHive with all required services, hardware requirements vary by setup profile. Each profile defines a specific performance level.</p> <p>Available profiles and corresponding hardware specifications are documented in the Docker Compose environments GitHub repository.</p> <p>For Kubernetes deployments, refer to the Docker Compose environments GitHub repository for hardware requirements.</p> <p>Elasticsearch heap size configuration</p> <p>Elasticsearch requires explicit heap size configuration in the <code>jvm.options</code> file. Heap allocation must not exceed 50% of the total system RAM.</p> <p>On a 12 GB RAM system, for example:</p> <pre><code>-Xms6g\n-Xmx6g\n</code></pre> <p>Undefined heap settings may cause memory contention or out-of-memory errors.</p> <p>Cluster deployments</p> <p>In cluster deployments, each node must independently meet the recommended per-service CPU and memory requirements. The number of nodes, as well as CPU and RAM, may need to be adjusted based on the specific demands of the deployment.</p>"}, {"location": "thehive/installation/system-requirements/#data-storage", "title": "Data storage", "text": "<p>The recommended storage requirements for TheHive vary based on the use case and data volume:</p> <ul> <li>100 GB of storage is recommended for most use cases, primarily for storing application data such as alerts, cases, observables, and logs.</li> <li>150 GB of storage is recommended for more intensive use cases with higher data volume or complex workflows.</li> </ul>"}, {"location": "thehive/installation/system-requirements/#recommended-operating-systems", "title": "Recommended operating systemsNext steps", "text": "<p>TheHive is officially supported on the following Linux distributions:</p> <ul> <li>Ubuntu 20.04 LTS | 22.04 LTS | 24.04 LTS</li> <li>Debian 11</li> <li>RHEL 8.5 | 9.3</li> <li>Rocky Linux 9.4</li> <li>Fedora 35 | 37</li> </ul> <p>Other distributions or versions aren't tested or supported.</p> <ul> <li>Software Requirements</li> <li>Quick Install on Linux Systems: One-Command Setup</li> <li>Install TheHive on Linux Systems</li> <li>Running TheHive with Docker</li> <li>Deploy TheHive on Kubernetes</li> <li>Setting up a Cluster with TheHive</li> </ul>"}, {"location": "thehive/installation/upgrade-from-4.x/", "title": "Upgrade from Version 4.x", "text": ""}, {"location": "thehive/installation/upgrade-from-4.x/#upgrade-from-thehive-4x", "title": "Upgrade from TheHive 4.x", "text": "<p>This guide provides comprehensive instructions for upgrading TheHive from version 4.1.x to 5.0.x. Please ensure that your system meets the following requirements:</p> <ul> <li>The application is running on a supported Linux operating system.</li> <li>The server meets prerequisites regarding CPU &amp; RAM.</li> </ul> <p>If you are using a cluster setup, specific notes are provided to guide you through the process.</p>"}, {"location": "thehive/installation/upgrade-from-4.x/#important-considerations", "title": "Important Considerations", "text": "<p>Switch to Elasticsearch as indexing engine: TheHive 5.x utilizes Elasticsearch as the indexing engine. If you were using Lucene as the indexing engine with TheHive 4.1.x, reindexing the data is mandatory. Please note that this process may take some time depending on the size of your database.</p>"}, {"location": "thehive/installation/upgrade-from-4.x/#preparation", "title": "Preparation", "text": "I'm Using a Cluster <p>Please ensure that the instructions under this section are followed on all nodes of the cluster.</p> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#database-backup", "title": "Database Backup", "text": "<p>Before proceeding with the upgrade, ensure to back up the following components:</p> <ul> <li>Database</li> <li>Index</li> <li>Files</li> </ul> <p>For detailed instructions on how to perform backups, refer to our backup and restore guide.</p> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#ensure-admin-user-access", "title": "Ensure Admin User Access", "text": "<p>Ensure that you can log in as an admin user with a password in TheHive database. By default, the local auth provider should be enabled.</p> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#stop-all-running-applications", "title": "Stop all Running Applications", "text": "<ol> <li> <p>Start by stopping TheHive:</p> <pre><code>sudo systemctl stop thehive\n</code></pre> </li> <li> <p>Once TheHive is successfully stopped, stop the database service:</p> <pre><code>sudo systemctl stop cassandra\n</code></pre> </li> <li> <p>If already using Elasticsearch as the indexing engine, stop the Elasticsearch service:</p> <pre><code>sudo systemctl stop elasticsearch\n</code></pre> </li> </ol>"}, {"location": "thehive/installation/upgrade-from-4.x/#upgrade-java", "title": "Upgrade Java", "text": "I'm Using a Cluster <p>Please ensure that the instructions under this section are followed on all nodes of the cluster.</p> <p>Follow the installation process to install the required version of Java.</p>"}, {"location": "thehive/installation/upgrade-from-4.x/#upgrade-or-install-elasticsearch", "title": "Upgrade or Install Elasticsearch", "text": "I'm Using a Cluster <p>Elasticsearch is crucial for TheHive 5.x clusters. However, if an update isn't urgently required, focus on upgrading Cassandra first.</p> <p>Elasticsearch is mandatory for TheHive 5.x clusters. Follow the installation process to install and configure the required version.</p>"}, {"location": "thehive/installation/upgrade-from-4.x/#upgrade-cassandra", "title": "Upgrade Cassandra", "text": "I'm Using a Cluster <p>For each node within the Cassandra cluster, it is essential to follow this procedure. Ensure that all nodes in the Cassandra cluster are successfully restarted before proceeding with the upgrade of all nodes in TheHive cluster to version 5.</p>"}, {"location": "thehive/installation/upgrade-from-4.x/#backup-configuration-file", "title": "Backup Configuration File", "text": "<p>Save the existing configuration file for Cassandra 3.x. It will be used later to configure Cassandra 4:</p> <pre><code>  sudo cp /etc/cassandra/cassandra.yaml /etc/cassandra/cassandra3.yaml.bak\n</code></pre> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#install-cassandra", "title": "Install Cassandra", "text": "<p>Follow the installation process to install the required version. During the installation process, replace existing configuration files as necessary.</p> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#configuration", "title": "Configuration", "text": "<p>Update the new configuration file and ensure the following parameters are correctly set with these values:</p> <pre><code>cluster_name: 'thp'\nnum_tokens: 256\n</code></pre> <p>Info</p> <p>If you have a customized configuration file for Cassandra 3.x, it is advisable to carefully review the entire file and make any necessary adjustments to ensure compatibility and proper functioning.</p> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#start-the-service", "title": "Start the Service", "text": "<p>Use the following command to start the Cassandra service:</p> <pre><code>sudo systemctl start cassandra\n</code></pre> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#upgrade-sstables", "title": "Upgrade SSTables", "text": "<p>On each Cassandra node, upgrade the SSTables:</p> <pre><code>nodetool upgradesstables\n</code></pre> <p>Then repair the keyspaces:</p> <pre><code>nodetool repair --full\n</code></pre>"}, {"location": "thehive/installation/upgrade-from-4.x/#install-thehive", "title": "Install TheHive", "text": ""}, {"location": "thehive/installation/upgrade-from-4.x/#preparing-for-the-new-installation", "title": "Preparing for the New Installation", "text": "I'm using a cluster <p>Before initiating the installation process, it is crucial to ensure that your Cassandra cluster is fully operational. Follow these steps:</p> <ul> <li>Run the command <code>nodetool status</code> to check the status of your Cassandra cluster.</li> </ul> <pre><code>  nodetool status\n</code></pre> <p>The output should display information about the nodes in your cluster, including their status, load, tokens, and other relevant details.</p> Example output<pre><code># nodetool status\n\nDatacenter: datacenter1\n=======================\n\nStatus=Up/Down\n|/ State=Normal/Leaving/Joining/Moving\n--  Address      Load      Tokens  Owns (effective)  Host ID                               Rack\nUN  10.1.1.2  1.41 GiB  256     100.0%            ba6daa4e-6d14-4b21-a06c-d01b3bdd659d  rack1\nUN  10.1.1.3  1.39 GiB  256     100.0%            201ab99c-8e16-49b1-9b66-5444043eb1cd  rack1\nUN  10.1.1.4  1.36 GiB  256     100.0%            a79c9a8c-c99b-4d74-8e78-6b0c252aeb86  rack1\n</code></pre> <ul> <li> <p>Ensure that all nodes in the cluster are in an operational state (UN), indicating that they are up and running normally.</p> </li> <li> <p>Before proceeding with the installation, perform the following steps:</p> <p>Stop Existing Nodes: Stop all existing nodes of TheHive (4.x).</p> <p>Upgrade and Start a Single Node: Begin by upgrading and starting only one node to TheHive 5.0.0. Verify that everything functions correctly with this node before proceeding further.</p> <p>Update and Start Other Nodes: Once the initial node is successfully upgraded and operational, proceed to update and start the remaining nodes.</p> </li> </ul> <p>TheHive configuration file: /etc/thehive/application.conf</p> <p>Starting from TheHive 5.0.0, the configuration process has been simplified, with most administration parameters configurable directly within the user interface (UI). The configuration file (/etc/thehive/application.conf) should only contain essential information required for the successful startup of the application, including:</p> <ul> <li>Secret</li> <li>Database</li> <li>Indexing Engine</li> <li>File Storage</li> <li>Enabled Connectors </li> <li>Akka Configuration (for clusters)</li> </ul> <p>Authentication, Webhooks, Cortex, and MISP configurations can now be conveniently set within the UI. </p> <p>!!! \"Note on Configuration Changes\"     Please note the following changes in configuration keys:</p> <pre><code>- The configuration keys for Cortex and MISP connector modules have been renamed from play.modules.enabled to scalligraph.modules. Update your configuration files accordingly to reflect these changes.\n</code></pre> Standalone serverCluster <ul> <li>Save your current configuration file:</li> </ul> <pre><code>sudo cp /etc/thehive/application.conf /etc/thehive/application.conf.bak\n</code></pre> <ul> <li>For the current scenario, which involves a standalone server, the ultimate configuration file should resemble the following:</li> </ul> sample of /etc/thehive/application.conf<pre><code># TheHive configuration - application.conf\n#\n#\n# This is the default configuration file.\n# This is prepared to run with all services locally:\n# - Cassandra for the database\n# - Elasticsearch for index engine\n# - File storage is local in /opt/thp/thehive/files\n#\n# If this is not your setup, please refer to the documentation at:\n# https://docs.thehive-project.org/thehive/\n#\n#\n# Secret key - used by Play Framework\n# If TheHive is installed with DEB/RPM package, this is automatically generated\n# If TheHive is not installed from DEB or RPM packages run the following\n# command before starting thehive:\n#   cat &gt; /etc/thehive/secret.conf &lt;&lt; _EOF_\n#   play.http.secret.key=\"$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 64 |#   head -n 1)\"\n#   _EOF_\ninclude \"/etc/thehive/secret.conf\"\n\n\n# Database and index configuration\n# By default, TheHive is configured to connect to local Cassandra 4.x and a\n# local Elasticsearch services without authentication.\ndb.janusgraph {\n  storage {\n    backend = cql\n    hostname = [\"127.0.0.1\"]\n    # Cassandra authentication (if configured)\n    # username = \"thehive\"\n    # password = \"password\"\n    cql {\n      cluster-name = thp\n      keyspace = thehive\n    }\n  }\n  index.search {\n    backend = elasticsearch\n    hostname = [\"127.0.0.1\"]\n    index-name = thehive\n  }\n}\n\n# Attachment storage configuration\n# By default, TheHive is configured to store files locally in the folder.\n# The path can be updated and should belong to the user/group running thehive service. (by default: thehive:thehive)\nstorage {\n  provider = localfs\n  localfs.location = /opt/thp/thehive/files\n}\n\n# Define the maximum size for an attachment accepted by TheHive\nplay.http.parser.maxDiskBuffer = 1GB\n# Define maximum size of http request (except attachment)\nplay.http.parser.maxMemoryBuffer = 10M\n\n# Service configuration\napplication.baseUrl = \"http://localhost:9000\"\nplay.http.context = \"/\"\n\n# Additional modules\n#\n# TheHive is strongly integrated with Cortex and MISP.\n# Both modules are enabled by default. If not used, each one can be disabled by\n# commenting the configuration line.\nscalligraph.modules += org.thp.thehive.connector.cortex.CortexModule\nscalligraph.modules += org.thp.thehive.connector.misp.MispModule\n</code></pre> <ul> <li>Save your current configuration file:</li> </ul> <pre><code>sudo cp /etc/thehive/application.conf /etc/thehive/application.conf.bak\n</code></pre> <ul> <li>The second configuration includes settings for setting up TheHive in a clustered environment. It extends upon the first one with additional settings for cluster configuration using Akka:</li> </ul> sample of /etc/thehive/application.conf<pre><code># TheHive configuration - application.conf\n#\n#\n# This is the default configuration file.\n# This is prepared to run with all services locally:\n# - Cassandra for the database\n# - Elasticsearch for index engine\n# - File storage is local in /opt/thp/thehive/files\n#\n# If this is not your setup, please refer to the documentation at:\n# https://docs.thehive-project.org/thehive/\n#\n#\n# Secret key - used by Play Framework\n# If TheHive is installed with DEB/RPM package, this is automatically generated\n# If TheHive is not installed from DEB or RPM packages run the following\n# command before starting thehive:\n#   cat &gt; /etc/thehive/secret.conf &lt;&lt; _EOF_\n#   play.http.secret.key=\"$(cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 64 |#   head -n 1)\"\n#   _EOF_\ninclude \"/etc/thehive/secret.conf\"\n\n\n# Database and index configuration\n# By default, TheHive is configured to connect to local Cassandra 4.x and a\n# local Elasticsearch services without authentication.\ndb.janusgraph {\n  storage {\n    backend = cql\n    hostname = [\"127.0.0.1\"]\n    # Cassandra authentication (if configured)\n    # username = \"thehive\"\n    # password = \"password\"\n    cql {\n      cluster-name = thp\n      keyspace = thehive\n    }\n  }\n  index.search {\n    backend = elasticsearch\n    hostname = [\"127.0.0.1\"]\n    index-name = thehive\n  }\n}\n\n# Attachment storage configuration\n# By default, TheHive is configured to store files locally in the folder.\n# The path can be updated and should belong to the user/group running thehive service. (by default: thehive:thehive)\nstorage {\n  provider = localfs\n  localfs.location = /opt/thp/thehive/files\n}\n\n# Define the maximum size for an attachment accepted by TheHive\nplay.http.parser.maxDiskBuffer = 1GB\n# Define maximum size of http request (except attachment)\nplay.http.parser.maxMemoryBuffer = 10M\n\n# Service configuration\napplication.baseUrl = \"http://localhost:9000\"\nplay.http.context = \"/\"\n\n# Additional modules\n#\n# TheHive is strongly integrated with Cortex and MISP.\n# Both modules are enabled by default. If not used, each one can be disabled by\n# commenting the configuration line.\nscalligraph.modules += org.thp.thehive.connector.cortex.CortexModule\nscalligraph.modules += org.thp.thehive.connector.misp.MispModule\n\n# Cluster configuration\nakka {\n  cluster.enable = on\n  actor {\n    provider = cluster\n  }\nremote.artery {\n  canonical {\n    hostname = \"&lt;My IP address&gt;\"\n    port = 2551\n  }\n}\n## seed node list contains at least one active node\ncluster.seed-nodes = [\n                      \"akka://application@&lt;Node 1 IP address&gt;:2551\",\n                      \"akka://application@&lt;Node 2 IP address&gt;:2551\",\n                      \"akka://application@&lt;Node 3 IP address&gt;:2551\"\n                    ]\n}\n</code></pre> <p>Note</p> <p>By default, both Cortex and MISP modules are enabled in TheHive. If you do not intend to use one or both of these modules, you can comment out the corresponding lines in the configuration file.</p> <p>Recommendation: It's advisable to utilize the default configuration sample provided, customize it with your specific parameter values, and retain the original file for configuring services through the web UI.</p> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#specific-configuration-for-upgrade-only", "title": "Specific Configuration for Upgrade Only", "text": "I'm using a cluster <p>This section pertains solely to the initial node, which will initiate the database and index upgrade process.</p> <p>These lines are to be included in the configuration file exclusively during the upgrade to version 5 and should be subsequently removed thereafter.</p> <pre><code>db.janusgraph.forceDropAndRebuildIndex = true\n</code></pre> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#installing-thehive", "title": "Installing TheHive", "text": "<p>TheHive packages are distributed as RPM and DEB files available for direct download via tools like Wget or cURL, with installation performed manually.</p> <p>All packages are hosted on an HTTPS-secured website and come with a SHA256 checksum and a GPG signature for verification.</p> DEBRPM <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\nwget -O /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\nwget -O /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\nwget -O /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\nwget -O /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\ncurl -o /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\ncurl -o /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\ncurl -o /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\ncurl -o /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive_5.5.10-1_all.deb.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive_5.5.10-1_all.deb.asc /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>apt-get</code> to manage dependencies automatically:</p> <pre><code>sudo apt-get install /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> <li> <p>Using <code>dpkg</code>:</p> <pre><code>sudo dpkg -i /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> </ul> </li> </ol> <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive-5.5.10-1.noarch.rpm.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive-5.5.10-1.noarch.rpm.asc /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>yum</code> to manage dependencies automatically:</p> <pre><code>sudo yum install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>dnf</code> to manage dependencies automatically:</p> <pre><code>sudo dnf install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>rpm</code>:</p> <pre><code>sudo rpm -ivh /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> </ul> </li> </ol> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#starting-services", "title": "Starting Services", "text": "<p>Ensure that the required services are started for TheHive to function properly. Follow these steps:</p> <ol> <li>Reload Systemd Daemon - Execute the following command to reload the systemd daemon:</li> </ol> <pre><code>sudo systemctl daemon-reload\n</code></pre> <ol> <li>Start Cassandra (if not already started) - If Cassandra is not already running, start it with:</li> </ol> <pre><code>sudo systemctl start cassandra\n</code></pre> <ol> <li>Start Elasticsearch (if not already started) - If Elasticsearch is not running, start it using:</li> </ol> <pre><code>sudo systemctl start elasticsearch\n</code></pre> <ol> <li>Start TheHive -  Once both database services are running, start TheHive by executing:</li> </ol> <pre><code>sudo systemctl start thehive\n</code></pre> <p>Note</p> <p>The first start of TheHive 5.x may take some time as it updates the database schema and proceeds with reindexing. Progress can be monitored in the log file <code>/var/log/thehive/application.log</code>. Refer to the troubleshooting section for further assistance.</p> <p> </p>"}, {"location": "thehive/installation/upgrade-from-4.x/#restarting-the-service", "title": "Restarting the Service", "text": "<p>After successfully starting the service, follow these steps to update the configuration file and restart TheHive:</p> <ol> <li>Update Configuration File - Remove the following lines from the configuration file <code>/etc/thehive/application.conf</code>:</li> </ol> <pre><code>db.janusgraph.forceDropAndRebuildIndex = true\n</code></pre> <ol> <li>Restart TheHive - Restart TheHive using the following command:</li> </ol> <pre><code>sudo systemctl restart thehive\n</code></pre> Using a cluster? <p>If you're deploying TheHive in a cluster, you can proceed to install and start TheHive on all other nodes following similar steps.</p>"}, {"location": "thehive/installation/upgrade-from-4.x/#troubleshooting", "title": "Troubleshooting", "text": "<p>During the update, few logs can be seen in TheHive <code>application.log</code> file. </p> <p>Example of logs and what they mean</p> <pre><code>[INFO] from org.janusgraph.graphdb.database.management.GraphIndexStatusWatcher in application-akka.actor.default-dispatcher-11 [|] Some key(s) on index global2 do not currently have status(es) [REGISTERED, ENABLED]: dateValue=INSTALLED,externalLink=INSTALLED,origin=INSTALLED,patternId=INSTALLED,revoked=INSTALLED,mandatory=INSTALLED,content=INSTALLED,isAttachment=INSTALLED,writable=INSTALLED,tactic=INSTALLED,stringValue=INSTALLED,owningOrganisation=INSTALLED,permissions=INSTALLED,actionRequired=INSTALLED,integerValue=INSTALLED,details=INSTALLED,locked=INSTALLED,slug=INSTALLED,cortexId=INSTALLED,owner=INSTALLED,workerId=INSTALLED,apikey=INSTALLED,level=INSTALLED,floatValue=INSTALLED,version=INSTALLED,occurDate=INSTALLED,url=INSTALLED,report=INSTALLED,tactics=INSTALLED,booleanValue=INSTALLED,cortexJobId=INSTALLED,category=INSTALLED,workerName=INSTALLED\n</code></pre> TheHive install indexes of the new schema in the database <pre><code>[INFO] from org.janusgraph.graphdb.olap.job.IndexRepairJob in Thread-97 [|] Index global2 metrics: success-tx: 1 doc-updates: 100 succeeded: 100\n</code></pre> TheHive reindexes all data <pre><code>* UPDATE SCHEMA OF thehive-enterprise (1): Create initial values\n[INFO] from org.thp.scalligraph.models.Operations in application-akka.actor.default-dispatcher-11 [d471d8b643d17b6d|d88fe62679b77ab1] Adding initial values for GDPRDummy\n[..]\n[INFO] from org.thp.scalligraph.models.Operations in application-akka.actor.default-dispatcher-11 [|] Update graph in progress (100): Add pap and ignoreSimilarity to observables\n</code></pre> Migrating data from v4. to v5 <pre><code>[WARN] from org.thp.thehive.enterprise.services.LicenseSrv in main [ef39c95eaa6de532|0ccf187e40a4cd34] No license found\n</code></pre> No license found. This is a normal behavior during the upgrade from versions 4 to 5 <pre><code>[INFO] from play.core.server.AkkaHttpServer in main [|] Listening for HTTP on /0:0:0:0:0:0:0:0:9000\n</code></pre> The service is available. Users/Administrators can log in <pre><code>[INFO] from org.thp.thehive.connector.cortex.services.CortexDataImportActor in application-akka.actor.default-dispatcher-16 [|] Analyzer templates already present (found 203), skipping\n[..]\n[INFO] from org.thp.thehive.services.ttp.PatternImportActor in application-akka.actor.default-dispatcher-14 [|] Import finished, 707 patterns imported\n</code></pre> Few operations are processed after making the service available, like installing MITRE Enterprise ATT&amp;CK patterns catalog or Analyzers templates. <pre><code>[ERROR] from org.janusgraph.diskstorage.log.util.ProcessMessageJob in pool-22-thread-1 [|] Encountered exception when processing message [Message@2022-03-24T16:50:40.655134Z:7f0001017672-ubuntu2=0x809F9F0568850528850550850558850570850600850610850618850650850668850710850738850758850760850808850900850910850A60850A70850A78850B00850B08853520853B3885150E8941608541688541788542088542688542708581] by reader [org.janusgraph.graphdb.database.management.ManagementLogger@3e1a6eae]:java.lang.IllegalStateException: Cannot access element because its enclosing transaction is closed and unbound\nat org.janusgraph.graphdb.transaction.StandardJanusGraphTx.getNextTx(StandardJanusGraphTx.java:380)\nat org.janusgraph.graphdb.vertices.AbstractVertex.it(AbstractVertex.java:61)\nat org.janusgraph.graphdb.relations.CacheVertexProperty.&lt;init&gt;(CacheVertexProperty.java:38)\nat org.janusgraph.graphdb.transaction.RelationConstructor.readRelation(RelationConstructor.java:88)\nat org.janusgraph.graphdb.transaction.RelationConstructor.readRelation(RelationConstructor.java:71)\nat org.janusgraph.graphdb.transaction.RelationConstructor$1.next(RelationConstructor.java:57)\nat org.janusgraph.graphdb.transaction.RelationConstructor$1.next(RelationConstructor.java:45)\nat org.janusgraph.graphdb.types.vertices.JanusGraphSchemaVertex.getDefinition(JanusGraphSchemaVertex.java:94)\nat org.janusgraph.graphdb.transaction.StandardJanusGraphTx.expireSchemaElement(StandardJanusGraphTx.java:1599)\nat org.janusgraph.graphdb.database.management.ManagementLogger.read(ManagementLogger.java:97)\nat org.janusgraph.diskstorage.log.util.ProcessMessageJob.run(ProcessMessageJob.java:46)\nat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\nat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\nat java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)\nat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\nat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\nat java.base/java.lang.Thread.run(Thread.java:829)\n</code></pre> During indexing, Janusgraph may display this message, this error is coming from a bug in janusgraph, don't mind it as the indexing will continue normally. This will have no impact on TheHive <p> </p>"}, {"location": "thehive/installation/upgrade-from-5.x/", "title": "Upgrade from Version 5.x", "text": ""}, {"location": "thehive/installation/upgrade-from-5.x/#upgrade-from-thehive-5x", "title": "Upgrade from TheHive 5.x", "text": "<p>Important: Starting with version 5.4, our web framework has been upgraded to Play3/Pekko. Depending on your TheHive installation and configuration, certain updates may be required in your configuration files. Refer to the configuration guide for details.</p> <p>Cortex support</p> <p>5.5 Cortex 3.1.5 and earlier are no longer supported since version 5.5.</p>"}, {"location": "thehive/installation/upgrade-from-5.x/#important-considerations", "title": "Important considerations", "text": "<p>Before proceeding with the upgrade, please keep the following points in mind:</p> <ol> <li> <p>Database Backup: We strongly recommend performing a full database backup before upgrading. For detailed instructions on how to perform a backup, please refer to the backup instructions.</p> </li> <li> <p>Downgrade Limitation: Once upgraded to TheHive 5.5, your instance can't be downgraded. This means reverting to a previous version of TheHive 5 will require restoring your data from the backup.</p> </li> <li> <p>When upgrading an existing TheHive 5.x instance, the first application launch will trigger a database evolution, including schema and data updates. This operation may take some time depending on your database size.</p> </li> <li> <p>Since version 5.1, TheHive no longer supports the Lucene backend as the index engine. Lucene was an option for handling data indexing with TheHive 4.1.x. To migrate your index to Elasticsearch, please follow the provided guide.</p> </li> </ol>"}, {"location": "thehive/installation/upgrade-from-5.x/#overview", "title": "Overview", "text": "<p>This guide provides step-by-step instructions for upgrading an existing TheHive 5.x instance to TheHive 5.5.x.</p>"}, {"location": "thehive/installation/upgrade-from-5.x/#upgrade-instructions", "title": "Upgrade instructions", "text": "<p>TheHive packages are distributed as RPM and DEB files available for direct download via tools like Wget or cURL, with installation performed manually.</p> <p>All packages are hosted on an HTTPS-secured website and come with a SHA256 checksum and a GPG signature for verification.</p> <p>Alternatively, you can deploy TheHive using Docker images.</p> DEBRPMDocker <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\nwget -O /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\nwget -O /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\nwget -O /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\nwget -O /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\ncurl -o /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\ncurl -o /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\ncurl -o /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\ncurl -o /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive_5.5.10-1_all.deb.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive_5.5.10-1_all.deb.asc /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>apt-get</code> to manage dependencies automatically:</p> <pre><code>sudo apt-get install /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> <li> <p>Using <code>dpkg</code>:</p> <pre><code>sudo dpkg -i /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> </ul> </li> </ol> <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive-5.5.10-1.noarch.rpm.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive-5.5.10-1.noarch.rpm.asc /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>yum</code> to manage dependencies automatically:</p> <pre><code>sudo yum install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>dnf</code> to manage dependencies automatically:</p> <pre><code>sudo dnf install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>rpm</code>:</p> <pre><code>sudo rpm -ivh /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> </ul> </li> </ol> <p>Update your existing TheHive 5.x Docker stack (docker-compose file or similar) using the image named <code>strangebee/thehive:5.5</code></p> <p>Important note</p> <p>Ensure that you update your Docker tags accordingly. The strangebee/thehive:latest tag is deprecated and remains associated with TheHive 5.0.x versions. A new strangebee/thehive:5.5 tag is now available and associated with the latest 5.5.x version.</p>"}, {"location": "thehive/installation/upgrade-from-5.x/#health-checks", "title": "Health checks", "text": "<p>If you have health checks on the application HTTP interface, they should be disabled during the upgrade process. Otherwise, the orchestrator may kill TheHive during the update process.</p> <p> </p>"}, {"location": "thehive/installation/licenses/about-licenses/", "title": "About Licenses", "text": ""}, {"location": "thehive/installation/licenses/about-licenses/#thehive-licenses", "title": "TheHive Licenses", "text": "<p>This topic presents the different types of licenses available for TheHive.</p> <p>Cortex</p> <p>Since Cortex is a fully open-source project, you don't need a license to use it.</p> <p>Platinum trial</p> <p>5.3 Installing TheHive On-prem or using TheHive Cloud Platform for the first time includes a 14-day Platinum trial license. After this trial period, TheHive transitions to read-only mode, requiring a valid license for all users for continued full functionality.</p> <p>Upgrading with Community license</p> <p>If you're upgrading to TheHive version 5.3 or later from a TheHive 5.x Community edition, be sure to request a Community license on the StrangeBee license portal. Without this registration, your interface is limited to read-only mode.</p>"}, {"location": "thehive/installation/licenses/about-licenses/#types-and-pricing", "title": "Types and pricing", "text": "License type Supported solution Purpose Pricing Community On-prem Essential features to get started with TheHive or for users with basic needs. Free\u2014requires requesting a Community license Gold On-prem Designed for internal response teams requiring enhanced case management lifecycles and organizational integrations. Paid\u2014requires contacting the StrangeBee team Platinum On-prem and Cloud Platform Ideal for large teams needing extensive server connections, clustering, and dedicated continuous support for mission-critical, large-scale incident response. Paid\u2014requires contacting the StrangeBee team <p>All license types require activation after acquisition.</p> <p>Check the pricing details and the full list of features available for each license type on the StrangeBee pricing page.</p>"}, {"location": "thehive/installation/licenses/about-licenses/#terms-and-quotas", "title": "Terms and quotasNext steps", "text": "<p>Each license includes validation and expiration dates.</p> <p>Each license type has specific quotas for:</p> <ul> <li>Number of users: Only unlocked user accounts of type Normal with at least one licensed permission count toward the license limit. Service accounts and Normal accounts with no licensed permissions, such as Read-Only or Admin profiles, don't.</li> <li>Number of organizations: Only unlocked organizations count toward the license limit.</li> <li>Number of instances</li> <li>Number of Cortex servers</li> <li>Number of Malware Information Sharing Platform (MISP) servers</li> </ul> <ul> <li>Request a Community License</li> <li>Activate or Update a License</li> </ul>"}, {"location": "thehive/installation/licenses/license/", "title": "Activate or Update a License", "text": ""}, {"location": "thehive/installation/licenses/license/#activate-or-update-a-license", "title": "Activate or Update a License", "text": "<p><code>[admin] managePlatform</code></p> <p>This topic provides step-by-step instructions for activating or updating a TheHive license, whether it\u2019s a Community, Gold, or Platinum license.</p> <p>Platinum trial</p> <p>5.3 Installing TheHive On-prem or using TheHive Cloud Platform for the first time includes a 14-day Platinum trial license. After this trial period, TheHive transitions to read-only mode, requiring a valid license for all users for continued full functionality.</p> <p>Requirements</p> <ul> <li>For Community license: This procedure assumes that you have already obtained a Community license by following the Request a Community License topic.</li> <li>For Gold and Platinum licenses: This procedure assumes that you have already purchased a valid Gold or Platinum license and no longer wish or are able to use your trial license.</li> </ul>"}, {"location": "thehive/installation/licenses/license/#step-1-retrieve-the-challenge-from-your-thehive-instance", "title": "Step 1: Retrieve the challenge from your TheHive instance", "text": "<ol> <li> <p>Go to the Platform management view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the License tab.</p> <p></p> </li> <li> <p>Select Update the current license</p> <p></p> </li> <li> <p>In the Set a license key drawer, select Copy this challenge.</p> </li> </ol>"}, {"location": "thehive/installation/licenses/license/#step-2-generate-your-license-key", "title": "Step 2: Generate your license key", "text": "<ol> <li> <p>Log in to the StrangeBee license portal.</p> </li> <li> <p>Select the Licenses tab.</p> <p></p> </li> <li> <p>Select Activate or View details for your product.</p> <p></p> </li> <li> <p>Paste the challenge into the License key activation challenge field.</p> <p></p> </li> <li> <p>Select Activate license.</p> </li> <li> <p>Select Copy the key to clipboard.</p> </li> </ol>"}, {"location": "thehive/installation/licenses/license/#step-3-activate-your-license-in-thehive", "title": "Step 3: Activate your license in TheHiveNext steps", "text": "<ol> <li> <p>Go back to your TheHive instance with the Set a license key drawer open.</p> </li> <li> <p>Paste the generated license into the License field.</p> </li> <li> <p>Select Activate the license key.</p> </li> </ol> <ul> <li>Configure Authentication</li> <li>Connect a MISP Server</li> <li>Add a Cortex Server</li> <li>Configure an SMTP Server</li> <li>Create an Organization</li> <li>Create a User Account</li> <li>Connect a Mailbox</li> <li>Create a Profile</li> <li>Create a Custom Field</li> <li>Create an Observable Type</li> <li>Create a Status</li> <li>Import Analyzer Templates</li> <li>Activate or Deactivate a Taxonomy</li> <li>Add a Tactics, Techniques and Procedures Catalog</li> </ul>"}, {"location": "thehive/installation/licenses/request-a-community-license/", "title": "Request a Community License", "text": ""}, {"location": "thehive/installation/licenses/request-a-community-license/#request-a-community-license", "title": "Request a Community License", "text": "<p>This topic provides step-by-step instructions for requesting a TheHive Community license.</p> <p>The Community license is free and includes essential features to help you get started with TheHive or support basic user needs.</p> <p>TheHive On-prem only</p> <p>The Community license is available exclusively for TheHive On-prem deployments and isn't offered for TheHive Cloud Platform.</p> <p>Upgrading with Community license</p> <p>If you\u2019re upgrading to TheHive version 5.3 or later from a TheHive 5.x Community edition, you must complete this procedure to avoid having your interface limited to read-only mode.</p> Procedure <ol> <li> <p>Go to the StrangeBee license portal registration page.</p> <p></p> </li> <li> <p>Create an account using your professional email address.</p> </li> <li> <p>Check your inbox for a confirmation message and verify your email address.</p> <p>Account not validated yet</p> <p>At this stage, your account still requires validation by the StrangeBee team.</p> </li> <li> <p>After validation, you receive a notification. Follow the instructions to set your password.</p> </li> <li> <p>Log in to the StrangeBee license portal.</p> </li> <li> <p>Select Request a Community license.</p> <p></p> </li> <li> <p>In the drawer, select Get a Community license.</p> <p></p> </li> </ol> Next steps <ul> <li>Activate or Update a License</li> </ul>"}, {"location": "thehive/operations/cassandra-cluster/", "title": "Cassandra Cluster Operations", "text": ""}, {"location": "thehive/operations/cassandra-cluster/#cassandra-cluster-operations", "title": "Cassandra Cluster Operations", "text": "<p>This guide provides comprehensive instructions for performing key operations on a Cassandra cluster, including adding nodes to an existing cluster and managing node removal.</p>"}, {"location": "thehive/operations/cassandra-cluster/#adding-a-node-to-a-cassandra-cluster", "title": "Adding a Node to a Cassandra Cluster", "text": "<p>To add a Cassandra node to an existing cluster without downtime, follow these steps:</p> <ol> <li> <p>Install the New Node:</p> <ul> <li>Install Cassandra on the new node using the same configuration file as the existing nodes, with adjustments made to the <code>listen_address</code> and <code>rpc_address</code> settings to reflect the node's IP address. Set the IP address of any existing node in the seeds section of the configuration file (cassandra.yaml). </li> </ul> </li> <li> <p>Start the Node</p> <ul> <li>Once installed and configured, start the Cassandra service on the new node.</li> </ul> </li> <li> <p>Check Cluster Status</p> <ul> <li>Use the nodetool status command to monitor the cluster status and verify that the new node is recognized and in the joining state.</li> </ul> Display Cassandra Nodes Status<pre><code># nodetool status\n\nDatacenter: datacenter1\n=======================\nStatus=Up/Down\n|/ State=Normal/Leaving/Joining/Moving\n--  Address     Load       Tokens  Owns (effective)  Host ID                               Rack \nUN  172.24.0.2  3.68 GiB   256      100.0%            048a870f-d6d5-405e-8d0d-43dbc12be747  rack1\nUJ  172.24.0.3  89.54 MiB  256      ?                 f192ef8f-a4fd-4e24-99a7-0f92605a7cb6  rack1\n</code></pre> </li> </ol> <p>After the new node is fully operational, re-run the nodetool status command to ensure that the cluster status reflects the successful addition of the new node:</p> Display Cassandra Nodes status<pre><code># nodetool status\n\nDatacenter: datacenter1\n=======================\nStatus=Up/Down\n|/ State=Normal/Leaving/Joining/Moving\n--  Address     Load      Tokens  Owns (effective)  Host ID                               Rack \nUN  172.24.0.2  3.68 GiB  256      48.8%             048a870f-d6d5-405e-8d0d-43dbc12be747  rack1\nUN  172.24.0.3  1.91 GiB  256      51.2%             f192ef8f-a4fd-4e24-99a7-0f92605a7cb6  rack1\n</code></pre> <p>The updated status will indicate the UN (Up/Normal) state for the new node, showing its load, tokens, ownership percentage, host ID, and rack assignment.</p> <p>Creating a Cluster from a Standalone Server</p> <p>If you are transitioning from a standalone server to a multi-node cluster by adding a new node, ensure that you update  the confiuration of the existing standalone server by modifying the <code>cassandra.yaml</code> file to replace the <code>localhost</code> in <code>listen_address</code> and <code>rpc_address</code> with the server's actual IP address. </p>"}, {"location": "thehive/operations/cassandra-cluster/#removing-an-alive-node-from-a-cassandra-cluster", "title": "Removing an Alive Node from a Cassandra Cluster", "text": "<p>To safely remove an alive node from your Cassandra cluster, follow these steps:</p> <ol> <li>Ensure Compatibility with Replication Factor</li> </ol> <p>Before proceeding with node removal, ensure that the replication factor is suitable for the desired number of nodes in the cluster. If necessary, update the replication factor to maintain adequate data redundancy.</p> <ol> <li>Decommission the Node</li> </ol> <p>To remove an alive node gracefully, connect to the node you intend to remove and execute the following nodetool command:</p> <pre><code>nodetool decommission\n</code></pre> <p>This command initiates the decommissioning process for the node, allowing it to transfer its data to other nodes in the cluster before removal.</p> <p>Monitor the decommissioning progress using <code>nodetool status</code> on other nodes in the cluster. Verify that the decommissioned node transitions to a <code>Leaving state</code> and completes data transfer successfully.</p>"}, {"location": "thehive/operations/cassandra-cluster/#removing-a-dead-node-from-a-cassandra-cluster", "title": "Removing a Dead Node from a Cassandra Cluster", "text": "<p>If a node has crashed and cannot be repaired, you can remove it from the cluster using the <code>nodetool removenode</code> command followed by the node <code>id</code>.</p> <p>Steps to Remove a Dead Node:</p> <ol> <li>Check Current Cluster Status:</li> <li> <p>Use <code>nodetool status</code> to view the current status of the Cassandra cluster:      </p><pre><code>nodetool status\n</code></pre><p></p> </li> <li> <p>Identify the Dead Node:</p> </li> <li> <p>Locate the node with a <code>DN</code> (Down) status in the cluster output.</p> </li> <li> <p>Execute <code>nodetool removenode</code> Command:</p> </li> <li> <p>Run the following command to remove the dead node from the cluster:      </p><pre><code>nodetool removenode &lt;node_id&gt;\n</code></pre>      Replace <code>&lt;node_id&gt;</code> with the ID of the dead node obtained from the <code>nodetool status</code> output.<p></p> </li> <li> <p>Verify Cluster Status:</p> </li> <li>After executing the <code>nodetool removenode</code> command, check the cluster status again using <code>nodetool status</code> to ensure that the dead node has been successfully removed and that the remaining nodes are in a <code>Normal</code> state.</li> </ol>"}, {"location": "thehive/operations/cassandra-cluster/#increasing-replication-factor-in-cassandra", "title": "Increasing Replication Factor in Cassandra", "text": "<p>When you have multiple nodes, increasing the replication factor enhances fault tolerance by creating additional copies in the cluster. More copies mean greater resilience to hardware failures. However, this also means more disk space is used due to the increased data redundancy, potentially resulting in slower write access.</p> <p>To enhance fault tolerance in your Cassandra cluster by increasing the replication factor, follow these steps:</p> <ol> <li>Connect to cqlsh</li> </ol> <p>Use cqlsh to connect to your Cassandra cluster:</p> <ol> <li>Modify Keyspace Replication</li> </ol> <p>Execute the following ALTER KEYSPACE command to increase the replication factor for a specific keyspace (replace thehive with your keyspace name):</p> <pre><code>ALTER KEYSPACE thehive WITH replication = {'class': 'SimpleStrategy', 'replication_factor': 3 };\n</code></pre> <ol> <li>Run nodetool repair -full on Each Node</li> </ol> <p>After modifying the keyspace replication, execute <code>nodetool repair -full</code> on each node in your Cassandra cluster to ensure data is fully replicated and consistent across the cluster.</p> <p>Increase the replication factor for system keyspaces to ensure high availability and reliability of critical Cassandra system data.</p> <p>To view the current replication settings for all keyspaces in your cluster, use the following cqlsh query:</p> Checking Current Keyspace Information<pre><code>&gt; SELECT * FROM system_schema.keyspaces;\n\n keyspace_name      | durable_writes | replication\n--------------------+----------------+-------------------------------------------------------------------------------------\n        system_auth |           True | {'class': 'org.apache.cassandra.locator.SimpleStrategy', 'replication_factor': '2'}\n      system_schema |           True |                             {'class': 'org.apache.cassandra.locator.LocalStrategy'}\n system_distributed |           True | {'class': 'org.apache.cassandra.locator.SimpleStrategy', 'replication_factor': '2'}\n             system |           True |                             {'class': 'org.apache.cassandra.locator.LocalStrategy'}\n      system_traces |           True | {'class': 'org.apache.cassandra.locator.SimpleStrategy', 'replication_factor': '2'}\n            thehive |           True | {'class': 'org.apache.cassandra.locator.SimpleStrategy', 'replication_factor': '2'}\n</code></pre> <p>This query displays detailed information about each keyspace, including its name and replication strategy with the associated replication factor.</p> <p> </p>"}, {"location": "thehive/operations/cassandra-security/", "title": "Cassandra Security Operations", "text": ""}, {"location": "thehive/operations/cassandra-security/#security-in-apache-cassandra", "title": "Security in Apache Cassandra", "text": ""}, {"location": "thehive/operations/cassandra-security/#authentication-with-cassandra", "title": "Authentication with Cassandra", "text": "<p>References</p> <p>Internal authentication</p> <ul> <li>https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/configuration/secureInternalAuthenticationTOC.html</li> </ul> <p>To authenticate with Cassandra and manage permissions, follow these steps:</p> <ol> <li>Create a Role and Grant Permissions:</li> </ol> <pre><code>CREATE ROLE thehive WITH PASSWORD = 'thehive1234' AND LOGIN = true;\nGRANT ALL PERMISSIONS ON KEYSPACE thehive TO thehive;\n</code></pre> <ol> <li> <p>Configure TheHive with the Account:</p> <p>Update <code>/etc/thehive/application.conf</code> with the Cassandra authentication details:</p> <pre><code>  db.janusgraph {\n    storage {\n      ## Cassandra configuration\n      # More information at https://docs.janusgraph.org/basics/configuration-reference/#storagecql\n      backend: cql\n      hostname: [\"xxx.xxx.xxx.xxx\"]\n      # Cassandra authentication (if configured)\n      username: \"thehive\" \n      password: \"thehive1234\" \n      cql {\n        cluster-name: thp\n        keyspace: thehive\n      }\n    }\n</code></pre> <p>Ensure to replace xxx.xxx.xxx.xxx with the appropriate Cassandra host name or IP address.</p> </li> </ol>"}, {"location": "thehive/operations/cassandra-security/#configuring-node-to-node-encryption-for-cassandra", "title": "Configuring Node-to-Node Encryption for Cassandra", "text": "<p>References</p> <p>Node-to-Node Encryption</p> <ul> <li>https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/configuration/secureSSLNodeToNode.html</li> </ul> <p>To enable node-to-node encryption, modify the <code>cassandra.yaml</code> configuration file with the following settings:</p> <pre><code>server_encryption_options:\n    internode_encryption: all\n    keystore: /path/to/keystore.jks\n    keystore_password: keystorepassword\n    truststore: /path/to/truststore.jks\n    truststore_password: truststorepassword\n    # More advanced defaults below:\n    protocol: TLS\n    algorithm: SunX509\n    store_type: JKS\n    cipher_suites: [TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_DHE_RSA_WITH_\nAES_128_CBC_SHA,TLS_DHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_R\nSA_WITH_AES_256_CBC_SHA]\n    require_client_auth: false\n</code></pre> <p> </p>"}, {"location": "thehive/operations/cassandra-security/#setting-up-cassandra-dedicated-ssl-port-optional", "title": "Setting Up Cassandra Dedicated SSL Port (Optional)", "text": "<p>Optionally, you can configure a dedicated port for SSL communication in Cassandra. Setting up a dedicated SSL port provides enhanced security for communication with your Cassandra cluster. Follow these steps to update the <code>/etc/cassandra/cassandra.yaml</code> configuration file on each node:</p> <ol> <li> <p>Open the cassandra.yaml configuration file on each node.</p> </li> <li> <p>Locate the native_transport_port_ssl parameter within the file.</p> </li> <li> <p>Update the native_transport_port_ssl parameter to specify the desired SSL port number (e.g., 9142):</p> <pre><code>native_transport_port_ssl: 9142\n</code></pre> </li> </ol> <p>By specifying a dedicated <code>native_transport_port_ssl</code>, all SSL communications will utilize this port instead of the default port configured for non-SSL traffic (<code>native_transport_port</code>). </p>"}, {"location": "thehive/operations/cassandra-security/#client-to-node-encryption", "title": "Client to Node Encryption", "text": "<p>References</p> <p>Client to Node Encryption</p> <ul> <li>https://docs.datastax.com/en/archived/cassandra/3.0/cassandra/configuration/secureSSLClientToNode.html</li> <li>https://docs.janusgraph.org/basics/configuration-reference/#storagecqlssl</li> </ul> <p>This guide explains how to establish a secure connection between Cassandra clients (specifically TheHive) and the Cassandra server.</p> <p> </p>"}, {"location": "thehive/operations/cassandra-security/#requirements", "title": "Requirements", "text": "<p>To set up secure encryption, you'll need the following:</p> <ol> <li>X509 Certificate for Cassandra Service</li> <li>Ensure the certificate has the following standard properties:<ul> <li>Key Usage: Digital Signature, Non-Repudiation, Key Encipherment, Key Agreement</li> <li>Extended Key Usage: TLS Web Server Authentication</li> <li>Certificate Type: SSL Server</li> </ul> </li> <li>Include a \"Subject Alternative Name\" (DNS name and/or IP address) that matches how the Cassandra server is identified by the client.</li> <li> <p>The certificate file format should be PKCS12 (with a <code>.p12</code> extension).</p> </li> <li> <p>Truststore</p> </li> <li>Create a truststore that contains the Certificate Authority (CA) used to generate the Cassandra server's certificate.</li> <li>The truststore should be in Java Keystore (JKS) format.</li> <li>If your CA file is named <code>ca.crt</code>, generate the truststore file using the following command:      <pre><code>keytool -import -file /path/to/ca.crt -alias CA -keystore ca.jks\n</code></pre>      You will be prompted to set a password for file integrity checking.</li> </ol> <p>Note: The <code>keytool</code> command is available as part of any JDK distribution.</p> <p> </p>"}, {"location": "thehive/operations/cassandra-security/#steps-to-set-up-encryption", "title": "Steps to Set Up Encryption", "text": "<p>Follow these steps to enable encryption between Cassandra clients (TheHive) and the Cassandra server:</p> <ol> <li> <p>Obtain the Server Certificate</p> <ul> <li>Acquire a valid X509 certificate for the Cassandra service with the specified properties.</li> </ul> </li> <li> <p>Configure the Server Certificate</p> <ul> <li>Ensure the certificate includes the necessary key usage and extended key usage properties.</li> </ul> </li> <li> <p>Create the Truststore</p> <ul> <li>Use the <code>keytool</code> command to import the CA certificate into a Java Keystore (JKS) file (<code>ca.jks</code>).</li> </ul> <pre><code>keytool -import -file /path/to/ca.crt -alias CA -keystore ca.jks\n</code></pre> <p>You will be prompted to set a password for the truststore.</p> </li> <li> <p>Configuring Cassandra</p> <ul> <li>Locate the section <code>client_encryption_options</code> and set the following options:</li> </ul> <pre><code>client_encryption_options:\n    enabled: true\n    # If enabled and optional is set to true encrypted and unencrypted connections are handled.\n    optional: false\n    keystore: /pat/to/keystore.jks\n    keystore_password: keystorepassword\n    require_client_auth: false\n    # Set trustore and truststore_password if require_client_auth is true\n    # truststore: conf/.truststore\n    # truststore_password: cassandra\n    # More advanced defaults below:\n    protocol: TLS\n    algorithm: SunX509\n    store_type: JKS\n    cipher_suites: [TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA,TLS_DHE_RSA_WITH_\nAES_128_CBC_SHA,TLS_DHE_RSA_WITH_AES_256_CBC_SHA,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA,TLS_ECDHE_R\nSA_WITH_AES_256_CBC_SHA]\n</code></pre> <ul> <li>After making these changes, restart the Cassandra service.</li> </ul> </li> <li> <p>Configure TheHive to Use Encryption</p> <ul> <li>Update TheHive Cassandra client configuration to specify the location of the truststore (<code>ca.jks</code>) and provide any additional connection properties required for SSL/TLS encryption.</li> </ul> <pre><code>db.janusgraph {\n  storage {\n    ## Cassandra configuration\n    # More information at https://docs.janusgraph.org/basics/configuration-reference/#storagecql\n    backend: cql\n    hostname: [\"ip_node_1\", \"ip_node_2\", \"ip_node_3\"]\n    # Cassandra authentication (if configured)\n    username: \"thehive\"\n    password: \"thehive1234\"\n    port: 9142 # if alternative port has been set in Cassandra configuration\n    cql {\n      cluster-name: thp\n      keyspace: thehive\n      ssl {\n        enabled: true\n        truststore {\n          location: \"/path/to/truststore.jks\"\n          password: \"truststorepassword\"\n        }\n      }\n    }\n  }\n</code></pre> <ul> <li>After making these changes, restart TheHive to apply the new configuration settings.</li> </ul> </li> </ol> <p> </p>"}, {"location": "thehive/operations/change-index/", "title": "Index Management", "text": ""}, {"location": "thehive/operations/change-index/#change-index-from-lucene-to-elasticsearch", "title": "Change Index from Lucene to Elasticsearch", "text": "<p>Lucene index support was removed starting from TheHive version 5.1. Follow this procedure to change your index to Elasticsearch. This procedure is compatible with any 5.x version.</p>"}, {"location": "thehive/operations/change-index/#setup-your-elasticsearch-server", "title": "Setup Your Elasticsearch Server", "text": "<p>Please refer to our installation manual or use your own server. Ensure that Elasticsearch is started.</p>"}, {"location": "thehive/operations/change-index/#update-thehive-configuration", "title": "Update TheHive Configuration", "text": "DEB / RPM <p>Update your <code>/etc/thehive/application.conf</code> file:</p> <pre><code># Update this configuration section\ndb.janusgraph {\n    # Retain this section for now, as TheHive will need it to migrate the index correctly\n    index.search {\n        backend: lucene\n        directory: ...\n    }\n\n    # Add this section below the Lucene configuration\n    index.search {\n        backend: elasticsearch\n        # Host name(s) of your Elasticsearch server(s)\n        hostname: [\"localhost\"]\n        # Default is \"thehive\"\n        index-name: thehive\n    }\n}\n</code></pre> Docker <p>Update your Docker arguments:</p> <pre><code># Docker compose file\ncommand:\n    # ... other args\n    - \"--index-backend\"\n    - \"elasticsearch\"\n    - \"--es-hostnames\"\n    - \"elasticsearch\"\n</code></pre>"}, {"location": "thehive/operations/change-index/#restart-thehive-application", "title": "Restart TheHive Application", "text": "<p>TheHive will detect the index change, create the new index in Elasticsearch, and start reindexing the documents into the new index. This process may take some time depending on the size of your database.</p> <p>In your logs, you should see the following lines:</p> <pre><code>[warn] o.j.d.c.b.ReadConfigurationBuilder [] Local setting index.search.backend=elasticsearch (Type: GLOBAL_OFFLINE) is overridden by globally managed value (lucene). Use the ManagementSystem interface instead of the local configuration to control this setting.\n</code></pre> <p>During the reindexing process, you will see lines similar to these (the name <code>global1</code> may be different for you):</p> <pre><code>[info] o.j.g.o.j.IndexRepairJob [] Index global1 metrics: success-tx: 110 doc-updates: 10992 succeeded: 10992\n[info] o.j.g.o.j.IndexRepairJob [] Index global1 metrics: success-tx: 111 doc-updates: 10992 succeeded: 10992\n[info] o.j.g.d.m.ManagementSystem [] Index update job successful for [global1]\n</code></pre> <p>Finally, the application will start listening on the HTTP port, and you will be able to access the interface.</p>"}, {"location": "thehive/operations/change-index/#remove-the-lucene-configuration", "title": "Remove the Lucene Configuration", "text": "<p>Once the reindexing is complete, you can remove the Lucene configuration from your configuration file.</p> DEB / RPM <p>Update your <code>/etc/thehive/application.conf</code> file:</p> <pre><code># Update this configuration section\ndb.janusgraph {\n    # Delete this section now\n    index.search {\n        backend: lucene\n        directory: ...\n    }\n\n    # Retain this section\n    index.search {\n        backend: elasticsearch\n        # Host name(s) of your Elasticsearch server(s)\n        hostname: [\"localhost\"]\n        # Default is \"thehive\"\n        index-name: thehive\n    }\n}\n</code></pre>"}, {"location": "thehive/operations/minio-cluster/", "title": "MinIO Cluster Operations", "text": ""}, {"location": "thehive/operations/minio-cluster/#minio-cluster-operations", "title": "MinIO Cluster Operations", "text": ""}, {"location": "thehive/operations/minio-cluster/#replace-a-disk", "title": "Replace a Disk", "text": "<p>If a disk in your MinIO cluster is faulty and needs to be replaced, you can perform this operation without downtime thanks to MinIO support for hot-swapping disks:</p> <ol> <li> <p>Unmount the Faulty Disk</p> <ul> <li> <p>Safely unmount the faulty disk from the server where it is installed.</p> </li> <li> <p>Ensure that any data on the disk is backed up or transferred to another location if possible.</p> </li> </ul> </li> <li> <p>Install the Replacement Disk</p> <ul> <li> <p>Install the healthy replacement disk in the same location as the faulty disk.</p> </li> <li> <p>Connect the replacement disk to the server and ensure it is properly recognized by the operating system.</p> </li> </ul> </li> <li> <p>Mount the Replacement Disk</p> <ul> <li>Mount the replacement disk to the same mount point previously used by the faulty disk.</li> </ul> </li> <li> <p>Check MinIO Logs</p> <ul> <li>Check the MinIO logs to ensure that the new disk has been recognized by the system:   <pre><code>mc admin service logs &lt;myminio&gt;\n</code></pre></li> </ul> </li> <li> <p>Initiate Disk Heal</p> <ul> <li>Run a disk heal operation to synchronize data and ensure data integrity across the cluster with the new disk:   <pre><code>mc admin heal &lt;myminio&gt;\n</code></pre></li> </ul> </li> </ol>"}, {"location": "thehive/operations/minio-cluster/#replace-a-node", "title": "Replace a Node", "text": "<p>In the event that a server within your MinIO cluster has crashed and cannot be recovered, you can install a new server to replace it. Ensure that the new node is configured with the same IP address or host name as the old node. Once the new server is operational and has joined the cluster, initiate a disk heal by running <code>mc admin heal</code>.</p> <p> </p>"}, {"location": "thehive/operations/minio-cluster/#step-by-step-guide-replace-a-node-in-minio-cluster", "title": "Step-by-Step Guide: Replace a Node in MinIO Cluster", "text": "<ol> <li> <p>Prepare the Replacement Server</p> <ul> <li> <p>Set up a new server that meets the hardware and network requirements for running MinIO.</p> </li> <li> <p>Ensure the new server has the same MinIO version as the existing cluster nodes.</p> </li> <li> <p>Assign the same IP address or host name as the node being replaced.</p> </li> </ul> </li> <li> <p>Prepare the Existing Cluster</p> <ul> <li>Identify the node that needs to be replaced and ensure it is no longer part of the active cluster. Stop the MinIO service on this node.</li> </ul> </li> <li> <p>Transfer Data</p> <ul> <li>If possible, transfer any data stored on the node being replaced to other nodes in the cluster to avoid data loss.</li> </ul> </li> <li> <p>Distribute the Configuration</p> <ul> <li>Copy the modified <code>config.json</code> file to the new replacement node's MinIO configuration directory.</li> </ul> </li> <li> <p>Start MinIO Service on Replacement Node</p> <ul> <li>Start the MinIO service on the new replacement node and ensure it joins the cluster successfully:   <pre><code>systemctl start minio\n</code></pre></li> </ul> </li> <li> <p>Verify Node Replacement</p> <ul> <li>Check the cluster status to ensure that the new replacement node has been successfully added and is part of the cluster:   <pre><code>mc admin info myminio\n</code></pre></li> </ul> </li> <li> <p>Initiate Disk Heal</p> <ul> <li>Run a disk heal operation to synchronize data and ensure data integrity across the cluster with the new replacement node:   <pre><code>mc admin heal myminio\n</code></pre></li> </ul> </li> <li> <p>Monitor Cluster Health</p> <ul> <li>Use MinIO monitoring tools (<code>mc admin top</code> or web-based console) to monitor the health and performance of the cluster with the new replacement node.</li> </ul> </li> </ol> <p>By following these steps, you can safely replace a node in your MinIO cluster while maintaining data integrity and cluster stability. Ensure that all operations are performed during a maintenance window to minimize impact on production services.</p>"}, {"location": "thehive/operations/minio-cluster/#add-a-node-to-the-cluster", "title": "Add a Node to the Cluster", "text": "<p>Adding a new server to an existing MinIO cluster involves restarting all MinIO nodes and updating their configuration to account for the new node. It's crucial to synchronize the configuration across all nodes. After the cluster is successfully started with the new node, perform a disk heal operation using <code>mc admin heal</code>.</p> <p>Note: MinIO strongly recommends restarting all nodes simultaneously when adding or removing nodes from a cluster. Avoid \"rolling\" restarts (i.e., restarting one node at a time).</p> <p> </p>"}, {"location": "thehive/operations/minio-cluster/#step-by-step-guide-adding-a-node-to-minio-cluster", "title": "Step-by-Step Guide: Adding a Node to MinIO Cluster", "text": "<ol> <li> <p>Prepare the New Server</p> <ul> <li> <p>Set up a new server (physical or virtual) that meets the hardware and network requirements for running MinIO.</p> </li> <li> <p>Ensure the new server has the same MinIO version as the existing cluster nodes.</p> </li> <li> <p>Assign a static IP address or configure a host name for the new node that matches the existing cluster nodes.</p> </li> </ul> </li> <li> <p>Update MinIO Configuration</p> <ul> <li> <p>Access the configuration file (<code>config.json</code>) of each existing MinIO node in the cluster.</p> </li> <li> <p>Add the details of the new node (IP address or host name) to the <code>config.json</code> file of each node under the <code>cluster</code> section:   </p><pre><code>{\n   \"version\": \"minio\",\n   \"cluster\": {\n      \"nodes\": [\n      {\"endpoint\": \"existing-node1:9000\"},\n      {\"endpoint\": \"existing-node2:9000\"},\n      {\"endpoint\": \"existing-node3:9000\"},\n      {\"endpoint\": \"new-node:9000\"}\n      ]\n   }\n}\n</code></pre><p></p> </li> <li> <p>Save the updated configuration file.</p> </li> </ul> </li> <li> <p>Distribute the Updated Configuration</p> <ul> <li>Copy the modified <code>config.json</code> file to the new node's MinIO configuration directory.</li> </ul> </li> <li> <p>Restart MinIO Service</p> <ul> <li>On each existing MinIO node, restart the MinIO service to apply the updated configuration:   <pre><code>systemctl restart minio\n</code></pre></li> </ul> </li> <li> <p>Verify Node Addition</p> <ul> <li>Once all nodes have been restarted, check the cluster status to ensure the new node has been successfully added:   <pre><code>mc admin info &lt;myminio&gt;\n</code></pre></li> </ul> </li> <li> <p>Initiate Disk Heal</p> <ul> <li>Run a disk heal operation to ensure data consistency across the cluster with the new node:   <pre><code>mc admin heal &lt;myminio&gt;\n</code></pre></li> </ul> </li> </ol>"}, {"location": "thehive/operations/minio-cluster/#remove-a-node-from-cluster", "title": "Remove a node from cluster", "text": "<p>When removing a node from your MinIO cluster, follow the same procedure as adding a node: update the cluster's configuration file to reflect the removal and restart all nodes in the cluster to apply the changes.</p>"}, {"location": "thehive/operations/minio-cluster/#minio-and-high-availability", "title": "MINIO and High Availability", "text": "<p>MinIO supports high availability by configuring a single S3 endpoint in applications like TheHive. To achieve high availability across MinIO nodes, use load balancers and virtual IP addresses to distribute connections evenly among the cluster nodes.</p> <p>Follow the guide under deploying a cluster to configure MinIO with load balancer and virtual IP.</p> <p> </p>"}, {"location": "thehive/operations/monitoring/", "title": "Set Up Monitoring", "text": ""}, {"location": "thehive/operations/monitoring/#set-up-monitoring-for-thehive-with-prometheus-and-grafana", "title": "Set Up Monitoring for TheHive with Prometheus and Grafana", "text": "<p>Set up a monitoring stack for TheHive with Prometheus and Grafana to track performance and activity.</p> <p>By the end, you'll have a fully functional monitoring system displaying real-time metrics about your TheHive instance performance, API requests, and system resources.</p> <p></p> <p>Before you begin</p> <p>Before you start, ensure you have:</p> <ul> <li>A running Prometheus instance, version 2.x or 3.x </li> <li>A running Grafana instance, version 7.0 or later</li> </ul>"}, {"location": "thehive/operations/monitoring/#step-1-enable-monitoring-in-thehive", "title": "Step 1: Enable monitoring in TheHive", "text": "<p>First, we need to activate TheHive built-in monitoring capabilities. TheHive uses the Kamon library to collect metrics, but it's turned off by default. The platform includes built-in integration with Prometheus Reporter. For other reporters, contact StrangeBee Support.</p> <ol> <li> <p>Open the <code>/etc/thehive/application.conf</code> file.</p> </li> <li> <p>In the <code>application.conf</code> file, add the following configuration to enable Kamon and the Prometheus reporter:</p> <pre><code>kamon {\n  # Activate Kamon module-deactivated by default\n  enabled = true\n\n  # Enable the Prometheus reporter\n  modules {\n    prometheus-reporter.enabled = yes\n  }\n\n  environment.tags {\n      # Configure additional tags to be sent to Prometheus \n      # See https://kamon.io/docs/latest/reporters/prometheus/#sending-environment-tags-to-prometheus\n      # Example: env = prod\n  }\n\n  # Reference: https://kamon.io/docs/latest/reporters/prometheus/#configuration\n  prometheus {\n    include-environment-tags = true\n    # Start an embedded server on the specified port \n    # If using Docker, ensure this port is accessible\n    embedded-server {\n      hostname = 0.0.0.0  # Binds to all interfaces. Required if Prometheus runs outside this host or in a cluster\n                          # If Prometheus runs on the same machine, prefer 127.0.0.1 for local-only access\n      port = 9095\n    }\n  }\n}\n</code></pre> <p>Production security</p> <p>This configuration exposes metrics without authentication on port <code>9095</code>. Ensure this port is only accessible to authorized monitoring systems in your environment.</p> </li> <li> <p>Save your modifications in the <code>application.conf</code> file.</p> </li> <li> <p>Restart TheHive to apply the changes.</p> </li> </ol> <p>Let's verify that everything is working. Open your browser and navigate to <code>http://&lt;thehive_hostname&gt;:9095/metrics</code>. You should see a page full of metrics in Prometheus format.</p>"}, {"location": "thehive/operations/monitoring/#step-2-connect-prometheus-to-thehive", "title": "Step 2: Connect Prometheus to TheHive", "text": "<p>Now we'll configure Prometheus to collect these metrics from TheHive.</p> <ol> <li> <p>Locate and open your <code>prometheus.yml</code> configuration file.</p> </li> <li> <p>Add TheHive as a scrape target. The configuration depends on your Prometheus version.</p> For Prometheus v2.xFor Prometheus v3.x <p>Add the scrape configuration to <code>prometheus.yml</code>.</p> <pre><code>scrape_configs:\n  # ...  other scrape configs \n\n  - job_name: 'thehive'\n    scrape_interval: 30s\n    static_configs:\n      - targets: ['&lt;thehive_hostname&gt;:9095'] # Set the IP or hostname for TheHive\n</code></pre> <p>Add the scrape configuration to <code>prometheus.yml</code>.</p> <pre><code>scrape_configs:\n  # ...  other scrape configs \n\n  - job_name: 'thehive'\n    scrape_interval: 30s\n    fallback_scrape_protocol: PrometheusText0.0.4\n    static_configs:\n      - targets: ['&lt;thehive_hostname&gt;:9095'] # Set the IP or hostname for TheHive\n</code></pre> <p>The <code>fallback_scrape_protocol</code> ensures compatibility with TheHive metrics format. For more details, check the Prometheus migration guide.</p> </li> <li> <p>Save the configuration file and restart Prometheus.</p> </li> <li> <p>Verify the connection by opening the Prometheus web interface.</p> <p>a. Open the Prometheus web interface.</p> <p>b. Select Status in the top menu.</p> <p>c. Select Targets from the dropdown.</p> <p>d. Check in the State column that 'thehive' target state is <code>UP</code>.</p> </li> <li> <p>Optional: Configure automatic discovery in Kubernetes</p> <p>If you're running TheHive in Kubernetes, you can set up automatic service discovery instead of static configuration by either:</p> <ul> <li>Add appropriate labels to your TheHive pods</li> <li>Create a <code>PodMonitor</code> resource if using Prometheus Operator</li> </ul> <p>For detailed instructions, see the Prometheus Kubernetes configuration or Prometheus Operator documentation.</p> </li> </ol>"}, {"location": "thehive/operations/monitoring/#step-3-visualize-metrics-in-grafana", "title": "Step 3: Visualize metrics in Grafana", "text": "<p>Time to make those metrics visible! We'll set up Grafana dashboards to display TheHive performance data.</p> <ol> <li> <p>Open Grafana in your browser and log in.</p> </li> <li> <p>Configure Prometheus as a data source:</p> <p>a. Select  in the left sidebar.</p> <p>b. Select Data Sources.</p> <p>c. If Prometheus isn't listed, select Add data source and select Prometheus.</p> <p>d. In the URL field, enter the appropriate Prometheus server URL.</p> <p>e. Adjust other data source settings as desired.</p> <p>f. Select Save &amp; Test.</p> </li> <li> <p>Now let's import pre-built dashboards to start monitoring TheHive.</p> <p>Recommended dashboard templates</p> <p>We suggest starting with these Kamon 2.x dashboards, which work well with TheHive:</p> <ul> <li>Kamon 2.x - API Dashboard <code>ID: 12317</code>: Shows API metrics like request throughput, response latency, and error rates. Note: Some API requests may display latencies of up to 60 seconds. This is expected as TheHive frontend uses long polling for real-time updates, so these legitimate requests will appear as outliers.</li> <li>Kamon 2.x - System Metrics Dashboard <code>ID: 12315</code>: Displays CPU usage, memory consumption, Java virtual machine (JVM) heap usage, and garbage collection stats.</li> <li>Kamon 2.x - Akka Dashboard <code>ID: 10776</code>: Shows Akka system information, actor metrics, and message processing times.</li> </ul> <p>For more options, browse the Grafana dashboard library.</p> <p>a. Select Dashboards in the left sidebar.</p> <p>b. Select Home and then Import.</p> <p>c. Enter the dashboard ID.</p> <p>d. Select Load.</p> <p>e. Select your Prometheus data source.</p> <p>f. Select Import.</p> </li> <li> <p>Review and adjust the dashboard variables to match your environment.</p> </li> </ol> <p>To build custom dashboards from scratch, see Create a dashboard in Grafana.</p>"}, {"location": "thehive/operations/monitoring/#step-4-verify-your-monitoring-setup", "title": "Step 4: Verify your monitoring setupNext steps", "text": "<p>Let's make sure everything is working together:</p> <ol> <li> <p>Generate some activity in TheHive.</p> <p>Create a case, add some observables, or run an analyzer.</p> </li> <li> <p>Open your Grafana dashboards. Within a minute or two, you should see:</p> <ul> <li>API request metrics appearing in the API Dashboard</li> <li>Memory and CPU usage in the System Metrics Dashboard</li> <li>Actor activity in the Akka Dashboard</li> </ul> </li> </ol> <p>You now have a complete monitoring solution for TheHive. Your dashboards will help you track performance, identify bottlenecks, and ensure your TheHive instance runs smoothly.</p> <p>If you experience performance issues, review and adjust the CPU and memory allocation according to your environment.</p> <ul> <li>TheHive Installation System Requirements</li> <li>Troubleshooting</li> </ul>"}, {"location": "thehive/operations/troubleshooting/", "title": "Troubleshooting Guide", "text": ""}, {"location": "thehive/operations/troubleshooting/#troubleshooting", "title": "Troubleshooting", "text": "<p>For some issues, additional information in logs is needed to troubleshoot and understand the root causes. To gather and share this information, please carefully read and follow these steps.</p> <p>Warning</p> <p>ENABLING TRACE LOGS HAS A SIGNIFICANT IMPACT ON PERFORMANCE. DO NOT ENABLE IT ON PRODUCTION SERVERS.</p>"}, {"location": "thehive/operations/troubleshooting/#step-1-stop-thehive-service", "title": "Step 1: Stop TheHive Service", "text": "<p>First, stop TheHive service:</p> <pre><code>service thehive stop\n</code></pre> <p>Ensure the service is stopped with the following command:</p> <pre><code>service thehive status\n</code></pre>"}, {"location": "thehive/operations/troubleshooting/#step-2-renew-applicationlog-file", "title": "Step 2: Renew <code>application.log</code> File", "text": "<p>Move the existing <code>application.log</code> file to a backup location:</p> <pre><code>mv /var/log/thehive/application.log /var/log/thehive/application.log.bak\n</code></pre>"}, {"location": "thehive/operations/troubleshooting/#step-3-update-log-configuration", "title": "Step 3: Update Log Configuration", "text": "<p>Edit the log configuration file <code>/etc/thehive/logback.xml</code>. Locate the line containing <code>&lt;logger name=\"org.thp\" level=\"INFO\"/&gt;</code> and update it to the following:</p> <pre><code>    &lt;logger name=\"org.thp\" level=\"TRACE\"/&gt;\n</code></pre> <p>Save the file after making the changes.</p>"}, {"location": "thehive/operations/troubleshooting/#step-4-restart-thehive-service", "title": "Step 4: Restart TheHive Service", "text": "<p>Restart TheHive service:</p> <pre><code>service thehive start\n</code></pre> <p>A new log file <code>/var/log/thehive/application.log</code> will be created and will contain extensive logging information.</p>"}, {"location": "thehive/operations/troubleshooting/#step-5-monitor-and-save-logs", "title": "Step 5: Monitor and Save Logs", "text": "<p>Wait for the issue to occur or for the application to stop. Then, copy the log file to a safe location:</p> <pre><code>cp /var/log/thehive/application.log /root\n</code></pre>"}, {"location": "thehive/operations/troubleshooting/#step-6-share-the-logs", "title": "Step 6: Share the Logs", "text": "<p>Create an issue on GitHub and include the following information:</p> <ul> <li>Context:</li> <li>Instance type (single node/cluster, backend type, index engine)</li> <li> <p>System details (Operating System, amount of RAM, number of CPUs for each server/node)</p> </li> <li> <p>Symptoms:</p> </li> <li> <p>Actions taken, how the situation occurred, and what happened</p> </li> <li> <p>Log File:</p> </li> <li>Attach the log file with trace information</li> </ul>"}, {"location": "thehive/operations/troubleshooting/#step-7-revert-log-configuration", "title": "Step 7: Revert Log Configuration", "text": "<p>To revert to the normal log configuration:</p> <ol> <li>Stop TheHive service.</li> <li>Edit the <code>logback.xml</code> file to restore the previous log level configuration.</li> <li>Restart TheHive service.</li> </ol> <pre><code>service thehive stop\n# Restore the logback.xml file to previous state\nservice thehive start\n</code></pre> <p> </p>"}, {"location": "thehive/operations/apt-yum-repositories-end/apt-yum-deprecation-notice/", "title": "Deprecation Notice", "text": ""}, {"location": "thehive/operations/apt-yum-repositories-end/apt-yum-deprecation-notice/#apt-and-yum-repositories-deprecation-notice", "title": "APT and YUM Repositories Deprecation Notice", "text": "<p>This topic explains the deprecation of APT and YUM repositories for TheHive and Cortex installations and upgrades.</p> <p>Starting July 31, 2025, TheHive and Cortex are no longer distributed via APT and YUM repositories. Instead, installation and upgrades require manually downloading DEB and RPM packages using tools like cURL or Wget, followed by manual installation.</p> <p>All packages are hosted on an HTTPS-secured website and come with a SHA256 checksum and a GPG signature for verification.</p> <p>Deprecated package sources</p> <p>Packages are no longer distributed from <code>https://archives.strangebee.com/</code> or <code>https://download.thehive-project.org/</code>.</p>"}, {"location": "thehive/operations/apt-yum-repositories-end/apt-yum-deprecation-notice/#why-apt-and-yum-repositories-are-being-deprecated", "title": "Why APT and YUM repositories are being deprecated", "text": "<p>Over time, several incidents have affected the availability of packages in the APT and YUM repositories, leading to unexpected downtime for users relying on these installation methods.</p> <p>To address these issues and enhance reliability, StrangeBee is transitioning to a unified, highly available distribution system. This new system supports all package formats (DEB and RPM) and architectures (AMD64 and ARM64), providing a consistent experience across Linux distributions.</p> <p>Key benefits include:</p> <ul> <li>Improved availability: Packages are served directly from the official, highly available download servers, eliminating dependencies on third-party repositories and reducing delays or interruptions.</li> <li>Simplified installation: A unified process across all supported Linux distributions streamlines package retrieval and installation.</li> <li>Faster updates: Users gain quicker access to new versions and security patches, ensuring their environments remain secure and up to date.</li> </ul>"}, {"location": "thehive/operations/apt-yum-repositories-end/apt-yum-deprecation-notice/#who-is-affected", "title": "Who is affected", "text": "<p>This change applies to users deploying TheHive On-prem and Cortex on Linux distributions via package installations. It doesn't affect those using the TheHive Cloud Platform or running TheHive and Cortex through Docker deployments.</p>"}, {"location": "thehive/operations/apt-yum-repositories-end/apt-yum-deprecation-notice/#what-you-should-do", "title": "What you should doNext steps", "text": "<p>If you are a new user, follow the instructions in TheHive and Cortex step-by-step installation guides.</p> <p>If you currently install or update TheHive and Cortex using <code>apt-get install</code>, <code>apt-get upgrade</code>, <code>yum install</code>, or <code>yum update</code>, switch to manual package downloads and installations. For detailed instructions, see Switch to Manual Download and Installation for TheHive and Switch to Manual Download and Installation for Cortex. Continuing with the current installation lets the application run but blocks it from receiving updates.</p> <ul> <li>Switch to Manual Download and Installation for TheHive</li> <li>Switch to Manual Download and Installation for Cortex</li> </ul>"}, {"location": "thehive/operations/apt-yum-repositories-end/switch-to-manual-download-installation-thehive/", "title": "Switch to Manual Download and Installation", "text": ""}, {"location": "thehive/operations/apt-yum-repositories-end/switch-to-manual-download-installation-thehive/#switch-to-manual-download-and-installation-for-thehive", "title": "Switch to Manual Download and Installation for TheHive", "text": "<p>This topic provides step-by-step instructions for switching from APT and YUM repositories to a manual process for installing and upgrading TheHive, following the APT and YUM repositories deprecation notice.</p> <p>For instructions on performing the same process for Cortex, see Switch to Manual Download and Installation for Cortex.</p> <p>Are you concerned?</p> <p>Use this procedure if you currently install or update TheHive On-prem on Linux distributions using <code>apt-get install</code>, <code>apt-get upgrade</code>, <code>yum install</code>, or <code>yum update</code>.</p> <p>You aren't affected if you use the TheHive Cloud Platform or run TheHive through Docker deployments.</p> <p>If you are a new user, follow the instructions in the installation guide.</p> <p>Dependencies</p> <p>Before starting this procedure, run the following commands:</p> Procedure"}, {"location": "thehive/operations/apt-yum-repositories-end/switch-to-manual-download-installation-thehive/#for-deb-based-systems", "title": "For DEB-based systems:", "text": "<pre><code>sudo apt update\nsudo apt install wget curl gnupg coreutils\n</code></pre>"}, {"location": "thehive/operations/apt-yum-repositories-end/switch-to-manual-download-installation-thehive/#for-rpm-based-systems", "title": "For RPM-based systems:", "text": "<pre><code>sudo yum update\nsudo yum install wget curl gnupg coreutils\n</code></pre>"}, {"location": "thehive/operations/apt-yum-repositories-end/switch-to-manual-download-installation-thehive/#step-1-manually-install-thehive", "title": "Step 1: Manually install TheHive", "text": "DEBRPM <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\nwget -O /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\nwget -O /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\nwget -O /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\nwget -O /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive_5.5.10-1_all.deb https://thehive.download.strangebee.com/5.5/deb/thehive_5.5.10-1_all.deb\ncurl -o /tmp/thehive_5.5.10-1_all.deb.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive_5.5.10-1_all.deb.sha256\ncurl -o /tmp/thehive_5.5.10-1_all.deb.asc https://thehive.download.strangebee.com/5.5/asc/thehive_5.5.10-1_all.deb.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.deb https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/deb/&lt;file_name&gt;.deb\ncurl -o /tmp/&lt;file_name&gt;.deb.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.deb.sha256\ncurl -o /tmp/&lt;file_name&gt;.deb.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.deb.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive_5.4.10-1_all</code>. </li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive_5.5.10-1_all.deb.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team.</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive_5.5.10-1_all.deb.asc /tmp/thehive_5.5.10-1_all.deb\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>apt-get</code> to manage dependencies automatically:</p> <pre><code>sudo apt-get install /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> <li> <p>Using <code>dpkg</code>:</p> <pre><code>sudo dpkg -i /tmp/thehive_5.5.10-1_all.deb\n</code></pre> </li> </ul> </li> </ol> <p>Destination path</p> <p>The commands below use <code>/tmp/</code> as the download path. Replace it with the full local directory path where you want to save the files.</p> <ol> <li> <p>Download the installation package along with its SHA256 checksum and signature files.</p> <ul> <li> <p>Using Wget:</p> <pre><code>wget -O /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\nwget -O /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>wget -O /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\nwget -O /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> <li> <p>Using cURL:</p> <pre><code>curl -o /tmp/thehive-5.5.10-1.noarch.rpm https://thehive.download.strangebee.com/5.5/rpm/thehive-5.5.10-1.noarch.rpm\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.sha256 https://thehive.download.strangebee.com/5.5/sha256/thehive-5.5.10-1.noarch.rpm.sha256\ncurl -o /tmp/thehive-5.5.10-1.noarch.rpm.asc https://thehive.download.strangebee.com/5.5/asc/thehive-5.5.10-1.noarch.rpm.asc\n</code></pre> <p>To download a specific version instead of the latest, use the following format:</p> <pre><code>curl -o /tmp/&lt;file_name&gt;.noarch.rpm https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/rpm/&lt;file_name&gt;.noarch.rpm\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.sha256 https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/sha256/&lt;file_name&gt;.noarch.rpm.sha256\ncurl -o /tmp/&lt;file_name&gt;.noarch.rpm.asc https://thehive.download.strangebee.com/&lt;major.minor_version&gt;/asc/&lt;file_name&gt;.noarch.rpm.asc\n</code></pre> <ul> <li>Replace <code>&lt;file_name&gt;</code> with the full name of the versioned file you want to install. For example, use <code>thehive-5.4.10-1</code>.</li> <li>Replace <code>&lt;major.minor_version&gt;</code> with the corresponding version directory. For example, use <code>5.4</code>.</li> </ul> </li> </ul> </li> <li> <p>Verify the integrity of the downloaded package.</p> <ul> <li> <p>Check the SHA256 checksum by comparing it with the provided value.</p> <p>a. Generate the SHA256 checksum of your downloaded package.</p> <pre><code>sha256sum /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>b. Compare the output hash with the official SHA256 value listed in the .sha256 file.</p> <pre><code>cat /tmp/thehive-5.5.10-1.noarch.rpm.sha256\n</code></pre> <p>c. If both hashes match exactly, the file integrity is verified. If not, the file may be corrupted or tampered with\u2014don't proceed with installation, and contact the StrangeBee Security Team</p> </li> <li> <p>Verify the GPG signature using the public key.</p> <p>a. Download the public key at keys.download.strangebee.com using Wget or cURL.</p> <p></p><pre><code>wget -O /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre> <pre><code>curl -o /tmp/strangebee.gpg https://keys.download.strangebee.com/latest/gpg/strangebee.gpg\n</code></pre><p></p> <p>b. Import the key into your GPG keyring.</p> <pre><code>gpg --import /tmp/strangebee.gpg\n</code></pre> <p>c. Verify the downloaded package signature.</p> <pre><code>gpg --verify /tmp/thehive-5.5.10-1.noarch.rpm.asc /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> <p>d. Expected result.</p> <p>You should see output similar to:</p> <pre><code>gpg: Good signature from \"TheHive Project (TheHive release key) &lt;support@thehive-project.org&gt;\"\n</code></pre> <p>The key fingerprint must match: <code>0CD5 AC59 DE5C 5A8E 0EE1  3849 3D99 BB18 562C BC1C</code></p> <p>Expected GPG warning</p> <p></p><pre><code>gpg: WARNING: This key is not certified with a trusted signature!\ngpg:          There is no indication that the signature belongs to the owner.\n</code></pre> This warning is expected. It means the package is signed with the official TheHive release key, but you haven't marked this key as <code>trusted</code> in your local GPG setup. As long as you see <code>Good signature</code> and the fingerprint matches, the verification is successful. Don't mark our key as globally trusted\u2014the warning is a normal safety reminder and should remain visible.<p></p> <p>If you don't see <code>Good signature</code>, if the fingerprint differs, or if the signature is reported as <code>BAD</code>, don't install the package. This indicates the integrity or authenticity of the file can't be confirmed. Report the issue to the StrangeBee Security Team.</p> </li> </ul> </li> <li> <p>Install the package.</p> <ul> <li> <p>Using <code>yum</code> to manage dependencies automatically:</p> <pre><code>sudo yum install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>dnf</code> to manage dependencies automatically:</p> <pre><code>sudo dnf install /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> <li> <p>Using <code>rpm</code>:</p> <pre><code>sudo rpm -ivh /tmp/thehive-5.5.10-1.noarch.rpm\n</code></pre> </li> </ul> </li> </ol>"}, {"location": "thehive/operations/apt-yum-repositories-end/switch-to-manual-download-installation-thehive/#step-2-remove-the-old-repository", "title": "Step 2: Remove the old repository", "text": "<p>Then, remove or deactivate the old repository to avoid stale configurations.</p> <p>Why you should remove or deactivate the old repository</p> <p>Keeping the old repository configuration can cause your system to download outdated or conflicting packages during updates, potentially breaking your installation or causing unexpected behavior.</p> DEBRPM <p>Run the following commands:</p> <pre><code>sudo rm /etc/apt/sources.list.d/strangebee.list\nsudo apt-get update\n</code></pre> <p>a. Deactivate the repository.</p> <pre><code>sudo yum-config-manager --disable strangebee\n</code></pre> <p>b. Optional: Remove the repository file.</p> <pre><code>sudo rm /etc/yum.repos.d/strangebee.repo\nsudo yum clean all\n</code></pre> Next steps <ul> <li>Switch to Manual Download and Installation for Cortex</li> </ul>"}, {"location": "thehive/operations/backup-restore/overview/", "title": "Overview", "text": ""}, {"location": "thehive/operations/backup-restore/overview/#backup-and-restore-guides", "title": "Backup and Restore Guides", "text": "<p>Warning</p> <p>Regardless of the situation, we strongly recommend performing cold backups. TheHive utilizes Cassandra as its database and Elasticsearch as its indexing engine. Files are typically stored in a folder, although some users opt for Minio S3 object storage. For every backup, the data, index, and files must remain intact and consistent. Any inconsistency could result in data restoration failure.</p> <p>This documentation provides detailed instructions for performing cold backups. Alternatively, you may opt for a hot backup and restore strategy. To assist with this, we provide sample scripts that you can tailor to your specific requirements. However, it is important to note that the final responsibility for implementing and testing the backup and restore processes lies with you.</p> <p>We strongly recommend thoroughly validating your backup and restoration procedures in a controlled environment before relying on them in production. While we strive to provide accurate and helpful guidance, we cannot assume liability for any data loss, downtime, or system failures resulting from incorrect configurations, inconsistencies in your data, or issues during the restoration process. It is essential to ensure that your chosen approach aligns with your infrastructure and operational needs.</p>"}, {"location": "thehive/operations/backup-restore/overview/#cold-backup-restore", "title": "Cold backup &amp; restore", "text": "<p>Your backup and restore strategy heavily depends on your infrastructure and orchestration approach, whether you are using physical servers, virtual servers, Docker, Kubernetes, or cloud solutions like AWS EC2 instances.</p> <p>For example, with AWS Amazon EC2 servers where all data, indexes, and files are stored on dedicated volumes, performing a daily snapshots of the volumes may take only few minutes, including housekeeping tasks such as stopping and restarting services.</p> <p>These procedures focus exclusively on methods for creating full backups and do not cover incremental backup strategies.</p>"}, {"location": "thehive/operations/backup-restore/overview/#backup-and-restore-procedures", "title": "Backup and restore procedures", "text": "<p>Find complete backup and restore procedures for:</p> <ul> <li>Physical servers: backup and restore procedures</li> <li>Virtual servers: backup and restore procedures</li> <li>Containerized Environments (Docker Compose): backup and restore procedures</li> </ul> <p>Use the links above or navigate through the documentation to find the specific procedure suited for your environment.</p>"}, {"location": "thehive/operations/backup-restore/overview/#introduction-to-hot-backup-and-restore", "title": "Introduction to hot backup and restore", "text": "<p>While cold backups are highly recommended due to their simplicity and consistency, you may want to consider hot backups.  </p> <p>Hot backup procedures can minimize downtime, making them more suitable for production environments where service availability is critical. However, hot backups introduce additional complexity and risks, such as data inconsistencies, particularly in distributed systems like Cassandra and Elasticsearch.</p>"}, {"location": "thehive/operations/backup-restore/overview/#considerations-for-hot-backups", "title": "Considerations for hot backups", "text": "<ul> <li>Data Consistency: Ensure that the backup process handles the synchronization of data across services like Cassandra and Elasticsearch. Use tools such as <code>nodetool snapshot</code> for Cassandra and Elasticsearch APIs for snapshots.  </li> <li>Service-Specific Tools: Hot backups often require the use of specialized commands or APIs to ensure that the data state remains consistent during the process.  </li> <li>Validation: Always test your hot backup and restore process thoroughly in a non-production environment before relying on it in production.  </li> </ul> <p>Sample scripts and guidelines for hot backups are provided in this documentation. However, these are intended as a starting point and must be adapted to your infrastructure and operational requirements.</p>"}, {"location": "thehive/operations/backup-restore/backup/cloud/", "title": "Cloud backup", "text": ""}, {"location": "thehive/operations/backup-restore/backup/cloud/#cloud-backup", "title": "Cloud backup", "text": "<p>TBD</p>"}, {"location": "thehive/operations/backup-restore/backup/docker-compose/", "title": "Docker Compose", "text": ""}, {"location": "thehive/operations/backup-restore/backup/docker-compose/#backup-a-stack-run-with-docker-compose", "title": "Backup a stack run with Docker Compose", "text": "<p>Note</p> <p>This solution assumes you are following our Running with Docker guide to run your application stack.</p>"}, {"location": "thehive/operations/backup-restore/backup/docker-compose/#introduction", "title": "Introduction", "text": "<p>The backup procedure is designed to capture the state of your application stack in three simple steps:</p> <ol> <li>Stop all services to ensure data consistency and prevent any changes during the backup process.</li> <li>Copy volumes and mapped directories on the host machine, which contain your data, configurations, and logs.</li> <li>Restart the services to resume normal operations after the backup is complete.</li> </ol>"}, {"location": "thehive/operations/backup-restore/backup/docker-compose/#prerequisites", "title": "Prerequisites", "text": "<p>Before starting, ensure:</p> <ul> <li>You have sufficient storage space for the backup.</li> <li>Administrative privileges to stop and start Docker Compose services.</li> <li>Familiarity with the locations of your mapped volumes and data directories.</li> </ul> <p>This step-by-step procedure ensures a safe and consistent backup of your Docker Compose stack, enabling quick recovery in case of an issue or migration to a new environment. For more details on restoring these backups, refer to the restore procedure for Docker Compose.</p>"}, {"location": "thehive/operations/backup-restore/backup/docker-compose/#step-by-step-instructions", "title": "Step-by-step instructions", "text": ""}, {"location": "thehive/operations/backup-restore/backup/docker-compose/#stop-the-services", "title": "Stop the services", "text": "<pre><code>docker compose down \n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/docker-compose/#copy-files-in-a-backup-folder", "title": "Copy files in a backup folder", "text": "<p>For example, on the host server, create a folder on a dedicated NFS volume named <code>/opt/backups</code> and copy all files preserving their permissions</p> <pre><code>#!/bin/bash\n\n## ============================================================\n## BACKUP SCRIPT FOR THEHIVE APPLICATION STACK\n## ============================================================\n## PURPOSE:\n## This script creates a backup of TheHive application stack, \n## including its configuration, data, and logs. It is designed \n## to ensure data is preserved for restoration purposes.\n##\n## IMPORTANT:\n## - This script must be run with appropriate permissions to read all data \n##   and write to the backup folders.\n## - Ensure sufficient storage is available in the backup location to avoid \n##   partial or failed backups.\n## - Services (Elasticsearch, Cassandra, and TheHive) will be stopped during \n##   the backup process to ensure data integrity.\n##\n## DISCLAIMER:\n## - Users are strongly advised to test this script in a non-production \n##   environment to ensure it works as expected with their specific \n##   infrastructure and application stack before using it in production.\n## - The maintainers of this script are not responsible for any data loss, \n##   corruption, or issues arising from the use of this script during your \n##   backup or restore processes. Proceed at your own risk.\n##\n## USAGE:\n## 1. Update the variables at the start of the script to reflect your setup:\n##    - BACKUP_ROOT_FOLDER: Root folder where backups will be stored.\n##    - BACKUP_TO_RESTORE: Name of the backup folder to restore.\n## 2. Run the script using the following command:\n##    `bash ./scripts/backup.sh`\n##\n## ADDITIONAL RESOURCES:\n## Refer to the official documentation for detailed instructions and \n## additional information: https://docs.strangebee.com/thehive/operations/backup-restore/\n##\n## WARNING:\n## - This script stops Nginx, Elasticsearch, Cassandra, and TheHive services, \n##   performs the backup, and then restarts the services.\n## - Do not modify the rest of the script unless necessary.\n##\n## ============================================================\n## DO NOT MODIFY ANYTHING BELOW THIS LINE\n## ============================================================\n\n# Display help message\nif [[ \"$1\" == \"--help\" || \"$1\" == \"-h\" ]]\nthen\n    echo \"Usage: $0 [BACKUP_ROOT_FOLDER]\"\n    echo\n    echo \"This script performs a backup of application data, including configurations, files, and logs.\"\n    echo\n    echo \"Options:\"\n    echo \"  DOCKER_COMPOSE_PATH  Optional. Specify the path of the folder with the docker-compose.yml.\"\n    echo \"                      If not provided, you will be prompted for a folder, with a default of '.'.\"\n    echo \"  BACKUP_ROOT_FOLDER  Optional. Specify the root folder where backups will be stored.\"\n    echo \"                      If not provided, you will be prompted for a folder, with a default of './backup'.\"\n    echo\n    echo \"Examples:\"\n    echo \"  $0 /path/to/docker-compose-folder /path/to/backup  Perform backup with specified root folder.\"\n    echo \"  $0                 Prompt for docker compose folder and backup root folder.\"\n    exit 0\nfi\n\n## Checks if the first argument is provided.\n## If it is, the script uses it as the value for BACKUP_ROOT_FOLDER\n## If no argument is passed, the script prompts the user to enter a value\n## \nif [[ -z \"$1\" ]]\nthen\n    read -p \"Enter the folder path including your docker compose file [default: ./]: \" DOCKER_COMPOSE_PATH\n    DOCKER_COMPOSE_PATH=${DOCKER_COMPOSE_PATH:-\".\"}\nelse\n    DOCKER_COMPOSE_PATH=\"$1\"\nfi\n\nif [[ -e \"${DOCKER_COMPOSE_PATH}/docker-compose.yml\" ]]\nthen\n    echo \"Path to your docker compose file: ${DOCKER_COMPOSE_PATH}/docker-compose.yml\"\nelse\n    { echo \"Docker compose file not found in ${DOCKER_COMPOSE_PATH}\"; exit 1; }\nfi\n\n\nif [[ -z \"$2\" ]]\nthen\n    read -p \"Enter the backup root folder [default: ./backup]: \" BACKUP_ROOT_FOLDER\n    BACKUP_ROOT_FOLDER=${BACKUP_ROOT_FOLDER:-\"./backup\"}\nelse\n    BACKUP_ROOT_FOLDER=\"$2\"\nfi\n\n\nDATE=\"$(date +\"%Y%m%d-%H%M%z\" | sed 's/+/-/')\"\nBACKUP_FOLDER=\"${BACKUP_ROOT_FOLDER}/${DATE}\"\n\n\n## Stop services\ndocker compose -f ${DOCKER_COMPOSE_PATH}/docker-compose.yml stop\n\n## Create the backup directory\nmkdir -p \"${BACKUP_FOLDER}\"  || { echo \"Creating backup folder failed\"; exit 1; }\necho \"Created backup folder: ${BACKUP_FOLDER}\"\n\n## Define the log file and start logging\nLOG_FILE=\"${BACKUP_ROOT_FOLDER}/backup_log_${DATE}.log\"\nexec &amp;&gt; &gt;(tee -a \"$LOG_FILE\")\n\n\n\n## Prepare folders tree\nmkdir -p ${BACKUP_FOLDER}/{thehive,cassandra,elasticsearch,nginx,certificates}\necho \"Created folder structure under ${BACKUP_FOLDER}\"\n\n## Copy TheHive data\necho \"Starting TheHive backup...\"\nrsync -aW --no-compress ${DOCKER_COMPOSE_PATH}/thehive/ ${BACKUP_FOLDER}/thehive || { echo \"TheHive backup failed\"; exit 1; }\necho \"TheHive backup completed.\"\n\n## Copy Cassandra data\necho \"Starting Cassandra backup...\"\nrsync -aW --no-compress ${DOCKER_COMPOSE_PATH}/cassandra/ ${BACKUP_FOLDER}/cassandra || { echo \"Cassandra backup failed\"; exit 1; }\necho \"Cassandra backup completed.\"\n\n## Copy Elasticsearch data\necho \"Starting Elasticsearch backup...\"\nrsync -aW --no-compress ${DOCKER_COMPOSE_PATH}/elasticsearch/ ${BACKUP_FOLDER}/elasticsearch || { echo \"Elasticsearch config backup failed\"; exit 1; }\necho \"Elasticsearch backup completed.\"\n\n## Copy Nginx certificates\necho \"Starting backup of Nginx and certificates...\"\nrsync -aW --no-compress ${DOCKER_COMPOSE_PATH}/nginx/ ${BACKUP_FOLDER}/nginx || { echo \" Backup of Nginx failed\"; exit 1; }\nrsync -aW --no-compress ${DOCKER_COMPOSE_PATH}/certificates/ ${BACKUP_FOLDER}/certificates || { echo \" Backup of Nginx and certificates failed\"; exit 1; }\necho \"Backup of certificates completed.\"\n\n## Restart services\necho \"Restarting services...\"\ndocker compose up -d -f ${DOCKER_COMPOSE_PATH}/docker-compose.yml\n\n\n\necho \"Backup process completed at: $(date)\"\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/docker-compose/#validation", "title": "Validation", "text": "<p>check the backup folder and verify the data has been well copied.</p> <p>Tip</p> <ul> <li>A comprehensive backup script, including all necessary housekeeping actions, is included with our Docker Compose profiles. Refer to the appropriate documentation for detailed instructions here.</li> <li>You can also review the backup script for <code>prod1-thehive</code> directly on our GitHub repository.</li> </ul>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/", "title": "Hot backups", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#hot-backups", "title": "Hot backups", "text": "<p>Warning</p> <p>As outlined in this documentation, it is crucial that the data, index, and files must remain intact and consistent during the backup process. Any inconsistency could jeopardize the restore process. While we provide guidance on creating and restoring Cassandra snapshots, it is important to note that Elasticsearch snapshots should be taken concurrently to ensure consistency and integrity across both systems. Additionally, when using clusters, snapshots should be taken simultaneously across all nodes to maintain consistency.</p> <p>The scripts provided are examples that you must customize to fit your infrastructure and application stack. For instance, folder paths may differ depending on whether you're using physical servers or Docker Compose to run the services.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#introduction", "title": "Introduction", "text": "<p>Hot backups are an essential strategy for maintaining business continuity in environments where downtime is not acceptable. Unlike cold backups, which require stopping services to ensure consistency, hot backups allow you to capture snapshots of your data while systems remain operational. This approach is particularly suited for high-availability environments where even minimal downtime could disrupt critical operations.</p> <p>However, hot backups come with unique challenges. Ensuring the consistency of data, indices, and files during the backup process is critical to avoid issues during restoration. For TheHive, this means taking simultaneous snapshots of its database (Cassandra), indexing engine (Elasticsearch), and file storage. While the process enables uninterrupted service, it requires careful planning and execution to ensure that all components remain synchronized.</p> <p>This guide provides detailed steps to perform hot backups of TheHive\u2019s components, including Cassandra, Elasticsearch, and file storage. It also discusses the risks, prerequisites, and best practices to ensure your data is securely backed up without affecting the system\u2019s availability. Whether you're operating on physical servers, virtual machines, or containerized environments, this guide will help you implement a reliable hot backup strategy tailored to your infrastructure.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#pre-requisites", "title": "Pre-requisites", "text": "<p>Before performing a hot backup, ensure the following prerequisites are met to facilitate a smooth and reliable process:</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#general-requirements", "title": "General requirements", "text": "<p>Ensure the following tools are installed on your system:</p> <ul> <li>Cassandra Nodetool: For creating database snapshots.</li> <li>tar/bzip2: For archiving and compressing backup files.</li> <li>rsync: For transferring file storage data.</li> </ul> <p>Install any missing tools using package managers such as apt or yum:</p> <ul> <li><code>apt install bzip2</code> for DEB based OS</li> <li><code>yum install bzip2</code> for RPM based OS</li> </ul> <p> </p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#configuration-knowledge", "title": "Configuration knowledge", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#cassandra-keyspace", "title": "Cassandra Keyspace", "text": "<p>Identify the keyspace used by TheHive. This is typically defined in the application.conf file under the <code>db.janusgraph.storage.cql.keyspace</code> attribute.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#elasticsearch-repository", "title": "Elasticsearch Repository", "text": "<p>Configure a repository for Elasticsearch snapshots. Ensure the repository is accessible and writable by Elasticsearch.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#file-storage-location", "title": "File Storage Location", "text": "<p>Locate the folder or object storage (e.g., MinIO) where TheHive stores files. This will be backed up along with the database and indices. If you're using local filesystem or NFS to store your files, the location is typically defined in the application.conf file under the <code>storage.localfs.location</code> attribute.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#consistency-considerations", "title": "Consistency Considerations", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#clustered-environments", "title": "Clustered Environments", "text": "<p>For Cassandra and Elasticsearch clusters, ensure snapshots are taken simultaneously across all nodes to maintain consistency.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#data-integrity-checks", "title": "Data Integrity Checks", "text": "<p>Perform a preliminary check on the system for data corruption or inconsistencies. Address any issues before proceeding with the backup.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#testing-and-validation", "title": "Testing and Validation", "text": "<p>Test the backup process in a staging or test environment to ensure scripts and configurations work as expected.</p> <p>And periodically validate your restoration procedures using test environments to confirm the integrity of the backup data.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#why-is-backing-up-the-index-optional-and-what-are-the-consequences", "title": "Why is backing up the index optional and what are the consequences ?", "text": "<p>In TheHive\u2019s architecture, the decision to back up the Elasticsearch index is a matter of balancing operational priorities such as backup speed, storage requirements, and restoration time. Here\u2019s a breakdown of why backing up the index might be considered optional and the potential consequences of doing so.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#why-backup-the-index-might-be-skipped", "title": "Why backup the index might be skipped", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#rebuild-capability", "title": "Rebuild capability", "text": "<p>Elasticsearch indices can be rebuilt from the data stored in Cassandra. This makes it possible to restore the system without explicitly backing up the index, provided the data is intact.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#backup-size-optimization", "title": "Backup size optimization", "text": "<p>Excluding the index from the backup process reduces the total backup size. This can be particularly beneficial when dealing with large datasets or limited storage.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#consequences-of-not-backing-up-the-index", "title": "Consequences of not backing up the index", "text": "<p>If the index is not backed up, it must be rebuilt from scratch during the restoration process. This can significantly increase the time required to fully restore the system.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#recommandation", "title": "Recommandation", "text": "<p>While skipping the index backup offers operational benefits during the backup process, it increases the restoration time and may introduce additional challenges.</p> <ul> <li>If minimal restoration time is critical, back up the index alongside the database and files.</li> <li>If backup speed and storage efficiency are prioritized, skip the index backup but prepare for a longer restoration process.</li> </ul> <p>Ultimately, the decision depends on your infrastructure, operational priorities, and acceptable downtime during recovery. Ensure you have tested and validated your backup and restore processes in a controlled environment before applying them in production.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#backup-procedures", "title": "Backup procedures", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#cassandra-database", "title": "Cassandra (database)", "text": "<p>Ensure that all Cassandra data is safely stored in consistent snapshots.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#prerequisites", "title": "Prerequisites", "text": "<p>To back up or export the database from Cassandra, the following information is required:</p> <ul> <li>Cassandra admin password</li> <li>Keyspace used by TheHive (default = <code>thehive</code>). This can be checked in the <code>application.conf</code> configuration file, in the database configuration under storage, cql, and <code>keyspace</code> attribute.</li> </ul> <p>Tip</p> <p>This information can be found in TheHive configuration file - application.conf - under the <code>db.janusgraph.storage</code> attribute:</p> <pre><code>db.janusgraph {\n    storage {\n        backend: cql\n        hostname: [\"127.0.0.1\"]\n        cql {\n            cluster-name: thp\n            keyspace: thehive\n        }\n    }\n}\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#create-snapshots", "title": "Create snapshots", "text": "<p>Following actions should be performed to backup the data successfully:</p> <ol> <li>Create a snapshot</li> <li>Save the data</li> </ol> <p>The steps described below for data backup should be executed on each node. Each node's data should be backed up to ensure consistency in the backups.</p> <p>Considering that ${BACKUP} is the name of the snapshot, run the following commands:</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#1-use-the-nodetool-snapshot-command-to-create-a-snapshot-of-all-keyspaces", "title": "1 - Use the <code>nodetool snapshot</code> command to create a snapshot of all keyspaces", "text": "<pre><code>nodetool snapshot -t ${BACKUP}\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#2-create-and-archive-with-the-snapshot-data-execute-the-following-command-for-every-cassandra-keyspace", "title": "2 - Create and archive with the snapshot data: Execute the following command For every cassandra keyspace", "text": "<pre><code>tar cjfv ${KEYSPACE_NAME}.tbz -C /var/lib/cassandra/data/${KEYSPACE_NAME}/*/snapshots/${BACKUP} .\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#3-remove-old-snapshots-if-necessary", "title": "3 - Remove old snapshots (if necessary)", "text": "<pre><code>nodetool -h localhost -p 7199 clearsnapshot -t ${BACKUP}\n</code></pre> <p>Note</p> <p>We strongly recommend copying the snapshot archive files to a remote server or backup storage.</p> <p> </p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#example", "title": "Example", "text": "<p>Example of script to generate backups of TheHive keyspace</p> <pre><code>#!/bin/bash\n\n## Create a tbz archive containing the snapshot\n## This script should be executed on each node of the cluster\n\n## Complete variables before running:\nHOSTNAME=$(hostname)\nSNAPSHOT_DATE=\"$(date +%F)\"\n\nREMOTE_USER=&lt;remote_user_to_change&gt;\nREMOTE_HOST=&lt;remote_host_to_change&gt;\n\n## Perform a backup for all keyspaces (system included)\nnodetool snapshot -t ${SNAPSHOT_DATE}\n\n## Navigate to the snapshot directory\n\nfind /var/lib/cassandra/data -name snapshots\n\n# Archive snapshot files\nmkdir -p /var/lib/cassandra/archive_backup/$HOSTNAME/${SNAPSHOT_DATE}\ncd /var/lib/cassandra/archive_backup/$HOSTNAME/${SNAPSHOT_DATE}\n\nfor KEYSPACE in $(ls /var/lib/cassandra/data); do\nmkdir $KEYSPACE\ncd $KEYSPACE\nfor TABLE in $(ls /var/lib/cassandra/data/${KEYSPACE}); do\n    tar cjfv ${TABLE}.tbz -C /var/lib/cassandra/data/${KEYSPACE}/${TABLE}/snapshots/${SNAPSHOT_DATE} .\ndone\ncd ..\ndone\n\nnodetool -h localhost -p 7199 clearsnapshot -t ${SNAPSHOT_DATE}\n\n# Copy the snapshot archive files to a remote server\n\nscp /var/lib/cassandra/archive_backup/$HOSTNAME/${SNAPSHOT_DATE}/* ${REMOTE_USER}@${REMOTE_HOST}:/remote/node-hostname_cassandra_backup_directory\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#elasticsearch-index-engine", "title": "Elasticsearch (index engine)", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#prerequisites_1", "title": "Prerequisites", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#snapshot-repository-configuration", "title": "Snapshot repository configuration", "text": "<p>Elasticsearch requires a snapshot repository to store backups. Common options include:</p> <ul> <li>Shared file systems</li> <li>AWS S3 buckets</li> <li>Azure Blob Storage</li> <li>Google Cloud Storage</li> </ul> <p>Set up the repository before taking snapshots.</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#permissions", "title": "Permissions", "text": "<p>Elasticsearch must have the appropriate permissions to write to the snapshot repository. For shared file systems:</p> <pre><code>chown -R elasticsearch:elasticsearch /path/to/backups\nchmod -R 770 /path/to/backups\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#cluster-health", "title": "Cluster health", "text": "<p>Ensure the cluster health is green before initiating the backup.</p> <pre><code>curl -X GET \"localhost:9200/_cluster/health?pretty\"\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#backup-procedure", "title": "Backup procedure", "text": ""}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#register-a-snapshot-repository", "title": "Register a Snapshot Repository", "text": "<p>Use the Elasticsearch API to register a snapshot repository. Below is an example for a file-based repository:</p> <pre><code>curl -X PUT \"http://localhost:9200/_snapshot/my_backup\" -H 'Content-Type: application/json' -d'\n{\n\"type\": \"fs\",\n\"settings\": {\n    \"location\": \"/patch/to/backups/elasticsearch\",\n    \"compress\": true\n}\n}'\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#verify-snapshot-completion", "title": "Verify Snapshot Completion", "text": "<pre><code>curl -X GET \"http://localhost:9200/_snapshot/my_backup/snapshot_1\"\n</code></pre> <p>Note</p> <p>If using a filesystem-based repository, consider archiving the snapshot files to long-term storage (e.g., cloud storage or external disks).</p>"}, {"location": "thehive/operations/backup-restore/backup/hot-backup/#backup-files", "title": "Backup files", "text": "<p>Wether you use local or distributed files system storage, copy the content of the folder/bucket. </p>"}, {"location": "thehive/operations/backup-restore/backup/physical-server/", "title": "Physical Server", "text": ""}, {"location": "thehive/operations/backup-restore/backup/physical-server/#for-physical-servers", "title": "For Physical Servers", "text": ""}, {"location": "thehive/operations/backup-restore/backup/physical-server/#introduction", "title": "Introduction", "text": "<p>Unlike virtualized or containerized environments, physical servers require direct access to the file system and services to perform backups. This procedure focuses on cold backups, where services are stopped to ensure the integrity and consistency of the data, indices, and logs.</p> <p>When performing a backup on physical servers, it\u2019s essential to:</p> <ol> <li>Stop services (e.g., Elasticsearch, Cassandra, TheHive) to avoid data corruption.</li> <li>Ensure file permissions are adequate for the backup process.</li> <li>Use tools like rsync to copy data, configuration files, and logs to a designated backup location.</li> <li>Validate the backup to ensure it can be restored without issues.</li> </ol>"}, {"location": "thehive/operations/backup-restore/backup/physical-server/#prerequisites", "title": "Prerequisites", "text": "<p>This guide assumes you have direct access to the server via SSH or other administrative tools and sufficient disk space to store backups. By following this procedure, you can create a consistent backup that can be securely archived or transferred for disaster recovery purposes.</p> <p>This process and example below assume you have followed our installation guide to install the application stack.</p> <p>Note</p> <p>Before proceeding, ensure you have read the general Backup and Restore Overview to understand the core principles of backup strategies.</p>"}, {"location": "thehive/operations/backup-restore/backup/physical-server/#step-by-step-instructions", "title": "Step-by-step instructions", "text": ""}, {"location": "thehive/operations/backup-restore/backup/physical-server/#stop-the-services-in-this-order", "title": "Stop the services in this order", "text": "<ol> <li>TheHive</li> <li>Elasticsearch</li> <li>Cassandra</li> </ol> <pre><code>systemctl stop thehive\nsystemctl stop elasticsearch\nsystemctl stop cassandra\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/physical-server/#copy-files-in-a-backup-folder", "title": "Copy files in a backup folder", "text": "<p>For example, create a folder on a dedicated NFS volume named <code>/opt/backups</code> and copy all files preserving their permissions</p> <pre><code>#!/bin/bash\n\n## ============================================================\n## BACKUP SCRIPT FOR THEHIVE APPLICATION STACK\n## ============================================================\n## PURPOSE:\n## This script creates a backup of TheHive application stack, \n## including its configuration, data, and logs. It is designed \n## to ensure data is preserved for restoration purposes.\n##\n## IMPORTANT:\n## - This script must be run with appropriate permissions to read all data \n##   and write to the backup folders.\n## - Ensure sufficient storage is available in the backup location to avoid \n##   partial or failed backups.\n## - Services (Elasticsearch, Cassandra, and TheHive) will be stopped during \n##   the backup process to ensure data integrity.\n##\n## DISCLAIMER:\n## - Users are strongly advised to test this script in a non-production \n##   environment to ensure it works as expected with their specific \n##   infrastructure and application stack before using it in production.\n## - The maintainers of this script are not responsible for any data loss, \n##   corruption, or issues arising from the use of this script during your \n##   backup or restore processes. Proceed at your own risk.\n##\n## USAGE:\n## 1. Update the variables at the start of the script to reflect your setup:\n##    - BACKUP_ROOT_FOLDER: Root folder where backups will be stored.\n## 2. Run the script using the following command:\n##    `bash ./scripts/backup.sh`\n##\n## ADDITIONAL RESOURCES:\n## Refer to the official documentation for detailed instructions and \n## additional information: https://docs.strangebee.com/thehive/operations/backup-restore/backup/physical-server/\n##\n## WARNING:\n## - This script stops Elasticsearch, Cassandra, and TheHive services, \n##   performs the backup, and then restarts the services.\n## - Do not modify the rest of the script unless necessary.\n##\n## ============================================================\n## DO NOT MODIFY ANYTHING BELOW THIS LINE\n## ============================================================\n##\n# Display help message\nif [[ \"$1\" == \"--help\" || \"$1\" == \"-h\" ]]\nthen\n    echo \"Usage: $0 [BACKUP_ROOT_FOLDER]\"\n    echo\n    echo \"This script performs a backup of application data, including configurations, files, and logs.\"\n    echo\n    echo \"Options:\"\n    echo \"  DOCKER_COMPOSE_PATH  Optional. Specify the path of the folder with the docker-compose.yml.\"\n    echo \"                      If not provided, you will be prompted for a folder, with a default of '.'.\"\n    echo \"  BACKUP_ROOT_FOLDER  Optional. Specify the root folder where backups will be stored.\"\n    echo \"                      If not provided, you will be prompted for a folder, with a default of './backup'.\"\n    echo\n    echo \"Examples:\"\n    echo \"  $0 /path/to/docker-compose-folder /path/to/backup  Perform backup with specified root folder.\"\n    echo \"  $0                 Prompt for docker compose folder and backup root folder.\"\n    exit 0\nfi\n\n## Checks if the first argument is provided.\n## If it is, the script uses it as the value for BACKUP_ROOT_FOLDER\n## If no argument is passed, the script prompts the user to enter a value\n## \nif [[ -z \"$1\" ]]\nthen\n    read -p \"Enter the folder path including your docker compose file [default: ./]: \" DOCKER_COMPOSE_PATH\n    DOCKER_COMPOSE_PATH=${DOCKER_COMPOSE_PATH:-\".\"}\nelse\n    DOCKER_COMPOSE_PATH=\"$1\"\nfi\n\nif [[ -e \"${DOCKER_COMPOSE_PATH}/docker-compose.yml\" ]]\nthen\n    echo \"Path to your docker compose file: ${DOCKER_COMPOSE_PATH}/docker-compose.yml\"\nelse\n    { echo \"Docker compose file not found in ${DOCKER_COMPOSE_PATH}\"; exit 1; }\nfi\n\n\nif [[ -z \"$2\" ]]\nthen\nread -p \"Enter the backup root folder [default: ./backup]: \" BACKUP_ROOT_FOLDER\n    BACKUP_ROOT_FOLDER=${BACKUP_ROOT_FOLDER:-\"./backup\"}\nelse\n    BACKUP_ROOT_FOLDER=\"$2\"\nfi\n\n\nDATE=\"$(date +\"%Y%m%d-%H%M%z\" | sed 's/+/-/')\"\nBACKUP_FOLDER=\"${BACKUP_ROOT_FOLDER}/${DATE}\"\n\n# Define the log file and start logging\nLOG_FILE=\"${BACKUP_ROOT_FOLDER}/backup_log_${DATE}.log\"\nexec &amp;&gt; &gt;(tee -a \"$LOG_FILE\")\n\n## Create the backup directory\nmkdir -p \"${BACKUP_FOLDER}\"  || { echo \"Creating backup folder failed\"; exit 1; }\necho \"Created backup folder: ${BACKUP_FOLDER}\"\n\n## Prepare folders tree\nmkdir -p ${BACKUP_FOLDER}/{thehive,cassandra,elasticsearch}/{config,data,logs}\necho \"Created folder structure under ${BACKUP_FOLDER}\"\n\n# Copy TheHive data\necho \"Starting TheHive backup...\"\nrsync -aW --no-compress /etc/thehive/ ${BACKUP_FOLDER}/thehive/config || { echo \"TheHive config backup failed\"; exit 1; }\nrsync -aW --no-compress /opt/thp/thehive/files/ ${BACKUP_FOLDER}/thehive/data || { echo \"TheHive data backup failed\"; exit 1; }\nrsync -aW --no-compress /var/log/thehive/ ${BACKUP_FOLDER}/thehive/logs || { echo \"TheHive logs backup failed\"; exit 1; }\necho \"TheHive backup completed.\"\n\n# Copy Casssandra data\necho \"Starting Cassandra backup...\"\nrsync -aW --no-compress /etc/cassandra/ ${BACKUP_FOLDER}/cassandra/config || { echo \"Cassandra config backup failed\"; exit 1; }\nrsync -aW --no-compress /var/lib/cassandra/ ${BACKUP_FOLDER}/cassandra/data || { echo \"Cassandra data backup failed\"; exit 1; }\nrsync -aW --no-compress /var/log/cassandra/ ${BACKUP_FOLDER}/cassandra/logs || { echo \"Cassandra logs backup failed\"; exit 1; }\necho \"Cassandra backup completed.\"\n\n# Copy Elasticsearch data\necho \"Starting Elasticsearch backup...\"\nrsync -aW --no-compress /etc/elasticsearch/ ${BACKUP_FOLDER}/elasticsearch/config || { echo \"Elasticsearch config backup failed\"; exit 1; }\nrsync -aW --no-compress /var/lib/elasticsearch/ ${BACKUP_FOLDER}/elasticsearch/data || { echo \"Elasticsearch data backup failed\"; exit 1; }\nrsync -aW --no-compress /var/log/elasticsearch/ ${BACKUP_FOLDER}/elasticsearch/logs || { echo \"Elasticsearch logs backup failed\"; exit 1; }\necho \"Elasticsearch backup completed.\"\n\necho \"Backup process completed at: $(date)\"\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/physical-server/#start-services-in-this-order", "title": "Start services in this order", "text": "<ol> <li>Elasticsearch</li> <li>Cassandra</li> <li>TheHive</li> </ol> <pre><code>systemctl start thehive\nsystemctl start elasticsearch\nsystemctl start cassandra\n</code></pre>"}, {"location": "thehive/operations/backup-restore/backup/physical-server/#validation", "title": "Validation", "text": "<p>check the backup folder and verify the data has been well copied.</p>"}, {"location": "thehive/operations/backup-restore/backup/virtual-server/", "title": "Virtual Server", "text": ""}, {"location": "thehive/operations/backup-restore/backup/virtual-server/#backup-virtual-server", "title": "Backup Virtual server", "text": "<p>Note</p> <p>This process and example below assume you have followed our installation guide to install the application stack.</p> <p>Using virtual servers allow more solutions to perform backup and restore operations.</p>"}, {"location": "thehive/operations/backup-restore/backup/virtual-server/#first-solution-backup-data-folders", "title": "First solution: Backup data folders", "text": "<p>Similar to using a physical server, use scripts to back up the configuration, data, and logs from each application in your stack, storing them in a folder that can be archived elsewhere. Refer to the cold backup guides for detailed instructions.</p>"}, {"location": "thehive/operations/backup-restore/backup/virtual-server/#second-solution-leverage-the-capabilities-of-the-hypervisor", "title": "Second solution: Leverage the capabilities of the hypervisor", "text": "<p>Hypervisors often come with the capacity to create a snapshot volumes and entire virtual machine. We recommend creating snapshots of volumes containing data and files after stopping TheHive, Cassandra and Elasticsearch applications. </p> <p>For the restore process, begin by restoring the snapshots created with the hypervisor. This allows you to quickly revert to a previous state, ensuring that both the system configuration and application data are restored to their exact state at the time of the snapshot. Be sure to follow any additional procedures specific to your hypervisor to ensure the snapshots are properly applied and that the system operates as expected after the restore.</p>"}, {"location": "thehive/operations/backup-restore/restore/cloud/", "title": "Cloud Infrastructure", "text": ""}, {"location": "thehive/operations/backup-restore/restore/cloud/#restore-cloud", "title": "Restore Cloud", "text": "<p>TBD</p>"}, {"location": "thehive/operations/backup-restore/restore/docker-compose/", "title": "Docker Compose", "text": ""}, {"location": "thehive/operations/backup-restore/restore/docker-compose/#restore-a-stack-run-with-docker-compose", "title": "Restore a stack run with Docker Compose", "text": "<p>Note</p> <p>This process assumes you are using one of our Docker Compose profiles, and you have already created backup using the previously outlined backup procedure.</p> <p>Restore data that has been saved following the previous backup process.</p>"}, {"location": "thehive/operations/backup-restore/restore/docker-compose/#ensure-all-services-are-stopped", "title": "Ensure all services are stopped", "text": "<pre><code>docker compose down\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/docker-compose/#ensure-all-data-folder-are-empty-before-running-the-restore-process", "title": "Ensure all data folder are empty before running the restore process", "text": "<p>A backup is highly recommended before running a restore operation; this ensures you can revert to the current state if anything goes wrong.</p> <p>Ensure that the target data folders are empty before running this script. Indeed, pre-existing files can cause conflicts or data corruption during the restore process.</p>"}, {"location": "thehive/operations/backup-restore/restore/docker-compose/#choose-the-archive-to-restore-from-the-backup-folder", "title": "Choose the archive to restore from the backup folder", "text": "<pre><code>#!/bin/bash\n\n## ============================================================\n## RESTORE SCRIPT FOR THEHIVE APPLICATION STACK\n## ============================================================\n## PURPOSE:\n## This script restores a backup of TheHive application stack, \n## including its configuration, data, and logs. It is designed to \n## recover from backups created using the associated backup script.\n##\n## IMPORTANT:\n## - A backup is highly recommended before running a restore operation. \n##   This ensures you can revert to the current state if anything goes wrong.\n## - Ensure that the target data folders are empty before running this script. \n##   Pre-existing files can cause conflicts or data corruption during the restore process.\n## - This script must be run with sufficient permissions to overwrite \n##   application data and modify service configurations.\n## - Ensure the backup folder path is correct and contains all required \n##   files and data.\n##\n## DISCLAIMER:\n## - Users are strongly advised to test this script in a non-production \n##   environment to ensure it works as expected with their specific \n##   infrastructure and application stack before using it in production.\n## - The maintainers of this script are not responsible for any data loss, \n##   corruption, or issues arising from the use of this script during your \n##   backup or restore processes. Proceed at your own risk.\n##\n## USAGE:\n## 1. Update the variables at the start of the script to reflect your setup:\n##    - BACKUP_ROOT_FOLDER: Path to the root directory of your backups.\n##    - BACKUP_TO_RESTORE: Name of the backup folder to restore.\n## 2. Run the script using the following command:\n##    `bash ./scripts/restore.sh`\n##\n## ADDITIONAL RESOURCES:\n## Refer to the official documentation for detailed instructions and \n## additional information: https://docs.strangebee.com/thehive/operations/backup-restore/\n##\n## WARNING:\n## - This script ensure Nginx, Elasticsearch, Cassandra, and TheHive services are stopped before performing the restore, and then restarts the services.\n## - This script will overwrite existing data. Use it with caution.\n## - Do not modify the rest of the script unless necessary.\n##\n## ============================================================\n## DO NOT MODIFY ANYTHING BELOW THIS LINE\n## ============================================================\n# Display help message\nif [[ \"$1\" == \"--help\" || \"$1\" == \"-h\" ]]\nthen\n  echo \"Usage: $0 [DOCKER_COMPOSE_PATH] [BACKUP_FOLDER]\"\n  echo\n  echo \"This script restores a backup of application data, including configurations, files, and logs.\"\n  echo\n  echo \"Options:\"\n  echo \"  DOCKER_COMPOSE_PATH  Optional. Specify the path of the folder with the docker-compose.yml.\"\n  echo \"                      If not provided, you will be prompted for a folder, with a default of '.'.\"\n  echo \"  BACKUP_FOLDER  Optional. Specify the folder containing the data to restore.\"\n  echo \"                      If not provided, you will be prompted for a folder or exit; no default folder is used.\"\n  echo\n  echo \"Examples:\"\n  echo \"  $0 /path/to/docker-compose-folder /path/to/backup-folder  restores backup stored in the specified folder.\"\n  echo \"  $0                 Prompt for docker compose folder and backup folder to restore.\"\n  exit 0\nfi\n\n## Checks if the first argument is provided.\n## If it is, the script uses it as the value for BACKUP_ROOT_FOLDER\n## If no argument is passed, the script prompts the user to enter a value\n## \nif [[ -z \"$1\" ]]\nthen\n  read -p \"Enter the folder path including your docker compose file [default: ./]: \" DOCKER_COMPOSE_PATH\n  DOCKER_COMPOSE_PATH=${DOCKER_COMPOSE_PATH:-\".\"}\nelse\n  DOCKER_COMPOSE_PATH=\"$1\"\nfi\n\nif [[ -e \"${DOCKER_COMPOSE_PATH}/docker-compose.yml\" ]]\nthen\n  echo \"Path to your docker compose file: ${DOCKER_COMPOSE_PATH}/docker-compose.yml\"\nelse\n  { echo \"Docker compose file not found in ${DOCKER_COMPOSE_PATH}\"; exit 1; }\nfi\n\n\nif [[ -z \"$2\" ]]\nthen\n  read -p \"Enter the backup root folder [default: None]: \" BACKUP_FOLDER\n  [[ -z \"${BACKUP_FOLDER}\" ]] &amp;&amp; echo \"No backup folder specified, exiting.\" &amp;&amp; exit 1\nelse\n  BACKUP_FOLDER=\"$2\"\nfi\n\n## Check if the backup folder to restore exists, else exit\n[[ -d ${BACKUP_FOLDER} ]] || { echo \"Backup folder not found, exiting\"; exit 1; }\n\n\n# Define the log file and start logging. Log file is stored in the current folder\nDATE=\"$(date +\"%Y%m%d-%H%M%z\" | sed 's/+/-/')\"\nLOG_FILE=\"./restore_log_${DATE}.log\"\nexec &amp;&gt; &gt;(tee -a \"$LOG_FILE\")\n\n# Log the start time\necho \"Restoration process started at: $(date)\"\n\n## Exit if docker compose is running\ndocker compose ps | grep -q \"Up\" &amp;&amp; { echo \"Docker Compose services are running. Exiting. Stop services and remove data before retoring data\"; exit 1; }\n\n\n# Copy TheHive data\necho \"Restoring TheHive data and configuration...\"\nrsync -aW --no-compress ${BACKUP_FOLDER}/thehive/ ${DOCKER_COMPOSE_PATH}/thehive || { echo \"TheHive config restore failed\"; exit 1; }\n\n# Copy Casssandra data\necho \"Restoring Cassandra data ...\"\nrsync -aW --no-compress ${BACKUP_FOLDER}/cassandra/ ${DOCKER_COMPOSE_PATH}/cassandra || { echo \"Cassandra data restore failed\"; exit 1; }\n\n\n# Copy Elasticsearch data\necho \"Restoring Elasticsearch data ...\"\nrsync -aW --no-compress ${BACKUP_FOLDER}/elasticsearch/ ${DOCKER_COMPOSE_PATH}/elasticsearch || { echo \"Elasticsearch data restore failed\"; exit 1; }\n\n\n# Copy Nginx certificates\necho \"Restoring Nginx data and configuration...\"\nrsync -a ${BACKUP_FOLDER}/nginx/ ${DOCKER_COMPOSE_PATH}/nginx  ||\n { echo \" Nginx configuration and certificates restore failed\"; exit 1; } \nrsync -a ${BACKUP_FOLDER}/certificates/ ${DOCKER_COMPOSE_PATH}/certificates  ||\n { echo \" certificates restore failed\"; exit 1; } \n\n## Restart services\necho \"Restarting services...\"\ndocker compose up -d -f ${DOCKER_COMPOSE_PATH}/docker-compose.yml\n\necho \"Restoration process completed at: $(date)\"\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/docker-compose/#restart-all-services", "title": "Restart all services", "text": "<p>The script above restarts all services with the command line <code>docker compose up -d -f ${DOCKER_COMPOSE_PATH}/docker-compose.yml</code>. </p>"}, {"location": "thehive/operations/backup-restore/restore/physical-server/", "title": "Physical Server", "text": ""}, {"location": "thehive/operations/backup-restore/restore/physical-server/#restore-physical-server", "title": "Restore physical server", "text": ""}, {"location": "thehive/operations/backup-restore/restore/physical-server/#introduction", "title": "Introduction", "text": "<p>Restoring your application stack on physical servers is a process that involves recovering configuration files, data, and logs from a previously created backup. This procedure ensures the application is returned to a consistent and operational state.</p> <p>Unlike virtual or containerized environments, restoring on physical servers requires manual handling of files and services. This guide assumes that:</p> <ul> <li>You are restoring from a cold backup, where services were stopped during the backup process to maintain data consistency.</li> <li>The server environment matches the original configuration (e.g., paths, software versions, and dependencies).</li> <li>The backup was created following the Backup Procedure for Physical Servers.</li> </ul> <p>When performing a restore, you will:</p> <ol> <li>Ensure all services are stopped (Elasticsearch, Cassandra, TheHive, etc.) before running the restoration process.</li> <li>Restore the configuration, data, and log files from the backup.</li> <li>Restart services and verify that the system is functioning as expected.</li> </ol> <p>Warning</p> <ul> <li>Always test the restoration process in a non-production or test environment before applying it to a live system.</li> <li>Ensure you have a current backup before starting the restore operation, as any errors during restoration could lead to data loss.</li> <li>This guide provides general instructions; adapt them to your specific server configuration.</li> </ul>"}, {"location": "thehive/operations/backup-restore/restore/physical-server/#step-by-step-instructions", "title": "Step-by-step instructions", "text": ""}, {"location": "thehive/operations/backup-restore/restore/physical-server/#ensure-all-services-are-stopped", "title": "Ensure all services are stopped", "text": "<pre><code>systemctl stop thehive\nsystemctl stop elasticsearch\nsystemctl stop cassandra\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/physical-server/#check-all-data-folders-are-empty", "title": "Check all data folders are empty", "text": "<p>Ensure <code>/var/lib/cassandra/</code> and <code>/var/lib/elasticsearch/</code> are empty.</p>"}, {"location": "thehive/operations/backup-restore/restore/physical-server/#copy-files-from-the-backup-folder", "title": "Copy files from the backup folder", "text": "<p>For example, with a dedicated NFS volume and a folder named <code>/opt/backup</code>  copy all files preserving their permissions</p> <pre><code>#!/bin/bash\n\n## ============================================================\n## RESTORE SCRIPT FOR THEHIVE APPLICATION STACK\n## ============================================================\n## PURPOSE:\n## This script restores a backup of TheHive application stack, \n## including its configuration, data, and logs. It is designed to \n## recover from backups created using the associated backup script.\n##\n## IMPORTANT:\n## - A backup is highly recommended before running a restore operation. \n##   This ensures you can revert to the current state if anything goes wrong.\n## - Ensure that the target data folders are empty before running this script. \n##   Pre-existing files can cause conflicts or data corruption during the restore process.\n## - This script must be run with sufficient permissions to overwrite \n##   application data and modify service configurations.\n## - Ensure the backup folder path is correct and contains all required \n##   files and data.\n##\n## DISCLAIMER:\n## - Users are strongly advised to test this script in a non-production \n##   environment to ensure it works as expected with their specific \n##   infrastructure and application stack before using it in production.\n## - The maintainers of this script are not responsible for any data loss, \n##   corruption, or issues arising from the use of this script during your \n##   backup or restore processes. Proceed at your own risk.\n##\n## USAGE:\n## 1. Update the variables at the start of the script to reflect your setup:\n##    - BACKUP_ROOT_FOLDER: Path to the root directory of your backups.\n##    - BACKUP_TO_RESTORE: Name of the backup folder to restore.\n## 2. Run the script using the following command:\n##    `bash ./scripts/restore.sh`\n##\n## ADDITIONAL RESOURCES:\n## Refer to the official documentation for detailed instructions and \n## additional information: https://docs.strangebee.com/thehive/operations/backup-restore/\n##\n## WARNING:\n## - This script ensure Nginx, Elasticsearch, Cassandra, and TheHive services are stopped before performing the restore, and then restarts the services.\n## - This script will overwrite existing data. Use it with caution.\n## - Do not modify the rest of the script unless necessary.\n##\n## ============================================================\n## DO NOT MODIFY ANYTHING BELOW THIS LINE\n## ============================================================\n# Display help message\nif [[ \"$1\" == \"--help\" || \"$1\" == \"-h\" ]]\nthen\n    echo \"Usage: $0 [DOCKER_COMPOSE_PATH] [BACKUP_FOLDER]\"\n    echo\n    echo \"This script restores a backup of application data, including configurations, files, and logs.\"\n    echo\n    echo \"Options:\"\n    echo \"  DOCKER_COMPOSE_PATH  Optional. Specify the path of the folder with the docker-compose.yml.\"\n    echo \"                      If not provided, you will be prompted for a folder, with a default of '.'.\"\n    echo \"  BACKUP_FOLDER  Optional. Specify the folder containing the data to restore.\"\n    echo \"                      If not provided, you will be prompted for a folder or exit; no default folder is used.\"\n    echo\n    echo \"Examples:\"\n    echo \"  $0 /path/to/docker-compose-folder /path/to/backup-folder  restores backup stored in the specified folder.\"\n    echo \"  $0                 Prompt for docker compose folder and backup folder to restore.\"\n    exit 0\nfi\n\n## Checks if the first argument is provided.\n## If it is, the script uses it as the value for BACKUP_ROOT_FOLDER\n## If no argument is passed, the script prompts the user to enter a value\n## \nif [[ -z \"$1\" ]]\nthen\n    read -p \"Enter the folder path including your docker compose file [default: ./]: \" DOCKER_COMPOSE_PATH\n    DOCKER_COMPOSE_PATH=${DOCKER_COMPOSE_PATH:-\".\"}\nelse\n    DOCKER_COMPOSE_PATH=\"$1\"\nfi\n\nif [[ -e \"${DOCKER_COMPOSE_PATH}/docker-compose.yml\" ]]\nthen\n    echo \"Path to your docker compose file: ${DOCKER_COMPOSE_PATH}/docker-compose.yml\"\nelse\n    { echo \"Docker compose file not found in ${DOCKER_COMPOSE_PATH}\"; exit 1; }\nfi\n\n\nif [[ -z \"$2\" ]]\nthen\n    read -p \"Enter the backup root folder [default: None]: \" BACKUP_FOLDER\n    [[ -z \"${BACKUP_FOLDER}\" ]] &amp;&amp; echo \"No backup folder specified, exiting.\" &amp;&amp; exit 1\nelse\n    BACKUP_FOLDER=\"$2\"\nfi\n\n## Check if the backup folder to restore exists, else exit\n[[ -d ${BACKUP_FOLDER} ]] || { echo \"Backup folder not found, exiting\"; exit 1; }\n\n\n# Define the log file and start logging. Log file is stored in the current folder\nDATE=\"$(date +\"%Y%m%d-%H%M%z\" | sed 's/+/-/')\"\nLOG_FILE=\"${BACKUP_ROOT_FOLDER}/restore_log_${DATE}.log\"\nexec &amp;&gt; &gt;(tee -a \"$LOG_FILE\")\n\n# Log the start time\necho \"Restoration process started at: $(date)\"\n\n# Check backup backup folder exists\n[[ -d ${BACKUP_FOLDER} ]] || { echo \"Backup folder not found\"; exit 1; }\n\n\n# Copy TheHive data\nrsync -aW --no-compress ${BACKUP_FOLDER}/thehive/config/ /etc/thehive  || { echo \"TheHive config restore failed\"; exit 1; }\nrsync -aW --no-compress ${BACKUP_FOLDER}/thehive/data/ /opt/thp/thehive/files || { echo \"TheHive data restore failed\"; exit 1; }\nrsync -aW --no-compress ${BACKUP_FOLDER}/thehive/logs/ /var/log/thehive || { echo \"TheHive logs restore failed\"; exit 1; }\n\n# Copy Casssandra data\nrsync -aW --no-compress ${BACKUP_FOLDER}/cassandra/config/ /etc/cassandra || { echo \"Cassandra config restore failed\"; exit 1; }\nrsync -aW --no-compress ${BACKUP_FOLDER}/cassandra/data/ /var/lib/cassandra || { echo \"Cassandra data restore failed\"; exit 1; }\nrsync -aW --no-compress ${BACKUP_FOLDER}/cassandra/logs/ /var/log/cassandra || { echo \"Cassandra logs restore failed\"; exit 1; }\n\n# Copy Elasticsearch data\nrsync -aW --no-compress ${BACKUP_FOLDER}/elasticsearch/config/ /etc/elasticsearch || { echo \"Elasticsearch config restore failed\"; exit 1; }\nrsync -aW --no-compress ${BACKUP_FOLDER}/elasticsearch/data/ /var/lib/elasticsearch || { echo \"Elasticsearch data restore failed\"; exit 1; }\nrsync -aW --no-compress ${BACKUP_FOLDER}/elasticsearch/logs/ /var/log/elasticsearch || { echo \"Elasticsearch logs restore failed\"; exit 1; }\n\necho \"Restoration process completed at: $(date)\" \n</code></pre> <p>Ensure permissions are correctly setup before running services. </p>"}, {"location": "thehive/operations/backup-restore/restore/physical-server/#start-services-in-this-order", "title": "Start services in this order", "text": "<ol> <li>Elasticsearch</li> <li>Cassandra</li> <li>TheHive</li> </ol> <pre><code>systemctl start thehive\nsystemctl start elasticsearch\nsystemctl start cassandra\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/physical-server/#validation", "title": "Validation", "text": "<p>Open you browser, connect to TheHive, and check your data has been restored correctly. </p>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/", "title": "Restore hot backups", "text": ""}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#restore-data", "title": "Restore data", "text": ""}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#cassandra", "title": "Cassandra", "text": ""}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#pre-requisites", "title": "Pre requisites", "text": "<p>Following data is required to restore TheHive database successfully: </p> <ul> <li>A backup of the database (<code>${SNAPSHOT}_${SNAPSHOT_DATE}.tbz</code>)</li> <li>Keyspace to restore does not exist in the database (or it will be overwritten)</li> <li>All nodes in the cluster should be up before starting the restore procedure.</li> <li>TheHive application should NOT be running.</li> </ul> <p> </p>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#restore-your-data", "title": "Restore your data", "text": ""}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#start-by-drop-the-database-thehive", "title": "Start by drop the database <code>TheHive</code>", "text": "<pre><code>## SOURCE_KEYSPACE contains the name of theHive database\nCASSANDRA_PASSWORD=&lt;your_admin_password&gt;\nCASSANDRA_ADDRESS=&lt;cassandra_node_ip&gt;\nSOURCE_KEYSPACE=thehive\ncqlsh -u admin -p ${CASSANDRA_PASSWORD} ${CASSANDRA_ADDRESS} -e \"DROP KEYSPACE IF EXISTS ${SOURCE_KEYSPACE};\"\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#create-the-keyspace", "title": "Create the keyspace", "text": "<pre><code>## TARGET_KEYSPACE contains the new name of theHive database \n## NOTE that you can keep the same database name since the old one has been deleted\ncqlsh -u admin -p ${CASSANDRA_PASSWORD} ${CASSANDRA_ADDRESS} -e \"\n    CREATE KEYSPACE ${TARGET_KEYSPACE}\n    WITH replication = {'class': 'NetworkTopologyStrategy', 'replication_factor': '3'}\n    AND durable_writes = true;\"\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#unarchive-backup-files", "title": "Unarchive backup files", "text": "<p>Note</p> <p>Note that the following steps should be executed for every Cassandra cluster node.</p> <pre><code>mkdir -p /var/lib/cassandra/restore\nRESTORE_PATH=\"/var/lib/cassandra/restore\"\nSOURCE_KEYSPACE=\"thehive\"\nSNAPSHOT_DATE=&lt;date_of_backup&gt;\n## TABLES should contain the list of all tables that will be restored\n## table_name should include the uuid generated by cassandra, for example: table1-f901e0c05d8811ef87c71fc3a94044f4\n\nTABLES=\"ls -1 /var/lib/cassandra/data/${SOURCE_KEYSPACE}/\"\n## copy all of the snapshot tables that you want to restore from remote server or local cassandra node then extract it\n## repeat the following  steps on each node Cassandra for each table in the TABLES List\n\ncd /var/lib/cassandra/restore\nfor table in $TABLES; do\nscp remoteuser@remotehost:/remote/node_name_directory/${SNAPSHOT_DATE}/${SOURCE_KEYSPACE}/${table}.tbz .\nmkdir -p ${RESTORE_PATH}/${SOURCE_KEYSPACE}/${table}\necho \"Unarchive backup files for table: $table\"\ntar jxf ${table}.tbz -C ${RESTORE_PATH}/${SOURCE_KEYSPACE}/${table}\ndone\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#create-tables-from-archive", "title": "Create tables from archive", "text": "<p>The archive contains the table schemas. They must be executed in the new keyspace. The schema files are in <code>${RESTORE_PATH}/${SOURCE_KEYSPACE}/${table}</code></p> <pre><code>for CQL in $(find ${RESTORE_PATH} -name schema.cql)\ndo\ncqlsh -u admin -p ${CASSANDRA_PASSWORD} -f $CQL\ndone\n</code></pre> <p>If you want to change the name of the keyspace (<code>${SOURCE_KEYSPACE}</code> =&gt; <code>${TARGET_KEYSPACE}</code>), you need to rewrite the cql command:</p> <pre><code>for CQL in $(find ${RESTORE_PATH} -name schema.cql)\ndo\ncqlsh cassandra -e \"$(sed -e '/CREATE TABLE/s/'${SOURCE_KEYSPACE}/${TARGET_KEYSPACE}/ $CQL)\"\ndone\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#load-table-data", "title": "Load table data", "text": "<p>Note</p> <p>Note that the following command should be executed on each Cassandra node in the cluster.</p> <pre><code>for TABLE in ${RESTORE_PATH}/${TARGET_KEYSPACE}/*\ndo \nTABLE_BASENAME=$(basename ${TABLE})\nTABLE_NAME=${TABLE_BASENAME%%-*}\nnodetool import ${TARGET_KEYSPACE} ${TABLE_NAME} ${RESTORE_PATH}/${TARGET_KEYSPACE}/${TABLE_BASENAME}\ndone\n</code></pre> <p> </p> <p>If the cluster topology has changed (new nodes added ou removed from the cluster since the last data backup), please follow the run the following command to perform a restore:</p> <pre><code>for TABLE in ${RESTORE_PATH}/${TARGET_KEYSPACE}/*\ndo \nTABLE_BASENAME=$(basename ${TABLE})\nsstableloader -d ${CASSANDRA_IP} ${RESTORE_PATH}/${TARGET_KEYSPACE}/${TABLE_BASENAME}\ndone\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#cleanup", "title": "Cleanup", "text": "<pre><code>rm -rf ${RESTORE_PATH}\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#rebuid-an-existing-node", "title": "Rebuid an existing node", "text": "<p>If for a particular reason (such as corrupted system data), you need to reintegrate the node into the cluster and restore all data (including system data), here is the procedure:</p>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#make-sure-that-the-cassandra-service-is-still-down-then-delete-the-contents-of-the-data-volume", "title": "Make sure that the Cassandra service is still down then delete the contents of the data volume:", "text": "<pre><code>cd /var/lib/cassandra/data\nrm -rf *\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#copy-and-unarchive-backup-files", "title": "Copy and unarchive backup files:", "text": "<pre><code>DATA_PATH=\"/var/lib/cassandra/data\"\n\nSNAPSHOT_DATE=&lt;date_of_snaphot&gt;\n## KEYSPACES list should inlude all keyspaces\nKEYSPACES=\"system system_distributed system_traces system_virtual_schema system_auth system_schema system_views thehive\"\ncd ${DATA_PATH}\nfor ks in $KEYSPACES; do\nscp -r remoteuser@remotehost:/remote/node_name_directory/${SNAPSHOT_DATE}/${ks}/ .\nfor file in /var/lib/cassandra/data/${ks}/*; do\n    echo \"Processing $file\"\n    filename=$(basename \"$file\")\n    table_name=\"${filename%%.*}\"\n    sudo mkdir -p ${ks}/${table_name}\n    sudo tar jxf $file -C ${ks}/${table_name}\n    rm -f $file\ndone\ndone\n\nchown -R cassandra:cassandra  /var/lib/cassandra/data\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#start-cassandra-service", "title": "Start cassandra service", "text": "<pre><code>service cassandra start\n\n## heck if Cassandra has started successfully by reviewing its logs\ntail -n 100 /var/log/cassandra/system.log | grep -iE \"listening for|startup complete|error|warning\"\n\nINFO  [main] ********,773 PipelineConfigurator.java:125 - Starting listening for CQL clients on localhost/127.0.0.1:9042 (unencrypted)...\nINFO  [main] ********,790 CassandraDaemon.java:776 - Startup complete\n</code></pre> <p>Ensure no Commitlog file exist before restarting Cassandra service. (<code>/var/lib/cassandra/commitlog</code>)</p> <p>Example of script to restore TheHive keyspace in Cassandra</p> <pre><code>#!/bin/bash\n\n## Restore a KEYSPACE and its data from a CQL file with the schema of the\n## KEYSPACE and an tbz archive containing the snapshot\n\n## Complete variables before running:\n## CASSANDRA_ADDRESS: IP of cassandra server\n## RESTORE_PATH: choose a TMP folder !!! this folder will be removed if exists.\n## SOURCE_KEYSPACE: KEYSPACE used in the backup\n## TARGET_KEYSPACE: new KEYSPACE name ; use same name of SOURCE_KEYSPACE if no changes\n## TABLES: should contain the list of all tables that will be restored, table_name should include the uuid generated by cassandra, for example: table1-f901e0c05d8811ef87c71fc3a94044f4\n## SNAPSHOT: choose a name for the backup\n## SNAPSHOT_DATE: date of the snapshot to restore\n\n## IMPORTANT: Note that the following steps should be executed on each Cassandra cluster node.\n\nCASSANDRA_ADDRESS=\"10.1.1.1\"\nRESTORE_PATH=\"/var/lib/cassandra/restore\"\nSOURCE_KEYSPACE=\"thehive\"\nTARGET_KEYSPACE=\"thehive_restore\"\nTABLES=\"\ntable1-f901e0c05d8811ef87c71fc3a94044f4\ntable2-d502a0c05d8811ef87c71fc3a94044f5\ntable3-a703c0c05d8811ef87c71fc3a94044f6\n\" \nSNAPSHOT_DATE=\"2024-09-23\"\n\n## Copy from backup folder and Uncompress data in restore folder\n\ncd ${RESTORE_PATH}\nfor table in $TABLES; do\n    cp -r PATH_TO_BACKUP_DIRECTORY/${SNAPSHOT_DATE}/${SOURCE_KEYSPACE}/${table}.tbz .\n    mkdir -p ${RESTORE_PATH}/${SOURCE_KEYSPACE}/${table}\n    echo \"Unarchive backup files for table: $table\"\n    tar jxf ${table}.tbz -C ${RESTORE_PATH}/${SOURCE_KEYSPACE}/${table}\ndone\n## Read Cassandra password\necho -n \"Cassandra admin password: \" \nread -s CASSANDRA_PASSWORD\n\n# Drop the keyspace\ncqlsh -u admin -p ${CASSANDRA_PASSWORD} ${CASSANDRA_ADDRESS} -e \"DROP KEYSPACE IF EXISTS ${SOURCE_KEYSPACE};\"\n\n# Create the keyspace\n## TARGET_KEYSPACE contains the new name of theHive database \n## NOTE that you can keep the same database name since the old one has been deleted\n\ncqlsh -u admin -p ${CASSANDRA_PASSWORD} ${CASSANDRA_ADDRESS} -e \"\n    CREATE KEYSPACE ${TARGET_KEYSPACE}\n    WITH replication = {'class': 'NetworkTopologyStrategy', 'replication_factor': '3'}\n    AND durable_writes = true;\"\n\n# Create table in keyspace\nfor CQL in $(find ${RESTORE_PATH} -name schema.cql)\ndo\ncqlsh -u admin -p ${CASSANDRA_PASSWORD} ${CASSANDRA_ADDRESS} -e \"$(sed -e '/CREATE TABLE/s/'${SOURCE_KEYSPACE}/${TARGET_KEYSPACE}/ $CQL)\"\ndone\n\n\n## Load data\nfor TABLE in ${RESTORE_PATH}/${TARGET_KEYSPACE}/*\n    do \n    TABLE_BASENAME=$(basename ${TABLE})\n    TABLE_NAME=${TABLE_BASENAME%%-*}\n    nodetool import ${TARGET_KEYSPACE} ${TABLE_NAME} ${RESTORE_PATH}/${TARGET_KEYSPACE}/${TABLE_BASENAME}\ndone\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#restore-elasticsearch-index", "title": "Restore Elasticsearch index", "text": "<p>Several solutions exist regarding the index:</p> <ol> <li>Restore a saved Elasticsearch index ; follow Elasticsearch guides to perform this action</li> <li>Rebuild the index on the new server, when TheHive start for the first time.</li> </ol> <p> </p>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#restoration-steps", "title": "Restoration steps", "text": "<p>Restoring from a snapshot involves creating a new cluster or restoring the snapshot into an existing one. Here\u2019s an example to restore all indices from a snapshot. </p> <pre><code>curl -X POST \"http://localhost&gt;:9200/_snapshot/my_backup/snapshot_1/_restore\" -H 'Content-Type: application/json' -d'\n{\n\"indices\": \"*\",\n\"include_global_state\": false\n}'\n</code></pre>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#rebuild-the-index", "title": "Rebuild the index", "text": "<p>Once Cassandra database is restored, update the configuration of TheHive to rebuild the index.</p> <p>These lines should be added to the configuration file only for the first start of TheHive application, and removed later on.</p> extract from /etc/thehive/application.conf<pre><code>db.janusgraph.forceDropAndRebuildIndex = true\n</code></pre> <p>Once TheHive application is started, both lines should be removed or commented from the application.conf configuration file</p>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#restore-files", "title": "Restore Files", "text": "<p>Restore the saved files into the destination folder/bucket that will be used by TheHive. Ensure the account running TheHive application has permissions to create files and folders into the destination folder.</p>"}, {"location": "thehive/operations/backup-restore/restore/restore-hot-backup/#references", "title": "References", "text": "<ul> <li>Backing up and restoring Cassandra data: https://cassandra.apache.org/doc/stable/cassandra/operating/backups.html</li> <li>Backing up and restoring Elasticsearch data: https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshot-restore.html</li> </ul>"}, {"location": "thehive/operations/backup-restore/restore/virtual-server/", "title": "Virtual Server", "text": ""}, {"location": "thehive/operations/backup-restore/restore/virtual-server/#restore-virtual-server", "title": "Restore virtual server", "text": "<p>Note</p> <p>This process and example below assume you have followed our step-by-step guide to install the application stack.</p> <p>Using virtual servers allow more solutions to perform backup and restore operations.</p>"}, {"location": "thehive/operations/backup-restore/restore/virtual-server/#1st-solution-restore-data-folders-from-a-backup", "title": "1st solution: Restore data folders from a backup", "text": "<p>Assuming you are using our cold backup guide to backup your data, use scripts to restore the configuration, data, and logs from each application in your stack. Refer to the cold restore guide for detailed instructions.</p>"}, {"location": "thehive/operations/backup-restore/restore/virtual-server/#2nd-solution-leverage-the-capabilities-of-the-hypervisor", "title": "2nd solution: Leverage the capabilities of the hypervisor", "text": "<p>Hypervisors often come with the capacity to create a snapshot volumes and entire virtual machine. We recommend creating snapshots of volumes containing data and files after stopping TheHive, Cassandra and Elasticsearch applications. </p> <p>For the restore process, begin by restoring the snapshots created with the hypervisor. This allows you to quickly revert to a previous state, ensuring that both the system configuration and application data are restored to their exact state at the time of the snapshot. Be sure to follow any additional procedures specific to your hypervisor to ensure the snapshots are properly applied and that the system operates as expected after the restore.</p>"}, {"location": "thehive/overview/", "title": "Overview", "text": ""}, {"location": "thehive/overview/#thehive-documentation", "title": "TheHive Documentation", "text": ""}, {"location": "thehive/overview/#overview", "title": "Overview", "text": "<p>TheHive offers a comprehensive 4-in-1 Security Incident Response Platform, serving as a vital tool for Security Operations Centers (SOCs), Computer Security Incident Response Teams (CSIRTs), Computer Emergency Response Teams (CERTs), and all information security professionals involved in swift and effective handling of security incidents. It composes of a robust suite of features designed to streamline incident response workflows, enhance collaboration, and empower information security practitioners to effectively investigate and mitigate security threats. With its seamless integration with the Malware Information Sharing Platform (MISP) and advanced capabilities for task management, evidence handling, and threat intelligence integration, TheHive is an indispensable tool for modern SOC, CSIRT, and CERT teams.</p>"}, {"location": "thehive/overview/#key-features", "title": "Key features", "text": "<p>Integration with MISP:  Tightly integrated with MISP (Malware Information Sharing Platform) for seamless collaboration and information sharing.</p> <p>Real-Time Collaboration:  Multiple analysts can collaborate simultaneously with live stream updates on cases, tasks, observables, and indicators of compromise (IOCs).</p> <p>Efficient Task Management:  Special notifications enable efficient task handling and assignment, with previews and imports from various sources such as email reports, CTI providers, and SIEMs.</p> <p>Customizable Templates:  Create cases and tasks using a flexible template engine, allowing customization with metrics and custom fields to drive team activity and identify areas for automation.</p> <p>Evidence Management:  Analysts can record progress, attach evidence or files, add tags, and import password-protected ZIP archives containing suspicious data securely.</p> <p>Observables Management:  Easily add and manage observables, either individually or in bulk, with options to import directly from MISP events or alerts. Triaging and filtering capabilities streamline the process.</p> <p>Threat Intelligence Integration:  Utilize Cortex and its analyzers and responders to gain insights, accelerate investigations, and contain threats. Leverage tags, flag IOCs, and identify previously seen observables to enrich threat intelligence.</p>"}, {"location": "thehive/overview/#architecture", "title": "Architecture", "text": "<p>TheHive can be set up on either a single server or as a cluster (a group of servers) to accommodate different levels of growth requirements.  TheHive architecture is highly modular, allowing each layer (TheHive application, database &amp; indexing engine, and file storage) to be deployed independently as standalone nodes or as part of a clustered setup. This flexibility enables complex clustered architectures with virtual IP addresses and load balancers for optimal performance and scalability. </p> <p>The essential components of TheHive setup include:</p> <ul> <li> Apache Cassandra for robust data storage, with support for version 4.x.</li> <li> Elasticsearch, serving as a powerful indexing engine, with support for versions 7.x and 8.x.</li> <li> A file storage solution, which can be the local filesystem of the server hosting the application for standalone setups or, NFS or S3 MINIO for clustered environments.</li> </ul> <p></p> <p>Using Lucene</p> <p>Starting from version 5.1, TheHive no longer supports the Lucene backend for indexing. Users who were previously utilizing Lucene with TheHive 4.1.x are advised to migrate their index to Elasticsearch using this comprehensive guide.</p> Standalone ServerCluster or Hybrid Architecture <p></p> <p>A standalone server setup involves installing all necessary components on a single server:</p> <ul> <li>Cassandra</li> <li>Elasticsearch</li> <li>File storage on the local filesystem (or MinIO if desired)</li> <li>TheHive</li> <li>Optional NGINX for managing HTTPS communications</li> </ul> <p>For detailed installation instructions, refer to the installation guide.</p> <p>TheHive and its associated applications offer flexibility in choosing the right setup based on specific requirements. This includes the ability to mix and match different nodes and applications within a cluster.</p> <p></p> <p>Each layer and node within the architecture can be installed on dedicated operating systems, allowing for tailored configurations. The installation guide for a 3-node cluster provides comprehensive instructions for setting up a more complex clustered environment.</p>"}, {"location": "thehive/release-notes/release-notes-5.0/", "title": "Release Notes for Version 5.0", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#release-notes-of-50-series", "title": "Release Notes of 5.0 Series", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#5026-27th-february-2023", "title": "5.0.26 - 27th February 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix issue that prevented closing a case when a custom field was not set</li> <li>Fix indentation issue in TTP list</li> <li>Fix overflow in pages with long content</li> <li>Fix loading of multiple comments</li> <li>Allow importing observables from analyzers when running on an alert</li> <li>Improve error message when closing a case with mandatory custom field</li> <li>Fix style for custom field input</li> <li>Typo fixes</li> </ul> <p>Backend:</p> <ul> <li>Fix v1 api for page which used the former v0 style: new fields were added and some fields are now marked as deprecated and will be removed in the future</li> <li>Add caseId in analyer input: field <code>message</code> should now contain the observable's parent id (alert or case)</li> <li>Fix a message serialization error when running in cluster</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5025-2nd-february-2023", "title": "5.0.25 - 2nd February 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_1", "title": "Fixes", "text": "<p>Backend:</p> <ul> <li>Fix TLP and PAP of MISP events</li> <li>Fix download of attachment when content type is malformed</li> <li>TheHive 3 migration: Fix parsing of old format of Cortex jobs</li> <li>Fix serialisation of configuration that contains a pipe character</li> </ul> <p>UI:</p> <ul> <li>Remove the limit on the number of techniques when selecting a TTP tactic</li> </ul> <p>Docker:</p> <ul> <li>Add parameter for Elasticsearch authentication</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5024-9th-january-2023", "title": "5.0.24 - 9th January 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_2", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix issue in slack notifier form</li> <li>Fix colored tags in several parts of the UI: tags should now be more colorful</li> </ul> <p>Backend:</p> <ul> <li>When changing a tag name, the name is also changed in the cases and alerts</li> <li>When an alert or case changes of stage, the stage is added to the audit details</li> <li>Slack notifier now correctly sends the username</li> <li>Update analyzer reports</li> <li>Improve api docs</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5023-20th-december-2022", "title": "5.0.23 - 20th December 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_3", "title": "Fixes", "text": "<ul> <li>Downgrade logback library to version 1.3.5 which still supports Java 8</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5022-19th-december-2022", "title": "5.0.22 - 19th December 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_4", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix: \"Add share\" window is empty when no target org</li> <li>Search: Observables search result direct link not working</li> <li>Search: results for Task Logs do not show a link to the case</li> <li>Markdown table issue with vertical bar: add support for <code>&amp;vert;</code> in cell tables</li> <li>Dashboard:<ul> <li>Bar Chart with tasks by status all have same colors</li> <li>Bar chart: add an option to display or not empty values</li> </ul> </li> <li>Long alert titles cut off other UI fields</li> <li>Bad cache when listing similar alerts</li> <li>Wrong drawer title when editing a case template</li> </ul> <p>Backend:</p> <ul> <li>Update dependencies</li> <li>API Query filter _startsWith don't work on customFields</li> <li>Pages in knowledge base incorrectly display pages from cases too</li> <li>Search on absent field does not use index</li> <li>Changing auth configuration does not work for v1 routes</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements", "title": "Improvements", "text": "<ul> <li>LDAP/AD: add option to ignore the realm/domain of the login</li> <li>Cortex: Send observable attribute <code>sightedAt</code> to Cortex</li> <li>UI: in a task preview, add the possibility to edit or delete a task log</li> <li>UI: standardize disposition of TLP, PAP and SEV across forms and elements.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5021-2nd-december-2022", "title": "5.0.21 - 2nd December 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_5", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix JavaScript error</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5020-1st-december-2022", "title": "5.0.20 - 1st December 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_6", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Dashboard:<ul> <li>Fix broken export as CSV for bar chart widget</li> <li>Remove some entities (patterns) that are not useful in dashboard view</li> <li>add live feed for dashboard</li> <li>re-enable aggregation on some fields and display a warning if the query is slow</li> <li>In widgets mark mandatory fields</li> <li>Some filter queries on string field (like title) were not correctly built</li> </ul> </li> <li>Admin: be less restrictive for urls (cortex and misp)</li> <li>Case sharing:<ul> <li>Fix request timing issue when sharing a case that prevented from sharing the tasks</li> <li>Update wording when sharing a case</li> </ul> </li> <li>When a customfield has options, prevent the user from selecting an other value</li> <li>Fix issue when updating custom fields in case templates</li> <li>Fix count of similar alerts </li> <li>When creating an observable the option \"one observable per line\" is now the default</li> <li>Fix duplicated refetch when updating an entity</li> <li>Fix live feed when updating a case</li> </ul> <p>Backend:</p> <ul> <li>Oauth2 connector will read the value for its proxy from <code>application.conf</code> &gt; <code>wsConfig.proxy</code></li> <li>Create audit logs when tasks are cancelled when closing a case</li> <li>In API allow status length of 64 chars for case and alerts (was wrongly 32 chars previously)</li> <li>Fix GDPR service that did not include all the tasks, task logs and observables</li> <li>Fix permission issue where analysts could no longer generate their Api Key (regression introduced in 5.0.19)</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5019-16th-november-2022", "title": "5.0.19 - 16th November 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_7", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix urls in mardown that contain <code>&amp;</code> character</li> <li>Platform configuration: <ul> <li>Webhook version was always set to 1</li> <li>Global endpoints can now be edited</li> </ul> </li> <li>Dashboards:<ul> <li>Fix issue with dashboards using relative times (like \"last 3 months\")</li> <li>Fix crash when deleting a widget in certain conditions</li> <li>Improve conversion of TheHive 4 dashboards</li> </ul> </li> <li>Display sightedAt date when an observable is set as sighted</li> </ul> <p>Backend:</p> <ul> <li>Fix permission issue for user edition</li> <li>Fix issue when trying to repair the index with a vertex containing non indexed fields</li> <li>Refresh license quotas faster after an organization is locked</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#security-updates", "title": "Security Updates", "text": "<ul> <li>Update dependency on org.apache.commons:commons-text to 1.10.0</li> <li>Remove dependency on org.apache.ivy:ivy</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5018-27th-october-2022", "title": "5.0.18 - 27th October 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#updates", "title": "Updates", "text": "<ul> <li>Update Cortex analyzer templates</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_8", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Dashboard:<ul> <li>Fix counter widget not working with observables</li> <li>Fix entity change not updating form changes</li> <li>Fix legends in dashboard that may be truncated</li> </ul> </li> <li>Custom fields options are shown even if the field is not empty</li> <li>Fix icons in analyser reports when serving TheHive on a non root path</li> <li>Fix issue when creating a case template with an already existing name</li> <li>Fix bad autocompletion on non tag fields</li> <li>Markdown tables now respect the alignment</li> <li>Fix drawer title when editing a dashboard</li> <li>Fix rare issue where the observable counter was not refreshed when an observable was added</li> </ul> <p>API docs</p> <ul> <li>Field <code>date</code> in Alert is now corectly marked as optional</li> <li>Add api docs for observable types</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_1", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Faster load of analyzer templates when viewing an analyzer report</li> <li>Sort search results by <code>_createdAt</code> date</li> <li>Sort analyzer list</li> <li>Dashboard:<ul> <li>color can now be customized for the field status</li> </ul> </li> </ul> <p>Backend:</p> <ul> <li>Make alert merging faster</li> <li>Fix chart time interval when empty series</li> <li>Set size limit on custom field values (8191 chars)</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5017-11th-october-2022", "title": "5.0.17 - 11th October 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_9", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix the search field in alert and case merging drawer</li> <li>Add missing validation button on the UI settings when choosing a date format</li> <li> <p>Fix case export button when MISP is available</p> </li> <li> <p>Dashboard:</p> <ul> <li>Fix filters during the import of dashboards, they was ignored</li> <li>Fix text and counter widget serie filters. They was ignored in 5.0.16</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_2", "title": "Improvements", "text": "<p>Backend:</p> <ul> <li>Use index to count the number of waiting tasks</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5016-7th-october-2022", "title": "5.0.16 - 7th October 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_10", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Removed clickable description</li> <li>Fixed crash on alert merge in a new case</li> <li>Fixed rule to enable/disable button for the case export (MISP and archive capability)</li> </ul> <p>API:</p> <ul> <li>startDate in task set even if we go from Waiting to Completed</li> <li>Notify user when Cortex requires admin actions to update analyzers</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_3", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Dashboard:<ul> <li>Added time selection in custom period picker</li> <li>Improved performances of Text and Counter widgets</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5015-30th-septembre-2022", "title": "5.0.15 - 30th Septembre 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_11", "title": "Fixes", "text": "<p>API:</p> <ul> <li>Fix \"none of\" filter which could return wrong result when using in dashboards</li> <li>Fix result of dashboard based on custom fields</li> </ul> <p>UI:</p> <ul> <li>Case count now takes filters into account</li> <li>Array and title panel in markdown edition was disappearing</li> <li>Deleting a filter had a weird behavior before (going back to the previous applied state), it now only deletes the selected filter</li> <li>Border for cortex/misp logo fixed for Safari 14</li> <li>Task completion bar is now refreshed when a task status is updated</li> <li>Fixed empty page sometimes when login</li> <li>Webhook endpoint version is now editable</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_4", "title": "Improvements", "text": "<p>API:</p> <ul> <li>Add \"alertsCount\" extraData in case list</li> </ul> <p>UI:</p> <ul> <li>Dashboard duplication feature has been added</li> <li>Count and link for similar cases/alert has been added to alert preview</li> </ul> <p>Description:</p> <ul> <li>textarea for edition is now resizable</li> <li>linebreak in text renders with a newline in markdown</li> <li>we can now click on the description to edit it</li> <li>font size when editing is now monospace</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5014-19th-september-2022", "title": "5.0.14 - 19th September 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_12", "title": "Fixes", "text": "<p>API:</p> <ul> <li>Fix an issue where case template prefix was duplicated in case title</li> <li>Observables with files were not linked correctly to their attachments which impacted the merge of observables</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_5", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Notifications: display the name of the webhook</li> <li>Ability to filter users by profile when listing the users of an organization</li> <li>In search page, add link to observable parent (case or alert)</li> <li>In live stream, display full date instead of 'x seconds ago'</li> <li>Dashboard:<ul> <li>Display users name instead of login</li> <li>Make time intervals aware of user timezone and locale, so that months and weeks aggregation behave correctly</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5013-8th-september-2022", "title": "5.0.13 - 8th September 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_13", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Dashboard:<ul> <li>Remove some entities from the entity list for which dashboards were not usefull or working (like comments or actions)</li> <li>Clicking on a counter or donut now correctly sets the filters in the search page</li> <li>conversion of v4 dashboards failed with <code>not</code> operator</li> </ul> </li> <li>Improvement around time filters (custom and periods)</li> <li>Assignees from other organizations are visible and searchable in case assignment</li> <li>Fix bad date format when using am/pm</li> <li>Case sharing displayed an empty list of organization</li> <li>Quote in the markdown editor only worked for the first line</li> <li>On small screen preview button was not visible when using Firefox</li> <li>Fix bug in list of TTP tactics</li> </ul> <p>API:</p> <ul> <li>Fix issue with integrity check of Observable</li> <li>Fix issues around Case Number Actor (responsible to give a sequential number for cases)</li> <li>Avoid locks when trying to fix inconsistencies in index</li> <li>Fix an issue that could happend during schema evolution</li> <li>Fix parsing of Cortex information (analyzers without dataType)</li> <li>Notifications: Email will now be sent in the format set by the text template (html or plain text)</li> <li>Prevent user ldap synchronisation if license is incompatible</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_6", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Notify user when an update in Cortex is available</li> <li>Dashboard:<ul> <li>Default period is now 3 months instead of \"All\"</li> <li>Remove some entities from the entity list for which dashboards were not usefull or working (like comments or actions)</li> <li>An org admin can disallow the \"All\" period in the dasboards (organization settings &gt; UI Configuration)</li> <li>Widgets legends now show fully</li> </ul> </li> <li>Add an indicator on the number of open requests made by the browser</li> <li>Admin can now configure the default user domain from the admin settings</li> <li>Admin can change the type of a user (Service or Normal users)</li> <li>Improvements around the Proxy and SSL forms (used in misp, cortex or endpoints definition)</li> </ul> <p>API:</p> <ul> <li>Add the ability to log the content of query request</li> <li>Admin can now write in the knowledge base (the permission <code>manageKnowledgeBase</code> was added to the <code>admin</code> profile)</li> <li>Improve templating capabilites in notifiers:<ul> <li>Add <code>dateFormat</code> helper (<code>{{dateFormat audit._createdAt \"EEEEE dd MMMMM yyyy\" \"fr\" }}</code> =&gt; <code>jeudi 01 septembre 2022</code>)</li> <li>Helper <code>eq</code> now supports numbers: <code>{{#if (eq object.severity 2) }}MEDIUM {{else}}Other {{/if}}</code></li> <li>Add helpers <code>tlpLabel</code>, <code>papLabel</code>, <code>severityLabel</code>: <code>{{tlpLabel object.tlp}}</code> =&gt; <code>Amber</code></li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5012-16th-august-2022", "title": "5.0.12 - 16th August 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_14", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix issue where case assignee was not displayed (because user was in an other organization)</li> <li>Fix org switch not working when using http context (bug introduced in 5.0.11)</li> </ul> <p>API:</p> <ul> <li>Don't fail integrityChecks if field <code>_createdAt</code> is missing</li> <li>Sync cortex jobs with status <code>Deleted</code></li> <li>Don't fail queries if a phamtom vertex is encountered</li> </ul> <p>Migration:</p> <ul> <li>Fix issue where users could be duplicated by the migration 3-&gt;5 process</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_7", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Add field to set the expiration token duration for reset password links</li> <li>In Proxy forms, add input field to set the port of the proxy</li> </ul> <p>API:</p> <ul> <li>Alert can be created even if they contain duplicated observables of type files. Before it triggered an \"AlreadyExits\" error.</li> <li>Remove orphan cortex jobs (when observable was deleted)</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5011-5th-august-2022", "title": "5.0.11 - 5th August 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_15", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix import of .thar files</li> <li>When switching of organization, the user is redirected to her homepage.</li> <li>Filters on number types showed <code>-1</code> in the preview</li> <li>In endpoints configuration, the setting \"Do not check Certificate Authority\" was not sent correctly</li> <li>Fix filters when using between dates with an hour or minute precision</li> </ul> <p>API:</p> <ul> <li>Cases created from an alert with a case template could have duplicated custom fields</li> <li>Cases created from an alert with a case template had duplicated tasks and prefix (from 5.0.10)</li> <li>Prevent failures during migration from v4 to v5: <ul> <li>TheHive will automatically reindex its data when a change in the index is detected (change from lucene to elasticsearch)</li> <li>TheHive will no longer try to run migrations when the setting <code>db.janusgraph.index.search.elasticsearch.bulk-refresh = false</code> is present</li> </ul> </li> <li>Fix issue where uploaded files like observable attachments were deleted from the server before being processed, resulting in \"File Not Found\" errors</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_8", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Improve the search experience when merging a case </li> <li>Ctrl+click on a case title in the list view will open the case in a new tab</li> </ul> <p>API:</p> <ul> <li>TheHive will try to fix ghost vertices when encountering one (a vertex that is present in the index but not in the database)</li> <li>a new field <code>extendedStatus</code> is passed to Cortex responders which represents the status of the Case which can be customized. The field <code>status</code> is still a fixed enumeration.</li> <li>Add integrity checks for <code>Share</code>s and <code>Role</code>s entities</li> <li>Some cortex jobs could be stuck in \"Waiting\" status: now when TheHive starts it will try to fix those jobs.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#5010-21st-july-2022", "title": "5.0.10 - 21st July 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_16", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Dashboard:<ul> <li>fix style issue when loading the knowledge base at the same time</li> <li>update api used by bar widget to fix issues with custom fields query</li> </ul> </li> <li>Markdown preview in full screen mode now uses the full height of the screen</li> <li>Fix a filter when using enumeration (severity, pap)</li> <li>MISP: add settings in the UI to be able to export tags on Case and Observable from TheHive to MISP</li> <li>Cortex: <ul> <li>UI is notified when an analyzer has finished adding all the observables to a report</li> <li>Fix report view for Spamhaus analyzer</li> </ul> </li> </ul> <p>API:</p> <ul> <li>Fix issue that caused the user <code>system@thehive.local</code> to be deleted by the user integrity check: this could cause issues with MISP or Cortex synchronization (Cortex jobs triggered by notifiers were left in \"Waiting\" state). If the user was missing from your instance, it will be recreated after an update of TheHive. </li> <li>Increase the timeout for count requests to 10s and add a config to increase this value (<code>db.limitedCountTimeout</code>). If a count takes longer that this duration, a truncated result is returned.</li> <li>Dashboard queries: Filter on custom fields was not applied on the name of the custom field (only on the value)</li> <li>Fix an issue that prevented TheHive from starting when misp or cortex were not configured correctly (missing <code>http</code> scheme in url for instance)</li> </ul> <p>Docker:</p> <ul> <li>Fix issue with argument <code>--no-cql-wait</code> that caused the next argument to be ignored</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_9", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Responder jobs list are now sorted by start date </li> <li>Users in Assignee field are now sorted by alphabetical order</li> <li>When showing an observable, prevent from loading all the reports details when loading the job list. Report details are now loaded only when opening the report drawer.</li> </ul> <p>API:</p> <ul> <li>Add new parameters to the endpoint \"create a case from an alert\".</li> <li>When creating a case from an alert, the events <code>CaseCreated</code> and <code>AlertImported</code> are triggered once all the alert observables are imported inside the case.</li> <li>When merging alerts inside a case, triggger the event <code>AlertImported</code> once all observables for an alert are imported inside the case.</li> <li>Emailer will now send html emails instead of text emails. This means that you use advanced formatting and styles in your emails.</li> <li>Cortex job reports are not included in the list anymore. An extra data needs to be used to retrieve them.</li> </ul> <p>Docker:</p> <ul> <li>Misp and Cortex modules are enabled by default when using the entrypoint. (They are not enabled if you use <code>--no-config</code>)</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#509-1st-july-2022", "title": "5.0.9 - 1st July 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_17", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Dashboard:<ul> <li>Fix radar when aggregating on custom fields</li> <li>Radar widget now uses a more efficient query</li> <li>Clicks on donut and counter widgets correctly sets the filters on the search page</li> </ul> </li> <li>Reset scroll when page is changed</li> <li>In alert observable list, remove the share column</li> <li>Fix french translation in quick views</li> <li>Fix links in search results for observables</li> </ul> <p>API:</p> <ul> <li>When merging an alert in a case, merge the tag reports for the observable</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_10", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>In analyzer reports, add the tags on the observables</li> <li>Sort case template by name when creating a case</li> <li>Add support for cortex entities in charts and dashboard</li> <li>Related case view: sort cases by matching percentage</li> </ul> <p>API:</p> <ul> <li>Limit the duration of count queries not using the index to 5 seconds</li> <li>Add support for cortex entities for charts api</li> <li>Add TheHive version in logs</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#508-15-june-2022", "title": "5.0.8 - 15 June 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#security", "title": "Security", "text": "<p>Fix issue related to AD/LDAP module.</p> <p>If you are using the ad/ldap authentification, you should update to TheHive 5.0.8 or later</p>"}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_18", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fixes issues around importing observables from an analyzer report</li> <li>Analyzer template list was not be exhaustive in certain cases</li> <li>Fix pagination and sorting when listing similar cases</li> <li>In related cases list, show several matching observables instead of only one</li> </ul> <p>API:</p> <ul> <li>Removed full text search on tags: that caused slow queries as the index cannot be used here</li> <li>Fixed regression from TH4: when merging alerts into a case, observables could be duplicated if they appeared in several alerts</li> <li>Add ability to filter and sort by case/alert status/stage on api v0</li> </ul> <p>Docker:</p> <ul> <li>Fix entrypoint for s3 configuration</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_11", "title": "Improvements", "text": "<p>API:</p> <ul> <li>Log login success and failures: those logs are useful for auditing purpose, to detect password guessing attacks via large unsuccessful logon attempts</li> <li>Prevent duplication of custom fields values</li> <li>Improve queries when filtering on a custom field with a high number of matches</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#507-31-may-2022", "title": "5.0.7 - 31 May 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_19", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>When creating a case from an alert, the correct case template is selected if the field was set in the alert</li> <li>Dashboard: fix an issue when converting a v4 dashboard</li> <li>Case count was not refreshed when adding a case</li> <li>Refresh comment section</li> <li>Misp configuration: Fix organization selection</li> <li>Analyzer reports:<ul> <li>in an alert, display the extractable observables</li> <li>can now import an observable of type file</li> </ul> </li> <li>Custom Fields:<ul> <li>Limit the size of custom fields in list views</li> <li>use the display name in list views</li> </ul> </li> <li>When closing a case, custom fields are no longer deleted</li> </ul> <p>API:</p> <ul> <li>Fix breaking change in api V0: don't limit the size of observable data in json. This prevented the creation of files in observables. Note: with v1 the prefered way is to use a multipart request.</li> </ul> <p>Migration 3 to 5</p> <ul> <li>Fix migration of custom fields of type number</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_12", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Add ability to manually refresh a list when auto-refresh is disabled</li> <li>Notifications: Add a json validator when creating a custom filter</li> <li>Prevent automatic scroll when an entity is updated</li> <li>Fix flickering of updated data fields when updating an entity</li> <li>Other UI improvements</li> </ul> <p>API:</p> <ul> <li>Check for duplicated files (by filename) when attaching a file to a case or to a log</li> <li>Add field <code>stage</code> to alert and case in api v0</li> <li>Users can manage their own api key without the permission <code>manageUsers</code></li> <li>Add new auth mecanism based on htpasswd file</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#506-17-may-2022", "title": "5.0.6 - 17 May 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_20", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>List of analyzers did not refresh correctly for alert observables</li> <li>Fix error when trying to download a task log attachment with the char <code>{</code> in the name</li> <li>logout popin remained open after a reconnection</li> <li>API docs did not appear when setting an http context</li> <li>Fix an issue where breadcrumps were not displayed correctly</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#improvements_13", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Faster render of big markdown section: use <code>marked-react</code> library instead of <code>react-markdown</code></li> <li>Adjust fanged message</li> <li>Improve sorting of tasks when in group mode</li> <li>Update observable count when an observable is added or removed</li> <li>Improvements for \"Required Action\" on tasks</li> </ul> <p>Migration 4 to 5:</p> <ul> <li>Improve migration for custom fields where previous script could overload the application</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#505-5-may-2022", "title": "5.0.5 - 5 May 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_21", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Analyzer templates: optimize rendering time</li> <li>Fixed SSO login when using an http context</li> </ul> <p>API:</p> <ul> <li>Dashboard: increase number of retrieved values for aggregations (eg. chart on custom field values)</li> <li>Fix for permission <code>manageConfig</code></li> <li>Improve support for AWS Keyspace: add retries on some failed queries</li> <li>Fix endpoint for deletion of catalog of ttp</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#504-3-may-2022", "title": "5.0.4 - 3 May 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_22", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Tasks are now displayed by their order</li> <li>Changed color of field for search by case id</li> <li>Fixed an issue where custom fields were deleted when editing a case template</li> <li>Fix download link of attachments when http context is set</li> <li>Update of vulnerable libraries</li> <li>When using bulk edit, \"Add tags\" and \"Remove tags\" now work</li> </ul> <p>API:</p> <ul> <li>Fixed bug introduced in 5.0.3 where TTPs were not linked to their tactics and reported <code>&lt;unknown&gt;</code></li> <li>It's now possible to delete the title prefix in a case template</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#503-15-april-2022", "title": "5.0.3 - 15 April 2022", "text": ""}, {"location": "thehive/release-notes/release-notes-5.0/#new-features", "title": "New Features", "text": "<p>API:</p> <ul> <li>Add support to procedures (TTPs) when creating alerts in TheHive</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#fixes_23", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>When importing a case from misp: additional parameters (custom fields, shares) are correctly sent</li> <li>When converting an alert to case, custom fields are no longer lost during the process</li> <li>Update moment.js library</li> </ul> <p>Migration tool:</p> <ul> <li>Fix typo in migration tool configuration</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#502-8-april-2022", "title": "5.0.2 - 8 April 2022", "text": "<p>We found a bug that prevents a user from using the reset pasword flow (present in 5.0.0). We recommend all 5.0.x users to update to this version.</p> <p>Fixes:</p> <ul> <li>Fix 404 page during the reset password flow</li> <li>Dashboard: include end date in time interval</li> <li>Fix detached live feed when using an http context</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.0/#501-7-april-2022", "title": "5.0.1 - 7 April 2022", "text": "<p>TheHive 5.0.1 is the first patch release in the 5.0 series. It contains fixes and improvements for the UI and some small changes for the API compared to 5.0.0.</p> <p>We recommend all 5.0.0 users to update to this version.</p>"}, {"location": "thehive/release-notes/release-notes-5.0/#notables-changes", "title": "Notables changes", "text": "<p>UI:</p> <ul> <li>fix description display on search page</li> <li>display org admin tabs only with required permissions</li> <li>fix permissions checks in the application</li> <li>improve case sharing user experience</li> <li>notifications - fix urls of http endpoints</li> <li>notifications - improve editor when using template variables</li> <li>be able to download a file attachment for an alert</li> <li>forms and drawers don't lose user data when the entity is refreshed by the feed</li> <li>improve live feed for cortex jobs on observables</li> </ul> <p>API:</p> <ul> <li>add ability to create alert with observables (of type string and files), see. API docs for more information</li> <li>rename field user to assignee in case creation</li> <li>rename field customFieldValues to customFields in alert creation</li> </ul> <p>Backend:</p> <ul> <li>fix tag edition</li> <li>fix permissions check for observables in case of sharing</li> <li>fix user deletion (user could be left without org)</li> <li>fix license reload on cluster nodes</li> <li>add more check to ensure uniqueness of data</li> <li>increase quotas for service users (set to unlimited) and cluster nodes (unlimited for platinum plan)</li> <li>update of dependencies</li> </ul> <p>Docs:</p> <ul> <li>fix url to website</li> <li>add documentation for MISP endpoints</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/", "title": "Release Notes for Version 5.1", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#release-notes-of-51-series", "title": "Release Notes of 5.1 Series", "text": "<p>Danger</p> <p>The 5.1 release comes with some changes on the database schema that can't be reversed. Please make sure to make a backup of your database before upgrading.</p> <p>This release also comes with some breaking changes, please review them below</p> <p>Info</p> <p>An upgrade guide is available to help you migrate from TheHive 5.0</p>"}, {"location": "thehive/release-notes/release-notes-5.1/#5112-9th-april-2024", "title": "5.1.12 - 9th April 2024", "text": "<ul> <li>Fix a regression following a security fix that made the MFA authentication impossible.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#5111-4th-april-2024", "title": "5.1.11 - 4th April 2024", "text": "<ul> <li>Fix security vulnerability. An advisory will be published in the coming weeks.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#5110-21st-december-2023", "title": "5.1.10 - 21st December 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes", "title": "Fixes", "text": "<p>Security:</p> <ul> <li>Fix security vulnerabilities. Please read the detailed advisories.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#519-29th-june-2023", "title": "5.1.9 - 29th June 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_1", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix display of task attachments in attachment listing</li> <li>Improve error message when merging cases</li> </ul> <p>Backend:</p> <ul> <li>Fix error \"Tag not Found\" which could occur when creating alerts and cases</li> <li>Fix link duplication when importing several times a TTP catalog</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#improvements", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Improve form for SAML authentication</li> </ul> <p>Backend:</p> <ul> <li>Add MISP event UUID to alert description in imported alerts</li> <li>Add validation for SAML configuration</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#518-20th-june-2023", "title": "5.1.8 - 20th June 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_2", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix the order of Cortex job reports in observable page</li> <li>Add events related to case templates in live feed</li> <li>Change rules of user quota</li> <li>Display the callback URL in SAML configuration</li> <li>Fix icon in timeline</li> <li>Fix format of some old generated dashboard widgets</li> </ul> <p>Backend:</p> <ul> <li>Change format of the date custom field values Ids</li> <li>Fix between filter on custom fields</li> <li>Ldap sync: add support of several mapping for the same group</li> <li>Ldap sync: fix conflict when several configurations exist with the same suffix</li> <li>Cortex job endDate is not set if the job is not finished</li> <li>Fix filter value when it contains only wilcards</li> <li>Make readonly profile not editable</li> <li>Add properties for alert KPIs</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#517-1st-june-2023", "title": "5.1.7 - 1st June 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_3", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fixes on long names</li> </ul> <p>Backend:</p> <ul> <li>Link correctly task and assignee when updating a task</li> <li>Limit the size of cortex response</li> <li>Cortex: Fix sync issue when multiple jobs are submitted at the same time</li> <li>Fix full text filter for custom fields</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#improvements_1", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Allow search for task assignee input</li> </ul> <p>Backend:</p> <ul> <li>Optimize resource usage when reading cortex jobs </li> <li>Replace default \"Job\" dashboard with a better TTP dashboard</li> <li>Cortex:<ul> <li>Add timeout for jobs (3 hours by default)</li> </ul> </li> <li>Deduplicate custom field values on case merge</li> <li>Increase observable data length in api v1 to 4096 chars</li> </ul> <p>Migration tool:</p> <ul> <li>Improve mapping of TheHive 3 Alert status </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#security", "title": "Security", "text": "<ul> <li>Update libraries</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#516-15th-may-2023", "title": "5.1.6 - 15th May 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_4", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix edition of property \"includeInTimeline\" for task activities</li> <li>Fix case template search when creating a new case</li> <li>Admin: show username and organization name as required in forms</li> <li>other small fixes</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#improvements_2", "title": "Improvements", "text": "<p>API:</p> <ul> <li>Improve performances in some areas</li> <li>Replace org default dashboard \"jobs\" with TTP</li> <li>Improve performance when running notifiers</li> <li>It's now possible to upload two attachments with the same name in a case (the second attachment will be renamed automatically)</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#security_1", "title": "Security", "text": "<ul> <li>Update libraries and remove unused dependencies</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#515-27th-april-2023", "title": "5.1.5 - 27th April 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_5", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Case template: fix issue where prefix was deleted when editing a template</li> <li>Sharing: Fix display of share options on small display</li> <li>Responder reports should now appear in the observable preview when triggered</li> </ul> <p>Backend:</p> <ul> <li>Fix Case dates when creating a case with status \"Closed\"</li> <li>Fix issue that created phamtom tags on alerts or case</li> <li>Fix issue that removed field <code>_id</code> from audits sent via notifiers (like webhook)</li> <li>Fix empty response when using the extraData <code>similarAlerts</code> on case queries</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#improvements_3", "title": "Improvements", "text": "<p>UI:</p> <ul> <li>Better user selector</li> <li>Tasks: redirect to task list after deleting a task</li> <li>Change wording in search bar</li> <li>Alert list: add capability to filter by assignee when clicking on an assignee</li> <li>Filters: assignee field will filter the dropdown list when typing</li> <li>Functions: several improvments</li> <li>Comments: use \"Enter\" to save a comment</li> <li>Responders: Sort responder reports by startDate</li> </ul> <p>API:</p> <ul> <li>Better error codes when making queries or when sending an http entity too large</li> <li>Allow attachment download using its <code>id</code> or <code>_id</code></li> <li>Fix some errors in the documentation</li> </ul> <p>Backend:</p> <ul> <li>Improve tag creation performances</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#514-13th-april-2023", "title": "5.1.4 - 13th April 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_6", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix crash when live feed is opened and a case is deleted</li> <li>Pages: several images with the same name can now be added (also fixes an issue with pasted images)</li> <li>Hide locked users in task assignee</li> <li>Custom fields of type boolean now display a set of options</li> <li>You can now press <code>Enter</code> to save a comment</li> <li>Fix report template download link</li> </ul> <p>Backend:</p> <ul> <li>Fix potential memory leak that could lead to a crash (from 5.1, issue not present in 5.0)</li> <li>Return error 413 when http input payload is too large</li> <li>Report error when email sending fails during password reset</li> <li>Fix api documentation for operator <code>_between</code> in queries</li> <li>Add field <code>_updatedBy</code> in comments</li> <li>Don't ignore cortex jobs when the report contains an unknown operation</li> <li>Deprecate page slugs (in api docs only)</li> </ul> <p>Warning</p> <p>In our next major release 5.2, the field <code>slug</code> for object <code>Page</code> will be removed. We are starting to deprecate it starting from this release</p>"}, {"location": "thehive/release-notes/release-notes-5.1/#513-29th-march-2023", "title": "5.1.3 - 29th March 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_7", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix filtering of case templates when creating a case</li> <li>When importing a case template that already exists, ask for a new name</li> <li>In dashboard list, be able to filter on group name</li> <li>Fix task list not refreshed when applying a case template on a case</li> <li>Fix url of popup livefeed when the application uses an http context</li> <li>Avoid tags deletion when editing a case template</li> </ul> <p>Backend:</p> <ul> <li>Improve error message when merging case</li> <li>Fix sharing not applied after merging cases</li> </ul> <p>Docker:</p> <ul> <li>Fixes <code>--storage-directory</code> option</li> <li>Don't show cassandra password</li> <li>Correctly escape Elasticsearch password</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#512-14th-march-2023", "title": "5.1.2 - 14th March 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_8", "title": "Fixes", "text": "<p>Backend:</p> <ul> <li>Fix SSO user autocreate</li> <li>Improve the application behavior when Janusgraph configuration gets updated while another connection exists</li> <li>Fix permission checks for case template creation</li> <li>Fix permission checks on pages</li> <li>Improve the observable type length check</li> </ul> <p>Cortex connector:</p> <ul> <li>Send the submit message to Cortex job actor when the transaction is committed</li> <li>Improve Cortex pending jobs recovery</li> <li>Fix: Recover only 100 jobs at startup. When the queue is empty, recover 100 more jobs.</li> <li>Updates of job with status \u201cDeleted\u201d are retried</li> <li>Improve logs</li> </ul> <p>MISP connector:</p> <ul> <li>MISP synchronisation misses some events in case of timeouts during synchronization</li> </ul> <p>UI:</p> <ul> <li>Refresh the task list when after bulk editing of assignee</li> <li>Fix tooltip overlap in some dashboard widgets</li> <li>Dashboard labels for cases/alerts are mixed</li> <li>Remove owner field from dashboard import drawer</li> <li>Fix the UI refresh when launching an analyzer job</li> <li>Fix incorrect search when click on donut due to persisting keyword \"domain\"</li> <li>Fix Customfield selector in case template editor</li> <li>Improve notifier name and suffix with using an existing endpoint</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#511-3rd-march-2023", "title": "5.1.1 - 3rd March 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_9", "title": "Fixes", "text": "<p>API:</p> <ul> <li>Fix a change in the observable creation API (regression from 5.0)</li> </ul> <p>UI:</p> <ul> <li>Date fields can be set using keyboard input</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#510-1st-march-2023", "title": "5.1.0 - 1st March 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.1/#breaking-changes", "title": "Breaking changes", "text": "<ul> <li> <p>Remove support for Hadoop for filestorage</p> <p>From this new release, Hadoop can no longer be used a file storage (it was removed from 5.0 documentation but could still be used)</p> </li> <li> <p>Drop support for java 8</p> <p>Java 8 version is no longer supported by TheHive. Please update to java 11 at least Our setup guide can help you on how to install a jvm</p> </li> <li> <p>Drop support for Lucene as index backend</p> <p>Former versions of TheHive supported lucene and elasticsearch as indexing engines for the data. We then encountered limitations while using the Lucene index (especially when making queries based on Custom Fields). With TheHive 5.0, we pushed users to install and migrate to Elasticsearch. Finally with TheHive 5.1, the support of Lucene index is removed: the application will start but queries involving Custom Fields will return wrong results. To migrate your index to Elasticsearch, follow this guide.</p> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#main-features", "title": "Main features", "text": "<ul> <li> <p>Apply case template on existing case: enrich a case with tasks, custom fields, tags from other case templates</p> <p>This will allow your organization to create more reusable case templates and apply them during the lifecycle of a case</p> </li> <li> <p>KPIs</p> <p>Get more indicators about your organization response: Time to Respond, Time to Acknowledge ...</p> </li> <li> <p>Global search</p> <p>You can now search on all elements of the database instead of choosing a scope</p> </li> <li> <p>Custom Field db model update</p> <p>Database model was updated to be able to better support dashboard and queries based on custom fields. Now dashboard using filters or aggregation on custom fields should be way faster</p> </li> <li> <p>New permissions</p> <p>Split some permissions to make them more granular. For instance <code>manageAlert</code> was split into 4 permissions: <code>manageAlert/create</code>, <code>manageAlert/delete</code>, <code>manageAlert/update</code>, <code>manageAlert/import</code>. Case permissions were also split</p> </li> <li> <p>History list for object</p> <p>Added a new tab in the UI to list the changes made on an Alert or Case.</p> </li> <li> <p>Mandatory Tasks</p> <p>Some tasks can be defined as mandatory. To close a case, those tasks need to be closed and contain at least one activity.</p> </li> <li> <p>SAML Support</p> <p>You can now use SAML as an SSO source for your users (requires platinum license)</p> </li> <li> <p>Functions (Beta)</p> <p>See dedicated page for more information (requires platinum license)</p> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#other-features", "title": "Other features", "text": "<ul> <li>New type of custom fields: url</li> <li>Change case ownership</li> <li>Similarity between observable now works with observable of kind attachment</li> <li>Improve Cortex connector resources usage</li> <li>Dashboards on org creation: default dashboards are now provided to new orgs</li> <li>Add cache for dashboard</li> <li>Auto import observables from Cortex: when an analyzer extract observables into its report, it can flag some observable to be automatically imported into the case/alert</li> <li>Experimental support for Elasticsearch 8</li> <li>Rework UX to add TTP</li> <li>Move interface date format to user settings (and localstorage) instead of org settings</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.1/#fixes_10", "title": "Fixes", "text": "<ul> <li>Notifications improvement: notifications are now triggered for each observable when creating an alert with multiple observables</li> <li>Several other fixes in the application and UI</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/", "title": "Release Notes for Version 5.2", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#release-notes-of-52-series", "title": "Release Notes of 5.2 Series", "text": "<p>Danger</p> <p>The 5.2 release comes with some changes on the database schema that can't be reversed. Please make sure to make a backup of your database before upgrading.</p> <p>This release also comes with some breaking changes, please review them below</p> <p>Info</p> <p>An upgrade guide is available to help you migrate from TheHive 5.x</p>"}, {"location": "thehive/release-notes/release-notes-5.2/#5216-april-24-2025", "title": "5.2.16 - April 24, 2025", "text": "<p>Last update: May 26, 2025</p>"}, {"location": "thehive/release-notes/release-notes-5.2/#security-fixes", "title": "Security fixes", "text": "<ul> <li>This update includes four patches addressing vulnerabilities identified as CVE-2025-48738, CVE-2025-48739, CVE-2025-48740, and CVE-2025-48741. None have been exploited in the wild. Further details are provided in our security bulletin, in line with our Responsible Vulnerability Disclosure Policy.</li> <li>JSON endpoints now strictly validate the <code>Content-Type</code> header. Requests must explicitly include <code>Content-Type: application/json</code>. If not, the server returns a <code>400 Bad Request</code> response.<ul> <li>A temporary compatibility mode is available to support legacy clients or scripts that don't set the <code>Content-Type</code> header properly. To enable it, add the following line to your <code>application.conf</code> file: <code>ignoreCSRFProtection = true</code>.</li> <li>After enabling compatibility mode, update all clients to send <code>Content-Type: application/json</code>. Once all clients are updated, remove this override to re-enable full validation.</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#5215-9th-of-january-2025", "title": "5.2.15 - 9th of January 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#security-fix", "title": "Security fix", "text": "<ul> <li>This update contains a patch for a vulnerability (CVSS 6.9) non-exploited in the wild. More details will come in a further security bulletin, as per our responsible disclosure policy.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#5214-9th-april-2024", "title": "5.2.14 - 9th April 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fix", "title": "Fix", "text": "<ul> <li>Fix a regression following a security fix that made the MFA authentication impossible.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#5213-5th-april-2024", "title": "5.2.13 - 5th April 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#security", "title": "Security", "text": "<ul> <li>Fix Username Enumeration vulnerability.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#fix_1", "title": "Fix", "text": "<p>Filter/Search</p> <ul> <li>Fixed the search when using a \"not\" operator on full-text data.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#5212-12th-march-2024", "title": "5.2.12 - 12th March 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes", "title": "Fixes", "text": "<p>Cortex connector fixes:</p> <ul> <li>Enhanced Stability: Fixed an issue with the Cortex connector that had issues after updating it's configuration. Additionally, the \"Test connection\" button is no more preventing to cancel the configuration defined in the drawer.</li> </ul> <p>Notification fixes and enhancements:</p> <ul> <li>Slack notifier: Slack notifications are now sending the accurate case titles. Also, we fixed an issue with the \"Advanced settings\" that was sent to the backend, even if the box wasn't checked.</li> <li>HTTP notifications: Fixed interpretation of backslashes, ensuring correct rendering and transmission of notifications without unexpected behavior.</li> </ul> <p>Performances improvements:</p> <ul> <li>Similar Cases/Alerts pages: Optimized the Similar Cases/Alerts pages by limiting the correlation count, improving performances and preventing the application ressource exhaustion.</li> </ul> <p>MISP Connector:</p> <ul> <li>Observables export enhancement: Mapping between TheHive observables dataTypes and MISP attributes types has been reworked.</li> </ul> <p>User Experience Enhancements:</p> <ul> <li>Quick filters: Resolved issues with open case quick filter functionality.</li> <li>Shared tasks: Fixed display of User ID on task logs.</li> <li>OAuth2 authentication: We improved the drawer by renaming some fields to be more explicit. Additionally, fixing a bug that was preventing to disable the OAuth2 authentication provider.</li> <li>Dashboard donut widget: Fixed an issue with the category filter in the donut widget in dashboards.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#security-updates", "title": "Security updates", "text": "<p>The library dependencies has been updated. The following vulnerabilities has been removed: - CVE-2020-8908 - CVE-2023-2976 - CVE-2023-46749 - CVE-2023-34454 - CVE-2023-34455 - CVE-2023-43642 - CVE-2023-5072 - CVE-2022-45688 - CVE-2023-44483 - CVE-2023-34462 - CVE-2023-3635 - CVE-2023-46120</p>"}, {"location": "thehive/release-notes/release-notes-5.2/#5211-8th-february-2024", "title": "5.2.11 - 8th February 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_1", "title": "Fixes", "text": "<p>User Interface:</p> <ul> <li>Dashboard Revitalization: The Donut widget shows again the total.</li> <li>Streamlined Dashboard Filtering: We've refined dashboard filtering to utilize associated field text instead of custom label text, enhancing usability and clarity in data presentation.</li> <li>Observables Management: only protect http(s) string if it is part of a url.</li> <li>Improved Linked Alert: In the Linked Alerts tab, all types of alerts, whether with or without observables, are now seamlessly displayed for enhanced visibility and swift action.</li> <li>Efficient Alert Assignment: Fix bulk assignment issues for alerts, ensuring smooth and efficient workflow management.</li> </ul> <p>API:</p> <ul> <li>Seamless Integration with MISP: Experience effortless file upload to MISP with identical files from TheHive, streamlining your incident response workflow and ensuring data consistency across platforms.</li> <li>Custom tags: fix tags global integrity check to delete orphan custom tags</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#improvements", "title": "Improvements", "text": "<p>SAML Authentication Enhancement:</p> <ul> <li>Custom Attribute Support: Introducing a new custom attribute - the Login Name field - in SAML forms, providing greater flexibility and customization options for user authentication.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#5210-10th-january-2024", "title": "5.2.10 - 10th January 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_2", "title": "Fixes", "text": "<p>API:</p> <ul> <li>Performance Enhancement: Improved performance when loading case pages with similar/related cases or alerts. Displays \"99+\" and seamlessly loads without blocking the page.</li> <li>TheHive Alert Creation: Fixing an observable deduplication issue while creating alerts. Merged description tags unless identical.</li> <li>Similar Cases Matching: Fixed a bug where in specific scenario, a case could match itself as similar.</li> </ul> <p>MISP:</p> <ul> <li>Optimized MISP Synchronization: Resolved abnormal CPU consumption during MISP synchronization when an event contains many observables.</li> </ul> <p>UI:</p> <ul> <li>Search of Knowledge Base Fix: Resolved the issue causing a \"white screen\" when searching in the Knowledge Base.</li> <li>Log Code Formatting: Fixed the code display in logs to correctly return to the line when exceeding a specified size component.</li> <li>Dashboard Memory Leak: Addressed a memory leak in the dashboard, ensuring that memory consumption does not increase.</li> <li>Cortex Analyzer/Responder Report Fix: Rectified the error message \"id undefined\" in Cortex Analyzer/Responder reports.</li> <li>Organization Name Trimming: Trimmed organization names when creating a new organization to prevent unnecessary spaces.</li> </ul> <p>Dashboard: - Customizable Fragment Display: Take control of your visualizations by choosing the number of fragments to display on the Donut. Tailor the dashboard to your preferences for a personalized and efficient user experience.</p> <p>Docker:</p> <ul> <li>Docker User Fix: Docker containers are now using \u201cthehive\u201d user instead of root. sudo is used when necessary to address file permission issues.</li> </ul> <p>Packages:</p> <ul> <li>Dependency Updates for RPM/DEB Packages: Updated dependencies for RPM/DEB packages, ensuring compatibility with java11-runtime-headless provided by both packages.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#new-features-improvements", "title": "New Features / Improvements", "text": "<ul> <li>Case Status Modification: Users can now change the status of a case from \"Closed\" to any other status without reopening the case.</li> <li>SAML Authentication Enhancement: Improved SAML authentication by allowing minutes to be used in the Maximum Authentication Lifetime.</li> <li>Observable Management from UI: Introduced the ability to add/edit observables directly into an alert from the user interface for enhanced flexibility.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#529-21st-december-2023", "title": "5.2.9 - 21st December 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_3", "title": "Fixes", "text": "<p>Security:</p> <ul> <li>Fix security vulnerabilities. Please read the detailed advisories.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#528-23rd-november-2023", "title": "5.2.8 - 23rd November 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_4", "title": "Fixes", "text": "<p>API:</p> <ul> <li>MISP Sync: Fixed a bug introduced in the latest version which causes TheHive to crash when parsing MISP events with the fields <code>first_seen</code> or <code>last_seen</code>. This bug does not happen in earlier versions (&lt;= 5.2.6) or if those fields are not present in the MISP event</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#527-2nd-november-2023", "title": "5.2.7 - 2nd November 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_5", "title": "Fixes", "text": "<p>API:</p> <ul> <li>LDAP Sync Enhancement: We've fine-tuned our LDAP sync functionality to ensure that it doesn't overwrite critical user fields like API key and TotpSecret.</li> <li>Attachment Upload: Fixed an issue where the empty files was discarded by default. TheHive now accept empty files by default.</li> </ul> <p>User Interface:</p> <ul> <li>Case Reporting CSS Fix: We've corrected a CSS tag name for high severity cases, which fix a display issue in the reports.</li> <li>Alert Responders Tab Enhancement: Fixing issues on the responder reports list display.</li> <li>Filter Preview Improvement: Lengthy filters do not break the display in the UI anymore</li> <li>Report Template Enhancement: We've added a more intuitive format for Custom Fields variables in report templates, introducing the format case.customFieldValues.name</li> <li>SAML Information Display: Fixed a bug where the session lifetime parameter wasn't displaying the actual value.</li> </ul> <p>New Features / Improvements:</p> <ul> <li>Alert Assignee:<ul> <li>Alert auto assignment at start/closure: If the alert is yet unassigned, TheHive now automatically set the assignee to the user that is performing the action of starting/closing the alert.</li> </ul> </li> <li>MISP Integration:<ul> <li>Improved MISP Status and Sync: We've revamped MISP status and synchronization reports to provide real-time insights into ongoing synchronizations. Stay informed about the status of your data exchanges.</li> </ul> </li> <li>Task Management:<ul> <li>Extended Task Group Name: Increasing task groups with names size up to 64 characters in length (instead of 32), allowing more flexibility when organizing incident response tasks and playbooks.</li> </ul> </li> <li>Case Reporting:<ul> <li>Docx Case Report Generation: Generate case reports in the popular .docx format, making it easier to customise post generation and share your cases reports with stakeholders. NB: No report preview available for this format.</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#526-19th-october-2023", "title": "5.2.6 - 19th October 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_6", "title": "Fixes", "text": "<p>User Interface:</p> <ul> <li>SAML Configuration: We've enhanced security by checking the format of the 'name' SAML configuration field before creating the 'callback' URL. Special characters and uppercase letters are now automatically replaced for improved compatibility.</li> <li>Alert Similar Cases Query: We've resolved an issue where the similar cases query was not fetching results due to the length of default filters.</li> <li>Duplicate Observables: Multiple alert imports no longer lead to duplicate observables, as we now deduplicate them automatically.</li> <li>MISP Integration:<ul> <li>MISP Attribute Handling: When exporting a case, MISP attributes of observables are now set correctly, ensuring seamless integration with MISP.</li> <li>Event Editing Strategy: We've implemented a comprehensive event edit strategy to enhance your MISP experience.</li> </ul> </li> <li>Comments: Text comments without spaces now wrap correctly within the component, ensuring a neat and organized display.</li> <li>Authentication: Fixed a bug that did not correctly remove the link between two organizations, which could lead to connection problems.</li> </ul> <p>API:</p> <ul> <li>Cortex Responders: Cortex responders now show up for Tasks and Task Logs</li> <li>Duplicate Observables: When merging multiple alerts into a case, observables are now better duplicated</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#new-features-improvements_1", "title": "New Features / Improvements", "text": "<ul> <li>Date fields: All date fields in the application can now be set to hours and minutes.</li> <li>Menu Label Updates: We've made menu label changes for clarity and consistency. \"Related Alerts\" is now \"Linked Alerts,\" and \"Related Cases\" has become \"Similar Cases.\" URL updates accompany these changes for a seamless transition.</li> <li>Alerts Attachment: You can now add attachments to alerts using a dedicated tab. Attachments can be merged and imported into cases for better incident tracking.</li> <li>Sorting and Filtering: Within the attachment tab for cases and alerts, you have the ability to sort attachments by ascending or descending order and apply filters for efficient management.</li> <li>New Permissions: We've introduced two new permissions, \"Manage Reopen Case\" and \"Manage Restart Alert.\" This feature allows specific profiles to block access to reopening cases or restarting alerts. By default, these permissions are enabled for all profiles with \"Manage Update\" enabled.</li> <li>TTPs : It is now possible to create TTPs via the API without specifying tactics. If only one tactic matches the technique, it will be automatically defined by the system. Otherwise, a message will indicate that the tactic is missing, leaving the user free to specify it via the interface. Editing is now possible on TTPs.</li> <li>Detailed Browser Tab Content: Identify page content at a glance with improved browser tab titling</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#525-5th-october-2023", "title": "5.2.5 - 5th October 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_7", "title": "Fixes", "text": "<p>API:</p> <ul> <li>Cortex Responders: Resolved an issue related to Cortex responders not triggering on TLP:RED (4) cases due to a compatibility issue with TheHive switch to TLPv2 while Cortex was using TLPv1.</li> </ul> <p>User Interface:</p> <ul> <li> <p>Cases: </p> <ul> <li>Improved Sorting: Now you can sort the list of related cases by title, date, and observables, providing better case management flexibility.</li> <li>Multi-Case Closure Fix: Fixed a problem that previously interchanged values when closing multiple cases simultaneously, ensuring accurate data handling.</li> <li>Merged Case Closure Fix: Fixed a problem that prevented a merged folder from being closed due to a new mechanism for deduplicating similar tasks during merging.</li> </ul> </li> <li> <p>Analyzers: Resolved a problem related to the selection of analyzers to launch on an observable after a previous analyzer had finished.</p> </li> <li>Global Search: The task log search results now correctly display the link to the task within the originating case.</li> <li>Date Display Format: Fixed a problem where the date format defined in the user profile was not being taken into.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#new-features", "title": "New Features", "text": "<ul> <li>Case URL option in MISP Connector: When exporting to MISP, TheHive could includes the case URL as an internal reference, enhancing traceability and information management.</li> <li>Session Duration Management: Introduced enhanced session termination and inactivity timeout management. Now, you can define session end and inactivity timeout times effectively, and even include a user warning message before session termination.<ul> <li>Read-only profiles will not be disconnected due to inactivity if they are connected to a dashboard and only to a dashboard. They will, however, be disconnected due to the end of a classic session.</li> </ul> </li> <li>Quick Assign to Me: A new action allows for quick assignment of cases or alerts directly from their details, streamlining task management.</li> <li>Cases: <ul> <li>Display number of alerts: The number of alerts imported into a case is now displayed in the case list information, providing valuable information at a glance.</li> <li>Attachment Previews: Preview HTML and Markdown attachments directly from the attachments list. Additionally, case reports are previewable from the report tab's attachments list.</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#524-19th-september-2023", "title": "5.2.4 - 19th September 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_8", "title": "Fixes", "text": "<p>API:</p> <ul> <li>Notification: The \"JobFinished\" trigger will no longer be triggered when the job is updated, but only when the responders have finished.</li> </ul> <p>User Interface:</p> <ul> <li>User Management: Administrators will now receive a warning message when attempting to create a new user with an existing login.</li> <li>Case Template: When applying a case template with tasks to an existing case with tasks, the template's tasks will be placed at the end.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#new-features_1", "title": "New Features", "text": "<ul> <li>Notification: You can now trigger a notification when an analyzer has finished using the \"ActionFinished\" trigger.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#523-5th-september-2023", "title": "5.2.3 - 5th September 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_9", "title": "Fixes", "text": "<p>API:</p> <ul> <li>Case Closure Enhancement: The case closing API has been enhanced to ensure that mandatory custom fields are filled in before a case can be closed.</li> </ul> <p>User Interface:</p> <ul> <li>Taxonomy Import: The message returned by the taxonomy import in the event of an error or duplication is clearer</li> <li>Task Creation: Newly created tasks are now added to the bottom of the task list to maintain task order consistency.</li> <li>Real-time Updates: The observables and tasks counter now updates in real-time after an item is deleted from the list.</li> <li>Sorting Fix: A sorting issue on the related alerts list has been addressed.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#new-features_2", "title": "New Features", "text": "<ul> <li>Enhanced Case Merging: When merging cases, identical unmodified tasks are now intelligently merged, streamlining case management.</li> <li>Attachment Previews: Enjoy the convenience of previewing image, text, and PDF attachments for cases and task logs.</li> <li>Task Date Handling: Task end dates now auto-populate when a task is cancelled, with added checks to ensure start-end date consistency.</li> <li>Redesigned Task Log Display: The task log display has undergone a redesign, optimizing readability for improved usability.</li> <li>Streamlined Comment Display: Comments are now displayed in a revamped layout, enhancing readability for easier comprehension.</li> <li>Self-Assignment Capability: It's now possible to assign cases and tasks to yourself</li> <li>Expanded Custom Field Usage: Custom fields can now be completed when closing an alert, offering more complete alert closure information.</li> <li>Markdown Support in Case Reports: Markdown formatting in task log displays within case reports is now correctly interpreted, maintaining rich text formatting.</li> <li>SMTP configuration testing: Easily validate your SMTP configuration directly from the platform, to ensure the smooth operation of e-mail evoies through the application.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#522-9th-august-2023", "title": "5.2.2 - 9th August 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_10", "title": "Fixes", "text": "<p>Infrastructure:</p> <ul> <li>Fix to create attachment directory if it doesn't exist when TheHive starts up</li> <li>A change in authentication configuration is now applied immediately, without the need to restart the platform.</li> <li>The http context is only present once when you configure a SAML authentication server like Okta</li> </ul> <p>API:</p> <ul> <li>Improve performances of notifications making http requests and limit the number of open processes</li> </ul> <p>User Interface:</p> <ul> <li>The name field is indicated as required in the endpoint configuration.</li> <li>Improved loading time for the list of observables</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#new-features_3", "title": "New Features", "text": "<p>Alerts, Cases and tasks:</p> <ul> <li>Cancelled tasks are now displayed in a case's task list and in the task menu. It will also be possible to see them in progress, and a quick filter on canceled tasks has been added.</li> <li>The severity component of a case and the case number have been split. A new severity component has been created and standardized in the application      </li> <li>Alert comments are visible in case they have been imported</li> <li>Added the ability to copy case number, case title and alert title to the clipboard</li> <li>Add an icon to display alerts, cases and unassigned tasks, and trigger a quick filter on lists</li> <li>Added ability to perform bulk actions on TTPs</li> <li>It is possible to obtain the URL of a case page so that it can be shared</li> </ul> <p>Administration: </p> <ul> <li>Improved case report templates<ul> <li>Added the ability to add a title to a case report widget</li> <li>It is possible to duplicate a case report template</li> <li>It is possible to duplicate a case report template widget</li> </ul> </li> <li>Notifications can now be triggered when an alert closes</li> <li>We have uniformized the labels for PAP, TLP and Severity, in making so, the template helpers severityLabel, tlpLabel and papLabel available in notifications now return the label in upper case</li> <li>The application will notify users by email when their account is modified by them or an admin in the following cases:<ul> <li>Modification of email address</li> <li>Modification of password</li> <li>Password reset</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#521-11th-july-2023", "title": "5.2.1 - 11th July 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_11", "title": "Fixes", "text": "<p>UI:</p> <ul> <li>Fix slow autocomplete of custom tags</li> </ul> <p>Docker:</p> <ul> <li>Fixed a behavior where cassandra host names were discarded when not resolvable by the entrypoint. This caused the application to use the local file database instead of the provided cassandra hosts when no host could be resolved. This issue appeared in environments like docker swarm.</li> </ul> <p>Warning</p> <p>The docker will no longer try to connect to a cassandra host called <code>cassandra</code> by default. If you use docker-compose with a cassandra database, make sure that you use the option <code>--cql-hostnames</code></p>"}, {"location": "thehive/release-notes/release-notes-5.2/#520-6th-july-2023", "title": "5.2.0 - 6th July 2023", "text": ""}, {"location": "thehive/release-notes/release-notes-5.2/#breaking-changes", "title": "Breaking changes", "text": "<p>Warning</p> <ul> <li>The transition to TLP 2.0 involves changing the ID of the TLP:RED value and adding TLP:AMBER+STRICT. The updated assignments are: <ul> <li>TLP:CLEAR = 0</li> <li>TLP:GREEN = 1</li> <li>TLP:AMBER = 2</li> <li>New: TLP:AMBER+STRICT = 3</li> <li>Change: TLP:RED = 4 (previously = 3)</li> </ul> </li> <li>Please make sure to update your dashboard and any integrations that rely on these values.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#main-features", "title": "Main features", "text": "<ul> <li> <p>What's new in templates</p> <ul> <li> <p>Report template: Boost your reporting with Case Reporting</p> <p>Create customized, high-impact reports with Case Reporting. Use a variety of dynamic widgets such as text, images, tables and lists. Relevant case data (tasks, observables, etc.) are automatically integrated. Export your reports in HTML and Markdown.</p> <p>See dedicated page for more information (requires platinum license)</p> </li> <li> <p>Page template: Customize and organize your cases pages</p> <p>Guide your collaborators in writing the documentation for a case by importing pages directly from the template to provide all the necessary elements and improve processes.</p> <p>See dedicated page for more information (requires platinum license)</p> </li> </ul> <p></p> <p></p> </li> <li> <p>What's new in alerts: </p> <ul> <li> <p>Alert assignment</p> <p>Assign alerts to members of the organization. Filter to find alerts assigned to a user.</p> </li> <li> <p>Triggers for alerts in notifications</p> <p>Benefit from new alert triggers to trigger your notifications.</p> </li> </ul> <p></p> <p></p> </li> <li> <p>Transition to TLP 2.0</p> <p>Our compatibility with the new TLP 2.0 standard is a key advantage for your business. Use the new TLP 2.0 terminologies to strengthen your cases, dashboards and reports.</p> <p></p> <p></p> </li> <li> <p>Notifiers Redis and Microsoft Teams</p> <p>With the new Redis Notifiers and Microsoft Teams, strengthen your communication. Keep your teams informed in real time about the progress of your processes.</p> <p></p> <p></p> </li> <li> <p>List Export</p> <p>Export your list information as you wish in JSON or CSV format. Apply filters and/or select items for export to keep only what you need. Exploit exported data according to your specific needs.</p> <p></p> <p></p> </li> <li> <p>Two-factor authentication activation indicator</p> <p>Identify users with two-factor authentication enabled. Enhance access security and promote two-factor authentication adoption.</p> </li> <li> <p>Add your own certificate authority on your servers</p> <p>Use your own CA for enhanced server security. Manage your own CA for complete control over certificate issuance, revocation, and management.</p> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#other-features", "title": "Other features", "text": "<ul> <li>PAP:WHITE changes to PAP:CLEAR</li> <li>Add new observable to alert</li> <li>Custom field mandotory indicator added</li> <li>Improve markdown editor and library change</li> <li>Improve validation errors in api</li> <li>Improve performance of NotificationActor</li> <li>Add button to test MISP/Cortex configuration</li> <li>API could understand \"last x days\" filters</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.2/#fixes_12", "title": "Fixes", "text": "<ul> <li>Fixed some display problems on custom fields</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/", "title": "Release Notes for Version 5.3", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#release-notes-of-53-series", "title": "Release Notes of 5.3 Series", "text": "<p>Danger</p> <p>The 5.3 release comes with some changes on the database schema that can't be reversed. Please make sure to make a backup of your database before upgrading.</p> <p>This release also comes with some breaking changes, please review them below</p> <p>Warning</p> <p>Note: public API v0 is now considered as deprecated.</p> <p>The public API v0 is obsolete, and you should not be using it anymore. All the endpoints are available in the public API v1. That being said, it will be deactivated in a future version.</p> <p>The API v0 was initially developed for TheHive 3 and maintained for backward compatibility reasons only. </p> <p>API v0 endpoints refer to APIs beginning with <code>/api/</code> or <code>/api/v0/</code> (but not with <code>/api/v1/</code>).</p> <p>Info</p> <p>An upgrade guide is available to help you migrate from TheHive 5.x</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#5311-april-24-2025", "title": "5.3.11 - April 24, 2025", "text": "<p>Last update: May 26, 2025</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#security-fixes", "title": "Security fixes", "text": "<ul> <li>This update includes four patches addressing vulnerabilities identified as CVE-2025-48738, CVE-2025-48739, CVE-2025-48740, and CVE-2025-48741. None have been exploited in the wild. Further details are provided in our security bulletin, in line with our Responsible Vulnerability Disclosure Policy.</li> <li>JSON endpoints now strictly validate the <code>Content-Type</code> header. Requests must explicitly include <code>Content-Type: application/json</code>. If not, the server returns a <code>400 Bad Request</code> response.<ul> <li>A temporary compatibility mode is available to support legacy clients or scripts that don't set the <code>Content-Type</code> header properly. To enable it, add the following line to your <code>application.conf</code> file: <code>ignoreCSRFProtection = true</code>.</li> <li>After enabling compatibility mode, update all clients to send <code>Content-Type: application/json</code>. Once all clients are updated, remove this override to re-enable full validation.</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#5310-9th-of-january-2025", "title": "5.3.10 - 9th of January 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#security-fix", "title": "Security fix", "text": "<ul> <li>This update contains a patch for a vulnerability (CVSS 6.9) non-exploited in the wild. More details will come in a further security bulletin, as per our responsible disclosure policy.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#539-21st-of-november-2024", "title": "5.3.9 - 21st of November 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#fix", "title": "Fix", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#cortex", "title": "Cortex", "text": "<ul> <li>Resolved an issue causing incorrect differentiation between \"In Progress\" Cortex analyzers and responders during TheHive startup process, that was causing some Responder jobs to never cleaned up.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#538-7th-of-november-2024", "title": "5.3.8 - 7th of November 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#fixes-improvements", "title": "Fixes &amp; improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#cortex-job-queue", "title": "Cortex Job Queue", "text": "<ul> <li>Enhanced the handling of concurrent job submissions to the Cortex server for better efficiency and stability.</li> <li>Fixed an issue related to job status recovery in TheHive when the Cortex server crashes.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#537-11th-of-october-2024", "title": "5.3.7 - 11th of October 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#fix_1", "title": "Fix", "text": "<ul> <li>We fixed an issue with the method used to filter entity Ids. In certain very specific situations, the filter could return incorrect results.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#improvements", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#cortex-job-queue_1", "title": "Cortex Job Queue", "text": "<p>We have made two improvements to the management of Cortex job queues from TheHive to:</p> <ul> <li>Prevent spamming the Cortex server when a large number of jobs are submitted.</li> <li>Reduce the latency in retrieving completed job reports, even when the job queue is highly loaded.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#536-12th-of-september-2024", "title": "5.3.6 - 12th of September 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#fixes", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#case-closure-with-mandatory-tasks", "title": "Case Closure with Mandatory Tasks", "text": "<ul> <li>It is no longer possible to close a case if there are mandatory tasks that remain incomplete. This prevents backend errors by ensuring that all required tasks are finished before allowing case closure.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#alert-status-display", "title": "Alert Status Display", "text": "<ul> <li>Fixed a display issue that incorrectly allowed closed alerts to be re-closed and already-started alerts to be started again.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#case-closure-custom-fields", "title": "Case Closure Custom Fields", "text": "<ul> <li>Fixed a problem where required custom fields with blank values were not properly flagged as required during case closure.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#case-closure-tab-refresh", "title": "Case Closure Tab Refresh", "text": "<ul> <li>Fixed an issue where the case closure tab would refresh unexpectedly while a user was filling out the form, due to actions taken by other users on the platform. This issue caused users to lose the values they had entered. The tab now remains stable during form completion, preventing data loss.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#markdown-formatting-in-case-reports", "title": "Markdown Formatting in Case Reports", "text": "<ul> <li>Fixed an issue with markdown formatting in case reports, specifically addressing problems with underlining and striking text.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#session-timeout-configuration", "title": "Session Timeout Configuration", "text": "<ul> <li>Fixed an issue that prevented users from editing fields related to session timeout due to inactivity.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#improvements_1", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#login-page", "title": "Login Page", "text": "<ul> <li>Users can now tab through the fields to focus on the MFA code input when multi-factor authentication is enabled, making the login process smoother.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#security-fixes_1", "title": "Security Fixes", "text": "<ul> <li>CVE-2024-20952</li> <li>CVE-2024-20932</li> <li>CVE-2024-20918</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#535-28th-of-august-2024-hotfix", "title": "5.3.5 - 28th of August 2024 - hotfix", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#fixes_1", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#analyzer-reports", "title": "Analyzer reports", "text": "<ul> <li>we fixed a regression that prevented the analyzer reports to be displayed when the observable is attached to an alert.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#534-26th-of-august-2024", "title": "5.3.4 - 26th of August 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#improvements_2", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#login-page_1", "title": "Login Page", "text": "<ul> <li>The text box now automatically gains focus when the page loads, allowing users to immediately begin typing their information.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#fixes_2", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#analyzer-jobs-report-display", "title": "Analyzer Jobs Report Display", "text": "<ul> <li>We improved the loading speed of analyzer reports in TheHive, reducing the time it takes for them to display (This change required a fix in 5.3.5 version).</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#activity-timestamp-in-timeline", "title": "Activity Timestamp in Timeline", "text": "<ul> <li>Fixed an issue that occurred when editing activity dates in the timeline.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#index-engine-configuration", "title": "Index Engine Configuration", "text": "<ul> <li>TheHive now prevents starting with an index engine that differs from the one specified in the configuration file.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#similar-alerts-display-safari-only", "title": "Similar Alerts Display (Safari Only)", "text": "<ul> <li>Resolved a display issue in the search input field within the drawer on Safari.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#navigation-menu", "title": "Navigation Menu", "text": "<ul> <li>Fixed a regression that prevented navigation menu links from opening in a new browser tab when using the mouse scroll button.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#list-component-fixes", "title": "List Component Fixes", "text": "<ul> <li>Corrected duration display in alert lists.</li> <li>Fixed status display in task lists.</li> <li>Resolved an issue where the \"hide custom field\" option was not functioning in case lists.</li> <li>Fixed the cropping of long custom field values to prevent display errors.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#case-reports", "title": "Case Reports", "text": "<ul> <li>Users from locked organizations are no longer visible in the user list.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#security-fix_1", "title": "Security fix", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#cve-vulnerability", "title": "CVE vulnerability", "text": "<ul> <li>CVE-2023-52428 : This vulnerability has been resolved.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#533-9th-of-july-2024", "title": "5.3.3 - 9th of July 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#improvements_3", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#ui-enhancements", "title": "UI Enhancements", "text": "<ul> <li>List Display Improvements: Various components within list displays have been updated to enhance the overall aesthetic and functional experience. These improvements include modifications to the design of status and other minor visual adjustments aimed at enhancing usability.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#fixes_3", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#sorting-on-similar-casesalerts", "title": "Sorting on Similar Cases/Alerts", "text": "<ul> <li>Sorting Logic Correction: Fixed an issue in the sorting logic of the similarities column to ensure that cases or alerts are first prioritized by the highest number of similar observables, and in cases where two or more entries have the same number, they are then ordered by the highest ratio of common to total observables.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#datatype-filtering-in-similar-casesalerts", "title": "DataType Filtering in Similar Cases/Alerts", "text": "<ul> <li>Filtering Functionality Restoration: Restored the ability to define and apply specific data types in the matches column that filter similar alerts and cases. This update ensures that only observables of the selected types are considered when displaying similar cases and alerts, thereby improving the relevance and accuracy of similarity matches.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#user-count-in-administration-section", "title": "User Count in Administration Section", "text": "<ul> <li>The user count is now immediately updated when an account is removed or locked.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#api-case-list", "title": "API Case List", "text": "<ul> <li>Fixed a bug in the <code>query</code> API route that caused cases to be unobtainable when using the <code>caseid</code> filter.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#custom-tags", "title": "Custom Tags", "text": "<ul> <li>Corrected an issue that generated an error when removing and re-adding a custom tag.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#dropdown-selectors", "title": "Dropdown Selectors", "text": "<ul> <li>Fixed a bug in dropdown menus that prevented the menu action from launching if the click was not on the text item.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#532-14th-of-june-2024", "title": "5.3.2 - 14th of June 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#improvements_4", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#similar-casesalerts", "title": "Similar Cases/Alerts", "text": "<ul> <li>Improved the queries to get and display the similar Cases &amp; similar Alerts lists. Only useful information is now loaded, significantly speeding up the list display. A new query is performed when accessing the observable list drawer of a similar Case/Alert.</li> </ul> <p><code>To ensure performance, the observable list preview drawer can display up to 100 observables only.</code></p>"}, {"location": "thehive/release-notes/release-notes-5.3/#fixes_4", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#directquery", "title": "DirectQuery", "text": "<ul> <li>Fixed an issue that could cause platform instability due to the handling of empty array requests when DirectQuery is activated.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#arrow-end-home-keys", "title": "Arrow / end / home keys", "text": "<ul> <li>Resolved a regression that prevented the use of arrow, end, and home keys in the edit mode of various components: Tasklog, Dashboard, Endpoints, Custom fields, Report template, and Case template.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#notifications", "title": "Notifications", "text": "<ul> <li>Corrected an issue in the httpRequest Notifier where the JSON mode was not properly applied when activated.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#misp-connector", "title": "MISP Connector", "text": "<ul> <li>Fixed an issue that prevented the MISP connector from capturing all events during synchronization.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#case-creation", "title": "Case Creation", "text": "<ul> <li> <p>Corrected a problem that prevented the selection of a custom Start Date when creating a case from an alert. Users can now select a custom Start Date for their cases.</p> </li> <li> <p>When multiple alerts are selected, the action button associated with a given alert now provides clearer information about the possible actions, like the creation of a case.</p> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#tasks", "title": "Tasks", "text": "<ul> <li>Locked users no longer appear in the assignable user list.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#531-16th-of-may-2024", "title": "5.3.1 - 16th of May 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#improvements_5", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#email-intake", "title": "Email Intake", "text": "<ul> <li>Added the possibility to specify the Microsoft Office365/Google Workspace host instead of the one provided by default.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#fixes_5", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#custom-fields", "title": "Custom Fields", "text": "<ul> <li>Fixed a bug where merging of alerts and cases could generate duplicated customfields values in the index (invisible in the UI).</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#misp-connector_1", "title": "MISP Connector", "text": "<ul> <li>Resolved a problem that prevented alert deletion.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#alerts-cases", "title": "Alerts &amp; Cases", "text": "<ul> <li>Fixed a bug related to assignable users.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#similar-alerts", "title": "Similar Alerts", "text": "<ul> <li>Fixed the counter in the pagination.</li> <li>Fixed the display of the pending status.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#dashboard", "title": "Dashboard", "text": "<ul> <li>Fixed an issue with the properties of the donut widget.</li> <li>Changed the list to display more than 30 dashboards.</li> <li>Improved the behavior of the diagram widget.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#notifications_1", "title": "Notifications", "text": "<ul> <li>Fixed a problem with the recipent field of the email notifier.</li> <li>Solved an issue with the <code>{{ url }}</code> variable when it concerns a task.</li> <li>Fixed an issue that made it impossible to delete a webhook endpoint.</li> <li>An Event is now triggered when a Case is created from an Alert.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#responders", "title": "Responders", "text": "<ul> <li>Resolved a problem with the display of a responder report in the task preview. </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#api", "title": "API", "text": "<ul> <li>Fixed an API error return code in the post <code>/case</code> route when the <code>status</code> value is <code>unknown</code>.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#ui", "title": "UI", "text": "<ul> <li>Renamed a field name in the SAML authentication configuration page for better understanding.</li> <li>Reviewed the breadcrumb to better manage long alert names.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#security-fixes_2", "title": "Security Fixes", "text": "<ul> <li>Embedded patches for the following vulnerability: CVE-2024-25710</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#530-24th-of-april-2024", "title": "5.3.0 - 24th of April 2024", "text": "<p>Info</p> <p>The licensing model for the community version has been updated. Users are now required to register on our licensing portal and request a community license to use TheHive in the community version. Additionally, TheHive will now include a default 14-day free Platinum trial license, allowing users to explore the full range of features offered by the platform.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#new-features", "title": "New features", "text": ""}, {"location": "thehive/release-notes/release-notes-5.3/#email-intake_1", "title": "Email intake", "text": "<p>The Email Intake connector now fully automates the transformation of incoming emails into actionable alerts on TheHive platform. It supports Microsoft 365, Google Workspace, and IMAP-based email services. </p> <p>It automates the detection and processing of suspicious elements such as links, attachments and sender details, which it all adds to the list of observables.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#new-timeline-widget", "title": "New timeline widget", "text": "<p>We've added a timeline widget to TheHive Platinum case reports, allowing users to visually track attack and defense actions. This widget displays key events and indicators like IOCs and TTPs.</p> <p>Only admins can customize these reports, choosing elements like alerts and tasks to include. This customization ensures the timeline meets the specific needs of each report, making it easier for everyone, including non-technical staff, to understand the sequence of security events.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#data-list-export", "title": "Data List Export", "text": "<p>We've improved the data export options across TheHive. Users can now select specific fields from application lists to export, making the data more relevant and manageable for analysis.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#opensearch-support", "title": "OpenSearch Support", "text": "<p>OpenSearch is now available as an indexing option alongside Elasticsearch. This addition offers more choices for your indexing needs.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#dynamic-date-filtering", "title": "Dynamic Date Filtering", "text": "<p>A new relative date filter on dashboards and search pages allows users to filter data based on specific time frames like the last few days or months.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#similar-case-and-alert-enhancements", "title": "Similar Case and Alert Enhancements", "text": "<p>We've updated the similar cases and alerts pages to display more accurate data, adding a drawer for observables common to related cases and alerts and including additional details like case status for clearer insights.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#observable-export-improvements", "title": "Observable Export Improvements", "text": "<p>The observable export feature now supports more formats, including JSON and customizable CSV, allowing users to select specific fields for export.</p>"}, {"location": "thehive/release-notes/release-notes-5.3/#elasticsearch-performance-and-interface-improvements", "title": "Elasticsearch performance and interface improvements", "text": "<ul> <li>Queries have been optimized for better dashboard and search performance.</li> <li>Full support for Elasticsearch 8.</li> <li>Improved handling of custom fields with new operators (isEmpty, nonEmpty, between).</li> <li>Users can now customize the number of segments in dashboard donuts.</li> <li>All data points are now included in category aggregations for donuts and charts, providing a complete view\u2014in the past, it was capped at 100 displayed values.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.3/#bug-fixes", "title": "Bug Fixes", "text": "<ul> <li>Fixed the display issue with the number of open cases in quick filters.</li> <li>Corrected a merging bug for custom tags to prevent duplicates.</li> <li>Fixed a bug in markdown editor related to the <code>&lt;</code> &amp; <code>&gt;</code> characters.</li> </ul> <p>Info</p> <p>As we have updated some front-end components, please remember to refresh your browser page after upgrading to version 5.3 to prevent any UI issues.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/", "title": "Release Notes for Version 5.4", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#release-notes-of-54-series", "title": "Release Notes of 5.4 Series", "text": "<p>Warning</p> <p>Backend framework upgraded to Pekko/Play3</p> <p>We upgraded our backend framework from Play 2 (also known as Akka) to Play 3 (also known as Pekko). While there are no functional changes, if you use TheHive in cluster mode, your configuration file will need to be modified when upgrading to TheHive 5.4. Please refer to this guide for the necessary changes.</p> <p>Please also note that the <code>play.http.secret.key</code> parameter requires now at least a 32 character value. See more details about secret configuration.</p> <p>Info</p> <p>The following API endpoints will no longer be accessible via GET requests. You will now need to use POST requests to access them:</p> <ul> <li>api/v1/admin/log/set/</li> <li>api/v1/admin/check/_all/trigger</li> <li>api/v1/admin/check/{name}/trigger</li> </ul> <p>For more details, please refer to the public API documentation.</p> <p>Info</p> <p>An upgrade guide is available to help you migrate from TheHive 5.x</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#5410-april-24-2025", "title": "5.4.10 - April 24, 2025", "text": "<p>Last update: May 26, 2025</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#security-fixes", "title": "Security fixes", "text": "<ul> <li>This update includes four patches addressing vulnerabilities identified as CVE-2025-48738, CVE-2025-48739, CVE-2025-48740, and CVE-2025-48741. None have been exploited in the wild. Further details are provided in our security bulletin, in line with our Responsible Vulnerability Disclosure Policy.</li> <li>JSON endpoints now strictly validate the <code>Content-Type</code> header. Requests must explicitly include <code>Content-Type: application/json</code>. If not, the server returns a <code>400 Bad Request</code> response.<ul> <li>A temporary compatibility mode is available to support legacy clients or scripts that don't set the <code>Content-Type</code> header properly. To enable it, add the following line to your <code>application.conf</code> file: <code>ignoreCSRFProtection = true</code>.</li> <li>After enabling compatibility mode, update all clients to send <code>Content-Type: application/json</code>. Once all clients are updated, remove this override to re-enable full validation.</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#549-march-25-2025", "title": "5.4.9 - March 25, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#fixes", "title": "Fixes", "text": "<ul> <li>Resolved a potential deadlock when invoking functions, depending on the cache state (related to the Query API).</li> <li>Eliminated redundant <code>/status</code> API calls triggered on each keystroke in the user creation form.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#548-february-24-2025", "title": "5.4.8 - February 24, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#fixes_1", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#dark-mode", "title": "Dark mode", "text": "<ul> <li>Improved the visibility of the  button in notification messages for better readability.</li> <li>Enhanced hover state contrast in analyzer reports for better accessibility.</li> <li>Increased the visibility of error messages when a dashboard widget fails.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#other-fixes", "title": "Other fixes", "text": "<ul> <li>Fixed an issue in notifications where endpoints with names ending in a space character were not handled correctly.</li> <li>Fixed incorrect counter widget behavior when used with the <code>closeDate</code> field.</li> <li>Fixed an issue preventing scrolling in the case template selection menu when creating a case from templates.</li> <li>Added more detailed error messages for issues related to attached file storage.</li> <li>Fixed an issue with Email Intake synchronization when TheHive is configured in a cluster environment.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#known-issues", "title": "Known issues", "text": "<p>Last update: April 3, 2025</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#merged-alert-audits", "title": "Merged alert audits", "text": "<p>A regression related to the JSON audit object of merged alerts was introduced. This has been fixed in version 5.5.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#547-16th-of-january-2025", "title": "5.4.7 - 16th of January 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#fixes_2", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#global-search", "title": "Global Search", "text": "<ul> <li>Added support for wildcard searches using the * operator.   Example for a case named Phishing incident on BU-FR45, will be returned by searching BU-F or BU..</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#ui", "title": "UI", "text": "<ul> <li>Impact field is now more readable in dark theme after case closure.</li> <li>Fixed an issue on avatar change in the user profile page.</li> <li>Removed an incorrect message displayed when launching a responder on an observable.</li> <li>Fixed a display issue occurring when the function/responder list is excessively long.</li> <li>Enhanced handling for overly long function names during input.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#dashboard", "title": "Dashboard", "text": "<ul> <li>Corrected the display of text color in the donut and bar charts for the dark theme.</li> <li>Removed the \u201c_total\u201d value from the radar widget display.</li> <li>Removed cache option in UI configuration when DirectQuery is activate.</li> <li>Ensured that customized date formats are now consistently applied in dashboards.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#docker-configuration-file", "title": "Docker configuration file", "text": "<ul> <li>The entry point docker parameter --cql-cluster is replaced by --cql-datacenter. This parameter, used in cluster configuration, allows to define the name of the Cassandra datacenter used by the TheHive node.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#546-12th-of-december-2024", "title": "5.4.6 - 12th of December 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#security-fix", "title": "Security fix", "text": "<ul> <li>This update contains a patch for a vulnerability (CVSS 6.9) non-exploited in the wild. More details will come in a further security bulletin, as per our responsible disclosure policy.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#fixes_3", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#unlicensed-users", "title": "Unlicensed users", "text": "<ul> <li>Unlicensed profiles can now be assigned even when the quota is full.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#ui_1", "title": "UI", "text": "<ul> <li>Fixed readability issues with Analyzer reports and list export previews in dark mode.</li> <li>Solved an issue in the similar observable detailed view: similar observables spotted in other cases can now be opened in a blank tab.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#dashboards", "title": "Dashboards", "text": "<ul> <li>Removed a useless parameter when DirectQuery / ESChart options are enabled.</li> <li>Fixed a problem that could generate an error during the agregation query. </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#other-fixes_1", "title": "Other fixes", "text": "<ul> <li>Fixed a regression introduced in 5.4.5 version; a route was missing in the OpenAPI documentation.</li> <li>Fixed an issue related to uppercase characters in logins and LDAP synchronization module. </li> <li>Corrected a log formatting issue from notifiers.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#545-21st-of-november-2024", "title": "5.4.5 - 21st of November 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#fixes_4", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#cortex", "title": "Cortex", "text": "<ul> <li>Resolved an issue causing incorrect differentiation between \"In Progress\" Cortex analyzers and responders during TheHive startup process, that was causing some Responder jobs to never cleaned up.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#dashboard_1", "title": "Dashboard", "text": "<ul> <li>Fixed an issue related to Custom Field and negative filter on some dashboard widgets: gauge, text, and counter.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#index-es", "title": "Index ES", "text": "<ul> <li>Fixed index deactivation during a global reindex request. Double reindexation is not required anymore.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#544-8th-of-november-2024", "title": "5.4.4 - 8th of November 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#fixes_5", "title": "Fixes", "text": "<ul> <li>Resolved a display issue with the status component in cases and alerts, which was not rendering correctly on Safari and Firefox.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#543-7th-of-november-2024", "title": "5.4.3 - 7th of November 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#improvements", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#microsoft-teams-notifier-update", "title": "Microsoft teams Notifier Update", "text": "<p>Updated the Microsoft Teams notifier to use Power Automate as Microsoft has deprecated the webhook used previously. A guide to updating your notifier is available here.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#casesalerts-status-visibility", "title": "Cases/Alerts status visibility", "text": "<p>Added a colored background to the stage icon in status components for better visibility in case and alert lists.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#license-check-improvements", "title": "License Check Improvements", "text": "<p>Improved display of permissions and profiles that consume licenses for clearer management by administrators. The \u201cManage Dashboard\u201d permission no longer consumes a license.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#task-title-limit", "title": "Task title Limit", "text": "<p>Added a character limit check for task titles to notify users when their input exceeds the allowed length.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#edit-alert-title", "title": "Edit Alert title", "text": "<p>Adding the ability to edit alert title directly from the general tab.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#fixes_6", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#cortex-job-queue", "title": "Cortex job queue", "text": "<ul> <li>Enhanced the handling of concurrent job submissions to the Cortex server for better efficiency and stability.</li> <li>Fixed an issue related to job status recovery in TheHive when the Cortex server crashes.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#live-feed-display", "title": "Live feed display", "text": "<p>Fixed issues with overly long text and tags in the live feed display.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#observables-list-loading", "title": "Observables list loading", "text": "<p>Optimized the rendering speed for the observables tab to improve performance.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#app-default-language", "title": "App default language", "text": "<p>Fixed default language selection to use the browser\u2019s language on first connection.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#improved-case-closure-error-handling", "title": "Improved Case Closure Error Handling", "text": "<p>Modified case closure behavior: if a backend error occurs, the case closure window now remains open to prevent data loss.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#tasklog-display-in-timeline", "title": "Tasklog Display in Timeline", "text": "<p>When adding a tasklog with the option \"display in the timeline\", the tasklog now appears in the timeline view from the task preview after the preview drawer is closed.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#542-21st-of-october-2024", "title": "5.4.2 - 21st of October 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#fix", "title": "Fix", "text": "<ul> <li>This version fixes a regression related to the query boolean parameters in the public API. These parameter values are case insensitive again.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#541-11th-of-october-2024", "title": "5.4.1 - 11th of October 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#fix_1", "title": "Fix", "text": "<ul> <li>We fixed an issue related to our backend framework configuration (pekko). This problem impacted the generated configuration file for a new installation of TheHive on Kubernetes.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#improvements_1", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#cortex-job-queue_1", "title": "Cortex Job Queue", "text": "<p>We have made two improvements to the management of Cortex job queues from TheHive to:</p> <ul> <li>Prevent spamming the Cortex server when a large number of jobs are submitted.</li> <li>Reduce the latency in retrieving completed job reports, even when the job queue is highly loaded.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.4/#540-26th-of-september-2024", "title": "5.4.0 - 26th of September 2024", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#new-features", "title": "New Features", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#dark-mode_1", "title": "Dark Mode", "text": "<p>We have introduced a Dark Mode option to enhance user comfort during low-light or night-time usage. This feature is accessible via the theme settings and provides a dark-themed interface for reduced eye strain and improved visibility.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#report-tab-in-case-details", "title": "Report Tab in case details", "text": "<p>A new \"Report\" tab has been added to the case detail screen, allowing users to access and generate case reports directly from a case. This feature utilizes the existing Case Report Templates, enabling customization and configuration of reports based on the templates set by organization administrators. The Report Tab supports multiple formats (HTML, Markdown, Word) and offers dynamic previews for quick and informed decision-making.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#comment-and-page-widgets-in-case-report-templates", "title": "Comment and Page Widgets in Case Report Templates", "text": "<p>Two new widgets\u2014Comments and Pages\u2014have been added to case report templates. These widgets allow users to include comments and documentation directly in case reports. Administrators can configure these widgets in the template section under org admin settings, ensuring richer reports with relevant context.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#functions-as-notifiers-can-be-automatically-triggered", "title": "Functions as notifiers, can be automatically triggered", "text": "<p>A new notifier is available: function notifier. You can now write TheHive functions that can be triggered by an internal event, and then perform automated actions in TheHive. This new feature opens up a wide range of new automation possibilities within TheHive.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#functions-can-be-performed-manually-like-responders", "title": "Functions can be performed manually, like responders", "text": "<p>TheHive functions can now be manually triggered directly from a Case or an Alert, just like responders. It allows you to save time by  automating some repetitive tasks. The functions must be written and assigned with the corresponding type in order to be visible in a Case or Alert.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#duplicate-a-case-template", "title": "Duplicate a case template", "text": "<p>Creating a case template can be very time effective, we now offer  the ability to duplicate a case template, instead of creating each one from scratch or from an import.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#hide-some-time-metrics", "title": "Hide some time metrics", "text": "<p>We have introduced the option for the OrgAdmin to hide some of (or all) time metrics. It makes the user interface lighter if these metrics are not used.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#improvements_2", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#restrict-dashboard-editing-for-read-only-users", "title": "Restrict Dashboard Editing for Read-Only Users", "text": "<p>A new permission system has been introduced to restrict read-only users from editing dashboards. However, read-only users retain the ability to adjust settings like the refresh rate and cache values. This helps maintain dashboard integrity by limiting editing capabilities to authorized users only.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#enhanced-display-of-time-metrics-ttx", "title": "Enhanced display of time metrics (TTx)", "text": "<p>We changed the display format of time metrics in Alert &amp; Case pages, and made it more accurate for the users.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#backend-framework-upgraded-to-pekkoplay3", "title": "Backend framework upgraded to Pekko/Play3", "text": "<p>We upgraded our backend framework to Play 2 (also named Akka) to Play 3 (also named Pekko). While there is no functional changes,  if you use TheHive in a cluster mode, your configuration will need to be changed when upgrading to TheHive 5.4. Please refer to this guide for further details.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#elasticsearch-query-optimisations-directquery-eschart", "title": "Elasticsearch query optimisations: DirectQuery &amp; ESChart", "text": "<p>A new query optimisation system enables the union of the best aspects of both graph and search engine data models. Dashboards will fully delegate data processing to Elasticsearch, resulting in an effective and precise output. Search filters will also benefit from the performance and precision of Elasticsearch.</p> <p>Those two options DirectQuery &amp; ESChart are enabled by default, but can be deactivated through API configuration.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#new-logo-and-favicon", "title": "New logo and favicon", "text": "<p>As part of our recent brand visual identity update, TheHive logo has been updated throughout the entire application. This includes changes on the login page, favicon, and navigation bar.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#fixes_7", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.4/#time-metrics", "title": "Time metrics", "text": "<p>We resolved an issue with the \"Time to Detect\" metric during alert creation.</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#known-issues_1", "title": "Known issues", "text": "<p>Last update: 21st of October 2024</p>"}, {"location": "thehive/release-notes/release-notes-5.4/#public-api-query-boolean-parameters-case-sensitive", "title": "Public API - Query boolean parameters case sensitive", "text": "<p>TheHive 5.4.0 introduced a non expected breaking change related to the query boolean parameters. The values passed in the query URL, with upper case (ex: <code>True</code> or <code>False</code>) are not accepted anymore. It does not concern the parameters passed in the body/payload. It impacts the endpoints listed below, and the tools that use those endpoints (like TH4Py 2.0). The 5.4.2 version fixes this issue.</p> <p>The following endpoints are impacted:</p> <ul> <li>Download Attachment from observable: GET /api/v1/observable/$id/attachment/id/download with the asZip param</li> <li>Delete CustomField: <code>DELETE /api/v1/customField/$id</code> with <code>force</code> flag</li> <li>Invoke Function: <code>POST /api/v1/function/$id</code> with <code>dryRun</code> flag</li> <li>Invoke Function on an object: <code>POST /api/v1/function/$id/$objectType/$objectId</code> with <code>dryRun</code> and <code>sync</code> params</li> <li>Test Function: <code>POST /api/v1/function/_test</code> with <code>dryRun</code> param</li> <li>Get platform status: <code>GET /api/v1/status</code> with <code>verbose</code> param</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/", "title": "Release Notes for Version 5.5", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#release-notes-of-55-series", "title": "Release Notes of 5.5 Series", "text": "<p>Cortex support</p> <p>Version 5.5 no longer supports Cortex versions earlier than 3.1.5 (released on June 22, 2022).</p> <p>Public API v0 deprecation</p> <p>Version 5.5 is the last minor release to support API v0 routes, which will be deactivated by default in version 5.6. Note that API v0 has been deprecated since version 5.4.0.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#5510-october-8-2025", "title": "5.5.10 - October 8, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#fixes", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#administration", "title": "Administration", "text": "<ul> <li>Organization user list: Removed the profile selector, which should not appear in this list.</li> <li>User creation: Resolved a UI bug affecting the organization name field in the user creation form.</li> <li>Case list: Improved performance by optimizing user permission checks when loading cases.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#sharing", "title": "Sharing", "text": "<p>Shared task deletion: When a task is deleted in the owner organization, it's now also automatically deleted in all shared organizations.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#elasticsearch-9-support", "title": "Elasticsearch 9 support", "text": "<p>TheHive now supports Elasticsearch 9 as a back-end index engine. See the official Elasticsearch upgrade guide for migration details.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#559-september-16-2025", "title": "5.5.9 - September 16, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#fixes_1", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#email-intake", "title": "Email Intake", "text": "<p>Email preview rendering: Line breaks in alert description previews are now displayed correctly, improving readability of email content.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#dashboards", "title": "Dashboards", "text": "<ul> <li>Sorting: Fixed an issue where certain fields were incorrectly available for sorting data series.</li> <li>Bar widget: Resolved a problem with the <code>_total</code> column display.</li> <li>Donut widget: Corrected section color assignments that were occasionally mismatched in some configurations.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_1", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#audit-logs", "title": "Audit logs", "text": "<p>Audit logs now capture updates to tags and custom fields. This makes it possible to detect specific changes (additions, modifications, deletions) and trigger notifications when such changes occur.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#api-documentation", "title": "API documentation", "text": "<ul> <li>Status lists: Added documentation for <code>listCaseStatus</code> and <code>listAlertStatus</code> queries, which return the available statuses for cases and alerts.</li> <li>Custom fields: Clarified the two update modes for custom fields on a case, highlighting their differences.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#other-improvements", "title": "Other improvements", "text": "<ul> <li>Attachments: The attachment list now shows the username of the creator.</li> <li>Alert Feeder: The maximum length of authentication keys has been increased to 1024 characters.</li> <li>Notifications: The notifier list can now be sorted by notifier type.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#558-august-27-2025", "title": "5.5.8 - August 27, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#fixes_2", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#dashboards_1", "title": "Dashboards", "text": "<ul> <li>Radar widget: Fixed an issue preventing creation of new radar widgets.</li> <li>Line widget: Adapted display for datasets with high-digit values.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#images", "title": "Images", "text": "<ul> <li>Markdown rendering: Resolved a problem affecting image rendering when using Markdown syntax.</li> <li>Case reports: Fixed an issue where footer images weren't correctly exported in HTML and Word report formats.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#other-fixes", "title": "Other fixes", "text": "<ul> <li>Reports and filters: Resolved an issue with boolean fields in case report template filters.</li> <li>Global task list: Fixed a bug that broke the global task list in grouped view mode.</li> <li>Login: Addressed latency experienced during the first login after application restart.</li> <li>Notifications: Fixed missing event trigger when an analyzer is launched on an alert\u2019s observable.</li> <li>Dark mode: Corrected minor transition issue between light and dark themes.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_2", "title": "Improvements", "text": "<ul> <li>Markdown styling: Updated the visual style of quote characters for better readability.</li> <li>Loading indicators: Introduced loading spinners on multiple pages to provide clearer feedback during page loads.</li> <li>Email intake: The login field is no longer required to be an email address.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#557-july-29-2025", "title": "5.5.7 - July 29, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#regression-fix", "title": "Regression fix", "text": "<p>Case search bar: Fixed a regression introduced in version 5.5.6 that affected the case search bar.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#556-july-28-2025", "title": "5.5.6 - July 28, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#beta-feature-improved-filters-and-views", "title": "Beta feature: Improved filters and views", "text": "<p>A new beta feature is available to enhance the filtering and view experience across TheHive.</p> <p>Watch this short demo video to see it in action.</p> <p>Want to try it out? Follow the instructions to activate the beta in your user settings.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#bulk-case-and-alert-merge-limit", "title": "Bulk case and alert merge limit", "text": "<p>To improve platform stability, a merge limit has been introduced for alerts and cases.</p> <ul> <li>You can now merge up to 50 alerts or cases in a single operation by default.</li> <li>This limit can be customized via the <code>alert.maxMergeInCase</code> and <code>case.maxMergeInCase</code> settings in <code>application.conf</code>.</li> </ul> <p>Caution: Raising the limit may affect performance. Proceed with care.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#fixes_3", "title": "Fixes", "text": "<ul> <li>Email Intake: Fixed an issue that prevented file attachments from being handled correctly when using the MS365 GraphAPI connector.</li> <li>SAML SSO authentication: Resolved a regression introduced in version 5.5.5 that affected SAML-based login.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_3", "title": "Improvements", "text": "<ul> <li> <p>Case reports:</p> <ul> <li>Images added to task descriptions, template headers, and the case summary are now embedded in exported Word and PDF reports.</li> <li>Case reports using page templates can now be exported and imported.</li> </ul> </li> <li> <p>Custom fields: Improved the display of long string values for enhanced readability in the UI.</p> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#555-july-10-2025", "title": "5.5.5 - July 10, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#regression-fixes", "title": "Regression fixes", "text": "<ul> <li>Case start date: Corrected an issue where the start date was incorrectly set after case creation.</li> <li>Tags: Fixed custom tag auto-completion problems when editing cases or configuring filters.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_4", "title": "Improvements", "text": "<p>Optimized audit JSON rendering to improve overall application performance and reduce CPU usage.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#other-fixes_1", "title": "Other fixes", "text": "<ul> <li>Dashboards: Resolved display issues with donut and bar widgets when using custom fields or statuses as categories.</li> <li>Metrics: Fixed inaccurate calculations in dashboard widgets that use metric-per-unit fields (such as TimeToDetectInHour and TimeToQualifyInDay).</li> <li>Case links: Improved conversion of external alert links into case links to prevent display errors caused by improperly formatted URLs.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#554-june-25-2025", "title": "5.5.4 - June 25, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#regression-fixes_1", "title": "Regression fixes", "text": "<p>Fixed a regression where the <code>creationDate</code> field wasn't automatically set to the current date when creating a new case.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_5", "title": "Improvements", "text": "<ul> <li>Functions: Added the ability to switch a case to restricted mode using a function.</li> <li>Docker image: Introduced a new entry point to support custom certificate authority (CA) handling.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#other-fixes_2", "title": "Other fixes", "text": "<ul> <li>Alert status: Fixed a display issue with the import date in alert status.</li> <li>Restricted cases: Resolved a bug affecting similarity checks for restricted cases.</li> <li>Case links: Fixed duplication issues when importing multiple alerts containing identical links.</li> <li>Description field: Improved visibility of the resize button in Chrome-based browsers.</li> <li>Filters: Fixed sorting issue in the case list when using the <code>title</code> field.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#553-june-2-2025", "title": "5.5.3 - June 2, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#regression-fixes_2", "title": "Regression fixes", "text": "<ul> <li>Markdown: Resolved a regression affecting table formatting in Markdown content.</li> <li>Description fields: Corrected an issue causing some description fields to display in editing mode by default.</li> <li>Custom fields: Fixed a display problem when custom fields contained more than 12 options.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#other-fixes_3", "title": "Other fixes", "text": "<ul> <li>Live Feed: Addressed a redirection issue related to attachment actions within the Live Feed.</li> <li>Case reports: Corrected image export issues in case descriptions within generated HTML reports.</li> <li>Email Intake: Fixed a problem handling duplicated email message-IDs.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#552-may-13-2025", "title": "5.5.2 - May 13, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#performance-fixes", "title": "Performance fixes", "text": "<p>Fixed a performance issue introduced by the new case links feature that could cause significant slowdowns in environments with large data volumes.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#other-fixes_4", "title": "Other fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#case-reports", "title": "Case reports", "text": "<p>Fixed an issue where images uploaded in the case description weren't displayed in generated HTML and Word reports.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#attachments-for-shared-cases", "title": "Attachments for shared cases", "text": "<p>Fixed an issue where attachment files weren't visible in shared cases.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#public-api", "title": "Public API", "text": "<p>Fixed incorrect HTTP response code returned when a merge operation failed due to an ID conflict.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_6", "title": "Improvements", "text": "<p>Analyzers and responders can now be triggered directly from a TheHive function, enabling greater automation capabilities.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#551-april-30-2025", "title": "5.5.1 - April 30, 2025", "text": "<p>Last update: May 26, 2025</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#security-fixes", "title": "Security fixes", "text": "<ul> <li>This update includes four patches addressing vulnerabilities identified as CVE-2025-48738, CVE-2025-48739, CVE-2025-48740, and CVE-2025-48741. None have been exploited in the wild. Further details are provided in our security bulletin, in line with our Responsible Vulnerability Disclosure Policy.</li> <li>JSON endpoints now strictly validate the <code>Content-Type</code> header. Requests must explicitly include <code>Content-Type: application/json</code>. If not, the server returns a <code>400 Bad Request</code> response.<ul> <li>A temporary compatibility mode is available to support legacy clients or scripts that don't set the <code>Content-Type</code> header properly. To enable it, add the following line to your <code>application.conf</code> file: <code>ignoreCSRFProtection = true</code>.</li> <li>After enabling compatibility mode, update all clients to send <code>Content-Type: application/json</code>. Once all clients are updated, remove this override to re-enable full validation.</li> </ul> </li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_7", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#tasks", "title": "Tasks", "text": "<p>You can now sort tasks by their due dates.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#fixes_4", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#dashboards_2", "title": "Dashboards", "text": "<ul> <li>Bar widget: The <code>_total</code> field no longer appears when data is stacked.</li> <li>Table widget: Fixed an issue with filter configuration, and corrected two issues affecting the maximum number of elements.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#filters", "title": "Filters", "text": "<ul> <li>Fixed incorrect handling of the hyphen character (<code>-</code>) with certain search and filter operators.</li> <li>Fixed an issue where the filter form was wiped when a new alert arrived.</li> <li>Fixed the \"Owned by my organization\" quick filter, which wasn't working as expected.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#others", "title": "Others", "text": "<ul> <li>Improved performance of TheHive when handling a high number of analyses coming from Cortex.</li> <li>Fixed a display issue in the timeline tab.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#550-april-22-2025", "title": "5.5.0 - April 22, 2025", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#new-features", "title": "New features", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#private-cases-restrict-access-to-sensitive-cases", "title": "Private cases: Restrict access to sensitive cases", "text": "<p>You can now restrict access to sensitive cases to designated team members and managers.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#alert-feeders", "title": "Alert feeders", "text": "<p>An alert feeder is a connector that periodically requests data from an external HTTP REST API and converts it into an alert using a TheHive function. It enables data retrieval in pull mode from services that can't push or post data to TheHive public API.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#case-links-link-external-or-internal-elements-to-a-case", "title": "Case links: Link external or internal elements to a case", "text": "<p>You can now link cases to each other and to external URLs, offering a comprehensive view of related information directly within the General tab. Additionally, when you create a case from a MISP alert or merge a MISP alert into a case, the MISP URL associated with the alert is added as an external link.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#table-widget-in-dashboard", "title": "Table widget in dashboard", "text": "<p>The table widget displays a list of entities (cases, alerts, or tasks) in a tabular format. You can customize the columns, apply advanced filters, and select sorting options. This can be used to view action-required cases directly on a dashboard.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#new-markdown-content-formatting-options", "title": "New Markdown content formatting options", "text": "<p>You now have access to three new improvements in the Markdown formatting options:</p> <ul> <li>The ability to use the <code>&lt;br /&gt;</code>, <code>&lt;br/&gt;</code>, or <code>&lt;br&gt;</code> HTML tags to break lines within table cells</li> <li>Code blocks with syntax highlighting</li> <li>Admonition blocks of types error, warning, success, or info</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#new-openid-sso-provider", "title": "New OpenID SSO provider", "text": "<p>TheHive now supports integration with an OpenID authentication provider, offering users Single Sign-On (SSO) access. While authentication via SAML and OAuth 2.0 was previously supported, OpenID, built on the OAuth2 authorization layer, simplifies the authentication process.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#hide-predefined-statuses", "title": "Hide predefined statuses", "text": "<p>You can now hide predefined statuses for cases and alerts, allowing users to see only the custom statuses you\u2019ve created. This provides a cleaner, more organized status list, displaying only relevant information for an improved user experience.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#ms-graph-api-for-email-intakes", "title": "MS Graph API for email intakes", "text": "<p>The Microsoft 365 Graph API connector is now available for email intakes. It uses the standard API recommended by Microsoft to connect and retrieve emails from a Microsoft mailbox.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#case-report-templates-display-the-description-of-custom-events", "title": "Case report templates: Display the description of custom events", "text": "<p>You can now hide or show the description of custom events in the timeline widget within case reports.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#improvements_8", "title": "Improvements", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#taxonomy-drawer", "title": "Taxonomy drawer", "text": "<p>The taxonomies component has been redesigned to provide an improved user experience.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#better-user-experience-for-custom-fields", "title": "Better user experience for custom fields", "text": "<p>The display of custom fields has been improved for better consistency and intuitiveness, making data entry and management more efficient while reducing errors.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#images-in-descriptions", "title": "Images in descriptions", "text": "<p>You can now display full-size images by dropping them directly into the descriptions of cases, alerts, and task logs. This improvement complements the existing attachment system, which displays images as attachments.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#status-visibility-in-the-tasks-tab-of-cases", "title": "Status visibility in the Tasks tab of cases", "text": "<p>The status of tasks is now clearly visible in each row of the Tasks tab in cases, enabling quick identification without needing to open the details.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#public-api-observable-route-optimization", "title": "Public API observable route optimization", "text": "<p>The observable creation routes in alerts and cases have been optimized, making the creation of dozens of observables five times faster.</p>"}, {"location": "thehive/release-notes/release-notes-5.5/#fixes_5", "title": "Fixes", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#ui", "title": "UI", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#dark-mode", "title": "Dark Mode", "text": "<ul> <li>Corrected rendering of tag colors in report analyzers.</li> <li>Fixed color display for failure messages on dashboards.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#others_1", "title": "Others", "text": "<ul> <li>MISP server connection: Improved by trimming the server URL.</li> <li>Attachment tab on cases: Fixed the counter to display the correct number. Filtering and sorting of attachments now work correctly.</li> <li>Case and alert closure: Added the ability to input multiple values in custom fields.</li> <li>Dashboards: <ul> <li>Selecting Audit in the Entity field is no longer allowed for any widget. Previously created widgets remain unaffected.</li> <li>Fixed an issue when using a date-type custom field as the date field in the widget.</li> </ul> </li> <li>Case export to MISP: Fixed an issue with attachments when exporting a case to MISP.</li> <li>Merged alert audits: Fixed a regression introduced in version 5.4.8 related to the JSON audit object of merged alerts. In the audit, the <code>object.*</code> field refers to the merged alert, while the <code>context.*</code> object refers to the case where the alert has been merged.</li> <li>Notification form: Improved the performance of the filteredEvent input.</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#documentation-updates", "title": "Documentation updates", "text": ""}, {"location": "thehive/release-notes/release-notes-5.5/#administration_1", "title": "Administration", "text": "<ul> <li>Authentication</li> <li>Organizations</li> <li>Cortex server connection</li> <li>Email intake connectors</li> <li>MISP integration</li> <li>Custom fields</li> <li>Taxonomies</li> <li>Case and alert statuses</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#configure-organization", "title": "Configure organization", "text": "<ul> <li>Notifications and endpoints</li> <li>Functions</li> <li>Templates</li> <li>Custom tags</li> </ul>"}, {"location": "thehive/release-notes/release-notes-5.5/#analysts-corner", "title": "Analyst's corner", "text": "<ul> <li>Closing alerts and cases</li> <li>Merging cases</li> <li>Task and task logs</li> <li>Case reports</li> <li>Case timelines</li> <li>Dashboards</li> <li>Knowledge Base</li> </ul>"}, {"location": "thehive/user-guides/automate-tracking-pending-alerts/", "title": "Tutorial: Automate Tracking of Pending Alerts", "text": ""}, {"location": "thehive/user-guides/automate-tracking-pending-alerts/#tutorial-automate-tracking-of-pending-alerts", "title": "Tutorial: Automate Tracking of Pending Alerts", "text": "<p>5.5 Platinum</p> <p>In this tutorial, we're going to set up an automation in TheHive to monitor alerts that stay in the New status and remain unassigned for too long.</p> <p>By the end, you'll have a working configuration that:</p> <ul> <li>Detects alerts that remain unassigned and in New status for more than four hours</li> <li>Flags them with a custom status to indicate they need review</li> <li>Sends an email notification to the manager</li> </ul> <p>This helps ensure no alert gets left behind without action.</p> <p>Customize criteria for your needs</p> <p>The status and wait time criteria used in this tutorial are just a starting point. Feel free to adjust them based on your team\u2019s triage and escalation practices.</p>"}, {"location": "thehive/user-guides/automate-tracking-pending-alerts/#step-1-create-a-custom-alert-status-to-flag-pending-alerts", "title": "Step 1: Create a custom alert status to flag pending alerts", "text": "<p>To highlight alerts needing review, start by creating a new alert status in TheHive.</p> <p>Follow the steps in Create a Status, using the following values:</p> <p>Values to use for the new TOREVIEW status</p> Field Value <code>Visibility</code> Display <code>Stage</code> New <code>Value</code> TOREVIEW"}, {"location": "thehive/user-guides/automate-tracking-pending-alerts/#step-2-set-up-an-email-notification-for-toreview-alerts", "title": "Step 2: Set up an email notification for TOREVIEW alerts", "text": "<p>Next, configure TheHive to send an email notification to the manager when an alert status changes to TOREVIEW.</p> <p>Follow the steps in Create a Notification, using the following values:</p> <p>Values to use for the email notification</p> <p>To verify that your notification works as expected, manually change the status of an alert to TOREVIEW. This action should trigger an email to the configured recipient. If the email arrives, you're all set to move on to the final step!</p>"}, {"location": "thehive/user-guides/automate-tracking-pending-alerts/#trigger", "title": "Trigger", "text": "<p>As the trigger, select FilteredEvent and enter the following custom filter:</p> <pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"objectType\": \"Alert\"\n            }\n        },\n        {\n            \"_is\": {\n                \"action\": \"update\"\n            }\n        },\n        {\n            \"_contains\": {\n                \"_field\": \"details.status\",\n                \"_value\": \"TOREVIEW\"\n            }\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/user-guides/automate-tracking-pending-alerts/#notifier", "title": "Notifier", "text": "<p>As the notifier, select EmailerToAddr.</p> <p>Email template example:</p> <pre><code>Hello,\n\nThe following alert has been pending for a while and requires your priority review:\n\n* ID: {{audit.objectId}}\n* Title: {{audit.object.title}}\n\nYou can access the full alert details here: https://&lt;your-thehive-url&gt;/alerts/{{audit.objectId}}/details\n</code></pre>"}, {"location": "thehive/user-guides/automate-tracking-pending-alerts/#step-3-automate-status-updates-using-an-alert-feeder", "title": "Step 3: Automate status updates using an alert feederNext steps", "text": "<p>Create an alert feeder that automatically updates the status of unassigned new alerts older than four hours.</p> <p>This alert feeder will periodically:</p> <ul> <li>Search for alerts that meet the criteria</li> <li>Update their status to TOREVIEW</li> </ul> <p>Follow the steps in Create an Alert Feeder, using the following values:</p> <p>Values to use for the ChangePendingAlertStatus alert feeder</p> Field Value <code>Method</code> GET <code>URL</code> https:///api/v1/status/public/ <code>Authentication</code> None <p>Use this function definition:</p> <pre><code>// Name: ChangePendingAlertStatus \n// Type: Feeder\n// Desc: This function retrieves all alerts with status New that are unassigned and were created more than four hours ago, then updates their status to TOREVIEW.\n\nfunction handle(input, context) {\n\n    // Retrieve all alerts where status is New, assignee is empty, and creation date is older than four hours\n    const query = [\n        {\n            \"_name\":\"listAlert\",\n        },\n        {\n            \"_name\":\"filter\",\n            \"_eq\":\n                { \n            \"_field\":\"status\", \n            \"_value\":\"New\" \n                }\n        },\n        {\n            \"_name\":\"filter\",\n            \"_not\":\n            {\n                \"_has\":\n                {\n                    \"_field\":\"assignee\"\n                }\n            }\n        },\n        {\n            \"_name\":\"filter\",\n            \"_lte\":\n            {\n                \"_field\": \"_createdAt\",\n                \"_value\": \n                {\n                    \"amount\": 4,\n                    \"unit\": \"hours\",\n                    \"look\": \"behind\" \n                }\n            } \n        }\n    ];\n\n    // Execute the search to get the targeted alerts\n    const alertList = context.query.execute(query);\n\n    // Update the status to TOREVIEW for all matching alerts\n    alertList.map((alrt) =&gt; {\n        context.alert.update(alrt._id, {status: \"TOREVIEW\"});\n    });\n}\n</code></pre> <ul> <li>Create a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/change-account-theme/", "title": "Change your Account Theme", "text": ""}, {"location": "thehive/user-guides/change-account-theme/#change-your-account-theme", "title": "Change your Account Theme", "text": "<p>5.4</p> <p>TheHive uses the light theme by default for all users.</p> <p>This topic provides step-by-step instructions for changing the user interface theme of your user account in TheHive. </p> <p>Persistent preferences</p> <p>Theme preferences are stored locally. If you access TheHive from another device or browser, you'll need to set your preferred theme again.</p> Procedure <ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Themes.</p> </li> <li> <p>Select one of the three options:</p> <ul> <li> <p>Light: Uses a light background with dark text for a brighter interface.</p> </li> <li> <p>Dark: Uses a dark background with light text to reduce eye strain in low-light environments.</p> </li> <li> <p>System: Matches the theme of your operating system settings automatically.</p> </li> </ul> </li> </ol> Next steps <ul> <li>Log Out of your Account</li> <li>Switch Organizations</li> <li>Manage your Password</li> <li>Manage your Account Settings</li> <li>View your Account Profile and Permissions</li> </ul>"}, {"location": "thehive/user-guides/date-field-definitions-alerts-cases/", "title": "Date Field Definitions", "text": ""}, {"location": "thehive/user-guides/date-field-definitions-alerts-cases/#date-field-definitions-for-alerts-and-cases", "title": "Date Field Definitions for Alerts and Cases", "text": "<p>This topic defines each date field used in alerts and cases in TheHive.</p> <p>Stages and statuses</p> <p>Some of those dates are based on the stage of alerts and cases. To learn more about how statuses and stages interact, see About Statuses.</p>"}, {"location": "thehive/user-guides/date-field-definitions-alerts-cases/#date-field-definitions-for-alerts", "title": "Date field definitions for alerts", "text": "API field Definition <code>date</code> The time the event occurred. Corresponds to the Occurred date field in the UI. <code>_createdAt</code> The time the alert was created in TheHive. <code>_updatedAt</code> The last time the alert was modified. <code>newDate</code> The first time the alert entered a status linked to the New stage. <code>inProgressDate</code> The first time the alert entered a status linked to the In progress stage. <code>closedDate</code> The first time the alert entered a status linked to the Closed stage because no further investigation was required. <code>importedDate</code> The first time the alert entered the Imported status after being merged into a new or existing case for investigation."}, {"location": "thehive/user-guides/date-field-definitions-alerts-cases/#date-field-definitions-for-cases", "title": "Date field definitions for casesNext steps", "text": "API field Definition <code>startDate</code> The time the event occurred. Corresponds to the Start date field in the UI. <code>_createdAt</code> The time the case was created in TheHive. <code>_updatedAt</code> The last time the case was modified. <code>newDate</code> The first time the case entered a status linked to the New stage. <code>inProgressDate</code> The first time the case entered a status linked to the In progress stage. <code>closedDate</code> The first time the case entered a status linked to the Closed stage because the investigation was completed. <code>endDate</code> The time the event actually ended. By default, this corresponds to the last time the case entered a status linked to the Closed stage. You can modify this value via the API to reflect the actual end time of the incident. <ul> <li>Key Performance Indicators</li> <li>Measure Case Performance</li> <li>Measure Alert Performance</li> </ul>"}, {"location": "thehive/user-guides/log-out/", "title": "Log Out of your Account", "text": ""}, {"location": "thehive/user-guides/log-out/#log-out-of-your-account", "title": "Log Out of your Account", "text": "<p>This topic provides step-by-step instructions for logging out of your user account in TheHive.</p> Procedure <ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Logout.</p> </li> </ol> Next steps <ul> <li>Switch Organizations</li> <li>Change your Account Theme</li> <li>Manage your Password</li> <li>Manage your Account Settings</li> <li>View your Account Profile and Permissions</li> </ul>"}, {"location": "thehive/user-guides/manage-password/", "title": "Manage your Password", "text": ""}, {"location": "thehive/user-guides/manage-password/#manage-your-password", "title": "Manage your Password", "text": "<p>This topic provides step-by-step instructions for managing the password of your user account in TheHive.</p>"}, {"location": "thehive/user-guides/manage-password/#reset-your-password", "title": "Reset your password", "text": "<p>Use this procedure if you\u2019ve forgotten your password and need to create a new one.</p> <ol> <li> <p>From the login page, select I forgot my password.</p> <p></p> </li> <li> <p>Enter your login information and select Send.</p> <p></p> </li> </ol> <p>You will receive an email with a link to set a new password. The link is valid for a limited time.</p>"}, {"location": "thehive/user-guides/manage-password/#edit-your-password", "title": "Edit your passwordNext steps", "text": "<p>Use this procedure to change your current password.</p> <ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>Select the Password tab.</p> </li> <li> <p>Enter your current and new password.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Log Out of your Account</li> <li>Switch Organizations</li> <li>Change your Account Theme</li> <li>Manage your Account Settings</li> <li>View your Account Profile and Permissions</li> </ul>"}, {"location": "thehive/user-guides/manage-user-settings/", "title": "Manage your Account Settings", "text": ""}, {"location": "thehive/user-guides/manage-user-settings/#manage-your-account-settings", "title": "Manage your Account Settings", "text": "<p>This topic provides step-by-step instructions for managing the settings of your user account in TheHive.</p>"}, {"location": "thehive/user-guides/manage-user-settings/#edit-your-avatar", "title": "Edit your avatar", "text": "<ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the Infos tab, select the avatar, then select a new image in PNG or JPG format. The file must be smaller than 500 KB.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/manage-user-settings/#edit-your-name", "title": "Edit your name", "text": "<ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the Infos tab, edit your name.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/manage-user-settings/#edit-your-email-address", "title": "Edit your email address", "text": "<ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the Infos tab, edit your email address. The email address is used to send you notifications and password-related information.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/manage-user-settings/#manage-your-api-key", "title": "Manage your API key", "text": "<ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the API key tab, select Renew, Reveal, or Revoke, depending on the action you want to take.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/manage-user-settings/#activate-multi-factor-authentication", "title": "Activate multi-factor authentication", "text": "<p>Use this procedure to add an extra layer of security to your account.</p> <ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the MFA tab, follow the on-screen instructions to activate multi-factor authentication.</p> </li> </ol>"}, {"location": "thehive/user-guides/manage-user-settings/#edit-your-homepage", "title": "Edit your homepage", "text": "<ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the Options tab, select the page you want to use as your homepage.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/manage-user-settings/#edit-the-default-date-format", "title": "Edit the default date format", "text": "<ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the Options tab, select the date format you want to use.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/manage-user-settings/#activate-the-beta-of-filters-and-views", "title": "Activate the beta of filters and viewsNext steps", "text": "<p>5.5.6</p> <p>A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables.</p> <p>Views persistence</p> <p>Use this beta feature for one-time testing only:</p> <ul> <li>When you activate the beta for the first time, views from the current version are automatically copied to the beta. However, if you deactivate and then reactivate the beta, views won't be copied again.</li> <li>Views you create while using the beta won't be retained in version 5.6 and will be lost if you deactivate the beta.</li> </ul> <ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the Options tab, turn on the Use the new beta filters view toggle.</p> <p></p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Log Out of your Account</li> <li>Switch Organizations</li> <li>Change your Account Theme</li> <li>Manage your Password</li> <li>View your Account Profile and Permissions</li> </ul>"}, {"location": "thehive/user-guides/switch-organizations/", "title": "Switch Between Organizations", "text": ""}, {"location": "thehive/user-guides/switch-organizations/#switch-between-organizations", "title": "Switch Between Organizations", "text": "<p>This topic provides step-by-step instructions for switching between organizations in TheHive.</p> Procedure <ol> <li> <p>From any view, select the organization symbol.</p> <p></p> </li> <li> <p>Select the organization you want to switch to.</p> </li> </ol> Next steps <ul> <li>Log Out of your Account</li> <li>Change your Account Theme</li> <li>Manage your Password</li> <li>Manage your Account Settings</li> <li>View your Account Profile and Permissions</li> </ul>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/", "title": "Flavored Markdown Syntax", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#thehive-flavored-markdown-syntax-reference", "title": "TheHive-Flavored Markdown Syntax Reference", "text": "<p>This topic provides a reference for TheHive-flavored Markdown syntax.</p> <p>Markdown is a lightweight markup language designed to format plain text using simple syntax. It allows users to create structured documents, including headings, lists, links, and code blocks, without relying on complex formatting tools.</p> <p>TheHive uses a customized version of Markdown, known as TheHive-flavored Markdown. This tailored syntax extends the standard Markdown features to support additional formatting options and functionalities specific to TheHive.</p>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#headings", "title": "Headings", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax", "title": "Syntax", "text": "<pre><code># h1 Heading\n## h2 Heading\n### h3 Heading\n#### h4 Heading\n##### h5 Heading\n###### h6 Heading\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering", "title": "Rendering", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#horizontal-rules", "title": "Horizontal rules", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_1", "title": "Syntax", "text": "<pre><code>--- or *** or ___\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_1", "title": "Rendering", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#emphasis", "title": "Emphasis", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_2", "title": "Syntax", "text": "<pre><code>**This is bold text** or __This is bold text__    \n*This is italic text* or _This is italic text_    \n~~Strikethrough~~\n++This is underlined text++\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_2", "title": "Rendering", "text": "<p>This is bold text</p> <p>This is italic text</p> <p>~~Strikethrough~~</p> <p>++This is underlined text++</p>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#admonition-blocks", "title": "Admonition blocks", "text": "<p>5.5</p>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_3", "title": "Syntax", "text": "<pre><code>::: error\nThis block highlights critical information or errors that require immediate attention.\n:::\n\n::: warning\nThis block alerts users to potential issues or important precautions to consider.\n:::\n\n::: success\nThis block confirms that an action was completed successfully.\n:::\n\n::: info\nThis block provides additional information or helpful tips.\n:::\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_3", "title": "Rendering", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#blockquotes", "title": "Blockquotes", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_4", "title": "Syntax", "text": "<pre><code>&gt; Blockquotes can also be nested...\n&gt;&gt; ...by using additional greater-than signs right next to each other...\n&gt; &gt; &gt; ...or with spaces between arrows.\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_4", "title": "Rendering", "text": "<p>Blockquotes can also be nested...</p> <p>...by using additional greater-than signs right next to each other...</p> <p>...or with spaces between arrows.</p>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#lists", "title": "Lists", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#unordered", "title": "Unordered", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_5", "title": "Syntax", "text": "<pre><code>+ Create a list by starting a line with `+`, `-`, or `*`\n+ Sub-lists are made by indenting 2 spaces:\n- Marker character change forces new list start:\n    * Ac tristique libero volutpat at\n    + Facilisis in pretium nisl aliquet\n    - Nulla volutpat aliquam velit\n+ Very easy!\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_5", "title": "Rendering", "text": "<ul> <li>Create a list by starting a line with <code>+</code>, <code>-</code>, or <code>*</code></li> <li>Sub-lists are made by indenting 2 spaces:</li> <li>Marker character change forces new list start:<ul> <li>Ac tristique libero volutpat at</li> <li>Facilisis in pretium nisl aliquet</li> <li>Nulla volutpat aliquam velit</li> </ul> </li> <li>Very easy!</li> </ul>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#ordered", "title": "Ordered", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_6", "title": "Syntax", "text": "<pre><code>1. Lorem ipsum dolor sit amet\n1. Consectetur adipiscing elit\n3. Integer molestie lorem at massa\n42. Fusce lobortis nisi nec mi scelerisque, at tincidunt nisi ullamcorper\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_6", "title": "Rendering", "text": "<ol> <li>Lorem ipsum dolor sit amet</li> <li>Consectetur adipiscing elit</li> <li>Integer molestie lorem at massa</li> <li>Fusce lobortis nisi nec mi scelerisque, at tincidunt nisi ullamcorper</li> </ol>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#code", "title": "Code", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_7", "title": "Syntax", "text": "<pre><code>Inline `code` with `\n\n```\nSample code here...\n```\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_7", "title": "Rendering", "text": "<p>Inline <code>code</code> with `</p> <pre><code>Sample code here...\n</code></pre> <p>5.5 Code block with syntax highlighting</p> <p>You can enable syntax highlighting by specifying the language name after the opening backticks.</p> <p>Syntax</p> <pre><code>``` python\nprint(\"Hello, bees!\")\n```\n</code></pre> <p>Rendering</p> <p></p><pre><code>print(\"Hello, bees!\")\n</code></pre> See the Highlight.js documentation for a list of supported languages.<p></p>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#tables", "title": "Tables", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_8", "title": "Syntax", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#alignment-on-the-left", "title": "Alignment on the left", "text": "<pre><code>| Option | Description |\n| ------ | ----------- |\n| data   | Path to data files to supply the data that will be passed into templates. |\n| engine | Engine to be used for processing templates. Handlebars is the default. |\n| ext    | Extension to be used for dest files. |\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#alignment-on-the-right", "title": "Alignment on the right", "text": "<pre><code>| Option | Description |\n| ------:| -----------:|\n| data   | Path to data files to supply the data that will be passed into templates. |\n| engine | Engine to be used for processing templates. Handlebars is the default. |\n| ext    | Extension to be used for dest files. |\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_8", "title": "Rendering", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#alignment-on-the-left_1", "title": "Alignment on the left", "text": "Option Description data path to data files to supply the data that will be passed into templates. engine engine to be used for processing templates. Handlebars is the default. ext extension to be used for dest files."}, {"location": "thehive/user-guides/thehive-flavored-markdown/#alignment-on-the-right_1", "title": "Alignment on the right", "text": "Option Description data Path to data files to supply the data that will be passed into templates. engine Engine to be used for processing templates. Handlebars is the default. ext Extension to be used for dest files. <p>5.5 Breaking lines in tables</p> <p>You can break lines within table cells by using the <code>&lt;br /&gt;</code>, <code>&lt;br/&gt;</code>, or <code>&lt;br&gt;</code> HTML tags. This feature is limited to table cells and doesn't work elsewhere.</p>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#links", "title": "Links", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_9", "title": "Syntax", "text": "<pre><code>[Link text](https://docs.strangebee.com/thehive/overview/)\n[Link with title](https://docs.strangebee.com/thehive/overview/ \"title text!\")\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_9", "title": "Rendering", "text": "<p>Link text</p> <p>Link with title</p>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#images", "title": "Images", "text": ""}, {"location": "thehive/user-guides/thehive-flavored-markdown/#syntax_10", "title": "Syntax", "text": "<pre><code>![TheHive](https://docs.strangebee.com/thehive/images/user-guides/organization/configure-organization/organization-view.png)\n![Cortex](https://docs.strangebee.com/cortex/user-guides/images/update.png \"Cortex\")\n\nSimilar to links, images can also use footnote-style syntax:\n![Alt text][id]\n\nWith a reference later in the document to define the URL location:\n[id]: https://docs.strangebee.com/thehive/images/user-guides/organization/configure-organization/organization-view.png  \"Organization view\"\n</code></pre>"}, {"location": "thehive/user-guides/thehive-flavored-markdown/#rendering_10", "title": "Rendering", "text": "Next steps <ul> <li>About the Knowledge Base</li> </ul>"}, {"location": "thehive/user-guides/view-permissions/", "title": "View your Account Profile and Permissions", "text": ""}, {"location": "thehive/user-guides/view-permissions/#view-your-account-profile-and-permissions", "title": "View your Account Profile and Permissions", "text": "<p>This topic provides step-by-step instructions for viewing the profile and permissions of your user account in TheHive.</p> <p>Profile and permissions per organization</p> <p>Keep in mind that your profile and its associated permissions depend on the organization you are currently using.</p> Procedure <ol> <li> <p>From any view, select the user symbol.</p> <p></p> </li> <li> <p>Select Settings.</p> </li> <li> <p>In the Infos tab, check in the Profile field the profile you are assigned to for the organization you're currently using.</p> </li> <li> <p>In the Permissions list section, check the permissions associated to this profile.</p> </li> </ol> <p>If you need additional permissions, contact someone with admin-level permissions to update your current profile with new permissions.</p> Next steps <ul> <li>Log Out of your Account</li> <li>Switch Organizations</li> <li>Change your Account Theme</li> <li>Manage your Password</li> <li>Manage your Account Settings</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/about-autorefresh/", "title": "About Autorefresh", "text": ""}, {"location": "thehive/user-guides/analyst-corner/about-autorefresh/#about-autorefresh", "title": "About Autorefresh", "text": "<p>Autorefresh is a feature that automatically refreshes lists to display new elements in TheHive.</p> <p>This topic explains how autorefresh works in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-autorefresh/#update-frequency", "title": "Update frequency", "text": "<p>When turned on, autorefresh updates the lists every time there is an event worth mentioning in the Live Feed.</p> <p></p>"}, {"location": "thehive/user-guides/analyst-corner/about-autorefresh/#manual-refresh", "title": "Manual refreshNext steps", "text": "<p>If users prefer not to configure autorefresh, they can still manually update their lists.</p> <p></p> <ul> <li>About the Live Feed</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/", "title": "About Filtering and Sorting", "text": ""}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#about-filtering-and-sorting", "title": "About Filtering and Sorting", "text": "<p>This topic explains how filtering and sorting work in TheHive.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#filtering-elements", "title": "Filtering elements", "text": "<p>Filtering in TheHive refines displayed lists across multiple views.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#applying-filters", "title": "Applying filters", "text": "<p>Applying filters requires turning on the Filters toggle at the top right of the page to access filtering options and manually enter filter values.</p> <p></p> <p>When available, these quicker alternatives provide filtering options without manual value entry:</p> <ul> <li> <p>Using predefined quick filters</p> <p>Select the Quick filters dropdown to access predefined filters. All users have access to these filters and can't modify them.</p> <p></p> </li> <li> <p>Selecting values directly from a list</p> <p>Select specific values within a list to apply filters dynamically.</p> <p></p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#filter-logic", "title": "Filter logic", "text": "<p>Filters are combined using the <code>AND</code> operator, meaning all selected conditions must be met.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#saving-filters", "title": "Saving filters", "text": "<p>Applied filters can be saved in a view to avoid reapplying them repeatedly. Selecting the saved view applies the filters automatically.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#sorting-elements", "title": "Sorting elements", "text": ""}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#applying-sorting", "title": "Applying sorting", "text": "<p>Sorting in TheHive organizes displayed lists across various views.</p> <p>Selecting the small arrows next to a field name sorts the list. The first click sorts in ascending order, the second click sorts in descending order, and the third click removes the sorting. The field name and selected arrow highlight to indicate the active sort.</p> <p></p>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#sorting-logic", "title": "Sorting logic", "text": "<p>Sorting applies to only one field at a time, as multiple-field sorting isn't supported.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-filtering-and-sorting/#saving-sorting", "title": "Saving sorting", "text": "<p>Applied sorting can be saved in a view to avoid reapplying it repeatedly. Selecting the saved view applies the stored sorting automatically.</p> Next steps <ul> <li>About Views</li> <li>Create a Custom View</li> <li>Update a Custom View</li> <li>Delete a Custom View</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/about-live-feed/", "title": "About the Live Feed", "text": ""}, {"location": "thehive/user-guides/analyst-corner/about-live-feed/#about-the-live-feed", "title": "About the Live Feed", "text": "<p>The Live Feed is a feature that displays the latest key events from the audit logs.</p> <p>This topic explains what the Live Feed covers.</p> <p></p> <p></p>"}, {"location": "thehive/user-guides/analyst-corner/about-live-feed/#elements", "title": "Elements", "text": "<p>The Live Feed contains links to cases, alerts, and observables.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-live-feed/#scope", "title": "Scope", "text": "<p>The results in the Live Feed depend on the user's context. In global views, it displays all types of events.</p> <p>When viewing a case description, alert description, task details, or observable details, it only shows events related to the respective item.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-live-feed/#limits", "title": "LimitsNext steps", "text": "<p>For performance reasons, the Live Feed displays only the last 10 events from the past 24 hours.</p> <ul> <li>About Audit Logs</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/about-statistics/", "title": "About Statistics", "text": ""}, {"location": "thehive/user-guides/analyst-corner/about-statistics/#about-statistics", "title": "About Statistics", "text": "<p>Predefined statistics are available in TheHive for cases, alerts, and observables lists.</p> <p>This topic describes the predefined statistics available in TheHive.</p> <p></p> <p>For custom statistics and dashboards, refer to the About Dashboards topic.</p>"}, {"location": "thehive/user-guides/analyst-corner/about-statistics/#available-statistics", "title": "Available statistics", "text": "<p>Cases statistics available:</p> <ul> <li>Cases by status</li> <li>Cases by severity</li> </ul> <p>Alerts statistics available:</p> <ul> <li>Alerts by status</li> <li>Alerts by type</li> </ul> <p>Observables statistics available:</p> <ul> <li>Observables by data type</li> <li>Observables as indicator of compromise (IOC)</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/about-statistics/#filters-on-statistics", "title": "Filters on statisticsNext steps", "text": "<p>Selecting a value in the statistics automatically filters the lists based on that value.</p> <ul> <li>Create a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/preview-vs-detail-view/", "title": "Detail View vs. Preview", "text": ""}, {"location": "thehive/user-guides/analyst-corner/preview-vs-detail-view/#detail-view-vs-preview", "title": "Detail View vs. Preview", "text": "<p>This topic explains the difference between preview and detail views in TheHive for cases, alerts, tasks, observables, TTPs, user accounts, and organizations\u2014so you know when to use each and what to expect from both.</p>"}, {"location": "thehive/user-guides/analyst-corner/preview-vs-detail-view/#whats-the-difference", "title": "What's the difference", "text": "<p>A detail view appears when you select an item. It opens a full page showing all available information and actions.</p> <p></p> <p>A preview appears when you hover over an item and select the  button. It opens a drawer with a summary\u2014without leaving your current view. If needed, you can access the full detail view directly from the preview.</p> <p></p>"}, {"location": "thehive/user-guides/analyst-corner/preview-vs-detail-view/#choosing-between-detail-view-and-preview", "title": "Choosing between detail view and previewNext steps", "text": "Feature Detail View Preview View and edit description \u2705 \u2705 View items (tasks, observables, or TTPs) \u2705 \u274c Add items (tasks, observables, or TTPs) \u2705 \u2705 View advanced information \u2705 \u274c Launch basic actions \u2705 \u2705 Launch advanced actions \u2705 \u274c <ul> <li>About Autorefresh</li> <li>About Filtering and Sorting</li> <li>About Views</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/", "title": "About Alerts", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#about-alerts", "title": "About Alerts", "text": "<p>This topic explains alerts, their components, and how they're created in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#definition", "title": "Definition", "text": "<p>An alert is a security event generated by detection tools such as SIEM, IDS, EDR, firewalls, or threat intelligence platforms like the Malware Information Sharing Platform (MISP). It serves as an early warning that helps analysts identify, investigate, and respond to potential threats.</p> <p>Alerts are reviewed and triaged, and converted into cases when further investigation is needed.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#sources", "title": "Sources", "text": "<p>Manual alert creation impossible</p> <p>TheHive doesn't allow manual alert creation. Alerts must originate from external tools connected to TheHive.</p> <p>The following sources can create alerts:</p> <ul> <li> <p>Detection tools, such as SIEM, IDS, EDR, and firewalls, that push data to TheHive</p> </li> <li> <p>5.5 External systems from which TheHive retrieves data using alert feeders</p> </li> <li> <p>Threat intelligence platforms like MISP connected to TheHive</p> </li> <li> <p>Email servers from which TheHive retrieves data.</p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#key-components", "title": "Key components", "text": "<p>In TheHive, an alert includes the following elements:</p> <ul> <li> <p>Observables: Data points such as IP addresses, file hashes, domains, and email addresses that are relevant to an investigation.</p> </li> <li> <p>TTPs: The methods and strategies used by attackers, based on the MITRE ATT&amp;CK knowledge base.</p> </li> <li> <p>Attachments: Files attached to an alert. Adding an image to an alert\u2019s description or summary automatically saves it in the alert\u2019s Attachments tab. Attachments can also be added manually.</p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#triage-outcomes", "title": "Triage outcomes", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#creating-cases-from-alerts", "title": "Creating cases from alerts", "text": "<p><code>manageAlert/import</code></p> <p>Create cases from alerts when further investigation is needed and no related investigation is already in progress.</p> <p>This action automatically creates a link between the alert and the case.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#adding-alerts-to-existing-cases", "title": "Adding alerts to existing cases", "text": "<p><code>manageAlert/import</code></p> <p>Alerts can be added to existing cases if they relate to an ongoing investigation.</p> <p>This action automatically creates a link between the alert and the case.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#closing-alerts", "title": "Closing alerts", "text": "<p><code>manageAlert/update</code></p> <p>Close alerts when they are not worth escalating into a new case or an existing case for further investigation. This may happen, for example, if the alert is a false positive or a duplicate.</p> <p>Closed alert can be reopened if needed.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#custom-fields-completion", "title": "Custom fields completion", "text": "<p>Alerts can't close if any required custom fields remain empty. Users can add or update values in custom fields during the closing process. However, they can't remove custom fields themselves.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/about-alerts/#statistics", "title": "StatisticsNext steps", "text": "<p>Predefined statistics in dashboards are available from the alerts list. For custom statistics and dashboards, refer to the About Dashboards topic.</p> <ul> <li>Find an Alert</li> <li>Enrich Alert Details</li> <li>Assign an Alert</li> <li>Start Investigating an Alert</li> <li>Ignore Alert Updates from MISP</li> <li>Change an Alert Status</li> <li>Create a Case from an Alert</li> <li>Add an Alert to an Existing Case</li> <li>Close an Alert</li> <li>Reopen an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/add-an-alert-to-an-existing-case/", "title": "Add an Alert to an Existing Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/add-an-alert-to-an-existing-case/#add-an-alert-to-an-existing-case", "title": "Add an Alert to an Existing Case", "text": "<p><code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for adding an alert to an existing case in TheHive.</p> <p>During triage, add an alert to an existing case if it needs further investigation and a similar case has already been created.</p> <p>If it requires a separate investigation, create a case from the alert.</p> <p>Data transfer</p> <p>When adding an alert to an existing case, data from the alert, including observables, TTPs, attachments, comments, and custom fields, is automatically transferred to the case.</p> <p>Link to case</p> <p>Adding an alert to an existing case automatically links the alert to the case.</p> Procedure <p>Bulk merge</p> <p>To add multiple alerts to an existing case, go to the Alerts view and select  next to each alert you want to include. Then select Merge selection into case above the list. This action merges all the selected alerts into a single case.</p> <p>By default, you can merge up to 50 alerts at once. You can change this limit using the <code>alert.maxMergeInCase</code> setting in the <code>application.conf</code> file. Proceed with caution: modifying this limit may affect platform stability.</p> <ol> <li> <p>Locate the alert you want to merge into an existing case.</p> </li> <li> <p>In the alert, select Merge alert into case.</p> <p></p> </li> <li> <p>In the Merge alerts into case drawer, search for the case by title or case number.</p> <p>Closed cases</p> <p>If you\u2019re unable to find closed cases, it means your organization has deactivated merging alerts into closed cases.</p> </li> <li> <p>Select Merge.</p> </li> </ol> Next steps <ul> <li>Add Tasks to a Case</li> <li>Add a Link to a Case</li> <li>Change a Case Status</li> <li>Restrict Case Visibility</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/assign-an-alert/", "title": "Assign an Alert", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/assign-an-alert/#assign-an-alert", "title": "Assign an Alert", "text": "<p><code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for assigning an alert in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/assign-an-alert/#assign-an-alert-to-yourself", "title": "Assign an alert to yourself", "text": "<ol> <li> <p>Go to the Alerts view from the sidebar menu.</p> <p></p> </li> <li> <p>Select  next to the alert you want to assign to yourself.</p> </li> <li> <p>Select Assign to me.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/alerts/assign-an-alert/#assign-an-alert-to-another-user", "title": "Assign an alert to another userNext steps", "text": "<ol> <li> <p>Find the alert you want to assign.</p> </li> <li> <p>In the alert, select an assignee in the left pane.</p> <p></p> </li> <li> <p>Select Save.</p> </li> </ol> <ul> <li>Change an Alert Status</li> <li>Ignore Alert Updates from MISP</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/change-status-alert/", "title": "Change an Alert Status", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/change-status-alert/#change-an-alert-status", "title": "Change an Alert Status", "text": "<p><code>manageAlert/update</code> <code>manageAlert/reopen</code></p> <p>This topic provides step-by-step instructions for changing the status of an alert in TheHive.</p> Procedure <ol> <li> <p>Find the alert you want to update.</p> </li> <li> <p>In the alert, move through the Status section in the left pane.</p> <p></p> </li> <li> <p>Select the new status from the dropdown list.</p> <p>Can't find a status?</p> <p>If you can't find the status you need, it may be due to one of the following reasons:</p> <ul> <li>The status isn't available from the alert description page. Statuses linked to the In progress stage are available only when starting the investigation of an alert or reopening a closed alert. Statuses linked to the Closed stage are available only when closing an alert.</li> <li>The status doesn't exist yet, or someone may have deleted or hidden it. Contact someone with admin-level permissions to create it or restore it.</li> </ul> </li> <li> <p>Select Save.</p> </li> </ol> Next steps <ul> <li>Start Investigating an Alert</li> <li>Assign an Alert</li> <li>Ignore Alert Updates from MISP</li> <li>Add an Alert to an Existing Case</li> <li>Create a Case from an Alert</li> <li>Run Responders and Review Reports for an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/close-an-alert/", "title": "Close an Alert", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/close-an-alert/#close-an-alert", "title": "Close an Alert", "text": "<p><code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for closing an alert in TheHive.</p> <p>Close an alert if it doesn't require escalation into a new or existing case for further investigation. This may happen, for example, if the alert is a false positive or a duplicate.</p> Procedure <ol> <li> <p>Find the alert you want to close.</p> </li> <li> <p>In the alert, select .</p> <p></p> </li> <li> <p>In the Change the alert status drawer, select the status that explains why the alert wasn't escalated to a new or existing case for further investigation.</p> </li> <li> <p>Optional: Enter a summary describing why the alert wasn't escalated to a case.</p> <p>5.5 You can add a full-size image by dropping it into the Summary field or selecting the  symbol.</p> <p>Wait for the upload to complete</p> <p>Wait until the image path appears in parentheses. If it doesn\u2019t, the upload is still in progress, and the image won\u2019t display as expected.</p> </li> <li> <p>Add or remove values in custom fields as needed. </p> <p>Custom fields completion</p> <p>You must complete all mandatory custom fields to close an alert.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Create a Case from an Alert</li> <li>Add an Alert to an Existing Case</li> <li>Change an Alert Status</li> <li>Reopen an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/create-a-case-from-an-alert/", "title": "Create a Case from an Alert", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/create-a-case-from-an-alert/#create-a-case-from-an-alert", "title": "Create a Case from an Alert", "text": "<p><code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for creating a case from an alert in TheHive.</p> <p>During triage, create a case from an alert if it needs further investigation and no case exists yet.</p> <p>If an investigation is already ongoing, add the alert to an existing case.</p> <p>Data transfer</p> <p>When creating a case from an alert, data from the alert, including observables, TTPs, attachments, comments, and custom fields, is automatically transferred to the case.</p> <p>Link to case</p> <p>Creating a case from an alert automatically links the alert to the case.</p> Procedure <p>Bulk merge</p> <p>To create a case from multiple alerts, go to the Alerts view and select  next to each alert you want to include. Then select New case from selection at the top of the screen. This action merges all the selected alerts into a single case.</p> <p>By default, you can merge up to 50 alerts at once. You can change this limit using the <code>alert.maxMergeInCase</code> setting in the <code>application.conf</code> file. Proceed with caution: modifying this limit may affect platform stability.</p> <ol> <li> <p>Locate the alert you want to merge into a new case.</p> </li> <li> <p>In the alert, select Create case from alert.</p> <p></p> </li> <li> <p>In the Create case drawer, select either Empty case or From template.</p> </li> <li> <p>Follow the instructions provided in the related sections:</p> <ul> <li>Create an empty case</li> <li>Create a case from a template</li> </ul> </li> </ol> Next steps <ul> <li>Add Tasks to a Case</li> <li>Add a Link to a Case</li> <li>Change a Case Status</li> <li>Restrict Case Visibility</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/enrich-alert-details/", "title": "Enrich Alert Details", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/enrich-alert-details/#enrich-alert-details", "title": "Enrich Alert Details", "text": "<p><code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for enriching alert details in TheHive.</p> <p>Status update</p> <p>When you enrich a new alert, its status automatically changes from one linked to the New stage to one linked to the In progress stage. To choose a different status within the In progress stage, see Change an Alert Status.</p> Procedure <ol> <li> <p>Find the alert you want to enrich.</p> </li> <li> <p>Update the following fields:</p> <p>- Title</p> <p>The title of the alert.</p> <p>- Tags</p> <p>Relevant tags for labeling the alert.</p> <p>- Description</p> <p>A description of the alert using TheHive-flavored Markdown syntax.</p> <p>5.5 You can add a full-size image by dropping it into the Description field or selecting the  symbol.</p> <p>Wait for the upload to complete</p> <p>Wait until the image path appears in parentheses. If it doesn\u2019t, the upload is still in progress, and the image won\u2019t display as expected.</p> <p>- Custom fields </p> <p>Custom fields for the alert, with or without predefined values.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Change an Alert Status</li> <li>Close an Alert</li> <li>Start Investigating an Alert</li> <li>Assign an Alert</li> <li>Ignore Alert Updates from MISP</li> <li>Add an Alert to an Existing Case</li> <li>Create a Case from an Alert</li> <li>Run Responders and Review Reports for an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/export-list-of-alerts/", "title": "Export a List of Alerts", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/export-list-of-alerts/#export-a-list-of-alerts", "title": "Export a List of Alerts", "text": "<p>This topic provides step-by-step instructions for exporting a list of alerts in TheHive.</p> Procedure <ol> <li> <p>Go to the Alerts view from the sidebar menu.</p> <p></p> </li> <li> <p>Select Export list to export all displayed alerts, reflecting the applied filters and sorting. To export a specific selection of alerts, select  next to the alerts you want to export, then select Export selection.</p> <p></p> </li> <li> <p>In the Export alerts to file drawer, select your preferred formatting options.</p> </li> <li> <p>Select Export to file.</p> </li> </ol> Next steps <ul> <li>Start Investigating an Alert</li> <li>Add an Alert to an Existing Case</li> <li>Create a Case from an Alert</li> <li>Assign an Alert</li> <li>Change an Alert Status</li> <li>Enrich Alert Details</li> <li>Close an Alert</li> <li>Reopen an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/ignore-alert-updates-misp/", "title": "Ignore Alert Updates from MISP", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/ignore-alert-updates-misp/#ignore-alert-updates-from-misp", "title": "Ignore Alert Updates from MISP", "text": "<p><code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for ignoring alert updates from the Malware Information Sharing Platform (MISP) in TheHive.</p> <p>MISP is an open-source threat intelligence platform that integrates with TheHive to retrieve events from MISP servers and convert them into alerts. By default, TheHive automatically updates these alerts when the corresponding MISP events change, which may also update the alerts\u2019 statuses.</p> <p>Use this procedure to turn off automatic updates for specific alerts.</p> <p>Requirements</p> <p>Automatic alert updates are available only for alerts created through MISP server integrations.</p> Procedure <ol> <li> <p>Find the alert you want to exclude from automatic updates.</p> </li> <li> <p>In the alert, select Ignore new updates.</p> <p></p> </li> </ol> Next steps <ul> <li>Change an Alert Status</li> <li>Start Investigating an Alert</li> <li>Assign an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/reopen-an-alert/", "title": "Reopen an Alert", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/reopen-an-alert/#reopen-an-alert", "title": "Reopen an Alert", "text": "<p><code>manageAlert/reopen</code></p> <p>This topic provides step-by-step instructions for reopening an alert in TheHive.</p> <p>Use this procedure to reopen a closed alert and change its status so that it moves from the Closed stage to the In progress stage.</p> Procedure <ol> <li> <p>Find the alert you want to reopen.</p> </li> <li> <p>In the alert, select Restart.</p> <p></p> </li> <li> <p>In the Change the alert status drawer, update the status for the alert, complete the analysis, and assign it to someone else if needed.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Change an Alert Status</li> <li>Ignore Alert Updates from MISP</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/run-responders-on-an-alert/", "title": "Run Responders and Review Reports for an Alert", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/run-responders-on-an-alert/#run-responders-and-review-reports-for-an-alert", "title": "Run Responders and Review Reports for an Alert", "text": "<p>This topic provides step-by-step instructions for running responders on an alert and reviewing responder reports in TheHive.</p> <p>Responders execute actions on cases, alerts, observables, tasks, and task logs.</p> <p>Run a responder on an alert to take actions such as closing an external ticket or executing a predefined response within TheHive.</p> <p>Observables not included</p> <p>Running a responder on an alert doesn't run it on the observables linked to the alert. To run responders on an observable, see Run Responders and Review Reports for an Observable.</p> <p>Running functions on an alert</p> <p>5.4 Did you know it\u2019s possible to run functions on alerts just like running responders? See Run a Function on a Case or an Alert for detailed instructions.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/run-responders-on-an-alert/#run-responders-on-an-alert", "title": "Run responders on an alert", "text": "<ol> <li> <p>Locate the alert on which you want to run responders.</p> </li> <li> <p>In the alert, select Responders.</p> <p></p> </li> <li> <p>In the Run actions on current alert drawer, select the responders you want to run.</p> </li> <li> <p>Select Launch actions.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/alerts/run-responders-on-an-alert/#review-responder-reports-for-an-alert", "title": "Review responder reports for an alertNext steps", "text": "<ol> <li> <p>Locate the alert on which you ran responders.</p> </li> <li> <p>In the alert, select the Responders tab to check the status of the executed responders.</p> <p></p> </li> </ol> <ul> <li>Enrich Alert Details</li> <li>Change an Alert Status</li> <li>Add an Alert to an Existing Case</li> <li>Create a Case from an Alert</li> <li>Close an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/start-investigating-an-alert/", "title": "Start Investigating an Alert", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/start-investigating-an-alert/#start-investigating-an-alert", "title": "Start Investigating an Alert", "text": "<p><code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for starting the investigation of an alert in TheHive.</p> <p>Use this procedure to start investigating a new alert and change its status so that it moves from the New stage to the In progress stage.</p> Procedure <ol> <li> <p>Find the alert you want to start investigating.</p> </li> <li> <p>In the alert, select Start.</p> <p></p> </li> <li> <p>In the Change the alert status drawer, update the status for the alert, write an initial analysis, and assign it to someone else if needed.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Change an Alert Status</li> <li>Ignore Alert Updates from MISP</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/unlink-alert-case/", "title": "Unlink an Alert and a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/unlink-alert-case/#unlink-an-alert-and-a-case", "title": "Unlink an Alert and a Case", "text": "<p>This topic provides step-by-step instructions for unlinking an alert and a case in TheHive.</p> <p>An alert is automatically linked to a case when you create a case from an alert or add an alert to an existing case.</p> <p>Status update</p> <p>When you unlink an alert from a case, its status automatically changes to one associated with the New stage, regardless of its previous status.</p> <p>Data transfer</p> <p>When unlinking an alert and a case, data from the alert, including observables, TTPs, attachments, comments, and custom fields, remains in the case.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/unlink-alert-case/#from-a-case", "title": "From a case", "text": "<ol> <li> <p>Find the case where you want to unlink alerts.</p> </li> <li> <p>In the case, select the Linked alerts tab.</p> <p></p> </li> <li> <p>Select  next to the alert you want to unlink.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select Unlink.</p> </li> <li> <p>Select OK.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/alerts/unlink-alert-case/#from-an-alert", "title": "From an alertNext steps", "text": "<p><code>manageAlert/update</code></p> <ol> <li> <p>Find the alert you want to unlink.</p> </li> <li> <p>In the alert, select Unlink.</p> <p></p> </li> <li> <p>Select OK.</p> </li> </ol> <ul> <li>View Alerts Linked to a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/find-an-alert/", "title": "Find an Alert", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/find-an-alert/#find-an-alert", "title": "Find an Alert", "text": "<p>Search for alerts in TheHive using different methods depending on your needs\u2014from quick searches to advanced filtering.</p> <p>If you\u2019re unsure which method to use, refer to the Overview of Search Methods for Alerts topic.</p> <p>Can't find an alert?</p> <p>Ensure autorefresh is turned on to automatically display new alerts in lists.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/find-an-alert/#method-1-similar-alerts", "title": "Method 1: Similar alerts", "text": "<p>Use this method if you want to find one or more alerts similar to a known alert and need to perform actions on them simultaneously.</p> <p>Filters</p> <p>Select the filters you want to apply on the Similar cases and Similar alerts tabs to find what you need faster.</p> <ol> <li> <p>Open a case, an alert, or a task, and select the Similar alerts tab.</p> <p></p> </li> <li> <p>Apply filters using any of these options individually or in combination:</p> <ul> <li> <p>Select Quick filters to access predefined filters.</p> <p></p> </li> <li> <p>Turn on the Filters toggle and enter one or more filters.</p> <p></p> </li> <li> <p>Select a value from a field to use it as a filter criterion.</p> <p></p> </li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> <p>For more information, see the Find Similar Alerts and Cases topic.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/find-an-alert/#method-2-filters-in-the-alerts-view", "title": "Method 2: Filters in the Alerts view", "text": "<p>Use this method if you need to search for one or more alerts to perform actions on them simultaneously.</p> <ol> <li> <p>Go to the Alerts view from the sidebar menu.</p> <p></p> </li> <li> <p>Apply filters using any of these options individually or in combination:</p> <ul> <li> <p>Select Quick filters to access predefined filters.</p> <p></p> </li> <li> <p>Turn on the Filters toggle and enter one or more filters.</p> <p></p> </li> <li> <p>Select a value from a field to use it as a filter criterion.</p> <p></p> </li> </ul> <p>Saving views</p> <p>If you frequently use filters, consider saving your preferences as views for easy reuse. For more information on filtering and sorting, see About Filtering and Sorting.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/find-an-alert/#method-3-global-search-feature", "title": "Method 3: Global Search featureNext steps", "text": "<p>Use this method if you need to conduct advanced searches for one or more alerts without requiring simultaneous actions.</p> <ol> <li> <p>Go to the Global Search view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Alerts item on the Search scope pane.</p> <p></p> <p>All elements</p> <p>Select the All elements item for a comprehensive tool-wide overview that includes all entity types, such as cases, alerts, observables, jobs, tasks, and task logs. Use this option to analyze cross-linked information or to conduct a detailed investigation.</p> </li> <li> <p>Enter the keywords you want to search for in the search box displayed by default.</p> <p>5.4.7 Wildcard character</p> <p>You can use the wildcard character * to broaden your searches.</p> <p>The wildcard character acts as a placeholder that matches zero or more characters, helping you find variations of a term or incomplete information.</p> <p>Examples of use cases:</p> <ul> <li>Email domains: Entering *@gmail.com will return entities containing the gmail.com domain.</li> <li>IP subnets: Entering 192.168.*.* will return entities with IP addresses in the 192.168.x.x subnet.</li> <li>URLs: Entering https://malwaredomain.com/* will return entities hosted under the malwaredomain.com directory.</li> </ul> <p>Other advanced search options, such as Boolean and phrase searches, are not currently supported.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p> </li> <li> <p>If you need additional filters, apply one or more filters by selecting Add new filter. </p> <p>These filters refine your search results and act as an equivalent to the AND operator in Boolean search.</p> <p>Required filters</p> <p>Filters are required for the following fields to ensure the search engine accurately interprets values:</p> <ul> <li>Fields with specific date formats</li> <li>Custom fields</li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> <ul> <li>Start Investigating an Alert</li> <li>Assign an Alert</li> <li>Ignore Alert Updates from MISP</li> <li>Add an Alert to an Existing Case</li> <li>Create a Case from an Alert</li> <li>Run Responders and Review Reports for an Alert</li> <li>Find Similar Alerts or Cases</li> <li>Close an Alert</li> <li>Reopen an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/overview-search-methods-alert/", "title": "Overview of Search Methods for Alerts", "text": ""}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/overview-search-methods-alert/#overview-of-search-methods-for-alerts", "title": "Overview of Search Methods for Alerts", "text": "<p>TheHive offers multiple methods for searching alerts, each tailored to specific scenarios.</p> <p>This topic provides an overview of the available search methods, compares their features, and explains when to use each one.</p> <p>Use this guide to choose the most effective method for your needs.</p>"}, {"location": "thehive/user-guides/analyst-corner/alerts/search-for-alerts/overview-search-methods-alert/#search-method-comparison", "title": "Search method comparisonNext steps", "text": "Method Filter options Result scope Allows bulk actions Use case Similar alerts Multiple Multiple Yes If you want to find one or more alerts similar to a known alert and need to perform actions on them simultaneously. Filters in the Alerts view Multiple Multiple Yes If you need to search for one or more alerts to perform actions on them simultaneously. Global Search feature Advanced Multiple No If you need to conduct advanced searches for one or more alerts without requiring simultaneous actions. <ul> <li>How to Find an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/", "title": "About Cases", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#about-cases", "title": "About Cases", "text": "<p>This topic explains cases in TheHive, their components, and how they work.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#definition", "title": "Definition", "text": "<p>A case is a structured entity used to track, investigate, and respond to security incidents, threats, or suspicious activities. It serves as a central repository where security teams organize information, collaborate on investigations, and document their findings.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#sources", "title": "Sources", "text": "<p>TheHive supports creating cases from the following sources:</p> <ul> <li> <p>Manual entry: Cases created through direct input by users.</p> </li> <li> <p>Merging cases: A new case created by merging two existing cases.</p> </li> <li> <p>Case templates: Predefined structures used to standardize case creation.</p> </li> <li> <p>Archived cases: Restored cases from previous investigations in TheHive.</p> </li> <li> <p>Malware Information Sharing Platform (MISP) event files: Cases created by manually importing MISP events.</p> </li> <li> <p>5.5 Alert feeders: Cases created from data retrieved from external systems using an alert feeder.</p> </li> <li> <p>Alerts: Cases generated from alerts received via connected detection tools (SIEM, EDR, IDS, or firewalls), threat intelligence platforms (like MISP), or email servers.</p> </li> <li> <p>Detection tools (SIEM, EDR, IDS, or firewalls): Cases created automatically by trusted detection tools, used when alert triage is managed within the tool or when the tool generates mostly true positives.</p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#key-components", "title": "Key components", "text": "<p>In TheHive, a case includes the following elements:</p> <ul> <li> <p>Observables: Data points such as IP addresses, file hashes, domains, and email addresses that are relevant to an investigation.</p> </li> <li> <p>Tasks: Actions assigned to analysts to analyze, assess, and mitigate threats.</p> </li> <li> <p>TTPs: The methods and strategies used by attackers, based on the MITRE ATT&amp;CK knowledge base.</p> </li> <li> <p>Attachments: Files attached to a case. Adding an image to a case description, summary, or task log automatically saves it in the Attachments tab of the case. Attachments can also be added manually.</p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#merging-cases", "title": "Merging cases", "text": "<p><code>manageCase/merge</code></p> <p>Cases can be merged if they're similar or part of the same investigation, enabling data centralization. </p> <p>To merge cases, they must belong to the same organization and share the same permission profile pairs. Merging consolidates two cases into a new one, combining their contents and deleting the originals.</p> <p>To learn how to merge cases, see Merge Cases.</p> <p>Merging also impacts:</p> <ul> <li>Restricted cases</li> <li>Linked elements</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#linking-elements", "title": "Linking elements", "text": "<p>5.5 <code>manageCase/update</code></p> <p>Alerts as linked elements</p> <p>Alerts can't be added to linked elements. An alert link is created automatically when a case is created from an alert or an alert is added to an existing case. To view alerts linked to a case, see View Alerts linked to a Case.</p> <p>Cases can be linked to other TheHive cases or external resources. These links enhance traceability and help visualize relationships between related incidents.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#link-categories", "title": "Link categories", "text": "<p>Links require categorization to indicate the type of relationship. If no category is specified, Internal link applies automatically for links between TheHive cases, and External link applies for links to external resources.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#link-display", "title": "Link display", "text": "<p>Users can only view links to cases in their organization and cases they have access to.</p> <p>Links automatically appear in both linked cases. Deleting a case automatically removes its related links.</p> <p>Case links aren't included in case exports, reports, or dashboards.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#actions", "title": "Actions", "text": "<p>Links can be added or removed in a case, but can't be modified once added.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#merging-cases-with-links", "title": "Merging cases with links", "text": "<ul> <li> <p>Merging cases combines links from both cases and removes duplicates based on the link and its type. Links pointing to the source merged cases are automatically removed.</p> </li> <li> <p>Creating a case from a MISP alert or merging a MISP alert into a case adds the MISP URL as an external link with the External alert link type. This link remains even if the alert is later unlinked from the case.</p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#closing-cases", "title": "Closing cases", "text": "<p><code>manageCase/update</code></p> <p>Cases can be closed once the investigation is complete.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#custom-fields-completion", "title": "Custom fields completion", "text": "<p>Cases can't be closed if any required custom fields remain empty. Users can add or update values in custom fields during the closing process. However, they can't remove custom fields themselves.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#case-visibility", "title": "Case visibility", "text": "<p>5.5 <code>manageCaseAccess/restrict</code> Platinum</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#usage", "title": "Usage", "text": "<p>Restricted case visibility controls access by limiting case viewing to specific team members and managers. This feature protects sensitive information and reduces the risk of unauthorized access.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#configuration", "title": "Configuration", "text": "<p>By default, cases created through the user interface are visible to all users in the organization.</p> <p>Visibility can be restricted to a specific group of users to secure sensitive cases and later restored if necessary. </p> <p>The case assignee and the user performing the action always have access and can't be removed.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#expected-behavior", "title": "Expected behavior", "text": "<p>When a case is set to restricted visibility, it doesn't appear in linked elements, case lists, search results, or dashboards for unauthorized users. However, alerts linked to restricted cases still display, marked with a  symbol. </p> <p>All related elements, including observables, tasks, and attachments, remain hidden as well. </p> <p>Unauthorized users can't be assigned to the case.</p> <p>Notifications behavior</p> <p>A case with restricted visibility still triggers configured notifications, regardless of who can view the case.</p> <p>Audit logs behavior</p> <p>When visibility is restricted on a case: - If you're using the default configuration with Apache Cassandra (JanusGraph) to store your audit logs, all associated audit logs, including those created earlier, immediately become private. - If you're using Elasticsearch to store your audit logs, all associated audit logs remain public. Audit logs retain the visibility they had at the time of creation, regardless of the current visibility of the case.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#indicators", "title": "Indicators", "text": "<p>For authorized users, a restricted case is identifiable by the  symbol in case descriptions, case lists, and linked elements, with an orange background color.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#merging-a-restricted-case", "title": "Merging a restricted case", "text": "<p>Merging one or more restricted cases with visible cases results in the merged case automatically inheriting restricted visibility.</p> <p>The list of authorized users includes all users who had access to any of the restricted cases involved in the merge.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/about-cases/#statistics", "title": "StatisticsNext steps", "text": "<p>Predefined statistics in dashboards are available from the cases list. For custom statistics and dashboards, refer to the About Dashboards topic.</p> <ul> <li>Find a Case</li> <li>Create a Case</li> <li>Merge Cases</li> <li>Restrict Case Visibility</li> <li>Restore Case Visibility</li> <li>Add a Link to a Case</li> <li>Remove a Link from a Case</li> <li>View Links in a Case</li> <li>Close a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/add-tasks-to-a-case/", "title": "Add Tasks to a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/add-tasks-to-a-case/#add-tasks-to-a-case", "title": "Add Tasks to a Case", "text": "<p>This topic provides step-by-step instructions for adding tasks to a case in TheHive.</p> Procedure <ol> <li> <p>Find the case where you want to add tasks.</p> </li> <li> <p>In the case, select the Tasks tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding a task drawer, enter the following information:</p> <p>- Group *</p> <p>The category your task belongs to. Tasks can be visually grouped by group for easier navigation. If the group doesn't exist, it will be created automatically.</p> <p>- Title *</p> <p>The name of the task, visible to users in the task list.</p> <p>- Mandatory *</p> <p>Specifies whether the task is required. Turn on the toggle to make it mandatory.</p> <p>- Description</p> <p>Additional details about the task. It appears when users view task details.</p> <p>- Assignee</p> <p>The person responsible for completing the task.</p> <p>- Flag this task? *</p> <p>Highlights the task for all users in the organization.</p> <p>- Due date</p> <p>The task\u2019s deadline.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Add a Link to a Case</li> <li>Apply a Case Template</li> <li>Merge Cases</li> <li>Restrict Case Visibility</li> <li>Share a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/apply-a-case-template/", "title": "Apply a Case Template", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/apply-a-case-template/#apply-a-case-template", "title": "Apply a Case Template", "text": "<p><code>manageCase/update</code></p> <p>This topic provides step-by-step instructions for applying a case template to an existing case in TheHive.</p> <p>If you want to apply a template to a new case, refer to the Create a Case topic.</p> Procedure <ol> <li> <p>Locate the case to apply the template.</p> </li> <li> <p>In the case, select the Apply a case template button.</p> <p></p> </li> <li> <p>In the Apply case template drawer, select a template from the dropdown list.</p> </li> <li> <p>Review the predefined values from the case template that you want to apply by selecting or clearing the checkboxes.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Add Tasks to a Case</li> <li>Add Custom Fields</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/change-case-alert-classification-settings/", "title": "Change Alert Classification Settings", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/change-case-alert-classification-settings/#change-case-or-alert-classification-settings", "title": "Change Case or Alert Classification Settings", "text": "<p><code>manageCase/update</code> <code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for changing the classification settings of a case or alert in TheHive, including severity, Traffic Light Protocol (TLP), and Permissible Actions Protocol (PAP).</p> Procedure <ol> <li> <p>Find the case or the alert you want to update.</p> </li> <li> <p>In the case or alert, move through the left pane.</p> <p></p> </li> <li> <p>Select the severity button to update its value. It indicates the severity level of the case or alert.</p> </li> <li> <p>Select the TLP button to update its value. It indicates how you can share information about the case or alert with others. Refer to the Malware Information Sharing Platform (MISP) taxonomy for detailed definitions of TLP values.</p> </li> <li> <p>Select the PAP button to update its value. It specifies which actions you can take with the data of the case or alert. Refer to the MISP taxonomy for detailed definitions of PAP values.</p> </li> </ol> Next steps <ul> <li>Change a Case Status</li> <li>Add a Link to a Case</li> <li>Apply a Case Template</li> <li>Share a Case</li> <li>Change an Alert Status</li> <li>Enrich Alert Details</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/change-status-case/", "title": "Change a Case Status", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/change-status-case/#change-a-case-status", "title": "Change a Case Status", "text": "<p><code>manageCase/update</code> <code>manageCase/reopen</code></p> <p>This topic provides step-by-step instructions for changing the status of a case in TheHive.</p> Procedure <ol> <li> <p>Find the case you want to update.</p> </li> <li> <p>In the case, move through the Status section in the left pane.</p> <p></p> </li> <li> <p>Select the new status from the dropdown list.</p> <p>Can't find a status?</p> <p>If you can't find the status you need, it may be due to one of the following reasons:</p> <ul> <li>The status isn't available from the case description page. Statuses linked to the Closed stage are available only when closing a case.</li> <li>The status doesn't exist yet, or someone may have deleted or hidden it. Contact someone with admin-level permissions to create it or restore it.</li> </ul> </li> <li> <p>Select Save.</p> </li> </ol> Next steps <ul> <li>Change Case or Alert Classification Settings</li> <li>Add a Link to a Case</li> <li>Apply a Case Template</li> <li>Share a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/close-a-case/", "title": "Close a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/close-a-case/#close-a-case", "title": "Close a Case", "text": "<p><code>manageCase/update</code></p> <p>This topic provides step-by-step instructions for closing a case in TheHive.</p> <p>Close the case when the investigation is complete.</p> <p>Pending tasks</p> <p>Closing a case also permanently closes all pending tasks. This action can't be undone.</p> Procedure <ol> <li> <p>Find the case you want to close.</p> </li> <li> <p>In the case, select .</p> <p></p> </li> <li> <p>In the Close case drawer, select the status that reflects the outcome of the investigation.</p> </li> <li> <p>Enter a summary describing the outcome of the investigation.</p> <p>5.5 You can add a full-size image by dropping it into the Summary field or selecting the  symbol.</p> <p>Wait for the upload to complete</p> <p>Wait until the image path appears in parentheses. If it doesn\u2019t, the upload is still in progress, and the image won\u2019t display as expected.</p> </li> <li> <p>Add or remove values in custom fields as needed. </p> <p>Custom fields completion</p> <p>You must complete all mandatory custom fields to close a case.</p> </li> <li> <p>Select Close tasks and case.</p> </li> </ol> Next steps <ul> <li>Export a Case to MISP</li> <li>Export an Archived Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/comment-on-case-alert/", "title": "Comment on Alerts", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/comment-on-case-alert/#comment-on-a-case-or-alert", "title": "Comment on a Case or Alert", "text": "<p><code>manageComment</code></p> <p>This topic provides step-by-step instructions for adding comments to a case or an alert in TheHive.</p> <p>Comments are visible to all organizations that share the case or alert.</p> <p>Use this procedure to provide feedback or leave notes for your team.</p> Procedure <ol> <li> <p>Find the case or alert where you want to add a comment.</p> </li> <li> <p>In the right pane of the screen, enter a comment.</p> <p></p> </li> <li> <p>Select .</p> </li> </ol> Next steps <ul> <li>Add Tasks to a Case</li> <li>Add a Link to a Case</li> <li>Enter Values in Custom Fields</li> <li>Add an Observable</li> <li>Add or Remove Tags</li> <li>Add Tactics, Techniques and Procedures</li> <li>Change Case or Alert Classification Settings</li> <li>Change a Case Status</li> <li>Flag a Case</li> <li>Assign an Alert</li> <li>Change an Alert Status</li> <li>Enrich Alert Details</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/", "title": "Create a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/#create-a-case", "title": "Create a Case", "text": "<p><code>manageCase/create</code></p> <p>This topic provides step-by-step instructions for creating a case in TheHive.</p> <p>Several options are offered to create a case in TheHive:</p> <ul> <li>Create an empty case</li> <li>Create a case from a template</li> <li>Create a case from an archived case</li> <li>Create a case from a MISP event</li> <li>Create a case from an alert</li> <li>Create a case from a detection tool</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/#create-an-empty-case", "title": "Create an empty case", "text": "<ol> <li> <p>From any view, select + Create case.</p> <p></p> </li> <li> <p>In the Create case drawer, select Empty case.</p> <p>Can't find the empty case option?</p> <p>If you don\u2019t see the empty case option, your organization has likely hidden it to ensure cases are created only from templates, archived cases, or MISP for better standardization.</p> </li> <li> <p>Enter the following fields:</p> <p>- Title * </p> <p>The title of the case.</p> <p>Date * </p> <p>The start date and time of the case. It indicates when the incident occured. By default, this field is pre-filled with the current date and time. This information is used to calculate KPIs.</p> <p>- Severity * </p> <p>The severity level for the case.</p> <p>- TLP (traffic light protocol) * </p> <p>The TLP level for the case. It indicates how you can share the case's information with others. Refer to the MISP taxonomy for detailed definitions of TLP values.</p> <p>- PAP (permissible actions protocol) * </p> <p>The PAP level for the case. It specifies which actions you can take with the case data. Refer to the MISP taxonomy for detailed definitions of PAP values.</p> <p>- Tags </p> <p>Relevant tags for labeling the case.</p> <p>- Description * </p> <p>A description of the case using TheHive-flavored Markdown syntax. </p> <p>5.5 You can add a full-size image by dropping it into the Description field or selecting the  symbol.</p> <p>Wait for the upload to complete</p> <p>Wait until the image path appears in parentheses. If it doesn\u2019t, the upload is still in progress, and the image won\u2019t display as expected.</p> <p>- Tasks </p> <p>Tasks for the case.</p> <p>- Custom fields </p> <p>Custom fields for the case, with or without predefined values.</p> <p>- Pages </p> <p>Pages to document the case.</p> <p>- Sharing </p> <p>By default, global sharing rules set at the organization level are applied when you create a new case. Here, you can modify these rules to apply local sharing settings to the case. You can modify local sharing rules for tasks and observables linked to the case after it is created. For more details, see the Share a Case topic.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> <p>Case template</p> <p>You can apply a case template after creating the case. For more details, see the Apply a Case Template topic.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/#create-a-case-from-a-template", "title": "Create a case from a template", "text": "<ol> <li> <p>From any view, select + Create case.</p> <p></p> </li> <li> <p>In the Create case drawer, select a template from the dropdown list in the From template section.</p> </li> <li> <p>In the Create case from template drawer, review the values inherited from the template and complete any missing ones. For more information about the fields, see the Create an empty case section.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/#create-a-case-from-an-archived-case", "title": "Create a case from an archived case", "text": "<p>Gold Platinum</p> <ol> <li> <p>From any view, select + Create case.</p> <p></p> </li> <li> <p>In the Create case drawer, select From archive (.thar).</p> </li> <li> <p>In the Import case drawer:</p> <p>- Attachment * </p> <p>Drop a THAR file directly into the Attachment section or select it from your computer. THAR files are TheHive archive files. Use the file you obtained from exporting an archived case.</p> <p>- Password * </p> <p>Enter the archive password that was set during the case export.</p> <p>- Sharing </p> <p>By default, global sharing rules set at the organization level are applied when you create a new case. Here, you can modify these rules to apply local sharing settings to the case. You can modify local sharing rules for tasks and observables linked to the case after it is created. For more details, see the Share a Case topic.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/#create-a-case-from-a-misp-event", "title": "Create a case from a MISP event", "text": "<p>See About MISP Integration to learn about how the Malware Information Sharing Platform (MISP) integrates with TheHive.</p> <p>Data transfer</p> <p>When creating a case from a MISP event, data from the event, such as observables, is automatically transferred to the case.</p> <ol> <li> <p>From any view, select + Create case.</p> <p></p> </li> <li> <p>In the Create case drawer, select From MISP (.json).</p> </li> <li> <p>In the Import from MISP drawer:</p> <p>- Attachment *</p> <p>Drop a JSON file directly into the Attachment section or select the JSON file from your computer. Refer to the MISP documentation to see how to export an event.</p> <p>- Tasks </p> <p>Tasks for the case.</p> <p>- Custom fields </p> <p>Custom fields for the case, with or without predefined values.</p> <p>- Sharing </p> <p>By default, global sharing rules set at the organization level are applied when you create a new case. Here, you can modify these rules to apply local sharing settings to the case. You can modify local sharing rules for tasks and observables linked to the case after it is created. For more details, see the Share a Case topic.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/#create-a-case-from-an-alert", "title": "Create a case from an alert", "text": "<p>Refer to the Create a Case from an Alert topic for instructions.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/create-a-new-case/#create-a-case-from-a-detection-tool", "title": "Create a case from a detection toolNext steps", "text": "<p>The creation of cases through detection tools is managed directly via the API.</p> <ul> <li>Apply a Case Template</li> <li>Add Tasks to a Case</li> <li>Add Custom Fields</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/delete-a-case/", "title": "Delete a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/delete-a-case/#delete-a-case", "title": "Delete a Case", "text": "<p><code>manageCase/delete</code></p> <p>This topic provides step-by-step instructions for deleting a case in TheHive.</p> <p>Use this procedure to permanently delete a case. To close a case because it's a false positive or duplicate, use Close a Case instead.</p> <p>Permanent action</p> <p>Deleting a case is an irreversible action. Once deleted, no one\u2014not even the StrangeBee Support team\u2014can recover the case.</p> Procedure <ol> <li> <p>Find the case you want to delete.</p> </li> <li> <p>In the case, select .</p> <p></p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Create a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/export-a-case-to-misp/", "title": "Export a Case to MISP", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/export-a-case-to-misp/#export-a-case-to-misp", "title": "Export a Case to MISP", "text": "<p>This topic provides step-by-step instructions for manually exporting a case to the Malware Information Sharing Platform (MISP) in TheHive.</p> <p>Use this procedure to share the results of your investigations with this open-source threat intelligence and sharing platform and contribute to the community.</p> <p>Only observables marked as indicators of compromise (IOCs) will be exported in the case. Once exported to MISP, any updates to the case IOCs is automatically synchronized with MISP, requiring no manual intervention.</p> <p>Requirements</p> <p>The MISP server you want to share your case with must be configured with either the Import and export or Export only purpose.</p> <p>MISP actions required</p> <p>The event created in MISP isn't published by default. You must review it and update its status in MISP to publish it.</p> Procedure <ol> <li> <p>Locate the case you want to export.</p> </li> <li> <p>In the case, select the Export button.</p> <p></p> </li> <li> <p>Select the relevant servers in the Export to MISP section.</p> </li> <li> <p>Select Export.</p> </li> </ol> Next steps <ul> <li>Create a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/export-an-archived-case/", "title": "Export an Archived Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/export-an-archived-case/#export-an-archived-case", "title": "Export an Archived Case", "text": "<p>Gold Platinum</p> <p>This topic provides step-by-step instructions for exporting an archived case in TheHive.</p> <p>Only for TheHive use</p> <p>TheHive configures exported cases to open only within the platform when you create a case based on a past investigation. Don't export an archived case for any other purpose, or you won't be able to open the file.</p> Procedure <ol> <li> <p>Locate the case you want to export.</p> </li> <li> <p>In the case, select the Export button.</p> <p></p> </li> <li> <p>Enter an archive password in the Export as an archive section. </p> <p>This password will be required when importing the archived case.</p> </li> <li> <p>Select Export archive to export the case in THAR format.</p> </li> </ol> Next steps <ul> <li>Create a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/export-list-of-cases/", "title": "Export a List of Cases", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/export-list-of-cases/#export-a-list-of-cases", "title": "Export a List of Cases", "text": "<p>This topic provides step-by-step instructions for exporting a list of cases in TheHive.</p> Procedure <ol> <li> <p>Go to the Cases view from the sidebar menu.</p> <p></p> </li> <li> <p>Select Export list to export all displayed cases, reflecting the applied filters and sorting. To export a specific selection of cases, select  next to the cases you want to export, then select Export selection.</p> <p></p> </li> <li> <p>In the Export cases to file drawer, select your preferred formatting options.</p> </li> <li> <p>Select Export to file.</p> </li> </ol> Next steps <ul> <li>Add Tasks to a Case</li> <li>Apply a Case Template</li> <li>Change a Case Status</li> <li>View Alerts Linked to a Case</li> <li>Close a Case</li> <li>Merge Cases</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/find-similar-alerts-cases/", "title": "Find Similar Alerts or Cases", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/find-similar-alerts-cases/#find-similar-alerts-or-cases", "title": "Find Similar Alerts or Cases", "text": "<p>This topic provides step-by-step instructions for finding similar alerts and cases in TheHive.</p> <p>Similarity checks between cases and alerts are based on observables.</p> <p>Use this procedure to identify similar cases or to correlate alerts with other alerts or with ongoing cases.</p> <p>Filters</p> <p>Select the filters you want to apply on the Similar cases and Similar alerts tabs to find what you need faster.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/find-similar-alerts-cases/#find-similar-alerts", "title": "Find similar alerts", "text": "<ol> <li> <p>Find the alert or case you want to compare for similarity.</p> </li> <li> <p>Select the Similar alerts tab.</p> <p></p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select See all in the Matches column to view the list of common observables.</p> <p>Performance optimization</p> <p>To optimize performance, a maximum of 100 observables are displayed in the Matches drawer. Users with an admin-type profile can adjust this limit in the <code>application.conf</code> file. However, increasing it beyond 100 may impact application performance. Proceed with caution when modifying this setting, as performance can't be guaranteed if the limit is raised.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/find-similar-alerts-cases/#find-similar-cases", "title": "Find similar casesNext steps", "text": "<ol> <li> <p>Find the alert or case you want to compare for similarity.</p> </li> <li> <p>Select the Similar cases tab.</p> <p></p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select See all in the Matches column to view the list of common observables.</p> <p>Performance optimization</p> <p>To optimize performance, a maximum of 100 observables are displayed in the Matches drawer. Users with an admin-type profile can adjust this limit in the <code>application.conf</code> file. However, increasing it beyond 100 may impact application performance. Proceed with caution when modifying this setting, as performance can't be guaranteed if the limit is raised.</p> </li> </ol> <ul> <li>Merge Cases</li> <li>Create a Case from an Alert</li> <li>Add an Alert to an Existing Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/flag-a-case/", "title": "Flag a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/flag-a-case/#flag-a-case", "title": "Flag a Case", "text": "<p><code>manageCase/update</code></p> <p>This topic provides step-by-step instructions for flagging a case in TheHive.</p> <p>Use this procedure to highlight a case for all users in your organization. Flagged cases appear at the top of the case list.</p> Procedure <p>Bulk flag</p> <p>You can flag multiple cases at once. Select  next to each case you want to flag, then choose Flag cases from the actions above the list.</p> <ol> <li> <p>Go to the Cases view from the sidebar menu.</p> <p></p> </li> <li> <p>Select  next to the case you want to flag.</p> <p></p> </li> <li> <p>Select Flag cases.</p> </li> </ol> Next steps <ul> <li>Add Tasks to a Case</li> <li>Change a Case Status</li> <li>Find Similar Alerts or Cases</li> <li>Merge Cases</li> <li>View Alerts Linked to a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/merge-cases/", "title": "Merge Cases", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/merge-cases/#merge-cases", "title": "Merge Cases", "text": "<p><code>manageCase/merge</code></p> <p>This topic provides step-by-step instructions for merging cases in TheHive.</p> Procedure <ol> <li> <p>Find the two cases that you want to merge.</p> </li> <li> <p>In one of the cases, select the Merge button.</p> <p></p> </li> <li> <p>In the Merge case drawer, select one of the following options:</p> <ul> <li> <p>By title: Search for a case by title.</p> <p>Enter keywords in the search box.</p> <p>Wildcard character</p> <p>Use the wildcard character * to broaden your search. The wildcard acts as a placeholder that matches zero or more characters.</p> </li> <li> <p>By case number: Search for a case using its case number.</p> <p>Enter the case number, wait a few seconds, and select the suggested result.</p> </li> </ul> </li> <li> <p>Select Merge.</p> </li> </ol> Next steps <ul> <li>Find a Case</li> <li>Create a Case</li> <li>Restrict Case Visibility</li> <li>Restore Case Visibility</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/reopen-a-case/", "title": "Reopen a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/reopen-a-case/#reopen-a-case", "title": "Reopen a Case", "text": "<p><code>manageCase/reopen</code></p> <p>This topic provides step-by-step instructions for reopening a case in TheHive.</p> <p>Use this procedure to reopen a closed case and change its status so that it moves from the Closed stage to the In progress stage.</p> Procedure <ol> <li> <p>Find the case you want to reopen.</p> </li> <li> <p>In the case, select Reopen.</p> <p></p> </li> <li> <p>In the drawer, update the status for the case.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Change an Case Status</li> <li>Merge Cases</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/run-responders-on-a-case/", "title": "Run Responders and Review Reports for a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/run-responders-on-a-case/#run-responders-and-review-reports-for-a-case", "title": "Run Responders and Review Reports for a Case", "text": "<p>This topic provides step-by-step instructions for running responders on a case and reviewing responder reports in TheHive.</p> <p>Responders execute actions on cases, alerts, observables, tasks, and task logs.</p> <p>Run a responder on a case to take actions such as closing an external ticket or executing a predefined response within TheHive.</p> <p>Observables not included</p> <p>Running a responder on a case doesn't run it on the observables linked to the case. To run responders on an observable, see Run Responders and Review Reports for an Observable.</p> <p>Running functions on a case</p> <p>5.4 Did you know it\u2019s possible to run functions on cases just like running responders? See Run a Function on a Case or an Alert for detailed instructions.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/run-responders-on-a-case/#run-responders-on-a-case", "title": "Run responders on a case", "text": "<ol> <li> <p>Locate the alert on which you want to run responders.</p> </li> <li> <p>In the case, select Responders.</p> <p></p> </li> <li> <p>In the drawer, select the responders you want to run.</p> </li> <li> <p>Select Launch actions.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/run-responders-on-a-case/#review-responder-reports-for-a-case", "title": "Review responder reports for a caseNext steps", "text": "<ol> <li> <p>Locate the case on which you ran responders.</p> </li> <li> <p>In the case, select the Responders tab to check the status of the executed responders.</p> <p></p> </li> </ol> <ul> <li>Add Tasks to a Case</li> <li>Change a Case Status</li> <li>View Alerts Linked to a Case</li> <li>Find Similar Alerts or Cases</li> <li>Merge Cases</li> <li>Close a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/share-a-case/", "title": "Share a Case with Other Organizations", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/share-a-case/#share-a-case-with-other-organizations", "title": "Share a Case with Other Organizations", "text": "<p><code>manageCase/update</code> <code>manageShare</code></p> <p>This topic provides step-by-step instructions for configuring local sharing rules with linked organizations for an existing case in TheHive.</p> <p>Global sharing rules</p> <p>This guide focuses on local sharing rules for individual existing cases. To configure global sharing rules for all cases in your organization, refer to How to Link an Organization.</p> <p>To learn more about how sharing rules function and interact, refer to the About Organizations Sharing Rules topic.</p> Procedure <ol> <li> <p>Locate the case you want to share.</p> </li> <li> <p>On the case description, select the Sharing button.</p> <p></p> </li> <li> <p>Select the tasks sharing rules to apply.</p> <p>Pick an option from the dropdown list:</p> <ul> <li>manual (default): Tasks aren't shared automatically. Users must share them manually.</li> <li>autoShare: Tasks are shared automatically.</li> </ul> </li> <li> <p>Select the observables sharing rules to apply.</p> <p>Pick an option from the dropdown list:</p> <ul> <li>manual (default): Observables aren't shared automatically. Users must share them manually.</li> <li>autoShare: Observables are shared automatically.</li> </ul> <p>Task and observable sharing scope</p> <p>Task and observable sharing rules apply to all linked organizations the case is shared with.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>Select Manage case sharings.</p> </li> <li> <p>Turn on the Share this case toggle for each relevant organization and select the appropriate permission profile.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Share a Task with Other Organizations</li> <li>Share an Observable with Other Organizations</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/share-an-observable/", "title": "Share an Observable with Other Organizations", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/share-an-observable/#share-an-observable-with-other-organizations", "title": "Share an Observable with Other Organizations", "text": "<p><code>manageCase/update</code> <code>manageShare</code></p> <p>This topic provides step-by-step instructions for manually sharing an observable in a shared case with linked organizations in TheHive.</p> <p>Shared cases only</p> <p>To share an observable manually, the case must already be shared with the relevant linked organizations. If not, refer to How to Share a Case.</p> <p>This is useful when observable sharing rules are set to manual, ensuring that users share only the relevant observables.</p> <p>To learn more about how sharing rules function and interact, see the About Organizations Sharing Rules topic.</p> Procedure <ol> <li> <p>Locate the shared case where you want to share the observable.</p> </li> <li> <p>Go to the Observables tab.</p> </li> <li> <p>Move through the Shares section.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select the linked organization to share the observable with.</p> </li> <li> <p>Select Add share.</p> </li> </ol> Next steps <ul> <li>Share a Task with Other Organizations</li> <li>Share a Case with Other Organizations</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/view-alerts-linked-to-a-case/", "title": "View Alerts Linked to a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/view-alerts-linked-to-a-case/#view-alerts-linked-to-a-case", "title": "View Alerts Linked to a Case", "text": "<p>This topic provides step-by-step instructions for viewing alerts linked to a case in TheHive.</p> <p>An alert is automatically linked to a case when you create a case from an alert or add an alert to an existing case.</p> Procedure <ol> <li> <p>Find the case where you want to view linked alerts.</p> </li> <li> <p>In the case, select the Linked alerts tab.</p> <p></p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> </ol> Next steps <ul> <li>Unlink an Alert and a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/", "title": "About Attachments", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/#about-attachments", "title": "About Attachments", "text": "<p>Attachments are files linked to an organization, case, or alert. They store supporting materials\u2014such as images, documents, or reports\u2014that provide context or evidence.</p> <p>This topic explains how attachments work in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/#where-to-add-attachments", "title": "Where to add attachments", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/#organizations", "title": "Organizations", "text": "<p>Attachments can be manually added to organizations.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/#cases", "title": "Cases", "text": "<p>Attachments can be added to cases. Case reports, images in case descriptions, summaries, and task logs, are automatically saved as attachments. Files can also be added manually to the case or reports tabs.</p> <p>Removing an image from a description, summary, or task log doesn't automatically remove it from the list of attachments.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/#alerts", "title": "Alerts", "text": "<p>Attachments can be added to alerts. Images in case descriptions and summaries are automatically saved as attachments. Files can also be added manually.</p> <p>Removing an image from a description or summary doesn't automatically remove it from the list of attachments.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/#format", "title": "Format", "text": "<p>Any file format is supported for attachments.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/about-attachments/#permissions", "title": "PermissionsNext steps", "text": "<ul> <li>Only users with the <code>manageKnowledgeBase</code> permission can manage attachments at the organization level in TheHive.</li> <li>Only users with the <code>manageCase/update</code> and <code>manageAlert/update</code> permissions can add and remove attachments at the case and alert levels in TheHive.</li> </ul> <p>Adding an attachment grants all users permission to view or download it.</p> <ul> <li>Add an Attachment to an Organization</li> <li>Remove an Attachment from an Organization</li> <li>Share an Attachment from an Organization</li> <li>Download an Attachment from an Organization</li> <li>Add an Attachment to a Case or an Alert</li> <li>Remove an Attachment from a Case or an Alert</li> <li>Share an Attachment from a Case or an Alert</li> <li>Download an Attachment from a Case or an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/add-an-attachment-case-alert/", "title": "Add an Attachment", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/add-an-attachment-case-alert/#add-an-attachment-to-a-case-or-an-alert", "title": "Add an Attachment to a Case or an Alert", "text": "<p><code>manageCase/update</code> <code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for adding an attachment to a case or an alert in TheHive.</p> <p>Use this procedure to add attachments in addition to those automatically saved when you save case reports or add images to case or alert descriptions and summaries, or task logs.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/add-an-attachment-case-alert/#add-an-attachment-to-a-case", "title": "Add an attachment to a case", "text": "<ol> <li> <p>Locate the case where you want to add an attachment.</p> </li> <li> <p>In the case, select the Attachments tab.</p> <p></p> </li> <li> <p>Go to the Cases or Reports tab and select .</p> </li> <li> <p>In the Add attachment drawer, drop a file or select it from your computer.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/add-an-attachment-case-alert/#add-an-attachment-to-an-alert", "title": "Add an attachment to an alertNext steps", "text": "<ol> <li> <p>Locate the alert where you want to add an attachment.</p> </li> <li> <p>In the alert, select the Attachments tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Add attachment drawer, drop a file or select it from your computer.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Remove an Attachment from a Case or an Alert</li> <li>Share an Attachment from a Case or an Alert</li> <li>Download an Attachment from a Case or an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/download-an-attachment-case-alert/", "title": "Download an Attachment", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/download-an-attachment-case-alert/#download-an-attachment-from-a-case-or-an-alert", "title": "Download an Attachment from a Case or an Alert", "text": "<p>This topic provides step-by-step instructions for downloading an attachment from a case or an alert in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/download-an-attachment-case-alert/#download-an-attachment-from-a-case", "title": "Download an attachment from a case", "text": "<ol> <li> <p>Locate the case where you want to remove an attachment.</p> </li> <li> <p>In the case, select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment you want to download.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Download.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/download-an-attachment-case-alert/#download-an-attachment-from-an-alert", "title": "Download an attachment from an alertNext steps", "text": "<ol> <li> <p>Locate the alert where you want to remove an attachment.</p> </li> <li> <p>In the alert, select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment you want to download.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Download.</p> </li> </ol> <ul> <li>Add an Attachment to a Case or an Alert</li> <li>Remove an Attachment from a Case or an Alert</li> <li>Share an Attachment from a Case or an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/remove-an-attachment-case-alert/", "title": "Remove an Attachment", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/remove-an-attachment-case-alert/#remove-an-attachment-from-a-case-or-an-alert", "title": "Remove an Attachment from a Case or an Alert", "text": "<p><code>manageCase/update</code> <code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for removing an attachment from a case or an alert in TheHive.</p> <p>Use this procedure to remove attachments you added manually or that were previously included in case or alert descriptions, summaries, or task logs.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/remove-an-attachment-case-alert/#remove-an-attachment-from-a-case", "title": "Remove an attachment from a case", "text": "<ol> <li> <p>Locate the case where you want to remove an attachment.</p> </li> <li> <p>In the case, select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment you want to remove.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Remove.</p> </li> <li> <p>Select OK.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/remove-an-attachment-case-alert/#remove-an-attachment-from-an-alert", "title": "Remove an attachment from an alertNext steps", "text": "<ol> <li> <p>Locate the alert where you want to remove an attachment.</p> </li> <li> <p>In the alert, select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment you want to remove.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Remove.</p> </li> <li> <p>Select OK.</p> </li> </ol> <ul> <li>Add an Attachment to a Case or an Alert</li> <li>Share an Attachment from a Case or an Alert</li> <li>Download an Attachment from a Case or an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/share-an-attachment-case-alert/", "title": "Share an Attachment", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/share-an-attachment-case-alert/#share-an-attachment-from-a-case-or-an-alert", "title": "Share an Attachment from a Case or an Alert", "text": "<p>This topic provides step-by-step instructions for sharing an attachment from a case or an alert in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/share-an-attachment-case-alert/#share-an-attachment-from-a-case", "title": "Share an attachment from a case", "text": "<ol> <li> <p>Locate the case containing the attachment you want to share.</p> </li> <li> <p>In the case, select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment to copy its URL.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Copy URL.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/attachments/share-an-attachment-case-alert/#share-an-attachment-from-an-alert", "title": "Share an attachment from an alertNext steps", "text": "<ol> <li> <p>Locate the alert containing the attachment you want to share.</p> </li> <li> <p>In the alert, select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment to copy its URL.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Copy URL.</p> </li> </ol> <ul> <li>Add an Attachment to a Case or an Alert</li> <li>Remove an Attachment from a Case or an Alert</li> <li>Download an Attachment from a Case or an Alert</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-links/add-a-link-to-a-case/", "title": "Add a Link to a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-links/add-a-link-to-a-case/#add-a-link-to-a-case", "title": "Add a Link to a Case", "text": "<p>5.5 <code>manageCase/update</code></p> <p>This topic provides step-by-step instructions for adding a link to a case in TheHive.</p> <p>The link can point to another TheHive case or to an external resource.</p> <p>Not applicable to alert links</p> <p>This procedure doesn't apply to alert links that are automatically created when creating a case from an alert or adding an alert to an existing case.</p> Procedure <ol> <li> <p>Find the case where you want to add the link.</p> </li> <li> <p>In the case description, move through the Linked elements section.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>Enter the following information:</p> <p>- Link type</p> <p>Link type specifies the category for the link. Existing categories appear when you click the field. Entering a new category automatically creates it when you add the link.</p> <p>If you don't specify a category, Internal link is applied by default when linking TheHive cases, and External link when linking external resources.</p> <p>- Case or external URL</p> <p>Search for the case by number or title, or paste an external URL.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p> </li> <li> <p>Select .</p> </li> </ol> Next steps <ul> <li>Remove a Link from a Case</li> <li>View Links in a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-links/remove-a-link-from-a-case/", "title": "Remove a Link from a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-links/remove-a-link-from-a-case/#remove-a-link-from-a-case", "title": "Remove a Link from a Case", "text": "<p>5.5 <code>manageCase/update</code></p> <p>This topic provides step-by-step instructions for removing a link from a case in TheHive.</p> <p>Not applicable to alert links</p> <p>This procedure doesn't apply to alert links that are automatically created when creating a case from an alert or adding an alert to an existing case. To unlink an alert and a case, refer to Unlink an Alert and a Case.</p> Procedure <p>Automatically removed case links</p> <p>Deleting or merging a case automatically removes its links. No manual action is required.</p> <ol> <li> <p>Find the case where you want to remove the link.</p> </li> <li> <p>In the case description, move through the Linked elements section.</p> <p></p> </li> <li> <p>Select  next to the link you want to remove.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add a Link to a Case</li> <li>View Links in a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-links/view-links-in-a-case/", "title": "View Links in a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-links/view-links-in-a-case/#view-links-in-a-case", "title": "View Links in a Case", "text": "<p>5.5</p> <p>This topic provides step-by-step instructions for viewing links in a case in TheHive.</p> <p>Links can point to other TheHive cases or to external resources.</p> <p>Not applicable to alert links</p> <p>This procedure doesn't apply to alert links that are automatically created when creating a case from an alert or adding an alert to an existing case. Refer to View Alerts Linked to a Case to see alerts linked to a case.</p> Procedure <ol> <li> <p>Find the case where you want to view links.</p> </li> <li> <p>In the case description, move through the Linked elements section.</p> <p></p> </li> </ol> Next steps <ul> <li>Add a Link to a Case</li> <li>Remove a Link from a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-reports/about-case-reports/", "title": "About Case Reports", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-reports/about-case-reports/#about-case-report", "title": "About Case Report", "text": "<p>Platinum</p> <p>A case report is available for each individual case and displays key data from the case.</p> <p>This topic provides an overview of case reports and their usage in TheHive.</p> <p>Other reports available</p> <ul> <li>To generate reports for multiple cases at once, refer to the About Dashboards topic.</li> <li>To view or export case events in a chronological order, refer to the About Case Timelines topic.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-reports/about-case-reports/#templates", "title": "Templates", "text": "<p>When displaying a report, a case report template is selected to determine both the data displayed and its presentation.</p> <p>Users have access to the default template and all additional case report templates created.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-reports/about-case-reports/#formats", "title": "Formats", "text": "<p>Three formats are available for downloading case reports:</p> <ul> <li>HTML</li> <li>Markdown</li> <li>Word</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-reports/about-case-reports/#permissions", "title": "PermissionsNext steps", "text": "<p>Case reports are available to all users in an organization within case descriptions for preview. However, only users with the <code>manageCaseReport</code> permission can save and download them. Once saved, the reports are available for download to all users in the Attachments tab.</p> <ul> <li>Create a Case Report Template</li> <li>Save and Download a Case Report</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-reports/save-download-a-case-report/", "title": "Save and Download a Case Report", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-reports/save-download-a-case-report/#save-and-download-a-case-report", "title": "Save and Download a Case Report", "text": "<p>5.4 <code>manageCaseReport</code> Platinum</p> <p>This topic provides step-by-step instructions for saving and downloading a case report in TheHive.</p> <p>Use this procedure to report to your management and provide a follow-up on a case investigation.</p> <p>Other reports available</p> <ul> <li>To generate reports for multiple cases at once, refer to the About Dashboards topic.</li> <li>To view or export case events in a chronological order, refer to the About Case Timelines topic.</li> </ul> Procedure <ol> <li> <p>Locate the case.</p> </li> <li> <p>In the case, select the Report tab.</p> <p></p> </li> <li> <p>In the right pane, under the General section, select the template you want to apply, the format, and the maximum number of elements displayed per widget.</p> <p>The element limit set here applies only to the report preview and doesn't affect the number of elements included when saving or downloading the report. Increasing the number of elements for preview may impact performance.</p> <p>Can't find a case report template?</p> <p>If you can't find the case report template you need, it might not exist yet, or someone may have deleted it. Contact someone with the <code>manageCaseReportTemplate</code> permission to create a new template or modify an existing one.</p> </li> <li> <p>Check the preview to ensure everything is correct.</p> </li> <li> <p>Select Save and download. </p> <p>Saved files access</p> <p>This action downloads the file to your computer and also saves it in the Attachments tab. Any user can then access and download it from there.</p> </li> </ol> Next steps <ul> <li>Create a Case Report Template</li> <li>Add or Remove Widgets in a Case Report Template</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/about-case-timelines/", "title": "About Case Timelines", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/about-case-timelines/#about-case-timelines", "title": "About Case Timelines", "text": "<p>Gold Platinum</p> <p>Case timelines provide a chronological view of all events that occurred during the lifecycle of a specific case.</p> <p>This topic explains the components of case timelines in TheHive.</p> <p>Other reports available</p> <ul> <li>To generate reports for multiple cases at once, refer to the About Dashboards topic.</li> <li>To view or download key data from cases, refer to the About Case Reports topic.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/about-case-timelines/#components", "title": "Components", "text": "<p>Case timelines consist of all types of events that have occurred in a case, including:</p> <ul> <li>Alert occurrences</li> <li>Case creation</li> <li>Investigation start</li> <li>Task completion</li> <li>Flagged task logs</li> <li>Indicator of compromise (IOC) sightings</li> <li>MITRE ATT&amp;CK patterns</li> </ul> <p>Configure custom events to include additional entries in the timeline.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/about-case-timelines/#rendering", "title": "Rendering", "text": "<p>Display case timelines as either a graph or a list.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/about-case-timelines/#actions", "title": "ActionsNext steps", "text": "<p>Custom events can be created and deleted, but can't be edited after creation.</p> <ul> <li>Add a Custom Event to a Case Timeline</li> <li>Delete a Custom Event in a Case Timeline</li> <li>View a Case Timeline</li> <li>Export a Case Timeline</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/add-custom-event-timeline/", "title": "Add a Custom Event", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/add-custom-event-timeline/#add-a-custom-event-to-a-case-timeline", "title": "Add a Custom Event to a Case Timeline", "text": "<p>Gold Platinum</p> <p>This topic provides step-by-step instructions for adding a custom event to a case timeline in TheHive.</p> Procedure <ol> <li> <p>Find the case where you want to add the custom event to the timeline.</p> </li> <li> <p>In the case, select the Timeline tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Add custom event drawer, enter the following information:</p> <p>Modification not possible</p> <p>Once you create a custom event, you can't modify it. To make changes, you must delete it and create a new one.</p> <p>- Title</p> <p>The name of your custom event, visible to users on the timeline.</p> <p>- Description</p> <p>A brief description of your custom event. Users can view this brief description of the custom event by selecting Preview, but it does not appear on the timeline.</p> <p>- Date</p> <p>The start date of your custom event.</p> <p>- End date</p> <p>The end date of your custom event.</p> </li> <li> <p>Select Add.</p> </li> </ol> Next steps <ul> <li>Delete a Custom Event in a Case Timeline</li> <li>View a Case Timeline</li> <li>Export a Case Timeline</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/delete-custom-event-timeline/", "title": "Delete a Case Timeline", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/delete-custom-event-timeline/#delete-a-custom-event-from-a-case-timeline", "title": "Delete a Custom Event from a Case Timeline", "text": "<p>Gold Platinum</p> <p>This topic provides step-by-step instructions for deleting a custom event from a case timeline in TheHive.</p> Procedure <ol> <li> <p>Find the case where you want to remove the custom event from the timeline.</p> </li> <li> <p>In the case, select the Timeline tab.</p> <p></p> </li> <li> <p>Select the custom event to delete.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add a Custom Event to a Case Timeline</li> <li>View a Case Timeline</li> <li>Export a Case Timeline</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/export-case-timeline/", "title": "Export a Case Timeline", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/export-case-timeline/#export-a-case-timeline", "title": "Export a Case Timeline", "text": "<p>Gold Platinum</p> <p>This topic provides step-by-step instructions for exporting a case timeline in TheHive.</p> <p>Other reports available</p> <ul> <li>To generate reports for multiple cases at once, refer to the About Dashboards topic.</li> <li>To view or download key data from cases, refer to the About Case Reports topic.</li> </ul> Procedure <ol> <li> <p>Find the case to export its timeline.</p> </li> <li> <p>In the case, select the Timeline tab.</p> <pre><code>![Case timeline tab](/thehive/images/user-guides/analyst-corner/cases/case-timeline-tab.png)\n</code></pre> </li> <li> <p>Select the Export to JSON symbol to export the case timeline in JSON format.</p> <p></p> </li> </ol> Next steps <ul> <li>Add a Custom Event to a Case Timeline</li> <li>Delete a Custom Event in a Case Timeline</li> <li>View a Case Timeline</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/view-case-timeline/", "title": "View a Case Timeline", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-timelines/view-case-timeline/#view-a-case-timeline", "title": "View a Case Timeline", "text": "<p>Gold Platinum</p> <p>This topic provides step-by-step instructions for viewing a case timeline in TheHive.</p> <p>Other reports available</p> <ul> <li>To generate reports for multiple cases at once, refer to the About Dashboards topic.</li> <li>To view or download key data from cases, refer to the About Case Reports topic.</li> </ul> Procedure <ol> <li> <p>Find the case to view its timeline.</p> </li> <li> <p>In the case, select the Timeline tab.</p> <p></p> </li> </ol> Next steps <ul> <li>Add a Custom Event to a Case Timeline</li> <li>Delete a Custom Event in a Case Timeline</li> <li>Export a Case Timeline</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-visibility/restore-visibility-case/", "title": "Restore Case Visibility", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-visibility/restore-visibility-case/#restore-case-visibility", "title": "Restore Case Visibility", "text": "<p>5.5 <code>manageCaseAccess/restrict</code> Platinum</p> <p>This topic provides step-by-step instructions for restoring the visibility of a case in TheHive, making it visible to all users again.</p> Procedure <ol> <li> <p>Find the case that you want to restore visibility for all users.</p> </li> <li> <p>In the case, select the Restrict access button.</p> <p></p> </li> <li> <p>In the Case access management drawer, select Visible.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Restrict Case Visibility</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/case-visibility/restrict-visibility-case/", "title": "Restrict Case Visibility", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/case-visibility/restrict-visibility-case/#restrict-case-visibility", "title": "Restrict Case Visibility", "text": "<p>5.5 <code>manageCaseAccess/restrict</code> Platinum</p> <p>This topic provides step-by-step instructions for restricting the visibility of a case in TheHive.</p> Procedure <ol> <li> <p>Find the case you want to restrict.</p> </li> <li> <p>In the case, select the Restrict access button.</p> <p></p> </li> <li> <p>In the Case access management drawer, select Restricted.</p> </li> <li> <p>Select the authorized users.</p> <p>Mandatory authorized users</p> <p>The case assignee and the user performing the action always have access and can't be removed.</p> </li> <li> <p>Select Confirm.</p> <p>Hang tight</p> <p>It may take a few seconds to apply restricted visibility to all elements linked to the case, such as observables and tasks.</p> </li> </ol> Next steps <ul> <li>Restore Case Visibility</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/custom-fields/add-custom-fields/", "title": "Add Custom Fields", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/custom-fields/add-custom-fields/#add-custom-fields", "title": "Add Custom Fields", "text": "<p><code>manageCase/update</code> <code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for adding custom fields to a case or an alert in TheHive.</p> <p>Can't find a custom field?</p> <p>If you can't find the custom field you need, it might not exist yet, or someone may have deleted it. Contact someone with admin-level permissions to create or restore it.</p> Procedure <ol> <li> <p>Find the case or the alert where you want to add custom fields.</p> </li> <li> <p>In the description, move through the Custom fields section.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>Select the custom fields you want to add.</p> <p>Bulk selection</p> <p>Select the group name to select all custom fields linked to that group.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Remove Custom Fields</li> <li>Enter Values in Custom Fields</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/custom-fields/enter-values-in-custom-fields/", "title": "Enter Values in Custom Fields", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/custom-fields/enter-values-in-custom-fields/#enter-values-in-custom-fields", "title": "Enter Values in Custom Fields", "text": "<p><code>manageCase/update</code> <code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for entering values in custom fields in a case or an alert in TheHive.</p> <p>Can't enter a value in a custom field?</p> <p>If you can't enter the value you need in a custom field, the field may not be configured correctly. Contact someone with admin-level permissions to update the configuration.</p> Procedure <ol> <li> <p>Find the case or the alert where you want to enter values in custom fields.</p> </li> <li> <p>In the description, move through the Custom fields section.</p> <p></p> </li> <li> <p>Enter a value under the custom field name. Depending on the configuration, the field will either accept free text or provide a dropdown list of options.</p> <p></p> <p>5.5 Custom field view</p> <p>You can filter mandatory custom fields and choose how many custom fields to display per line.</p> <p></p> </li> <li> <p>Optional: Select Add to enter another value, if available.</p> </li> <li> <p>Optional: Use the  symbol to delete an entire entry in a multi-line custom field. Use the  symbol to remove a value from the field.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Add Custom Fields</li> <li>Remove Custom Fields</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/custom-fields/remove-custom-fields/", "title": "Remove Custom Fields", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/custom-fields/remove-custom-fields/#remove-custom-fields", "title": "Remove Custom Fields", "text": "<p><code>manageCase/update</code> <code>manageAlert/update</code></p> <p>This topic provides step-by-step instructions for removing custom fields from a case or an alert in TheHive.</p> Procedure <ol> <li> <p>Find the case or the alert where you want to remove custom fields.</p> </li> <li> <p>In the description, move through the Custom fields section.</p> <p></p> </li> <li> <p>Select  in the top-right corner of the custom field you want to remove.</p> <p></p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add Custom Fields</li> <li>Enter Values in Custom Fields</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/", "title": "About Observables", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#about-observables", "title": "About Observables", "text": "<p>Observables are data points that represent specific events or properties within a system and can be directly observed. They serve as indicators monitored for signs of suspicious or malicious activity.</p> <p>Observables include stateful properties like IP addresses, domain names, file MD5 hashes, and system behaviors. They also cover measurable events such as the creation or deletion of files, registry keys, and other activities crucial to system and network operations.</p> <p>This topic provides an overview of the main characteristics of observables in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#type", "title": "Type", "text": "<p>An observable type defines the category or classification of an observable in TheHive. While TheHive includes a predefined set of types, this list can be expanded with custom types to meet specific needs.</p> <p>Available analyzers depend on the observable\u2019s type.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#data", "title": "Data", "text": "<p>Data can take the following forms:</p> <ul> <li>For types that don't require attachments: values entered into a text area.</li> <li>For types that require attachments: a file, which is hashed.</li> </ul> <p>Users can add one or more values to a single observable in TheHive, but they can only add one file at a time.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#statuses", "title": "Statuses", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#indicator-of-compromise", "title": "Indicator of compromise", "text": "<p>An observable can be marked as an indicator of compromise (IOC) once it's identified as being linked to suspicious or malicious activity.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#sighted", "title": "Sighted", "text": "<p>An observable can be marked as sighted once it has been detected or observed in the environment.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#similar-alerts-and-cases", "title": "Similar alerts and cases", "text": "<p>Observables are key to identifying similar cases and correlating malicious activity across different alerts and cases. TheHive uses observables to detect patterns and surface related items in the Similar alerts and Similar cases tabs. Similarity checks apply between cases and cases, alerts and alerts, and between alerts and cases.</p> <p>Observables that lack relevance for threat correlation, such as the company\u2019s domain name, can be excluded from similarity checks.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#rules-for-similarity", "title": "Rules for similarity", "text": "<p>Cases and alerts are considered similar if all the following conditions are met:</p> <ul> <li>At least one observable not excluded from similarity checks shares the same value, such as an identical file name or IP address.</li> <li>The related cases and alerts belong to the same organization or to linked organizations.</li> <li>Alerts don't have the status Imported. Alerts that have been merged into a case are no longer included in similarity checks\u2014but the case is. </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/about-observables/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageObservable</code> permission can manage observables in TheHive.</p> <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> <li>Exclude an Observable from Similarity Checks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/add-an-observable/", "title": "Add an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/add-an-observable/#add-an-observable", "title": "Add an Observable", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for adding an observable to a case or alert in TheHive.</p> <p>Observables are data points that represent specific events or properties within a system and can be directly observed. They serve as indicators monitored for signs of suspicious or malicious activity.</p> Procedure <ol> <li> <p>Locate the case or alert where you want to add the observable.</p> </li> <li> <p>In the alert or case, select the Observables tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding an observable drawer, enter the following information:</p> <p>- Type</p> <p>The type of an observable determines which analyzers are available and whether it requires a value or an attachment. You can't change an observable\u2019s type between one requiring a value and one requiring an attachment once it\u2019s created.</p> <p>Can't find an observable type?</p> <p>If you can't find the type you need, it might not exist yet, or someone may have deleted it. Contact someone with admin-level permissions to create or restore it.</p> <p>- Value/attachment</p> <p>Depending on the type of the observable, provide:</p> <ul> <li>One or more values: To enter multiple values, place each value on a separate line and turn on the One observable per line toggle.</li> <li>A file: Hashed automatically and available for download from the observable details.</li> </ul> <p>You can't change an observable's value or file once it's created.</p> <p>- TLP (traffic light protocol) *</p> <p>The TLP level for the observable. It indicates how you can share the observable's information with others. Refer to the Malware Information Sharing Platform (MISP) taxonomy for detailed definitions of TLP values.</p> <p>- PAP (permissible actions protocol) *</p> <p>The PAP level for the observable. It specifies which actions you can take with the observable data. Refer to the MISP taxonomy for detailed definitions of PAP values.</p> <p>- Is IOC</p> <p>Turn on the toggle if you recognize the observable as related to suspicious or malicious activity.</p> <p>- Has been sighted</p> <p>Turn on the toggle when you detect or observe the observable in your environment.</p> <p>- Ignore similarity</p> <p>Turn on the toggle of you don't want to include the observable in the algorithm used to identify similar alerts and cases based on observables. This can be useful for contextual observables, such as the company domain name, or for observables that aren't related to any potential threat.</p> <p>- Tags </p> <p>One or more tags for labeling the observable.</p> <p>- Description</p> <p>A description of the observable using TheHive-flavored Markdown syntax.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> <li>Exclude an Observable from Similarity Checks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/edit-multiple-observables/", "title": "Edit Multiple Observables", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/edit-multiple-observables/#edit-multiple-observables", "title": "Edit Multiple Observables", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for performing bulk edits on multiple observables in TheHive.</p> Procedure <ol> <li> <p>Locate the case or alert where you want to update the observables.</p> </li> <li> <p>In the alert or case, select the Observables tab.</p> <p></p> </li> <li> <p>Select  next to the observables you want to update.</p> </li> <li> <p>Select  above the list.</p> </li> <li> <p>In the Edit several observables drawer, update the values as needed.</p> </li> <li> <p>Select Submit.</p> </li> </ol> Next steps <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/exclude-an-observable-from-similarity-checks/", "title": "Exclude an Observable From Similarity Checks", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/exclude-an-observable-from-similarity-checks/#exclude-an-observable-from-similarity-checks", "title": "Exclude an Observable from Similarity Checks", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for excluding an observable from similarity checks in cases and alerts in TheHive.</p> <p>Similar alerts and cases are detected based on shared observables. You can choose to ignore similarity for contextual observables, such as the company domain name, or for observables that aren't related to any potential threat.</p> <p>Bulk updates</p> <p>You can edit multiple observables at once. Follow the instructions in the Edit Multiple Observables topic.</p> Procedure <ol> <li> <p>Locate the observable you want to update.</p> </li> <li> <p>In the observable details, turn on the Ignore similarity toggle.</p> </li> <li> <p>Select Save.</p> </li> </ol> Next steps <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/export-data-observables/", "title": "Export Data from an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/export-data-observables/#export-data-from-observables", "title": "Export Data from Observables", "text": "<p>This topic provides step-by-step instructions for exporting data from observables in a case or alert in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/export-data-observables/#copy-data-from-an-observable", "title": "Copy data from an observable", "text": "<ol> <li> <p>Locate the observable you want to download.</p> </li> <li> <p>In the observable, select .</p> </li> <li> <p>Select Copy data.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/export-data-observables/#download-an-observable-attachment", "title": "Download an observable attachment", "text": "<ol> <li> <p>Locate the observable you want to download.</p> </li> <li> <p>In the observable, select .</p> </li> <li> <p>Select Download.</p> </li> <li> <p>Memorize the password and select OK.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/export-data-observables/#export-a-list-of-observables", "title": "Export a list of observablesNext steps", "text": "<ol> <li> <p>Locate the case or alert from which you want to export the observables.</p> </li> <li> <p>In the alert or case, select the Observables tab.</p> <p></p> </li> <li> <p>Select Export list to export all observables displayed in the tab, reflecting the applied filters and sorting. To export a specific selection of observables, select  next to the observables you want to export, then select Export selection.</p> <p></p> </li> <li> <p>In the Export observable to file drawer, select your preferred formatting options.</p> <p>Select Yes for Protect to fang URLs and prevent accidental clicks.</p> </li> <li> <p>Select Export to file.</p> </li> </ol> <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/import-observables-from-analyzer-reports/", "title": "Import Observables from Analyzer Reports", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/import-observables-from-analyzer-reports/#import-observables-from-analyzer-reports", "title": "Import Observables from Analyzer Reports", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for importing observables from analyzer reports in TheHive.</p> <p>Analyzers enrich observables with detailed contextual intelligence, generating a report with the results, which may include additional observables.</p> Procedure <ol> <li> <p>Locate the observable on which you ran the analyzer.</p> </li> <li> <p>In the observable details, select the relevant report in the Reports section.</p> <p></p> </li> <li> <p>In the Analysis report drawer, under the Observables extracted from analysis report section, select  next to the observables you want to import.</p> </li> <li> <p>Select Import observables.</p> </li> <li> <p>In the Adding an observable drawer, review the prefilled information.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Exclude an Observable from Similarity Checks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/pin-an-observable/", "title": "Pin an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/pin-an-observable/#pin-an-observable", "title": "Pin an Observable", "text": "<p>This topic provides step-by-step instructions for pinning an observable in an case or alert in TheHive.</p> <p>Pinning an observable allows you to access it from the Observables tab within a case or alert. Pins are personal and only visible to you.</p> Procedure <ol> <li> <p>Locate the case or alert where you want to pin the observable.</p> </li> <li> <p>In the alert or case, select the Observables tab.</p> <p></p> </li> <li> <p>Select  next to the observable you want to pin.</p> </li> <li> <p>Select Pin.</p> </li> </ol> Next steps <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/remove-an-observable/", "title": "Remove an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/remove-an-observable/#remove-an-observable", "title": "Remove an Observable", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for removing an observable from a case or alert in TheHive.</p> Procedure <ol> <li> <p>Locate the observable you want to remove.</p> </li> <li> <p>In the observable, select .</p> <p></p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> <li>Exclude an Observable from Similarity Checks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-analyzers-on-an-observable/", "title": "Run Analyzers and Review Reports for an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-analyzers-on-an-observable/#run-analyzers-and-review-reports-for-an-observable", "title": "Run Analyzers and Review Reports for an Observable", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for running analyzers on an observable and reviewing analyzer reports in TheHive.</p> <p>Analyzers enrich observables with detailed, contextual intelligence, generating a report with the results. The type of each observable determines which analyzers are available.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-analyzers-on-an-observable/#run-analyzers-on-an-observable", "title": "Run analyzers on an observable", "text": "<p>Bulk run</p> <p>To run analyzers on multiple observables, go to the Observables tab in a case or alert and select  next to each observable you want to include. Then select Run analyzers above the list.</p> <ol> <li> <p>Locate the observable on which you want to run analyzers.</p> </li> <li> <p>In the observable, select .</p> <p></p> </li> <li> <p>Select Run analyzers.</p> </li> <li> <p>In the Analyzer drawer, select the analyzers you want to run.</p> <p>Can't find an analyzer?</p> <p>If you can't find the analyzer you need, it might not be available for this observable type. Contact someone with admin-level permissions on Cortex to change the types associated with the analyzer.</p> </li> <li> <p>Select Run selected analyzers.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-analyzers-on-an-observable/#review-analyzer-reports-for-an-observable", "title": "Review analyzer reports for an observableNext steps", "text": "<ol> <li> <p>Locate the observable on which you ran analyzers.</p> </li> <li> <p>In the observable details, move through the Reports section to select a report, or move through the Analyzers section and select any green item in the Last analysis column.</p> <p></p> </li> <li> <p>Optional: Import observables from reports. See Import Observables from Analyzer Reports for detailed instructions.</p> </li> </ol> <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> <li>Exclude an Observable from Similarity Checks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-responders-on-an-observable/", "title": "Run Responders and Review Reports for an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-responders-on-an-observable/#run-responders-and-review-reports-for-an-observable", "title": "Run Responders and Review Reports for an Observable", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for running responders on an observable and reviewing responder reports in TheHive.</p> <p>Responders execute actions on cases, alerts, observables, tasks, and task logs.</p> <p>Run a responder on an observable to take actions such as blocking an IP address on the firewall or a URL on the proxy.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-responders-on-an-observable/#run-responders-on-an-observable", "title": "Run responders on an observable", "text": "<ol> <li> <p>Locate the observable on which you want to run responders.</p> </li> <li> <p>In the observable, select .</p> <p></p> </li> <li> <p>Select Responders.</p> </li> <li> <p>In the Run actions on current observable drawer, select the responders you want to run.</p> </li> <li> <p>Select Launch actions.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/run-responders-on-an-observable/#review-responder-reports-for-an-observable", "title": "Review responder reports for an observableNext steps", "text": "<ol> <li> <p>Locate the observable on which you ran responders.</p> </li> <li> <p>In the observable details, move through the Responder reports section to check the status of the executed responders.</p> <p></p> </li> </ol> <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> <li>Exclude an Observable from Similarity Checks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/update-an-observable-status/", "title": "Update the Status of an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/observables/update-an-observable-status/#update-the-status-of-an-observable", "title": "Update the Status of an Observable", "text": "<p><code>manageObservable</code></p> <p>This topic provides step-by-step instructions for updating the status of an observable in TheHive.</p> <p>Bulk updates</p> <p>You can edit multiple observables at once. Follow the instructions in the Edit Multiple Observables topic.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/update-an-observable-status/#mark-an-observable-as-sighted", "title": "Mark an observable as sighted", "text": "<p>Mark an observable as sighted when you detect or observe it in your environment.</p> <ol> <li> <p>Locate the observable you want to update.</p> </li> <li> <p>In the observable details, turn on the Sighted toggle.</p> </li> <li> <p>Select Save.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/observables/update-an-observable-status/#mark-an-observable-as-indicator-of-compromise", "title": "Mark an observable as indicator of compromiseNext steps", "text": "<p>Mark an observable as an indicator of compromise (IOC) if you recognize it as related to suspicious or malicious activity.</p> <ol> <li> <p>Locate the observable you want to update.</p> </li> <li> <p>In the observable details, turn on the IOC toggle.</p> </li> <li> <p>Select Save.</p> </li> </ol> <ul> <li>Add an Observable</li> <li>Remove an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> <li>Exclude an Observable from Similarity Checks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-case/", "title": "Find a Case", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-case/#find-a-case", "title": "Find a Case", "text": "<p>Search for cases in TheHive using different methods depending on your needs\u2014from quick searches to advanced filtering.</p> <p>If you\u2019re unsure which method to use, refer to the Overview of Search Methods for Cases topic.</p> <p>Can't find a case?</p> <ul> <li>Ensure autorefresh is turned on to automatically display new cases in lists.</li> <li>5.5 Case visibility can be restricted to protect sensitive data. If you aren't an authorized user, it won't appear in the case list, search results, or dashboards.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-case/#method-1-enter-a-case-number-search-box", "title": "Method 1: Enter a case number search box", "text": "<p>Use this method if you already know the case number you're looking for.</p> <ol> <li> <p>Enter the case number in the search box located at the top of the page, visible across all views.</p> <p></p> </li> <li> <p>Press Enter or select .</p> </li> <li> <p>The case description appears.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-case/#method-2-similar-cases", "title": "Method 2: Similar cases", "text": "<p>Use this method if you want to find one or more cases similar to a known case without needing to perform actions on them simultaneously.</p> <p>Filters</p> <p>Select the filters you want to apply on the Similar cases and Similar alerts tabs to find what you need faster.</p> <ol> <li> <p>Open a case, an alert, or a task, and select the Similar cases tab.</p> <p></p> </li> <li> <p>Apply filters using any of these options individually or in combination:</p> <ul> <li> <p>Select Quick filters to access predefined filters.</p> <p></p> </li> <li> <p>Turn on the Filters toggle and enter one or more filters.</p> <p></p> </li> <li> <p>Select a value from a field to use it as a filter criterion.</p> <p></p> </li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> <p>For more information, see the Find Similar Alerts and Cases topic.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-case/#method-3-filters-in-the-cases-view", "title": "Method 3: Filters in the Cases view", "text": "<p>Use this method if you want to find one or more cases to perform actions on them simultaneously.</p> <ol> <li> <p>Go to the Cases view from the sidebar menu.</p> <p></p> </li> <li> <p>Apply filters using any of these options individually or in combination:</p> <ul> <li> <p>Select Quick filters to access predefined filters.</p> <p></p> </li> <li> <p>Turn on the Filters toggle and enter one or more filters.</p> <p></p> </li> <li> <p>Select a value from a field to use it as a filter criterion.</p> <p></p> </li> </ul> <p>Saving views</p> <p>If you frequently use filters, consider saving your preferences as views for easy reuse. For more information on filtering and sorting, see About Filtering and Sorting.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-case/#method-4-global-search-feature", "title": "Method 4: Global Search featureNext steps", "text": "<p>Use this method if you need to conduct advanced searches for one or more cases without requiring simultaneous actions.</p> <ol> <li> <p>Go to the Global Search view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Cases item on the Search scope pane.</p> <p></p> <p>All elements</p> <p>Select the All elements item for a comprehensive tool-wide overview that includes all entity types, such as cases, alerts, observables, jobs, tasks, and task logs. Use this option to analyze cross-linked information or to conduct a detailed investigation.</p> </li> <li> <p>Enter the keywords you want to search for in the search box displayed by default.</p> <p>5.4.7 Wildcard character</p> <p>You can use the wildcard character * to broaden your searches.</p> <p>The wildcard character acts as a placeholder that matches zero or more characters, helping you find variations of a term or incomplete information.</p> <p>Examples of use cases:</p> <ul> <li>Email domains: Entering *@gmail.com will return entities containing the gmail.com domain.</li> <li>IP subnets: Entering 192.168.*.* will return entities with IP addresses in the 192.168.x.x subnet.</li> <li>URLs: Entering https://malwaredomain.com/* will return entities hosted under the malwaredomain.com directory.</li> </ul> <p>Other advanced search options, such as Boolean and phrase searches, are not currently supported.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p> </li> <li> <p>If you need additional filters, apply one or more filters by selecting Add new filter. </p> <p>These filters refine your search results and act as an equivalent to the AND operator in Boolean search.</p> <p>Required filters</p> <p>Filters are required for the following fields to ensure the search engine accurately interprets values:</p> <ul> <li>Fields with specific date formats</li> <li>Custom fields</li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> <ul> <li>Merge Cases</li> <li>Restrict Case Visibility</li> <li>Restore Case Visibility</li> <li>Add Tasks to a Case</li> <li>Add Custom Fields</li> <li>Find Similar Alerts or Cases</li> <li>Add TTPs</li> <li>Add an Attachment</li> <li>View a Case Timeline</li> <li>View a Case Page</li> <li>Run Responders and Review Reports for a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-job/", "title": "Find a Job", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-a-job/#find-a-job", "title": "Find a Job", "text": "<p>This topic provides step-by-step instructions for searching a job in TheHive.</p> <p>A job is a task initiated by Cortex to run an analyzer on an observable.</p> <p>Can't find a job?</p> <p>5.5 Case visibility can be restricted to protect sensitive data. If you aren't an authorized user, its linked observables and any jobs launched on those observables won't appear in the list, search results, or dashboards.</p> Procedure <ol> <li> <p>Go to the Global Search view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Jobs item on the Search scope pane.</p> <p></p> <p>All elements</p> <p>Select the All elements item for a comprehensive tool-wide overview that includes all entity types, such as cases, alerts, observables, jobs, tasks, and task logs. Use this option to analyze cross-linked information or to conduct a detailed investigation.</p> </li> <li> <p>Enter the keywords you want to search for in the search box displayed by default.</p> <p>5.4.7 Wildcard character</p> <p>You can use the wildcard character * to broaden your searches.</p> <p>The wildcard character acts as a placeholder that matches zero or more characters, helping you find variations of a term or incomplete information.</p> <p>Examples of use cases:</p> <ul> <li>Email domains: Entering *@gmail.com will return entities containing the gmail.com domain.</li> <li>IP subnets: Entering 192.168.*.* will return entities with IP addresses in the 192.168.x.x subnet.</li> <li>URLs: Entering https://malwaredomain.com/* will return entities hosted under the malwaredomain.com directory.</li> </ul> <p>Other advanced search options, such as Boolean and phrase searches, are not currently supported.</p> <p>Unindexed fields</p> <p>The <code>workerDefinition</code> field and the <code>operations[]</code> array aren't indexed for search.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p> </li> <li> <p>If you need additional filters, apply one or more filters by selecting Add new filter. </p> <p>These filters refine your search results and act as an equivalent to the AND operator in Boolean search.</p> <p>Required filters</p> <p>Filters are required for the following fields to ensure the search engine accurately interprets values:</p> <ul> <li>Fields with specific date formats</li> <li>Custom fields</li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> Next steps <ul> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Run Responders and Review Reports for a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-an-observable/", "title": "Find an Observable", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-an-observable/#find-an-observable", "title": "Find an Observable", "text": "<p>This topic provides step-by-step instructions for searching an observable in TheHive.</p> <p>Can't find an observable?</p> <ul> <li>Ensure autorefresh is turned on to automatically display new observables in lists.</li> <li>5.5 Case visibility can be restricted to protect sensitive data. If you aren't an authorized user, its linked observables won't appear in the list, search results, or dashboards.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-an-observable/#method-1-observables-tab-in-cases-and-alerts-descriptions", "title": "Method 1: Observables tab in cases and alerts descriptions", "text": "<p>Use this method if you know the case or alert containing the observable you're looking for and if you need to perform actions on one or more observables simultaneously.</p> <ol> <li> <p>Open a case or an alert, and select the Observables tab.</p> <p></p> </li> <li> <p>Apply filters using any of these options individually or in combination:</p> <ul> <li> <p>Turn on the Filters toggle and enter one or more filters.</p> <p></p> </li> <li> <p>Select a value from a field to use it as a filter criterion.</p> <p></p> </li> </ul> <p>Saving views</p> <p>If you frequently use filters, consider saving your preferences as views for easy reuse. For more information on filtering and sorting, see About Filtering and Sorting.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/find-an-observable/#method-2-global-search-feature", "title": "Method 2: Global Search featureNext steps", "text": "<p>Use this method if you\u2019re unsure where to find the observable you\u2019re looking for or if you need to conduct advanced searches for one or more observables without requiring simultaneous actions.</p> <ol> <li> <p>Go to the Global Search view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Observables item on the Search scope pane.</p> <p></p> <p>All elements</p> <p>Select the All elements item for a comprehensive tool-wide overview that includes all entity types, such as cases, alerts, observables, jobs, tasks, and task logs. Use this option to analyze cross-linked information or to conduct a detailed investigation.</p> </li> <li> <p>Enter the keywords you want to search for in the search box displayed by default.</p> <p>5.4.7 Wildcard character</p> <p>You can use the wildcard character * to broaden your searches.</p> <p>The wildcard character acts as a placeholder that matches zero or more characters, helping you find variations of a term or incomplete information.</p> <p>Examples of use cases:</p> <ul> <li>Email domains: Entering *@gmail.com will return entities containing the gmail.com domain.</li> <li>IP subnets: Entering 192.168.*.* will return entities with IP addresses in the 192.168.x.x subnet.</li> <li>URLs: Entering https://malwaredomain.com/* will return entities hosted under the malwaredomain.com directory.</li> </ul> <p>Other advanced search options, such as Boolean and phrase searches, are not currently supported.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p> </li> <li> <p>If you need additional filters, apply one or more filters by selecting Add new filter. </p> <p>These filters refine your search results and act as an equivalent to the AND operator in Boolean search.</p> <p>Required filters</p> <p>Filters are required for the following fields to ensure the search engine accurately interprets values:</p> <ul> <li>Fields with specific date formats</li> <li>Custom fields</li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> <ul> <li>Remove an Observable</li> <li>Update the Status of an Observable</li> <li>Edit Multiple Observables</li> <li>Pin an Observable</li> <li>Export Data from Observables</li> <li>Run Analyzers and Review Reports for an Observable</li> <li>Run Responders and Review Reports for an Observable</li> <li>Import Observables from Analyzer Reports</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/overview-search-methods-case/", "title": "Overview of Search Methods for Cases", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/overview-search-methods-case/#overview-of-search-methods-for-cases", "title": "Overview of Search Methods for Cases", "text": "<p>TheHive offers multiple methods for searching cases, each tailored to specific scenarios.</p> <p>This topic provides an overview of the available search methods, compares their features, and explains when to use each one.</p> <p>Use this guide to choose the most effective method for your needs.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/search-for-cases/overview-search-methods-case/#search-method-comparison", "title": "Search method comparisonNext steps", "text": "Method Filter options Result scope Allows bulk actions Use case Enter a case number search box Single Simple No If you already know the case number you're looking for. Similar cases Multiple Multiple No If you want to find one or more cases similar to a known case without needing to perform actions on them simultaneously. Filters in the Cases view Multiple Multiple Yes If you want to find one or more cases to perform actions on them simultaneously. Global Search feature Advanced Multiple No If you need to conduct advanced searches for one or more cases without requiring simultaneous actions. <ul> <li>How to Find a Case</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/tags/about-tags/", "title": "About Tags", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/tags/about-tags/#about-tags", "title": "About Tags", "text": "<p>Tags assign labels to cases, alerts, and observables in TheHive.</p> <p>This topic explains how tags function.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/tags/about-tags/#sources", "title": "Sources", "text": "<p>In TheHive, tags are created in two ways:</p> <ul> <li>Taxonomy tags: Created from an imported taxonomy</li> <li>Custom tags: Created manually by users as free text to cases, alerts, and observables, or automatically by connected external tools, email servers, or alert feeders</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/tags/about-tags/#scope", "title": "ScopeNext steps", "text": "<ul> <li>Taxonomy tags are available to all organizations within a TheHive instance.</li> <li>Custom tags are specific to a single organization and can't be shared between organizations or TheHive instances.</li> </ul> <ul> <li>About Taxonomies</li> <li>About Custom Tags</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/tags/add-remove-tags/", "title": "Add or Remove Tags", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/tags/add-remove-tags/#add-or-remove-tags", "title": "Add or Remove Tags", "text": "<p>This topic provides step-by-step instructions for adding and removing tags from a case, an alert, or an observable in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/tags/add-remove-tags/#add-tags", "title": "Add tags", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/tags/add-remove-tags/#add-taxonomy-tags", "title": "Add taxonomy tags", "text": "<ol> <li> <p>Find the case, the alert, or the observable where you want to add tags.</p> </li> <li> <p>Hover over the tags and select  on the right.</p> <p></p> <p>Can't find the  button?</p> <p>The button appears only if at least one taxonomy is active. Contact someone with admin-level permissions to activate taxonomies.</p> </li> <li> <p>In the Select tags from library drawer, select the relevant taxonomy and the tags you want to add.</p> </li> <li> <p>Select Add selected tags.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/tags/add-remove-tags/#add-custom-tags", "title": "Add custom tags", "text": "<ol> <li> <p>Find the case, the alert, or the observable where you want to add tags.</p> </li> <li> <p>Click the empty space at the end of the tag list.</p> <p></p> </li> <li> <p>Enter your new tag.</p> </li> <li> <p>Press Enter or select the suggested value.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/cases/tags/add-remove-tags/#remove-tags", "title": "Remove tagsNext steps", "text": "<ol> <li> <p>Find the case, the alert, or the observable where you want to remove tags.</p> </li> <li> <p>Select the tags you want to remove.</p> <p></p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Add a Link to a Case</li> <li>Add Tasks to a Case</li> <li>Add Custom Fields</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/about-ttps/", "title": "About TTPs", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/about-ttps/#about-tactics-techniques-and-procedures", "title": "About Tactics, Techniques and Procedures", "text": "<p>Tactics, techniques and procedures (TTPs) describe the behaviors and methods commonly used by specific threat actors or groups.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/about-ttps/#definitions", "title": "Definitions", "text": "<p>Tactics describe the goals of threat actors\u2014what they're trying to achieve.</p> <p>Techniques show how they achieve those goals.</p> <p>Procedures detail how they implement the techniques in practice.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/about-ttps/#mitre-attck-framework", "title": "MITRE ATT&amp;CK framework", "text": "<p>By default, TheHive includes the MITRE Enterprise Matrix. It's installed during setup, and a catalog named Enterprise Attack is created with all the techniques.</p> <p>This catalog can be updated or supplemented by adding others.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/about-ttps/#actions", "title": "Actions", "text": "<p>Add or remove TTPs from cases. You can also export TTPs from both cases and alerts.</p>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/about-ttps/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>managePattern</code> permission can manage TTPs in TheHive.</p> <p>Only users with the <code>manageProcedure</code> permission can add and remove TTPs in cases and alerts in TheHive.</p> <ul> <li>Add a Catalog</li> <li>Update a Catalog</li> <li>Remove a Catalog</li> <li>View Techniques in a Catalog</li> <li>Add TTPs</li> <li>Remove TTPs</li> <li>Export TTPs</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/add-ttps/", "title": "Add TTPs", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/add-ttps/#add-tactics-techniques-and-procedures", "title": "Add Tactics, Techniques and Procedures", "text": "<p><code>manageProcedure</code></p> <p>Add tactics, techniques and procedures (TTPs) to a case in TheHive.</p> <p>TTPs describe the behaviors and methods commonly used by specific threat actors or groups.</p> Procedure <ol> <li> <p>Find the case where you want to add TTPs.</p> </li> <li> <p>In the alert or case, select the TTPs tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Add TTP drawer, enter the following information:</p> <p>-Catalog *</p> <p>The MITRE catalog to use. By default, the Enterprise Attack catalog is installed with TheHive and includes all standard techniques. Additional catalogs can be added.</p> <p>-Occur date *</p> <p>The date when the attack occurred.</p> <p>-Technique *</p> <p>The technique used in the attack\u2014describing how the attacker achieved their objective.</p> <p>-Procedure</p> <p>Turn on the toggle to add a detailed description of how the technique was carried out\u2014the specific procedure used.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Export TTPs</li> <li>Remove TTPs</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/export-ttps/", "title": "Export TTPs", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/export-ttps/#export-tactics-techniques-and-procedures", "title": "Export Tactics, Techniques and Procedures", "text": "<p>Export tactics, techniques and procedures (TTPs) from a case or an alert in TheHive.</p> <p>TTPs describe the behaviors and methods commonly used by specific threat actors or groups.</p> Procedure <ol> <li> <p>Find the case or the alert where you want to export TTPs.</p> </li> <li> <p>In the alert or case, select the TTPs tab.</p> <p></p> </li> <li> <p>Select Export list to export all TTPs displayed in the tab, reflecting the applied filters and sorting. To export a specific selection of TTPs, select  next to the TTPs you want to export, then select Export selection.</p> <p></p> </li> <li> <p>In the Export TTP to file drawer, select your preferred formatting options.</p> </li> <li> <p>Select Export to file.</p> </li> </ol> Next steps <ul> <li>Add TTPs</li> <li>Remove TTPs</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/remove-ttps/", "title": "Remove TTPs", "text": ""}, {"location": "thehive/user-guides/analyst-corner/cases/ttps/remove-ttps/#remove-tactics-techniques-and-procedures", "title": "Remove Tactics, Techniques and Procedures", "text": "<p><code>manageProcedure</code></p> <p>Remove tactics, techniques and procedures (TTPs) from a case in TheHive.</p> <p>TTPs describe the behaviors and methods commonly used by specific threat actors or groups.</p> Procedure <p>Bulk remove</p> <p>To remove TTPs in bulk, select  to each TTP you want to remove, then  at the top of the screen.</p> <ol> <li> <p>Find the case where you want to remove TTPs.</p> </li> <li> <p>In the alert or case, select the TTPs tab.</p> <p></p> </li> <li> <p>Select  next to the TTP you want to remove.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add TTPs</li> <li>Export TTPs</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/", "title": "About Dashboards", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/#about-dashboards", "title": "About Dashboards", "text": "<p>A dashboard compiles and visualizes data to provide key insights at a glance.</p> <p>This topic describes dashboards in the context of TheHive, including their functionality.</p> <p>Specific case reporting</p> <p>To access reporting data for a specific case, use the case report and case timeline features.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/#configuration", "title": "Configuration", "text": "<p>Dashboards consist of widgets that can be dragged into place.</p> <p>TheHive includes four default dashboards: </p> <ul> <li>Alerts statistics</li> <li>Cases statistics</li> <li>Observables statistics</li> <li>TTPs statistics</li> </ul> <p>Customize these default dashboards and create new ones from scratch.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/#scope", "title": "Scope", "text": "<p>Dashboards are at the organization level and can't be shared between organizations.</p> <p>However, dashboards can be manually shared between organizations or TheHive instances by exporting and importing. These dashboards remain independent and unlinked, providing a useful template for starting without building from scratch.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/#visibility", "title": "Visibility", "text": "<p>Dashboards can be private or shared with the entire organization.</p> <p>Only the dashboard owner can change its visibility:</p> <ul> <li>For shared dashboards, the default owner is the creator.</li> <li>For private dashboards, the owner is the creator.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/#data-interactions", "title": "Data interactions", "text": "<p>Some widgets allow accessing detailed data directly from dashboards by selecting a value. This action opens the Global search view with predefined filters applied.</p> <p>Data in certain widgets can also be hidden by selecting the corresponding item in the legend.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/#finding-a-dashboard", "title": "Finding a dashboard", "text": "<p>Organizing dashboards into groups makes them easier to find and use. Use the Show items as group button available on the dashboards list to organize dashboards by type.</p> <p>Apply filters and sorting to help locate specific dashboards. These preferences can be saved using views.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/about-dashboards/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageDashboard</code> permission can manage dashboards in TheHive. However, any user can view, download, and export dashboards.</p> <p>Every user has read access to the dashboards within their organization and can export dashboards.</p> <ul> <li>Widgets in Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Export or Import a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Set a Dashboard Display Period</li> <li>Download a Dashboard</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/add-remove-widgets-dashboard/", "title": "Add or Remove Widgets", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/add-remove-widgets-dashboard/#add-or-remove-widgets-in-a-dashboard", "title": "Add or Remove Widgets in a Dashboard", "text": "<p><code>manageDashboard</code></p> <p>This topic provides step-by-step instructions for adding or removing widgets in a dashboard in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/add-remove-widgets-dashboard/#add-widgets-in-a-dashboard", "title": "Add widgets in a dashboard", "text": "<ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>On the dashboards list, select the name of your dashboard.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select .</p> </li> <li> <p>Drag available widgets to position them as needed.</p> <p></p> </li> <li> <p>Enter the required information for the widgets.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/add-remove-widgets-dashboard/#remove-widgets-in-a-dashboard", "title": "Remove widgets in a dashboardNext steps", "text": "<ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>On the dashboards list, select the name of your dashboard.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select  at the top right of the widget you want to remove.</p> </li> <li> <p>Select OK.</p> </li> </ol> <ul> <li>Create a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Export or Import a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Set a Dashboard Display Period</li> <li>Download a Dashboard</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/adjust-dashboard-refresh-frequency/", "title": "Adjust Dashboard Refresh Frequency", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/adjust-dashboard-refresh-frequency/#adjust-dashboard-refresh-frequency", "title": "Adjust Dashboard Refresh Frequency", "text": "<p>This topic provides step-by-step instructions for adjusting dashboard refresh frequency in TheHive.</p> <p>If you need to pause dashboard refresh and prevent users from re-enabling it due to performance issues, see Pause Dashboard Refresh.</p> Procedure <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>On the dashboards list, select the name of your dashboard.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select the desired frequency from the Refresh dropdown list.</p> <p></p> </li> </ol> Next steps <ul> <li>Widgets in Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Export or Import a Dashboard</li> <li>Set a Dashboard Display Period</li> <li>Download a Dashboard</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/change-visibility-of-a-dashboard/", "title": "Change Visibility of a Dashboard", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/change-visibility-of-a-dashboard/#change-the-visibility-of-a-dashboard", "title": "Change the Visibility of a Dashboard", "text": "<p><code>manageDashboard</code></p> <p>This topic provides step-by-step instructions for changing the visibility of a dashboard in TheHive.</p> Procedure <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>Select  next to the relevant dashboard.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select Edit.</p> </li> <li> <p>Select the new visibility you want to apply to your dashboard. Either private or shared with the entire organization.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Widgets in Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> <li>Export or Import a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Set a Dashboard Display Period</li> <li>Download a Dashboard</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/create-a-dashboard/", "title": "Create a Dashboard", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/create-a-dashboard/#create-a-dashboard", "title": "Create a Dashboard", "text": "<p><code>manageDashboard</code></p> <p>This topic provides step-by-step instructions for creating a dashboard in TheHive.</p> <p>You can create a dashboard from scratch or duplicate an existing one.</p> <p>If you want to use a dashboard from another organization or TheHive instance as a template, you can import it.</p> Procedure <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>Two options are available:</p> <ul> <li> <p>Create a dashboard from scratch by selecting .</p> </li> <li> <p>Duplicate an existing dashboard by selecting  next to dashboard you want to duplicate, then select Duplicate.</p> </li> </ul> </li> <li> <p>Select a group to categorize your dashboard. You can either choose an existing group from the list by clicking in the field or create a new one by entering a custom name.</p> </li> <li> <p>Enter a title for your dashboard.</p> </li> <li> <p>Enter a description for your dashboard.</p> </li> <li> <p>Select the visibility you want to apply to your dashboard. Either private or shared with the entire organization.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>On the dashboards list, select the name of your dashboard.</p> </li> <li> <p>Select .</p> </li> <li> <p>Drag available widgets to position them as needed.</p> <p></p> </li> <li> <p>Enter the required information for the widgets.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Add or Remove Widgets in a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Export or Import a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Set a Dashboard Display Period</li> <li>Download a Dashboard</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/delete-a-dashboard/", "title": "Delete a Dashboard", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/delete-a-dashboard/#delete-a-dashboard", "title": "Delete a Dashboard", "text": "<p><code>manageDashboard</code></p> <p>This topic provides step-by-step instructions for deleting a dashboard in TheHive.</p> Procedure <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>Select  next to dashboard you want to delete.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Widgets in Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Export or Import a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Set a Dashboard Display Period</li> <li>Download a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/download-a-dashboard/", "title": "Download a Dashboard", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/download-a-dashboard/#download-a-dashboard", "title": "Download a Dashboard", "text": "<p>This topic provides step-by-step instructions for downloading a dashboard in TheHive.</p> <p>The PNG format is available for both the entire dashboard and individual widgets, while the CSV format is only available for individual widgets.</p> <p>To download your dashboard in JSON format, refer to the Export a Dashboard topic.</p> Procedure <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>On the dashboards list, select the name of your dashboard.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select the Export symbol at the top right of the page to export the entire dashboard.</p> <p></p> </li> <li> <p>Hover below the widget title and select Download as PNG or Download as CSV.</p> <p></p> </li> </ol> Next steps <ul> <li>Widgets in Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Set a Dashboard Display Period</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/export-import-a-dashboard/", "title": "Export or Import a Dashboard", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/export-import-a-dashboard/#export-or-import-a-dashboard", "title": "Export or Import a Dashboard", "text": "<p><code>manageDashboard</code></p> <p>This topic provides step-by-step instructions for exporting and importing a dashboard in TheHive.</p> <p>Find dashboard templates</p> <p>Dashboard templates from the community are available in a dedicated GitHub repository. Contributions are welcome!</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/export-import-a-dashboard/#export-a-dashboard", "title": "Export a dashboard", "text": "<p>Use this procedure to share a dashboard with another organization or TheHive instance.</p> <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>Select  next to the dashboard you want to export, then select Export.</p> <p></p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/export-import-a-dashboard/#import-a-dashboard", "title": "Import a dashboardNext steps", "text": "<p>Use this procedure to use a dashboard from another organization or TheHive instance.</p> <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>Select Import dashboard.</p> </li> <li> <p>In the Import a dashboard drawer, drop a JSON file directly into the Attachment section or select it from your computer. Use the file you obtained from exporting a dashboard.</p> </li> <li> <p>Enter a title for your dashboard.</p> </li> <li> <p>Enter a description for your dashboard.</p> </li> <li> <p>Select the visibility you want to apply to your dashboard. Either private or shared with the entire organization.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Widgets in Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Set a Dashboard Display Period</li> <li>Download a Dashboard</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/set-dashboard-display-period/", "title": "Set a Dashboard Display Period", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/set-dashboard-display-period/#set-a-dashboard-display-period", "title": "Set a Dashboard Display Period", "text": "<p>This topic provides step-by-step instructions for setting a display period for a dashboard in TheHive.</p> <p>If you need to remove the All periods option due to performance issues, see Remove the All Periods Option.</p> Procedure <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>On the dashboards list, select the name of your dashboard.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select the desired display period from the Period dropdown list.</p> <p></p> </li> </ol> Next steps <ul> <li>Widgets in Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> <li>Change the Visibility of a Dashboard</li> <li>Export or Import a Dashboard</li> <li>Adjust Dashboard Refresh Frequency</li> <li>Download a Dashboard</li> <li>Delete a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/", "title": "Widgets", "text": ""}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#widgets-in-dashboards", "title": "Widgets in Dashboards", "text": "<p>Several widget types are available for dashboards in TheHive.</p> <p>This topic describes each widget type and its attributes.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#row-widget", "title": "Row widget", "text": "<p>A row widget is a prerequisite for adding other types of widgets. Each row can contain up to three widgets. If a row already exists, you can add more widgets to it.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#bar-widget", "title": "Bar widget", "text": "<p>Displays grouped data in a vertical bar chart. Useful for comparing categories over time or by type.</p> <p>Bar widget configuration includes:</p> <p>- Title</p> <p>A title to define the widget\u2019s name.</p> <p>- Interval</p> <p>A data grouping interval to structure the visualization.</p> <p>- Entity</p> <p>The specific entity the widget applies to.</p> <p>- Category field</p> <p>The field used for categorizing data.</p> <p>- Date</p> <p>The date field displayed on the chart.</p> <p>- Period field</p> <p>The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</p> <p>- Stack by type</p> <p>The option to stack data in a single bar instead of displaying separate bars.</p> <p>- Logarithmic scale for y-axis</p> <p>The option to apply a logarithmic scale for better visualization of large value differences.</p> <p>- Filters</p> <p>Filters to refine and customize the displayed data.</p> <p>- Customize</p> <p>For certain category fields, you can customize the label and color of each possible value.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#donut-widget", "title": "Donut widget", "text": "<p>Visualizes categorical data as a segmented ring. Ideal for showing proportions or distributions within a dataset.</p> <p>Donut widget configuration includes:</p> <p>- Title</p> <p>A title to define the widget\u2019s name.</p> <p>- Entity</p> <p>The specific entity the widget applies to.</p> <p>- Category field</p> <p>The field used for categorizing data.</p> <p>- Period field</p> <p>The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</p> <p>- Max fragments</p> <p>The maximum number of segments in the donut chart. When the specified number is lower than the total data categories, the system combines the remaining values into an Other segment.</p> <p>- Filters</p> <p>Filters to refine and customize the displayed data.</p> <p>- Display values as percentage?</p> <p>The option to display values as percentages instead of absolute values.</p> <p>- Customize</p> <p>For certain category fields, you can customize the label and color of each possible value.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#line-widget", "title": "Line widget", "text": "<p>Plots one or more data series as lines across a time axis. Useful for identifying trends and comparisons over time.</p> <p>Line widget configuration includes:</p> <p>- Title</p> <p>A title to define the widget\u2019s name.</p> <p>- Interval</p> <p>A data grouping interval to structure the visualization.</p> <p>- Series</p> <p>One or more datasets plotted as visual elements on the chart. Select multiple series to compare different data points over time.</p> <p>Enter the following details:</p> <ul> <li>Entity: The specific entity the series applies to.</li> <li>Date: The date field displayed on the chart.</li> <li>Period field: The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</li> <li>Aggregation: The method used to aggregate data values.</li> <li>Field: Aggregation applies to this data field.</li> <li>Label: The text used to identify the data series in the chart.</li> <li>Type: The visualization style for the series.</li> <li>Color: The color assigned to the data series.</li> <li>Filters: Criteria to refine and customize the displayed data.</li> </ul> <p>- Stack by type</p> <p>The option to stack data in a single bar instead of displaying separate bars.</p> <p>- Logarithmic scale for y-axis</p> <p>The option to apply a logarithmic scale for better visualization of large value differences.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#radar-widget", "title": "Radar widget", "text": "<p>Displays data across multiple categories in a radial chart. Good for comparing multiple variables on the same scale.</p> <p>Radar widget configuration includes:</p> <p>- Title</p> <p>A title to define the widget\u2019s name.</p> <p>- Entity</p> <p>The specific entity the widget applies to.</p> <p>- Category field</p> <p>The field used for categorizing data.</p> <p>- Period field</p> <p>The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</p> <p>- Filters</p> <p>Filters to refine and customize the displayed data.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#counter-widget", "title": "Counter widget", "text": "<p>Shows numeric values with optional thresholds. Useful for displaying KPIs or status metrics at a glance.</p> <p>Counter widget configuration includes:</p> <p>- Title</p> <p>A title to define the widget\u2019s name.</p> <p>- Entity</p> <p>The specific entity the widget applies to.</p> <p>- Period field</p> <p>The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</p> <p>- Filters</p> <p>Filters to refine and customize the displayed data.</p> <p>- Series</p> <p>The counter widget displays one or more datasets. Select multiple series to compare different data points over time.</p> <p>Enter the following details:</p> <ul> <li>Aggregation: The method used to aggregate data values.</li> <li>Label: The text used to identify the data series in the counter widget.</li> <li>Threshold: A reference value to compare the data against.</li> <li>Orientation: Determines how the threshold affects the data display:<ul> <li>Minimum: The data appears in green if it meets or exceeds the threshold.</li> <li>Maximum: The data appears in green if it meets or falls below the threshold.</li> </ul> </li> <li>Filters: Criteria to refine and customize the displayed data.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#text-widget", "title": "Text widget", "text": "<p>Displays rich text or aggregated data using TheHive-flavored Markdown. Useful for contextual notes, summaries, or custom metrics.</p> <p>Text widget configuration includes:</p> <p>- Title</p> <p>A title for the text block.</p> <p>- Template</p> <p>The content of the text block, formatted using TheHive-flavored Markdown syntax.</p> <p>- Series</p> <p>The text block displays one or more datasets. Select multiple series to compare different data points over time.</p> <p>Enter the following details:</p> <ul> <li>Entity: The specific entity the series applies to.</li> <li>Period field: The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</li> <li>Aggregation: The method used to aggregate data values.</li> <li>Label: The text used to identify the data series in the chart.</li> <li>Filters: Criteria to refine and customize the displayed data.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#gauge-widget", "title": "Gauge widget", "text": "<p>Visualizes a single value against a scale using a circular gauge. Ideal for tracking performance against defined thresholds.</p> <p>Gauge widget configuration includes:</p> <p>- Title</p> <p>A title to define the widget\u2019s name.</p> <p>- Entity</p> <p>The specific entity the widget applies to.</p> <p>- Period field</p> <p>The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</p> <p>- Min</p> <p>The minimum value displayed on the gauge. This defines the starting point of the scale.</p> <p>- Medium</p> <p>An intermediate reference value, used to indicate a midpoint in the gauge.</p> <p>- Max</p> <p>The maximum value displayed on the gauge. This defines the upper limit of the scale.</p> <p>- Filters</p> <p>Filters to refine and customize the displayed data.</p>"}, {"location": "thehive/user-guides/analyst-corner/dashboard/widgets-dashboards/#table-widget", "title": "Table widgetNext steps", "text": "<p>5.5</p> <p>Displays data in a tabular format. Useful for listing critical in-progress cases, alerts, or tasks.</p> <p>Table widget configuration includes:</p> <p>- Title</p> <p>A title to define the widget\u2019s name.</p> <p>- Entity</p> <p>The specific entity the widget applies to. Only cases, alerts, and tasks are supported.</p> <p>- Max elements in the table</p> <p>The maximum number of elements to display in the table.</p> <p>- Period field</p> <p>The date field that controls how filters from the Period dropdown at the top of the page apply to the data.</p> <p>- Columns</p> <p>The data fields to display in each column of the table. For optimal visual clarity on a one-third width layout, use no more than three columns. You can configure up to nine columns in total.</p> <p>Excluded data fields</p> <p>Some data fields are excluded and can't be selected:</p> <ul> <li>For cases: <code>description</code>, <code>customFields</code>, <code>tags</code>, <code>userPermissions</code>, <code>extraData</code>, <code>summary</code>, and any computed fields.</li> <li>For alerts: <code>description</code>, <code>customFields</code>, <code>tags</code>, <code>userPermissions</code>, <code>extraData</code>, <code>externalLink</code>, <code>summary</code>, and any computed fields (for example, handlingDuration).</li> <li>For tasks: <code>description</code> and <code>extraData</code>.</li> </ul> <p>- Filters</p> <p>Filters to refine and customize the displayed data.</p> <p>- Sort</p> <p>Sorting rules to refine the displayed data.</p> <ul> <li>About Dashboards</li> <li>Create a Dashboard</li> <li>Add or Remove Widgets in a Dashboard</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-task-logs/", "title": "About Task Logs", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/about-task-logs/#about-task-logs", "title": "About Task Logs", "text": "<p>This topic explains what task logs are and how they're used in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-task-logs/#definition", "title": "Definition", "text": "<p>A task log\u2014also referred to as an activity\u2014is where analysts record their actions, observations, and decisions in response to a task.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-task-logs/#sources", "title": "Sources", "text": "<p>Analysts should create a task log whenever they perform or complete a meaningful action, observation, or decision related to the task. Certain task logs can be automated, but analytical insights and contextual observations typically require manual input.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-task-logs/#examples", "title": "Examples", "text": "<p>No observables allowed</p> <p>Task logs should never include observables. Doing so can make data unsearchable, disorganized, and prevent export to the Malware Information Sharing Platform (MISP). Additionally, links within task logs are clickable, which can be risky.</p> <p>Tasks logs can include actions such as:</p> <ul> <li>Investigating authentication, VPN, or endpoint activity</li> <li>Reviewing system or script execution logs</li> <li>Identifying signs of lateral movement or account compromise</li> <li> <p>Running targeted scans for potential exposures</p> </li> <li> <p>Applying network or system-level containment measures</p> </li> <li> <p>Providing awareness or policy guidance to employees</p> </li> <li> <p>Implementing or reinforcing data protection policies</p> </li> <li> <p>Tuning detection rules for improved accuracy</p> </li> <li> <p>Updating workflows or processes based on incident findings</p> </li> <li> <p>Documenting insights or lessons learned</p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-task-logs/#format", "title": "Format", "text": "<p>Task logs can include text using TheHive-flavored Markdown syntax or images.</p> <p>Adding an image to a task log automatically saves it in the Attachments tab of the case.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-task-logs/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageTask</code> permission can manage task logs in TheHive.</p> <ul> <li>Create a Task Log</li> <li>Delete a Task Log</li> <li>Find a Task Log</li> <li>Find a Task</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/", "title": "About Tasks", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#about-tasks", "title": "About Tasks", "text": "<p>This topic explains tasks, their components, and their behavior in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#definition", "title": "Definition", "text": "<p>A task represents one or more actions, called task logs\u2014also referred to as activities\u2014that must be completed within a case.</p> <ul> <li>Tasks can be mandatory or optional.</li> <li>Tasks organize into groups to improve structure and management.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#sources", "title": "Sources", "text": "<p>Create tasks manually or automatically using alert feeders.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#statuses", "title": "Statuses", "text": "<p>The following task statuses are available in TheHive:</p> <ul> <li>In progress</li> <li>Waiting</li> <li>Cancelled</li> <li>Completed</li> </ul> <p>Task statuses are hard-coded. They can't be modified, deleted, or extended.</p> <p>Marking mandatory tasks as Completed requires creating at least one task log.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#behavior", "title": "Behavior", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#requiring-actions-on-a-task", "title": "Requiring actions on a task", "text": "<p>Require users in any organization to take action on a task. After completion, the task's status remains unchanged. This approach facilitates input or assistance from other teams or business units without impacting the task\u2019s workflow.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#highlighting-important-tasks", "title": "Highlighting important tasks", "text": "<p>TheHive provides the following options to highlight important tasks:</p> <ul> <li>Pin a task: Pin a task to access it from the Tasks tab within a case.</li> <li>Flag a task: Flag a task to highlight it for all users in an organization, making it more visible in the task list.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#closing-a-case-with-open-tasks", "title": "Closing a case with open tasks", "text": "<ul> <li> <p>Closing a case automatically closes all associated tasks, even if some non-mandatory tasks remain incomplete or unassigned.</p> </li> <li> <p>However, the case can't be closed if any mandatory tasks remain incomplete.</p> </li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/about-tasks/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageTask</code> permission can manage tasks in TheHive.</p> <ul> <li>Find a Task</li> <li>Create a Task</li> <li>Share a Task</li> <li>Change a Task Status</li> <li>Manage Tasks</li> <li>Delete a Task</li> <li>Create a Task Log</li> <li>Run Responders and Review Reports for a Task</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/change-task-status/", "title": "Change a Task Status", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/change-task-status/#change-a-task-status", "title": "Change a Task Status", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for changing the status of a task in TheHive.</p> Procedure <ol> <li> <p>Find the task you want to update.</p> </li> <li> <p>In the task details, select a status from the Status dropdown list.</p> <p>Can't change the status?</p> <p>For mandatory tasks, you must create at least one task log before marking them as Completed.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Share a Task</li> <li>Manage Tasks</li> <li>Delete a Task</li> <li>Create a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/close-a-task/", "title": "Close a Task", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/close-a-task/#close-a-task", "title": "Close a Task", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for closing a task in TheHive.</p> <p>Use this procedure to mark the task as Completed. For mandatory tasks, create at least one task log before closing. You can continue recording logs even after closing the task.</p> Procedure <ol> <li> <p>Locate the task you want to close.</p> </li> <li> <p>In the task details, select the status Completed.</p> <p></p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Export a List of Tasks</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/create-a-task-log/", "title": "Create a Task Log", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/create-a-task-log/#create-a-task-log", "title": "Create a Task Log", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for creating a task log in TheHive.</p> <p>A task log\u2014also referred to as an activity\u2014is where analysts record their actions, observations, and decisions in response to a task. Task logs can be recorded at any time, regardless of the task\u2019s status, including when it's marked as Completed.</p> Procedure <ol> <li> <p>Locate the task where you want to create a task log.</p> </li> <li> <p>In the task description, move through the Activity section.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Create a task log drawer, enter the text you want to add in the Log field using TheHive-flavored Markdown syntax.</p> <p>No observables allowed</p> <p>Task logs should never include observables. Doing so can make data unsearchable, disorganized, and prevent export to MISP. Additionally, links within task logs are clickable, which can be risky.</p> </li> <li> <p>Optional: Add images to the task log.</p> <ul> <li> <p>To add an image as an attachment, drop it into the Attachment section or select it from your computer.</p> </li> <li> <p>5.5 To display an image at full size in the Activity feed, drop it into the Log field or use the  symbol.</p> </li> </ul> <p>Wait for the upload to complete</p> <p>Wait until the image path appears in parentheses. If it doesn\u2019t, the upload is still in progress, and the image won\u2019t display as expected.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Delete a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/create-a-task/", "title": "Create a Task", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/create-a-task/#create-a-task", "title": "Create a Task", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for creating a task in TheHive.</p> Procedure <ol> <li> <p>Find the case where you want to add a task.</p> </li> <li> <p>In the case, select the Tasks tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding a task drawer, enter the following information:</p> <p>- Group *</p> <p>The group the task belongs to. Groups help organize and visualize tasks.</p> <p>- Title *</p> <p>The title of the task.</p> <p>- Mandatory *</p> <p>Whether the task is mandatory. Mandatory tasks must contain at least one task log before you can mark them as Completed. You can't close a case until all mandatory tasks are completed.</p> <p>- Description</p> <p>A description of the task using TheHive-flavored Markdown syntax. It appears only in the task preview.</p> <p>- Assignee</p> <p>The person assigned to the task.</p> <p>- Flag this task? *</p> <p>Whether to flag the task to highlight it for all users in your organization. Flagged tasks are more visible in the task list.</p> <p>- Due date</p> <p>The date by which the task should be completed.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Share a Task</li> <li>Change a Task Status</li> <li>Manage Tasks</li> <li>Delete a Task</li> <li>Create a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/delete-a-task-log/", "title": "Delete a Task Log", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/delete-a-task-log/#delete-a-task-log", "title": "Delete a Task Log", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for deleting a task log in TheHive.</p> Procedure <ol> <li> <p>Locate the task log you want to delete.</p> </li> <li> <p>In the task description, move through the Activity section.</p> <p></p> </li> <li> <p>Select  next the task log.</p> </li> <li> <p>Select Remove.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/delete-a-task/", "title": "Delete a Task", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/delete-a-task/#delete-a-task", "title": "Delete a Task", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for deleting a task in TheHive.</p> Procedure <ol> <li> <p>Find the task you want to delete.</p> </li> <li> <p>In the task details, select .</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Share a Task</li> <li>Change a Task Status</li> <li>Create a Task</li> <li>Manage Tasks</li> <li>Create a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/export-list-of-tasks/", "title": "Export a List of Tasks", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/export-list-of-tasks/#export-a-list-of-tasks", "title": "Export a List of Tasks", "text": "<p>This topic provides step-by-step instructions for exporting a list of tasks in TheHive.</p> Procedure <ol> <li> <p>Go to the Tasks view from the sidebar menu.</p> <p></p> </li> <li> <p>Select Export list to export all displayed tasks, reflecting the applied filters and sorting. To export a specific selection of tasks, select  next to the tasks you want to export, then select Export selection.</p> <p></p> </li> <li> <p>In the Export tasks to file drawer, select your preferred formatting options.</p> </li> <li> <p>Select Export to file.</p> </li> </ol> Next steps <ul> <li>Change a Task Status</li> <li>Manage a Task</li> <li>Delete a Task</li> <li>Create a Task Log</li> <li>Delete a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/manage-a-task/", "title": "Manage Tasks", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/manage-a-task/#manage-tasks", "title": "Manage Tasks", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for managing a task in TheHive.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/manage-a-task/#set-a-task-as-mandatory-or-optional", "title": "Set a task as mandatory or optional", "text": "<ol> <li> <p>Find the task you want to update.</p> </li> <li> <p>In the task details, turn the Mandatory toggle on or off.</p> <p>Mandatory tasks must contain at least one task log before you can mark them as Completed. You can't close a case until all mandatory tasks are completed.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/tasks/manage-a-task/#change-the-task-assignee", "title": "Change the task assignee", "text": "<ol> <li> <p>Find the task you want to update.</p> </li> <li> <p>In the task details, select a new assignee.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/tasks/manage-a-task/#pin-a-task", "title": "Pin a task", "text": "<p>Pinning a task allows you to access it from the Tasks tab within a case. Pins are personal and only visible to you.</p> <ol> <li> <p>Find the task you want to pin.</p> </li> <li> <p>In the task details, select .</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/tasks/manage-a-task/#flag-a-task", "title": "Flag a taskNext steps", "text": "<p>Flagging a task highlights it for all users in your organization, making it more visible in the task list.</p> <ol> <li> <p>Find the task you want to flag.</p> </li> <li> <p>In the task details, select .</p> </li> <li> <p>Select Flag.</p> </li> </ol> <ul> <li>Share a Task</li> <li>Change a Task Status</li> <li>Create a Task</li> <li>Delete a Task</li> <li>Create a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task-log/", "title": "Run Responders and Review Reports for a Task Log", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task-log/#run-responders-and-review-reports-for-a-task-log", "title": "Run Responders and Review Reports for a Task Log", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for running responders on a task log and reviewing responder reports in TheHive.</p> <p>Responders execute actions on cases, alerts, observables, tasks, and task logs.</p> <p>Run a responder on a task log to take actions such as improving its readability or clarity.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task-log/#run-responders-on-a-task-log", "title": "Run responders on a task log", "text": "<ol> <li> <p>Locate the task that contains the task log on which you want to run responders.</p> </li> <li> <p>In the task, move through the Activity section and select  next to the relevant task log.</p> <p></p> </li> <li> <p>Select Responders.</p> </li> <li> <p>In the Run actions on current task log drawer, select the responders you want to run.</p> </li> <li> <p>Select Launch actions.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task-log/#review-responder-reports-for-a-task-log", "title": "Review responder reports for a task logNext steps", "text": "<ol> <li> <p>Locate the task that contains the task log on which you ran responders.</p> </li> <li> <p>In the task, move through the Activity section and select  next to the task log.</p> <p></p> </li> <li> <p>Select Show responder reports.</p> </li> </ol> <ul> <li>Manage a Task</li> <li>Run Responders and Review Reports for a Task</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task/", "title": "Run Responders and Review Reports for a Task", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task/#run-responders-and-review-reports-for-a-task", "title": "Run Responders and Review Reports for a Task", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for running responders on a task and reviewing responder reports in TheHive.</p> <p>Responders execute actions on cases, alerts, observables, tasks, and task logs.</p> <p>Run a responder on a task to take actions such as summarizing task logs.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task/#run-responders-on-a-task", "title": "Run responders on a task", "text": "<ol> <li> <p>Locate the task on which you want to run responders.</p> </li> <li> <p>In the task, select Responders.</p> <p></p> </li> <li> <p>In the Run actions on current task drawer, select the responders you want to run.</p> </li> <li> <p>Select Launch actions.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/analyst-corner/tasks/run-responders-on-a-task/#review-responder-reports-for-a-task", "title": "Review responder reports for a taskNext steps", "text": "<ol> <li> <p>Locate the task on which you ran responders.</p> </li> <li> <p>In the task details, move through the Responder reports section to check the status of the executed responders.</p> <p></p> </li> </ol> <ul> <li>Manage a Task</li> <li>Run Responders and Review Reports for a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/share-a-task/", "title": "Share a Task with Other Organizations", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/share-a-task/#share-a-task-with-other-organizations", "title": "Share a Task with Other Organizations", "text": "<p><code>manageCase/update</code> <code>manageShare</code></p> <p>This topic provides step-by-step instructions for manually sharing a task in a shared case with linked organizations in TheHive.</p> <p>Shared cases only</p> <p>To share a task manually, the case must already be shared with the relevant linked organizations. If not, refer to How to Share a Case.</p> <p>This is useful when task sharing rules are set to manual, ensuring that users share only the relevant tasks.</p> <p>To learn more about how sharing rules function and interact, see the About Organizations Sharing Rules topic.</p> Procedure <ol> <li> <p>Locate the shared case where you want to share the task.</p> </li> <li> <p>In the case, select the Tasks tab.</p> <p></p> </li> <li> <p>Select the task you want to share.</p> </li> <li> <p>Move through the Shares section.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select the linked organization to share the task with.</p> </li> <li> <p>Select Add share.</p> </li> </ol> Next steps <ul> <li>Share an Observable</li> <li>Share a Case</li> <li>Change a Task Status</li> <li>Manage Tasks</li> <li>Delete a Task</li> <li>Create a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/start-a-task/", "title": "Start a Task", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/start-a-task/#start-a-task", "title": "Start a Task", "text": "<p><code>manageTask</code></p> <p>This topic provides step-by-step instructions for starting a task in TheHive.</p> <p>Use this procedure to indicate that you have started working on a task. This action automatically changes the task status to In progress.</p> Procedure <ol> <li> <p>Locate the task you want to start.</p> </li> <li> <p>In the task details, select .</p> <p></p> </li> <li> <p>Select Start.</p> </li> </ol> Next steps <ul> <li>Create a Task Log</li> <li>Manage Tasks</li> <li>Run Responders on a Task</li> <li>Share a Task</li> <li>Close a Task</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/find-a-task-log/", "title": "Find a Task Log", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/find-a-task-log/#find-a-task-log", "title": "Find a Task Log", "text": "<p>This topic provides step-by-step instructions for searching a task log in TheHive.</p> <p>A task log is a recorded history of actions, updates, or decisions taken on a specific task. It provides a detailed audit trail that helps track investigation progress, accountability, and compliance.</p> <p>Can't find a task log?</p> <p>5.5 Case visibility can be restricted to protect sensitive data. If you aren't an authorized user, its linked tasks and task logs won't appear in the list, search results, or dashboards.</p> Procedure <ol> <li> <p>Go to the Global Search view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Task logs item on the Search scope pane.</p> <p></p> <p>All elements</p> <p>Select the All elements item for a comprehensive tool-wide overview that includes all entity types, such as cases, alerts, observables, jobs, tasks, and task logs. Use this option to analyze cross-linked information or to conduct a detailed investigation.</p> </li> <li> <p>Enter the keywords you want to search for in the search box displayed by default.</p> <p>5.4.7 Wildcard character</p> <p>You can use the wildcard character * to broaden your searches.</p> <p>The wildcard character acts as a placeholder that matches zero or more characters, helping you find variations of a term or incomplete information.</p> <p>Examples of use cases:</p> <ul> <li>Email domains: Entering *@gmail.com will return entities containing the gmail.com domain.</li> <li>IP subnets: Entering 192.168.*.* will return entities with IP addresses in the 192.168.x.x subnet.</li> <li>URLs: Entering https://malwaredomain.com/* will return entities hosted under the malwaredomain.com directory.</li> </ul> <p>Other advanced search options, such as Boolean and phrase searches, are not currently supported.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p> </li> <li> <p>If you need additional filters, apply one or more filters by selecting Add new filter. </p> <p>These filters refine your search results and act as an equivalent to the AND operator in Boolean search.</p> <p>Required filters</p> <p>Filters are required for the following fields to ensure the search engine accurately interprets values:</p> <ul> <li>Fields with specific date formats</li> <li>Custom fields</li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> Next steps <ul> <li>Delete a Task Log</li> <li>Run Responders and Review Reports for a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/find-a-task/", "title": "Find a Task", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/find-a-task/#find-a-task", "title": "Find a Task", "text": "<p>This topic provides step-by-step instructions for using various methods to search for a task in TheHive.</p> <p>If you\u2019re unsure which method to use, refer to the Overview of Search Methods for Tasks topic.</p> <p>Can't find a task?</p> <ul> <li>Ensure autorefresh is turned on to automatically display new tasks in lists.</li> <li>5.5 Case visibility can be restricted to protect sensitive data. If you aren't an authorized user, its linked tasks won't appear in the list, search results, or dashboards.</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/find-a-task/#method-1-tasks-tab-in-cases-descriptions", "title": "Method 1: Tasks tab in cases descriptions", "text": "<p>Use this method if you want to find one or more tasks related to a case and want to perform actions on them simultaneously.</p> <ol> <li> <p>Open a case and select the Tasks tab.</p> <p></p> </li> <li> <p>Apply filters using any of these options individually or in combination:</p> <ul> <li> <p>Select Quick filters to access predefined filters.</p> <p></p> </li> <li> <p>Turn on the Filters toggle and enter one or more filters.</p> <p></p> </li> <li> <p>Select a value from a field to use it as a filter criterion.</p> <p></p> </li> </ul> <p>Saving views</p> <p>If you frequently use filters, consider saving your preferences as views for easy reuse. For more information on filtering and sorting, see About Filtering and Sorting.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> <p>Show tasks per group</p> <p>You can display tasks per group to classify them by type, making them easier to find.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/find-a-task/#method-2-filters-in-the-tasks-view", "title": "Method 2: Filters in the Tasks view", "text": "<p>Use this method if you need to search for one or more tasks without requiring simultaneous actions.</p> <ol> <li> <p>Go to the Tasks view from the sidebar menu.</p> <p></p> </li> <li> <p>Apply filters using any of these options individually or in combination:</p> <ul> <li> <p>Select Quick filters to access predefined filters.</p> <p></p> </li> <li> <p>Turn on the Filters toggle and enter one or more filters.</p> <p></p> </li> <li> <p>Select a value from a field to use it as a filter criterion.</p> <p></p> </li> </ul> <p>Saving views</p> <p>If you frequently use filters, consider saving your preferences as views for easy reuse. For more information on filtering and sorting, see About Filtering and Sorting.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/find-a-task/#method-3-global-search-feature", "title": "Method 3: Global Search featureNext steps", "text": "<p>Use this method if you need to conduct advanced searches for one or more tasks without requiring simultaneous actions.</p> <ol> <li> <p>Go to the Global Search view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Tasks item on the Search scope pane.</p> <p></p> <p>All elements</p> <p>Select the All elements item for a comprehensive tool-wide overview that includes all entity types, such as cases, alerts, observables, jobs, tasks, and task logs. Use this option to analyze cross-linked information or to conduct a detailed investigation.</p> </li> <li> <p>Enter the keywords you want to search for in the search box displayed by default.</p> <p>5.4.7 Wildcard character</p> <p>You can use the wildcard character * to broaden your searches.</p> <p>The wildcard character acts as a placeholder that matches zero or more characters, helping you find variations of a term or incomplete information.</p> <p>Examples of use cases:</p> <ul> <li>Email domains: Entering *@gmail.com will return entities containing the gmail.com domain.</li> <li>IP subnets: Entering 192.168.*.* will return entities with IP addresses in the 192.168.x.x subnet.</li> <li>URLs: Entering https://malwaredomain.com/* will return entities hosted under the malwaredomain.com directory.</li> </ul> <p>Other advanced search options, such as Boolean and phrase searches, are not currently supported.</p> <p>Case sensitivity</p> <p>Partial-word searches and filters are case sensitive in Elasticsearch, so capitalization matters.</p> </li> <li> <p>If you need additional filters, apply one or more filters by selecting Add new filter. </p> <p>These filters refine your search results and act as an equivalent to the AND operator in Boolean search.</p> <p>Required filters</p> <p>Filters are required for the following fields to ensure the search engine accurately interprets values:</p> <ul> <li>Fields with specific date formats</li> <li>Custom fields</li> </ul> </li> <li> <p>Based on your inputs, a list of results appears.</p> </li> </ol> <p>You can view up to 300 results per page and navigate through them using Previous and Next.</p> <ul> <li>Create a Task</li> <li>Share a Task</li> <li>Change a Task Status</li> <li>Manage Tasks</li> <li>Delete a Task</li> <li>Create a Task Log</li> <li>Run Responders and Review Reports for a Task</li> <li>Run Responders and Review Reports for a Task Log</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/overview-search-methods-task/", "title": "Overview of Search Methods for Tasks", "text": ""}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/overview-search-methods-task/#overview-of-search-methods-for-tasks", "title": "Overview of Search Methods for Tasks", "text": "<p>TheHive offers multiple methods for searching tasks, each tailored to specific scenarios.</p> <p>This topic provides an overview of the available search methods, compares their features, and explains when to use each one.</p> <p>Use this guide to choose the most effective method for your needs.</p>"}, {"location": "thehive/user-guides/analyst-corner/tasks/search-for-tasks/overview-search-methods-task/#search-method-comparison", "title": "Search method comparisonNext steps", "text": "Method Filter options Result scope Allows bulk actions Use case Tasks tab in cases descriptions Multiple Multiple Yes If you want to find one or more tasks related to a case and want to perform actions on them simultaneously. Filters in the Tasks view Multiple Multiple No If you need to search for one or more tasks without requiring simultaneous actions. Global Search feature Advanced Multiple No If you need to conduct advanced searches for one or more tasks without requiring simultaneous actions. <ul> <li>How to Find an Task</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/views/about-views/", "title": "About Views", "text": ""}, {"location": "thehive/user-guides/analyst-corner/views/about-views/#about-views", "title": "About Views", "text": "<p>Views save filters and sorting applied to a list in TheHive.</p> <p>This topic explains how views function in TheHive.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p>"}, {"location": "thehive/user-guides/analyst-corner/views/about-views/#default-view", "title": "Default view", "text": "<p>A Default view without filters or sorting is always available. Modifying or deleting this view isn't permitted.</p>"}, {"location": "thehive/user-guides/analyst-corner/views/about-views/#actions", "title": "Actions", "text": "<p>Users have the ability to create custom views tailored to their specific needs or update existing views as necessary. When a view is no longer useful, it can be deleted to keep the workspace organized.</p> <p>To switch between different views, users select the current view in the top-left corner of the screen.</p> <p></p>"}, {"location": "thehive/user-guides/analyst-corner/views/about-views/#scope", "title": "Scope", "text": "<p>Views are user-specific and list-specific, meaning each user has access to their own saved views, which apply only to a specific list.</p>"}, {"location": "thehive/user-guides/analyst-corner/views/about-views/#behavior", "title": "BehaviorNext steps", "text": "<p>The last used view is automatically applied by default when accessing a list.</p> <ul> <li>About Filtering and Sorting</li> <li>Create a Custom View</li> <li>Update a Custom View</li> <li>Delete a Custom View</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/views/create-a-custom-view/", "title": "Create a Custom View", "text": ""}, {"location": "thehive/user-guides/analyst-corner/views/create-a-custom-view/#create-a-custom-view", "title": "Create a Custom View", "text": "<p>This topic provides step-by-step instructions for creating a custom view in TheHive.</p> <p>Use this procedure to save the filters and sorting preferences applied to a list for easy reuse.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> Procedure <ol> <li> <p>Adjust the filters and sorting on the list as desired.</p> </li> <li> <p>Select the current view name followed by an asterisk (*).</p> <p></p> </li> <li> <p>Select Save view as to save your changes as a new view.</p> </li> <li> <p>In the Save current view drawer, enter the name of the view.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Update a Custom View</li> <li>Delete a Custom View</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/views/delete-a-custom-view/", "title": "Delete a Custom View", "text": ""}, {"location": "thehive/user-guides/analyst-corner/views/delete-a-custom-view/#delete-a-custom-view", "title": "Delete a Custom View", "text": "<p>This topic provides step-by-step instructions for deleting a custom view in TheHive.</p> <p>Default view</p> <p>You can't delete the Default view.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> Procedure <ol> <li> <p>Select the current view name followed by an asterisk (*).</p> <p></p> </li> <li> <p>Select Manage views.</p> </li> <li> <p>Select  next to the view you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> </ol> Next steps <ul> <li>Create a Custom View</li> <li>Update a Custom View</li> </ul>"}, {"location": "thehive/user-guides/analyst-corner/views/update-a-custom-view/", "title": "Update a Custom View", "text": ""}, {"location": "thehive/user-guides/analyst-corner/views/update-a-custom-view/#update-a-custom-view", "title": "Update a Custom View", "text": "<p>This topic provides step-by-step instructions for updating a custom view in TheHive.</p> <p>Default view</p> <p>You can't modify the Default view.</p> <p>Beta feature available for filters and views</p> <p>5.5.6 A beta feature to enhance user experience for filters and views is available for testing on lists of cases, alerts, tasks, and observables. For detailed instructions on how to activate this beta feature, see Activate the Beta of Filters and Views.</p> Procedure <ol> <li> <p>Adjust the filters and sorting on the list as desired.</p> </li> <li> <p>Select the current view name followed by an asterisk (*).</p> <p></p> </li> <li> <p>Select Save view.</p> </li> </ol> Next steps <ul> <li>Create a Custom View</li> <li>Delete a Custom View</li> </ul>"}, {"location": "thehive/user-guides/key-performance-indicators/key-performance-indicators/", "title": "KPIs", "text": ""}, {"location": "thehive/user-guides/key-performance-indicators/key-performance-indicators/#key-performance-indicators", "title": "Key Performance Indicators", "text": "<p>5.1</p> <p>TheHive provides valuable insights into event and incident time metrics, enabling you to track key performance indicators (KPIs) for cases and alerts.</p> <p>These KPIs are displayed by default on all cases and alerts in TheHive. However, you can hide some or all indicators if they're not useful or may be misleading for your organization.</p> <p>You can also include these KPIs in dashboards and case reports.</p> <p>This topic defines each of these indicators.</p> <p>Units</p> <p>If the unit of an indicator is not explicitly mentioned, values are in milliseconds.</p>"}, {"location": "thehive/user-guides/key-performance-indicators/key-performance-indicators/#time-to-detect-ttd", "title": "Time to detect (TTD)", "text": "<p>The time it takes to set the status of a case or alert to one linked to the New stage in TheHive after the event occurs. This metric helps assess the effectiveness of your monitoring tools and detection capabilities.</p> KPI Formula In case description In alert description Time to detect (TTD) = date of status New - event date = <code>case.newDate</code> - <code>case.startDate</code> = <code>alert.newDate</code> - <code>alert.date</code>"}, {"location": "thehive/user-guides/key-performance-indicators/key-performance-indicators/#time-to-triage-ttt", "title": "Time to triage (TTT)", "text": "<p>The time it takes for your security team to acknowledge a case or alert by changing its status to one linked to the In Progress stage in TheHive. It reflects how efficiently alerts and cases are reviewed and escalated for investigation.</p> KPI Formula In case description In alert description Time to triage (TTT) = date of status In Progress - date of status New = <code>case.inProgressDate</code> - <code>case.newDate</code> = <code>alert.inProgressDate</code> - <code>alert.newDate</code>"}, {"location": "thehive/user-guides/key-performance-indicators/key-performance-indicators/#time-to-acknowledge-tta", "title": "Time to acknowledge (TTA)", "text": "<p>The time it takes for your security team to acknowledge a case or alert by changing its status to one linked to the In Progress stage after the event occurs. This measures the responsiveness of your team after detecting a potential security incident.</p> KPI Formula In case description In alert description Time to acknowledge (TTA) = date of status In Progress - event date = <code>case.inProgressDate</code> - <code>case.startDate</code> = <code>alert.inProgressDate</code> - <code>alert.date</code>"}, {"location": "thehive/user-guides/key-performance-indicators/key-performance-indicators/#time-to-qualify-ttq", "title": "Time to qualify (TTQ)", "text": "<p>The time it takes for your security team to analyze an alert and determine whether it is a true positive or false positive, resulting in case closure or merging into a case. This metric helps measure the accuracy and speed of the qualification process.</p> KPI Formula In case description In alert description Time to qualify (TTQ) = date of alert closure or merge into case - date of status New = <code>max(alert.importedDate, alert.closedDate)</code> - <code>alert.newDate</code> not applicable"}, {"location": "thehive/user-guides/key-performance-indicators/key-performance-indicators/#time-to-resolve-ttr", "title": "Time to resolve (TTR)Next steps", "text": "<p>The time it takes for your security team to fully resolve an incident after its status is set to one linked to the In Progress stage. This includes investigation, remediation, and closure, indicating the efficiency of your incident response process.</p> KPI Formula In case description In alert description Time to resolve (TTR) = end of the incident date - date of status In Progress = <code>case.endDate</code> - <code>min(alert.inProgressDate, case.inProgressDate)</code> not applicable <p>handlingDuration</p> <p>The <code>handlingDuration</code> field is available for cases and alerts in the API. The calculation is based on the difference between the end of the case date or the alert merge into case date, and the incident creation date in TheHive.  </p> <p>This field is a relic from older TheHive versions and can be slow to calculate. Use the time to resolve metric instead.</p> <p>For more information on these KPIs, consult this SecurityScorecard blog post.</p> <ul> <li>Date Field Definitions for Alerts and Cases</li> <li>Hide Key Performance Indicators</li> <li>Measure Case Performance</li> <li>Measure Alert Performance</li> </ul>"}, {"location": "thehive/user-guides/key-performance-indicators/measure-alert-management-performance/", "title": "Measure Alert Management Performance", "text": ""}, {"location": "thehive/user-guides/key-performance-indicators/measure-alert-management-performance/#measure-alert-management-performance", "title": "Measure Alert Management Performance", "text": "<p>This topic provides step-by-step instructions for measuring alert management performance in TheHive.</p> <p>You can measure alert management performance for all alerts in your organization or a specific case.</p> <p>If you want to know more about the key performance indicators (KPIs) available in TheHive, refer to the Key Performance Indicators topic.</p> <p>Automated actions</p> <p>If alerts are created or updated through automated actions (API, functions, or external services), some indicators may be identical or very close in value, especially if multiple operations occur within the same second.</p>"}, {"location": "thehive/user-guides/key-performance-indicators/measure-alert-management-performance/#measure-the-performance-of-all-alerts-in-your-organization", "title": "Measure the performance of all alerts in your organization", "text": "<p><code>manageDashboard</code></p> <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>Select a dashboard related to alerts.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select Edit on the section where you want to add your alert management KPIs.</p> </li> <li> <p>Select any value that begins with timeTo to any Filters box.</p> </li> </ol> <p>Units</p> <p>If the unit of an indicator is not explicitly mentioned, values are in milliseconds.</p>"}, {"location": "thehive/user-guides/key-performance-indicators/measure-alert-management-performance/#measure-the-performance-of-a-specific-alert", "title": "Measure the performance of a specific alertNext steps", "text": "<ol> <li> <p>Locate the case you want to check.</p> </li> <li> <p>In the alert, move through the Time metrics section in the left pane.</p> <p></p> </li> <li> <p>Review the available indicators for your alert.</p> </li> </ol> <ul> <li>Measure Case Performance</li> </ul>"}, {"location": "thehive/user-guides/key-performance-indicators/measure-case-management-performance/", "title": "Measure Case Management Performance", "text": ""}, {"location": "thehive/user-guides/key-performance-indicators/measure-case-management-performance/#measure-case-management-performance", "title": "Measure Case Management Performance", "text": "<p>This topic provides step-by-step instructions for measuring case management performance in TheHive.</p> <p>You can measure case management performance for all cases in your organization or a specific case.</p> <p>If you want to know more about the key performance indicators (KPIs) available in TheHive, refer to the Key Performance Indicators topic.</p> <p>Automated actions</p> <p>If cases are created or updated through automated actions (API, functions, or external services), some indicators may be identical or very close in value, especially if multiple operations occur within the same second.</p>"}, {"location": "thehive/user-guides/key-performance-indicators/measure-case-management-performance/#measure-the-performance-of-all-cases-in-your-organization", "title": "Measure the performance of all cases in your organization", "text": "<p><code>manageDashboard</code></p> <ol> <li> <p>Go to the Dashboards view from the sidebar menu.</p> <p></p> </li> <li> <p>Select a dashboard related to cases.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select Edit on the section where you want to add your case management KPIs.</p> </li> <li> <p>Select any value that begins with timeTo to any Filters box.</p> </li> </ol> <p>Units</p> <p>If the unit of an indicator is not explicitly mentioned, values are in milliseconds.</p>"}, {"location": "thehive/user-guides/key-performance-indicators/measure-case-management-performance/#measure-the-performance-of-a-specific-case", "title": "Measure the performance of a specific caseNext steps", "text": "<p>Two options are available to measure a case's performance:</p> <p>In a case description:</p> <ol> <li> <p>Locate the case you want to check.</p> </li> <li> <p>In the case, move through the Time metrics section in the left pane.</p> <p></p> </li> <li> <p>Review the available indicators for your case.</p> </li> </ol> <p>In a case report template:</p> <p><code>manageCaseReportTemplate</code></p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Reports tab.</p> <p> </p> </li> <li> <p>Select a case report template.</p> </li> <li> <p>Select  on the section where you want to add your case management KPIs.</p> </li> <li> <p>Select Add variable.</p> </li> <li> <p>Select any value that begins with timeTo.</p> </li> </ol> <p>Units</p> <p>If the unit of an indicator is not explicitly mentioned, values are in milliseconds.</p> <ul> <li>Measure Alert Performance</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/about-case-pages/", "title": "About Case Pages", "text": ""}, {"location": "thehive/user-guides/knowledge-base/about-case-pages/#about-case-pages", "title": "About Case Pages", "text": "<p>Case pages in TheHive enable the creation and sharing of valuable information within a team on a specific case. They support documenting lessons learned, writing reports, recording meeting notes, and sharing content that enhances collaboration and knowledge sharing.</p> <p>This topic describes how case pages support teamwork and ensures important information remains available to the team.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-case-pages/#permanent-vs-temporary-documentation", "title": "Permanent vs. temporary documentation", "text": "<p>Case pages are intended for temporary documentation, useful during investigations but not necessarily retained long-term, and they can't be searched. In contrast, Knowledge Base pages store knowledge that should be preserved for future reference. To retain information from case pages, manually copy the content to a Knowledge Base page.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-case-pages/#templates", "title": "Templates", "text": "<p>Templates are available for case pages.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-case-pages/#flavored-markdown", "title": "Flavored Markdown", "text": "<p>Case pages use TheHive-flavored Markdown syntax for formatting.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-case-pages/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>managePage</code> permission can manage case pages in TheHive.</p> <p>Users with the necessary permissions can edit and delete any page, regardless of who created it.</p> <ul> <li>Create a Case Page</li> <li>Delete a Case Page</li> <li>View a Case Page</li> <li>Share a Case Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/about-knowledge-base/", "title": "About the Knowledge Base", "text": ""}, {"location": "thehive/user-guides/knowledge-base/about-knowledge-base/#about-the-knowledge-base", "title": "About the Knowledge Base", "text": "<p>The Knowledge Base in TheHive enables the creation and sharing of valuable information within a team. It supports documenting lessons learned, writing reports, recording meeting notes, and sharing content that enhances collaboration and knowledge sharing.</p> <p>This topic describes how the Knowledge Base supports teamwork and ensures important information remains available to the team.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-knowledge-base/#organization-wide-sharing", "title": "Organization-wide sharing", "text": "<p>Knowledge Base pages are shared across the entire organization and accessible to all users.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-knowledge-base/#permanent-vs-temporary-documentation", "title": "Permanent vs. temporary documentation", "text": "<p>The Knowledge Base stores knowledge intended for long-term preservation and future reference. For temporary documentation\u2014useful during active investigations but not meant to be retained permanently\u2014use case pages instead.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-knowledge-base/#flavored-markdown", "title": "Flavored Markdown", "text": "<p>Knowledge Base pages use TheHive-flavored Markdown syntax for formatting.</p>"}, {"location": "thehive/user-guides/knowledge-base/about-knowledge-base/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageKnowledgeBase</code> permission can manage the Knowledge Base in TheHive.</p> <p>Users with the necessary permissions can edit and delete any page, regardless of who created it.</p> <ul> <li>Create a Knowledge Base Page</li> <li>Delete a Knowledge Base Page</li> <li>View a Knowledge Base Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/create-a-case-page/", "title": "Create a Page", "text": ""}, {"location": "thehive/user-guides/knowledge-base/create-a-case-page/#create-a-case-page", "title": "Create a Case Page", "text": "<p><code>managePage</code></p> <p>This topic provides step-by-step instructions for creating a case page in TheHive.</p> <p>Use this procedure to store temporary, case-specific knowledge that\u2019s useful during investigations but isn\u2019t retained long term. To preserve information from case pages for the long term, manually copy the content to a Knowledge Base page.</p> Procedure <ol> <li> <p>Find the case where you want to add a page.</p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>Select one of the following options:</p> <p>Create new page</p> <p>To start with a blank page, enter the following information:</p> <ul> <li>Title: The title of your page.</li> <li>Category: The category your page belongs to. Pages are visually grouped by category for easier navigation. If the category doesn't exist, it will be created automatically.</li> </ul> <p>Use an existing page template</p> <p>To apply a case page template to your new page, select one or more templates. The icons next to the selected pages turn green when selected.</p> </li> <li> <p>Select Add page.</p> </li> <li> <p>Select .</p> </li> <li> <p>Write your content using TheHive-flavored Markdown syntax.</p> </li> <li> <p>Select Preview to vizualize the rendering of your content.</p> </li> <li> <p>Select  to save your page.</p> </li> </ol> Next steps <ul> <li>Delete a Case Page</li> <li>View a Case Page</li> <li>Share a Case Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/create-a-knowledge-base-page/", "title": "Create a Page", "text": ""}, {"location": "thehive/user-guides/knowledge-base/create-a-knowledge-base-page/#create-a-knowledge-base-page", "title": "Create a Knowledge Base Page", "text": "<p><code>manageKnowledgeBase</code></p> <p>This topic provides step-by-step instructions for creating a page in the TheHive Knowledge Base.</p> <p>Use this procedure to store knowledge that should be preserved for future reference, such as lessons learned, reports, and meeting notes.</p> Procedure <ol> <li> <p>Go to the Knowledge Base view from the sidebar menu.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Add a page to the Knowledge Base drawer, enter the following information:</p> <p>Title</p> <p>The title of your page.</p> <p>Category</p> <p>The category your page belongs to. Pages are visually grouped by category for easier navigation. If the category doesn't exist, it will be created automatically.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>Select .</p> </li> <li> <p>Write your content using TheHive-flavored Markdown syntax.</p> </li> <li> <p>Select Preview to vizualize the rendering of your content.</p> </li> <li> <p>Select  to save your page.</p> </li> </ol> Next steps <ul> <li>Delete a Knowledge Base Page</li> <li>View a Knowledge Base Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/delete-a-case-page/", "title": "Delete a Page", "text": ""}, {"location": "thehive/user-guides/knowledge-base/delete-a-case-page/#delete-a-case-page", "title": "Delete a Case Page", "text": "<p><code>managePage</code></p> <p>This topic provides step-by-step instructions for deleting a case page in TheHive.</p> Procedure <ol> <li> <p>Find the case where you want to delete a page.</p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select or hover over the page you want to delete in the right pane.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Case Page</li> <li>View a Case Page</li> <li>Share a Case Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/delete-a-knowledge-base-page/", "title": "Delete a Page", "text": ""}, {"location": "thehive/user-guides/knowledge-base/delete-a-knowledge-base-page/#delete-a-knowledge-base-page", "title": "Delete a Knowledge Base Page", "text": "<p><code>manageKnowledgeBase</code></p> <p>This topic provides step-by-step instructions for deleting a Knowledge Base page in TheHive.</p> Procedure <ol> <li> <p>Go to the Knowledge Base view from the sidebar menu.</p> <p></p> </li> <li> <p>Select or hover over the page you want to delete in the right pane.</p> </li> <li> <p>Select .</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Knowledge Base Page</li> <li>View a Knowledge Base Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/share-a-case-page/", "title": "Share a Page", "text": ""}, {"location": "thehive/user-guides/knowledge-base/share-a-case-page/#share-a-case-page", "title": "Share a Case Page", "text": "<p>This topic provides step-by-step instructions for sharing a case page.</p> <p>Use this procedure to share a case page with your teammates through a messaging tool, for instance.</p> Procedure <ol> <li> <p>Find the case where you want to share a page.</p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select or hover over the page you want to share in the right pane.</p> </li> <li> <p>Select .</p> </li> </ol> Next steps <ul> <li>Create a Case Page</li> <li>Delete a Case Page</li> <li>View a Case Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/view-a-case-page/", "title": "View a Page", "text": ""}, {"location": "thehive/user-guides/knowledge-base/view-a-case-page/#view-a-case-page", "title": "View a Case Page", "text": "<p>This topic provides step-by-step instructions for viewing a case page in TheHive.</p> Procedure <ol> <li> <p>Find the case where you want to view a page.</p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select the page you want to view in the right pane.</p> </li> </ol> Next steps <ul> <li>Create a Case Page</li> <li>Delete a Case Page</li> <li>Share a Case Page</li> </ul>"}, {"location": "thehive/user-guides/knowledge-base/view-a-knowledge-base-page/", "title": "View a Page", "text": ""}, {"location": "thehive/user-guides/knowledge-base/view-a-knowledge-base-page/#view-a-knowledge-base-page", "title": "View a Knowledge Base Page", "text": "<p>This topic provides step-by-step instructions for viewing a Knowledge Base page in TheHive.</p> Procedure <ol> <li> <p>Go to the Knowledge Base view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the page you want to view in the right pane.</p> </li> </ol> Next steps <ul> <li>Create a Knowledge Base Page</li> <li>Delete a Knowledge Base Page</li> </ul>"}, {"location": "thehive/user-guides/organization/about-audit-logs/", "title": "About Audit Logs", "text": ""}, {"location": "thehive/user-guides/organization/about-audit-logs/#about-audit-logs", "title": "About Audit Logs", "text": "<p>Audit logs in TheHive record all user actions, ensuring full traceability of activities performed within the platform.</p> <p>Every create, update, delete, merge, and function invocation generates an audit entry that captures comprehensive details about the action, the user who performed it, and the affected objects.</p> <p>TheHive displays audit logs graphically in the History tab within case and alert descriptions.</p> <p>Tag and custom field changes</p> <p>5.5.9 Starting with TheHive 5.5.9, audit logs now record updates to tags and custom fields.</p>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#key-use-cases", "title": "Key use cases", "text": "<p>Audit logs provide critical insights into system activity and security that are usually used to:</p>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#workflow-automation", "title": "Workflow automation", "text": "<p>Audit logs stream to orchestration platforms like SOAR systems, where specific events trigger automated response workflows. For example, when an analyst escalates a case severity, the audit log can automatically notify the incident response team.</p>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#security-monitoring", "title": "Security monitoring", "text": "<p>Security teams forward audit logs to SIEM systems to detect anomalous behavior patterns. Unusual access patterns, privilege escalations, or bulk data modifications generate alerts for immediate investigation.</p>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#activity-traceability", "title": "Activity traceability", "text": "<p>The History tab maintains a permanent record of all case and alert modifications. This immutable audit trail satisfies regulatory requirements and enables forensic analysis of incident handling procedures.</p>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#audit-log-structure", "title": "Audit log structure", "text": "<p>Each audit log entry contains fields that capture the complete context of an action:</p>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#core-identification-fields", "title": "Core identification fields", "text": "<ul> <li><code>_id</code>: Unique identifier of the audit log entry.</li> <li><code>_type</code>: Always contains the value <code>Audit</code>.</li> <li><code>_createdBy</code>: Email address of the user who performed the action.</li> <li><code>_createdAt</code>: Timestamp when the action occurred\u2014Unix timestamp in milliseconds.</li> </ul>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#action-details", "title": "Action details", "text": "<ul> <li><code>action</code>: Type of action performed, which can be <code>create</code>, <code>update</code>, <code>delete</code>, <code>merge</code> or <code>invoke</code> for functions.</li> <li><code>mainAction</code>: Boolean\u2014<code>true</code> for the primary action; <code>false</code> for a derived event, for example when the action occurs in another organization that shares elements with this one.</li> <li><code>requestId</code>: Unique identifier of the HTTP request that triggered the audit entry.</li> <li><code>details</code>: JSON object containing only the modified fields and their new values.</li> </ul>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#object-information", "title": "Object information", "text": "<ul> <li><code>objectId</code>: The <code>_id</code> of the directly affected object.</li> <li><code>objectType</code>: The <code>_type</code> of the affected object.</li> <li><code>object</code>: Complete state of the object after the modification.</li> <li><code>rootId</code>: The <code>_id</code> of the parent object. For example, the case ID when a task is modified.</li> </ul>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#organizational-context", "title": "Organizational context", "text": "<ul> <li><code>context</code>: Full description of the parent object, providing complete situational awareness.</li> <li><code>organisation</code>: Organization receiving the audit event, which may differ from the performing organization in sharing scenarios.</li> </ul>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#example-audit-entries", "title": "Example audit entries", "text": ""}, {"location": "thehive/user-guides/organization/about-audit-logs/#case-status-update-from-new-to-inprogress", "title": "Case status update from New to InProgress", "text": "<pre><code>{\n  \"_id\": \"~327684328\",\n  \"_type\": \"Audit\",\n  \"_createdBy\": \"alice@example.com\",\n  \"_createdAt\": 1694441999960,\n  \"action\": \"update\",\n  \"mainAction\": true,\n  \"requestId\": \"74dc37479904ebe7:3957d351:18a847d4266:-8000:109\",\n  \"rootId\": \"~327925760\",\n  \"details\": {\n    \"status\": \"InProgress\",\n    \"stage\": \"InProgress\"\n  },\n  \"objectId\": \"~327925760\",\n  \"objectType\": \"Case\",\n  \"object\": {\n    \"_id\": \"~327925760\",\n    \"_type\": \"Case\",\n    \"_createdBy\": \"sami@example.com\",\n    \"_updatedBy\": \"alice@example.com\",\n    \"_createdAt\": 1693412835689,\n    \"_updatedAt\": 1694441999230,\n    \"number\": 34,\n    \"title\": \"Suspicious network activity detected\",\n    \"description\": \"***Description***\",\n    \"severity\": 3,\n    \"severityLabel\": \"HIGH\",\n    \"startDate\": 1693151602000,\n    \"tags\": [\n      \"tagA\"\n    ],\n    \"flag\": false,\n    \"tlp\": 2,\n    \"tlpLabel\": \"AMBER\",\n    \"pap\": 1,\n    \"papLabel\": \"GREEN\",\n    \"status\": \"InProgress\",\n    \"stage\": \"InProgress\",\n    \"assignee\": \"sami@example.com\",\n    \"customFields\": [],\n    \"userPermissions\": [],\n    \"extraData\": {},\n    \"newDate\": 1693412835673,\n    \"inProgressDate\": 1694441998841,\n    \"timeToDetect\": 261233673,\n    \"timeToTriage\": 1029163168,\n    \"timeToAcknowledge\": 1290396841,\n    \"customFieldValues\": {}\n  },\n  \"context\": {\n    \"_id\": \"~327925760\",\n    \"_type\": \"Case\",\n    \"_createdBy\": \"sami@example.com\",\n    \"_updatedBy\": \"alice@example.com\",\n    \"_createdAt\": 1693412835689,\n    \"_updatedAt\": 1694441999230,\n    \"number\": 34,\n    \"title\": \"Suspicious network activity detected\",\n    \"description\": \"***Description***\",\n    \"severity\": 3,\n    \"severityLabel\": \"HIGH\",\n    \"startDate\": 1693151602000,\n    \"tags\": [\n      \"tagA\"\n    ],\n    \"flag\": false,\n    \"tlp\": 2,\n    \"tlpLabel\": \"AMBER\",\n    \"pap\": 1,\n    \"papLabel\": \"GREEN\",\n    \"status\": \"InProgress\",\n    \"stage\": \"InProgress\",\n    \"assignee\": \"sami@example.com\",\n    \"customFields\": [],\n    \"userPermissions\": [],\n    \"extraData\": {},\n    \"newDate\": 1693412835673,\n    \"inProgressDate\": 1694441998841,\n    \"timeToDetect\": 261233673,\n    \"timeToTriage\": 1029163168,\n    \"timeToAcknowledge\": 1290396841,\n    \"customFieldValues\": {}\n  },\n  \"organisation\": {\n    \"organisationId\": \"~4169864\",\n    \"organisation\": \"TheOrganization\"\n  }\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/about-audit-logs/#custom-field-update-from-support-to-engineering", "title": "Custom field update from Support to Engineering", "text": "<p>5.5.9</p> <pre><code>{\n  \"_id\": \"~327684328\",\n  \"_type\": \"Audit\",\n  \"_createdBy\": \"alice@example.com\",\n  \"_createdAt\": 1694441999960,\n  \"action\": \"update\",\n  \"mainAction\": true,\n  \"requestId\": \"74dc37479904ebe7:3957d351:18a847d4266:-8000:109\",\n  \"rootId\": \"~327925760\",\n  \"details\": {\n    \"customFields\": [\n      {\n        \"_id\": \"business-unit:Engineering\",\n        \"name\": \"business-unit\",\n        \"type\": \"string\",\n        \"value\": \"Engineering\",\n        \"order\": 0\n      }\n    ],\n    \"customFieldChanges\": [\n      {\n        \"operation\": \"valuesAdded\",\n        \"name\": \"business-unit\",\n        \"values\": [\n          \"Engineering\"\n        ]\n      },\n      {\n        \"operation\": \"valuesRemoved\",\n        \"name\": \"business-unit\",\n        \"values\": [\n          \"Support\"\n        ]\n      }\n    ]\n  },\n  \"objectId\": \"~327925760\",\n  \"objectType\": \"Case\",\n  \"object\": {\n    \"_id\": \"~327925760\",\n    \"_type\": \"Case\",\n    \"_createdBy\": \"sami@example.com\",\n    \"_updatedBy\": \"alice@example.com\",\n    \"_createdAt\": 1693412835689,\n    \"_updatedAt\": 1694441999230,\n    \"number\": 34,\n    \"title\": \"Suspicious network activity detected\",\n    \"description\": \"***Description***\",\n    \"severity\": 3,\n    \"severityLabel\": \"HIGH\",\n    \"startDate\": 1693151602000,\n    \"tags\": [\"tagA\"],\n    \"flag\": false,\n    \"tlp\": 2,\n    \"tlpLabel\": \"AMBER\",\n    \"pap\": 1,\n    \"papLabel\": \"GREEN\",\n    \"status\": \"InProgress\",\n    \"stage\": \"InProgress\",\n    \"assignee\": \"sami@example.com\",\n    \"customFields\": [\n      {\n        \"_id\": \"business-unit:Engineering\",\n        \"name\": \"business-unit\",\n        \"type\": \"string\",\n        \"value\": \"Engineering\",\n        \"order\": 0\n      }\n    ],\n    \"userPermissions\": [],\n    \"extraData\": {},\n    \"newDate\": 1693412835673,\n    \"inProgressDate\": 1694441998841,\n    \"timeToDetect\": 261233673,\n    \"timeToTriage\": 1029163168,\n    \"timeToAcknowledge\": 1290396841,\n    \"customFieldValues\": {\n      \"business-unit\": \"Engineering\"\n    }\n  },\n  \"context\": {\n    \"_id\": \"~327925760\",\n    \"_type\": \"Case\",\n    \"_createdBy\": \"sami@example.com\",\n    \"_updatedBy\": \"alice@example.com\",\n    \"_createdAt\": 1693412835689,\n    \"_updatedAt\": 1694441999230,\n    \"number\": 34,\n    \"title\": \"Suspicious network activity detected\",\n    \"description\": \"***Description***\",\n    \"severity\": 3,\n    \"severityLabel\": \"HIGH\",\n    \"startDate\": 1693151602000,\n    \"tags\": [\n      \"tagA\"\n    ],\n    \"flag\": false,\n    \"tlp\": 2,\n    \"tlpLabel\": \"AMBER\",\n    \"pap\": 1,\n    \"papLabel\": \"GREEN\",\n    \"status\": \"InProgress\",\n    \"stage\": \"InProgress\",\n    \"assignee\": \"sami@example.com\",\n    \"customFields\": [\n      {\n        \"_id\": \"business-unit:Engineering\",\n        \"name\": \"business-unit\",\n        \"type\": \"string\",\n        \"value\": \"Engineering\",\n        \"order\": 0\n      }\n    ],\n    \"userPermissions\": [],\n    \"extraData\": {},\n    \"newDate\": 1693412835673,\n    \"inProgressDate\": 1694441998841,\n    \"timeToDetect\": 261233673,\n    \"timeToTriage\": 1029163168,\n    \"timeToAcknowledge\": 1290396841,\n    \"customFieldValues\": {\n      \"business-unit\": \"Engineering\"\n    }\n  },\n  \"organisation\": {\n    \"organisationId\": \"~4169864\",\n    \"organisation\": \"TheOrganization\"\n  }\n}\n</code></pre> Next steps <ul> <li>Write a FilteredEvent Trigger</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/add-an-attachment-organization/", "title": "Add an Attachment", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/add-an-attachment-organization/#add-an-attachment-to-an-organization", "title": "Add an Attachment to an Organization", "text": "<p><code>manageKnowledgeBase</code></p> <p>This topic provides step-by-step instructions for adding an attachment to an organization in TheHive.</p> <p>To add an attachment to a case or an alert, see Add an Attachment to a Case or an Alert.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attachments tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Add attachment drawer, drop a file or select it from your computer.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Remove an Attachment from an Organization</li> <li>Share an Attachment from an Organization</li> <li>Download an Attachment from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/download-an-attachment-organization/", "title": "Download an Attachment", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/download-an-attachment-organization/#download-an-attachment-from-an-organization", "title": "Download an Attachment from an Organization", "text": "<p><code>manageKnowledgeBase</code></p> <p>This topic provides step-by-step instructions for downloading an attachment from an organization in TheHive.</p> <p>To download an attachment from a case or an alert, see Download an Attachment from a Case or an Alert.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment you want to download.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Download.</p> </li> </ol> Next steps <ul> <li>Add an Attachment to an Organization</li> <li>Remove an Attachment from an Organization</li> <li>Share an Attachment from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/remove-an-attachment-organization/", "title": "Remove an Attachment", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/remove-an-attachment-organization/#remove-an-attachment-from-an-organization", "title": "Remove an Attachment from an Organization", "text": "<p><code>manageKnowledgeBase</code></p> <p>This topic provides step-by-step instructions for removing an attachment from an organization in TheHive.</p> <p>To remove an attachment from a case or an alert, see Remove an Attachment from a Case or an Alert.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment you want to remove.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Remove.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Add an Attachment to an Organization</li> <li>Share an Attachment from an Organization</li> <li>Download an Attachment from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/share-an-attachment-organization/", "title": "Share an Attachment", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-attachments/share-an-attachment-organization/#share-an-attachment-from-an-organization", "title": "Share an Attachment from an Organization", "text": "<p><code>manageKnowledgeBase</code></p> <p>This topic provides step-by-step instructions for sharing an attachment from an organization in TheHive.</p> <p>To share an attachment from a case or an alert, see Share an Attachment from a Case or an Alert.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Attachments tab.</p> <p></p> </li> <li> <p>Select  next to the attachment to copy its URL.</p> <p>Applying filters</p> <p>You can apply filters to quickly find what you need.</p> </li> <li> <p>Select Copy URL.</p> </li> </ol> Next steps <ul> <li>Add an Attachment to an Organization</li> <li>Remove an Attachment from an Organization</li> <li>Download an Attachment from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/about-custom-tags/", "title": "About Custom Tags", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/about-custom-tags/#about-custom-tags", "title": "About Custom Tags", "text": "<p>Custom tags are one of the tag categories in TheHive.</p> <p>These free-text labels are created when users add them to cases, alerts, or observables.</p> <p>This topic explains how custom tags work.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/about-custom-tags/#scope", "title": "Scope", "text": "<p>Custom tags are specific to a single organization and can't be shared between organizations or TheHive instances. Tags can contain sensitive data without risking exposure outside the organization.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/about-custom-tags/#sources", "title": "Sources", "text": "<p>Custom tags can be created:</p> <ul> <li>Manually by users when added to cases, alerts, or observables</li> <li>Automatically by connected external tools</li> <li>Automatically by email servers</li> <li>Automatically by alert feeders</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/about-custom-tags/#actions", "title": "Actions", "text": "<ul> <li> <p>Create custom tags by adding them directly to cases, alerts, and observables. Custom tags can't duplicate tags already present in a taxonomy, even if that taxonomy is deactivated.</p> <p>Consistent naming</p> <p>Tag usage must be consistent, as TheHive doesn't enforce standardization. For example, tags with different formatting, such as Phishing and phishing, are treated as separate tags.</p> </li> <li> <p>Manage custom tags by:</p> <ul> <li>Changing the color of a custom tag</li> <li>Renaming a custom tag</li> <li>Deleting a custom tag</li> </ul> <p>Changes applied everywhere</p> <p>Modifying or deleting a custom tag applies to all instances of that tag across cases, alerts, and observables within the organization.</p> </li> <li> <p>View the number of times a custom tag appears in cases, case templates, alerts, and observables. This helps with cleanup and maintaining consistent naming.</p> </li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/about-custom-tags/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageTag</code> permission can manage custom tags in TheHive.</p> <p>Users can create new custom tags by adding them directly to cases, alerts, and observables.</p> <ul> <li>Change the Color of a Custom Tag</li> <li>Rename a Custom Tag</li> <li>View Custom Tag Statistics</li> <li>Delete a Custom Tag</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/change-the-color-of-a-custom-tag/", "title": "Change the Color of a Custom Tag", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/change-the-color-of-a-custom-tag/#change-the-color-of-a-custom-tag", "title": "Change the Color of a Custom Tag", "text": "<p><code>manageTag</code></p> <p>This topic provides step-by-step instructions for changing the color of a custom tag in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom tags tab.</p> <p></p> </li> <li> <p>Select  in the Color column for the custom tag you want to update.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Enter the hex color code, or select  to open the color picker.</p> </li> <li> <p>Select .</p> </li> </ol> Next steps <ul> <li>Rename a Custom Tag</li> <li>View Custom Tag Statistics</li> <li>Delete a Custom Tag</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/delete-a-custom-tag/", "title": "Delete a Custom Tag", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/delete-a-custom-tag/#delete-a-custom-tag", "title": "Delete a Custom Tag", "text": "<p><code>manageTag</code></p> <p>This topic provides step-by-step instructions for deleting a custom tag in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom tags tab.</p> <p></p> </li> <li> <p>Select  next to the custom tag to delete.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Rename a Custom Tag</li> <li>Change the Color of a Custom Tag</li> <li>View Custom Tag Statistics</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/rename-a-custom-tag/", "title": "Rename a Custom Tag", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/rename-a-custom-tag/#rename-a-custom-tag", "title": "Rename a Custom Tag", "text": "<p><code>manageTag</code></p> <p>This topic provides step-by-step instructions for renaming a custom tag in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom tags tab.</p> <p></p> </li> <li> <p>Select the name of the custom tag you want to change.</p> <p>Applying filters and views</p> <p>Apply filters and sorting and save preferences using views.</p> </li> <li> <p>Select .</p> </li> </ol> Next steps <ul> <li>Change the Color of a Custom Tag</li> <li>View Custom Tag Statistics</li> <li>Delete a Custom Tag</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/view-custom-tag-statistics/", "title": "View Custom Tag Statistics", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-custom-tags/view-custom-tag-statistics/#view-custom-tag-statistics", "title": "View Custom Tag Statistics", "text": "<p><code>manageTag</code></p> <p>This topic provides step-by-step instructions for viewing custom tag statistics in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Custom tags tab.</p> <p></p> </li> </ol> Next steps <ul> <li>Rename a Custom Tag</li> <li>Change the Color of a Custom Tag</li> <li>Delete a Custom Tag</li> <li>Add or Remove Tags</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/about-endpoints/", "title": "About Endpoints", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/about-endpoints/#about-endpoints", "title": "About Endpoints", "text": "<p>An endpoint is an entry point in a communication channel where two systems interact.</p> <p>In the Hive, endpoints can be local, defined at the organization level, or global, defined at the client level for one or more organizations.</p> <p>This topic explains when an endpoint is required in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/about-endpoints/#notifiers-endpoints", "title": "Notifiers endpointsNext steps", "text": "<p>Endpoints are required in TheHive to configure the following notifiers:</p> <ul> <li>HttpRequest notifier</li> <li>Mattermost notifier</li> <li>Slack notifier</li> <li>Teams notifier</li> <li>Webhook notifier</li> </ul> <ul> <li>Add a Global Endpoint</li> <li>Add a Local HttpRequest Endpoint</li> <li>Add a Local Mattermost Endpoint</li> <li>Add a Local Slack Endpoint</li> <li>Add a Local Teams Endpoint</li> <li>Add a Local Webhook Endpoint</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-http-request-endpoint/", "title": "Add a Local HttpRequest Endpoint", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-http-request-endpoint/#add-a-local-httprequest-endpoint", "title": "Add a Local HttpRequest Endpoint", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for adding a local HttpRequest endpoint in TheHive.</p> <p>Once created, this endpoint is available solely for your organization. To create an endpoint for multiple organizations, refer to the Add a Global Endpoint topic.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Endpoints tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Endpoint creation drawer, select Http.</p> </li> <li> <p>Enter the following information:</p> <p>- Name</p> <p>The endpoint name, used to identify this HttpRequest integration in TheHive. This name must be unique, as two endpoints can't have the same name.</p> <p>- Method</p> <p>Select an HTTP method from the dropdown list.</p> <p>- URL</p> <p>The destination URL where the HTTP request should be sent. This must be a valid and accessible endpoint.</p> </li> <li> <p>Select  in the Headers section to add headers.</p> <p>Enter a header key and its corresponding value to include in the HTTP request. Use headers to send authentication tokens, content types, or other metadata required by the external system.</p> </li> <li> <p>In the Authentication section, select an authentication type if required.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure the HttpRequest Notifier</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-mattermost-endpoint/", "title": "Add a Local Mattermost Endpoint", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-mattermost-endpoint/#add-a-local-mattermost-endpoint", "title": "Add a Local Mattermost Endpoint", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for adding a local Mattermost endpoint in TheHive.</p> <p>Once created, this endpoint is available solely for your organization. To create an endpoint for multiple organizations, refer to the Add a Global Endpoint topic.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Endpoints tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Endpoint creation drawer, select Mattermost.</p> </li> <li> <p>Enter the following information:</p> <p>- Name *</p> <p>The endpoint name, used to identify this Mattermost integration in TheHive. This name must be unique, as two endpoints can't have the same name.</p> <p>- URL *</p> <p>The URL used to connect to your Mattermost instance.</p> <p>- Username</p> <p>The default username used to send messages. If left blank, the default username configured in Mattermost will be used.</p> <p>- Channel</p> <p>The default channel used to send messages. If specified, this overrides the default channel set in the Mattermost webhook configuration.</p> </li> <li> <p>In the Authentication section, select an authentication type if required.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure the Mattermost Notifier</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-slack-endpoint/", "title": "Add a Local Slack Endpoint", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-slack-endpoint/#add-a-local-slack-endpoint", "title": "Add a Local Slack Endpoint", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for adding a local Slack endpoint in TheHive.</p> <p>Once created, this endpoint is available solely for your organization. To create an endpoint for multiple organizations, refer to the Add a Global Endpoint topic.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Endpoints tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Endpoint creation drawer, select Slack.</p> </li> <li> <p>Enter the following information:</p> <p>- Name</p> <p>The endpoint name, used to identify this Slack integration in TheHive. This name must be unique, as two endpoints can't have the same name.</p> <p>- Token</p> <p>The authentication token required to connect to Slack.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure the Slack Notifier</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-teams-endpoint/", "title": "Add a Local Teams Endpoint", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-teams-endpoint/#add-a-local-microsoft-teams-endpoint", "title": "Add a Local Microsoft Teams Endpoint", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for adding a local Microsoft Teams endpoint in TheHive.</p> <p>Once created, this endpoint is available solely for your organization. To create an endpoint for multiple organizations, refer to the Add a Global Endpoint topic.</p> Procedure"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-teams-endpoint/#step-1-create-a-flow-in-microsoft-teams", "title": "Step 1: Create a flow in Microsoft Teams", "text": "If you are using TheHive 5.4.3 or laterIf you are using TheHive 5.4.2 or earlier <ol> <li> <p>Go to your Microsoft Teams application.</p> </li> <li> <p>Select .</p> <p></p> </li> <li> <p>Select the Workflows application.</p> <p></p> </li> <li> <p>In the Workflows application, select New flow.</p> </li> <li> <p>In the template search bar, enter Send webhook alerts to a channel.</p> </li> <li> <p>Select the template Send webhook alerts to a channel.</p> </li> <li> <p>Enter your flow name.</p> </li> <li> <p>Select Next.</p> </li> <li> <p>Select a Microsoft Teams team and channel.</p> </li> <li> <p>Select Create flow.</p> </li> <li> <p>Copy the HTTP POST URL.</p> </li> </ol> <p>For TheHive versions earlier than 5.4.3, users can still send notifications to Microsoft Teams using Incoming Webhooks. This method simply requires creating a webhook and adding its URL to TheHive\u2019s settings.</p> <p>While easy to set up, this legacy approach lacks the customization and enhanced security features provided by the newer Workflows integration. Moreover, with Microsoft deprecating Incoming Webhooks, this method may become less reliable or lose functionality in the future.</p> <p>Migrating to the Workflows application for Microsoft Teams integration</p> <p>With the 5.4.3 release, TheHive has updated the Microsoft Teams notifier in response to Microsoft deprecation of the Incoming Webhooks. Users must now migrate from the legacy webhook setup to a new configuration using the Workflows application.</p> <p>Migration expected by January 31, 2025</p> <p>As announced by Microsoft on their official blog, Connector owners must update their webhook URLs by January 31, 2025, to comply with the new structure. This update is crucial for maintaining seamless integration and ensuring the continued functionality of Connectors in Microsoft Teams.</p> <p>For detailed instructions, refer to Microsoft official documentation on creating an Incoming Webhook.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-teams-endpoint/#step-2-create-a-microsoft-teams-endpoint", "title": "Step 2: Create a Microsoft Teams endpoint", "text": "<ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Endpoints tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Endpoint creation drawer, select Teams.</p> </li> <li> <p>Enter the following information:</p> <p>- Name</p> <p>The endpoint name, used to identify this Microsoft Teams integration in TheHive. This name must be unique, as two endpoints can't have the same name.</p> <p>- URL</p> <p>The URL used to connect to your Microsoft Teams. This should be the HTTP POST URL generated by the Workflows application or Incoming Webhooks, depending on your configuration.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure the Teams Notifier</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-webhook-endpoint/", "title": "Add a Local Webhook Endpoint", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-endpoints/add-webhook-endpoint/#add-a-local-webhook-endpoint", "title": "Add a Local Webhook Endpoint", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for adding a local Webhook endpoint in TheHive.</p> <p>Once created, this endpoint is available solely for your organization. To create an endpoint for multiple organizations, refer to the Add a Global Endpoint topic.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Endpoints tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Endpoint creation drawer, select Webhook.</p> </li> <li> <p>Enter the following information:</p> <p>- Name</p> <p>The endpoint name, used to identify this webhook integration in TheHive. This name must be unique, as two endpoints can't have the same name.</p> <p>- URL</p> <p>The URL to which TheHive will send webhook requests.</p> <p>- Version</p> <p>Enter the webhook version supported by your external system. This determines the payload format and request structure that TheHive will use when sending data.</p> </li> <li> <p>In the Authentication section, select an authentication type if required.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Configure the Webhook Notifier</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/about-feeders/", "title": "About Alert Feeders", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/about-feeders/#about-alert-feeders", "title": "About Alert Feeders", "text": "<p>5.5 Platinum</p> <p>Alert feeders enable TheHive to retrieve data from external systems on a schedule, eliminating the need for external tools to push data.</p> <p>This topic provides an overview of the scope and usage of alert feeders in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/about-feeders/#how-alert-feeders-work", "title": "How alert feeders work", "text": "<p>Alert feeders allow an organization to automate data retrieval at a defined frequency from an external service through an HTTP API call. The retrieved data is then converted into alerts using a function. Each alert feeder supports only one function.</p> <p>Alert feeders don't perform bi-directional synchronization.</p> <p>In addition to alerts, alert feeders can also generate cases and tasks</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/about-feeders/#feeder-functions", "title": "Feeder functions", "text": "<p>Feeder function examples</p> <p>Feeder function examples are available in a dedicated GitHub repository.</p> <p>A feeder function transforms data retrieved from the HTTP API call and converts it into the expected TheHive format to create alerts.</p> <p>Avoid creating a feeder function as a standalone function, as it can't link to an alert feeder. Instead, create it directly within the alert feeder. After creation, the function automatically appears in the functions list with the type feeder. </p> <p>Modify the function either from the functions list or within the alert feeder configuration.</p> <p>Deleting an alert feeder doesn't remove its associated function. To remove the function, follow the steps in Delete a Function.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/about-feeders/#authentication-modes", "title": "Authentication modes", "text": "<p>Currently, alert feeders support the following four authentication methods:</p> <ul> <li>None</li> <li>Basic</li> <li>Key</li> <li>Bearer</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/about-feeders/#example-integrations", "title": "Example integrations", "text": "<p>Use an alert feeder to integrate any external system that exposes a public REST API with supported authentication modes and supports synchronous data retrieval into TheHive, including:</p> <ul> <li>Jira</li> <li>Airtable</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/about-feeders/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageConfig</code> permission can manage alert feeders in TheHive.</p> <ul> <li>Create an Alert Feeder</li> <li>Turn Off an Alert Feeder</li> <li>Delete an Alert Feeder</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/create-a-feeder/", "title": "Create an Alert Feeder", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/create-a-feeder/#create-an-alert-feeder", "title": "Create an Alert Feeder", "text": "<p>5.5 <code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for creating an alert feeder in TheHive, with an example for Airtable.</p> <p>Use this procedure to automatically retrieve data at a defined frequency from an external service via an HTTP API call and convert it into alerts in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the General settings section, enter the following information:</p> <p>- Name</p> <p>A unique name for the alert feeder. You can\u2019t change this name later.</p> <p>- Interval</p> <p>How often the alert feeder sends requests to the external system.</p> <p>Define the interval carefully based on your reactivity requirements</p> <p>Make sure the interval is shorter than the processing time to avoid potential issues, but not too short to prevent excessive requests to the API.</p> <p>- Request timeout time</p> <p>The maximum time, in seconds, the alert feeder waits for a response before timing out.</p> <p>- Request response max size</p> <p>The maximum response size, in megabytes, that the alert feeder accepts from the external system.</p> <p>- Description</p> <p>A description to provide additional context or notes about the alert feeder configuration.</p> </li> <li> <p>In the HTTP request section, enter the following information:</p> <p>- Method</p> <p>The HTTP method to use when requesting data from the external system.</p> <p>- URL</p> <p>The endpoint URL of the external system.</p> </li> <li> <p>Select  in the Headers section to add headers.</p> <p>Enter a header key and its corresponding value to include in the HTTP request. Use headers to send authentication tokens, content types, or other metadata required by the external system.</p> </li> <li> <p>In the Authentication section, select an authentication type if required.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <p>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See Configure JVM Trust for SSL/TLS Certificates for instructions.</p> <p>You can turn off the Don't check certificate authority toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.</p> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Test connection to verify the connection to the external system.</p> </li> <li> <p>Create a function to map fields from the external system to TheHive\u2019s format:</p> <p>Feeder function</p> <p>Once created, the function is automatically added to the functions list with the type feeder. </p> <p>- Function name</p> <p>Enter a name for the function. You can\u2019t change this name later.</p> <p>- Description</p> <p>Describe what the function does.</p> <p>- Definition</p> <p>Enter the JavaScript code for your function. If you need inspiration, check out the GitHub repository with function examples.</p> <p>Basic function structure</p> <p>In TheHive, a function follows this basic structure:</p> <pre><code>function handle(input, context) {\n    // Your function logic goes here\n}\n</code></pre> <ul> <li>The <code>handle</code> function: This is where you write your script. Your function must be placed inside this structure.</li> <li>The <code>input</code> parameter: This represents the data passed into the function. Its content depends on how the function is triggered.</li> <li>The <code>context</code> parameter: This provides access to TheHive\u2019s environment, allowing your function to interact with common TheHive actions.</li> </ul> <p>Duplicate management</p> <p>Make sure to implement duplicate management in your functions to prevent duplicate objects.</p> </li> <li> <p>In the Test function section, you can test your function as follows:</p> <pre><code>* Enter input data by selecting *input*.\n\n* Select one of the following:\n\n    * **Run function (dry-run)** to simulate the function without sending data.\n    * **Run function** to execute the function with actual data.\n\n* After running the function, select one of the following to view results:\n\n    * *result* to view the function\u2019s output\n    * *stdout* to display standard output from the function\n    * *stderr* to display errors and warnings\n</code></pre> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/create-a-feeder/#airtable-example", "title": "Airtable example", "text": "<p>Airtable is one of the external systems you can configure as an alert feeder in TheHive. Airtable is a cloud-based platform that combines the features of a spreadsheet and a database.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/create-a-feeder/#query", "title": "Query", "text": "<pre><code>--location --request GET 'https://api.airtable.com/v0/&lt;base_id&gt;/&lt;table_id&gt;?returnFieldsByFieldId=false&amp;cellFormat=string&amp;timeZone=&lt;timezone&gt;&amp;userLocale=&lt;locale&gt;' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Bearer &lt;api_key&gt;' \\\n--data '{\n    \"returnFieldsByFieldId\": true,\n    \"maxRecords\": 1\n}'\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/create-a-feeder/#response", "title": "Response", "text": "<pre><code>{\n    \"records\": [\n        {\n            \"id\": \"rec3mzMkF2JNsApxn\",\n            \"createdTime\": \"2025-01-23T16:18:13.000Z\",\n            \"fields\": {\n                \"Incident Category\": \"Security\",\n                \"Issue Description\": \"Phishing campaign on financial department\"\n            }\n        },\n        {\n            \"id\": \"rec5FB3iOuoT9avrm\",\n            \"createdTime\": \"2025-01-23T17:50:56.000Z\",\n            \"fields\": {\n                \"Incident Category\": \"Software\",  \n                \"Reported By\": \"U003\",  \n                \"Priority Level\": \"ASAP\",  \n                \"Assigned Agent\": \"SOC Officer\",  \n                \"Department\": \"Supply chain\",  \n                \"Issue Description\": \"Supply chain server SPC-345 infected\",  \n                \"Resolution Details\": \"RES-003\"\n            }\n        },\n        {\n            \"id\": \"rec6FGdVFzMQX3Ke4\",\n            \"createdTime\": \"2025-01-21T14:00:49.000Z\",\n            \"fields\": {\n                \"Incident Category\": \"Security\",\n                \"Reported By\": \"Automated alert\",\n                \"Priority Level\": \"ASAP\",\n                \"Issue Description\": \"Software version need to be updated\"\n            }\n        },\n        ...\n    ]\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/create-a-feeder/#feeder-function", "title": "Feeder function", "text": "<p>You can find the function example for creating an alert from Airtable in the GitHub repository.</p> Next steps <ul> <li>Turn Off an Alert Feeder</li> <li>Delete an Alert Feeder</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/delete-a-feeder/", "title": "Delete an Alert Feeder", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/delete-a-feeder/#delete-an-alert-feeder", "title": "Delete an Alert Feeder", "text": "<p>5.5 <code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for deleting an alert feeder in TheHive.</p> <p>Deleting an alert feeder doesn't delete the associated feeder function</p> <p>When you delete an alert feeder, the associated function remains. To remove the function, follow the instructions in Delete a Function.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select  next to the alert feeder you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create an Alert Feeder</li> <li>Turn Off an Alert Feeder</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/turn-off-a-feeder/", "title": "Turn Off an Alert Feeder", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-feeders/turn-off-a-feeder/#turn-off-an-alert-feeder", "title": "Turn Off an Alert Feeder", "text": "<p>5.5 <code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for turning off an alert feeder in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Connectors tab.</p> <p></p> </li> <li> <p>Select the alert feeder you want to edit, or select  next to the alert feeder and then select Edit.</p> </li> <li> <p>Turn off the Enable toggle.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Create an Alert Feeder</li> <li>Delete an Alert Feeder</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/", "title": "About Functions", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#about-functions", "title": "About Functions", "text": "<p>5.1 Platinum</p> <p>A function in TheHive is a controlled JavaScript code block that must be written within TheHive\u2019s interface and runs securely within the platform. This code operates on a restricted set of predefined features, ensuring that it can't access the full JavaScript language or execute arbitrary code outside the platform's security boundaries.</p> <p>It accepts inputs from external sources, processes data, and interacts with TheHive API to integrate external applications into its workflow.</p> <p>For example, use a function to create alerts within TheHive without requiring an additional Python service for data conversion.</p> <p>Contribute!</p> <p>Examples of function use cases are available in a dedicated GitHub repository. Contributions are welcome!</p> <p>This topic provides details on the different types and uses of functions in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#function-endpoints", "title": "Function endpoints", "text": "<p>Creating a function in TheHive automatically adds a new public endpoint to the TheHive public API, making it easy to call from an external system.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#trigger-sources", "title": "Trigger sources", "text": "<p>Various sources can trigger functions in TheHive:</p> <ul> <li> <p>User actions in TheHive: Triggered by specific actions performed within TheHive</p> </li> <li> <p>Automation: Triggered to automate manual or repetitive tasks, either on a schedule or based on predefined conditions</p> </li> <li> <p>Notifications: Triggered by an event in TheHive that generates a notification</p> </li> <li> <p>External systems (push method): Triggered when an external system, such as a detection tool, pushes data to TheHive</p> </li> <li> <p>5.5 External systems (pull method): Triggered when TheHive retrieves data from an external system using an alert feeder</p> </li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#common-use-cases", "title": "Common use cases", "text": "<p>Functions in TheHive automate workflows, process data, and enhance case management.</p> <p>Below are some common use cases, each with a link to the corresponding JavaScript function:</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#user-actions", "title": "User actions", "text": "<ul> <li>Deleting observables of type IP from an alert: Code</li> <li>Changing the assignee of a case and all its associated tasks to the user who runs the function: Code</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#automation", "title": "Automation", "text": "<p>Identifying New and In progress cases that haven't been updated in the last month and tagging them with cold-case: Code</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#notifications", "title": "Notifications", "text": "<ul> <li>Assigning high or critical alerts to a specific user when they're created via a notification: Code</li> <li>Updating the status of alerts merged into a case that was closed via a notification: Code</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#external-systems-push-method", "title": "External systems (push method)", "text": "<p>Ingesting Splunk alerts and converting them into TheHive alerts: Code</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#external-systems-pull-method", "title": "External systems (pull method)", "text": "<p>5.5 </p> <ul> <li>Creating alerts from an Airtable database via an alert feeder while applying data transformations: Code</li> <li>Creating alerts from Jira via an alert feeder while applying data transformations: Code</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#function-types", "title": "Function types", "text": "<p>The function type defines the scope in which the function can execute.</p> <p>Multiple types allowed</p> <p>A function can have one or multiple types.</p> <p>Below are the different types of functions supported in TheHive:</p> <ul> <li> <p>API: An external service triggers these functions through TheHive public API, enabling automated workflows from outside the platform. A list of available objects appears in the Functions Objects topic. Execute the function by invoking it via an HTTP call.</p> </li> <li> <p>Notification: These functions act as notifiers and trigger when specific events occur, such as alerts or case updates. They automate the notification process based on predefined conditions.</p> </li> <li> <p>Action: Case: Trigger these functions manually within the context of a specific case. Execute the function by running it manually.</p> </li> <li> <p>Action: Alert: Trigger these functions manually within the context of a specific alert. Execute the function by running it manually.</p> </li> <li> <p>5.5 Feeder: A feeder function transforms data retrieved from the HTTP API call and converts it into the expected TheHive format to create alerts. Avoid manually creating functions of the feeder type. Instead, create an alert feeder with a function. The function automatically appears in the functions list. Updates to the function reflect in the alert feeder, and changes in the alert feeder update the function accordingly.</p> </li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#function-modes", "title": "Function modes", "text": "<p>A function in TheHive can operate in one of three modes:</p> <ul> <li>Enabled: The function executes normally when triggered.</li> <li>Disabled: The function doesn't execute when triggered.</li> <li>Dry-run: The function runs, but it doesn't create or modify cases, alerts, or other entities in TheHive. Instead, creation attempts return <code>null</code>, making this mode ideal for testing integrations before going live.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/about-functions/#permissions", "title": "PermissionsNext steps", "text": "<ul> <li>Only users with the <code>manageFunction/create</code> permission can create a function in TheHive.</li> <li>Only users with the <code>manageFunction/invoke</code> permission can invoke a function in TheHive.</li> <li>Only users with the <code>manageAction</code> permission can run a function in TheHive.</li> </ul> <ul> <li>Create a Function</li> <li>Invoke a Function</li> <li>Manually Run a Function on a Case or an Alert</li> <li>Delete a Function</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/create-a-function/", "title": "Create a Function", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/create-a-function/#create-a-function", "title": "Create a Function", "text": "<p>5.1 <code>manageFunction/create</code> Platinum</p> <p>This topic provides step-by-step instructions for creating a function in TheHive.</p> <p>Functions automate workflows, process data, and enhance case management.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Functions tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Create function drawer:</p> <p>- Name *</p> <p>Enter the function name, which you will use in your HTTP call to invoke the function.</p> <p>- Mode *</p> <p>Select the mode you want to apply to the function. For more details on the available options, see About Functions.</p> <p>- Types *</p> <p>Select the type of the function. For more details on the available options, see About Functions.</p> <p>- Description</p> <p>Enter a brief description of the function\u2019s purpose.</p> <p>- Definition *</p> <p>Enter the JavaScript code for your function. If you need inspiration, check out the GitHub repository with function examples.</p> <p>Basic function structure</p> <p>In TheHive, a function follows this basic structure:</p> <pre><code>function handle(input, context) {\n    // Your function logic goes here\n}\n</code></pre> <ul> <li>The <code>handle</code> function: This is where you write your script. Your function must be placed inside this structure.</li> <li>The <code>input</code> parameter: This represents the data passed into the function. Its content depends on how the function is triggered.</li> <li>The <code>context</code> parameter: This provides access to TheHive\u2019s environment, allowing your function to interact with common TheHive actions.</li> </ul> <p>Duplicate management</p> <p>Make sure to implement duplicate management in your functions to prevent duplicate objects.</p> </li> <li> <p>In the Test function section, you can test your function as follows:</p> <ul> <li> <p>Enter input data by selecting input.</p> </li> <li> <p>Select one of the following:</p> <ul> <li>Run function (dry-run) to simulate the function without sending data.</li> <li>Run function to execute the function with actual data.</li> </ul> </li> <li> <p>After running the function, select one of the following to view results:</p> <ul> <li>result to view the function\u2019s output</li> <li>stdout to display standard output from the function</li> <li>stderr to display errors and warnings</li> </ul> </li> </ul> </li> <li> <p>Select Save. </p> </li> </ol> Next steps <ul> <li>Invoke a Function</li> <li>Manually Run a Function on a Case or an Alert</li> <li>Delete a Function</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/delete-a-function/", "title": "Delete a Function", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/delete-a-function/#delete-a-function", "title": "Delete a Function", "text": "<p>5.1 <code>manageFunction/create</code> Platinum</p> <p>This topic provides step-by-step instructions for deleting a function in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Functions tab.</p> <p></p> </li> <li> <p>Select  next to the function you want to delete, and then Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Function</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/", "title": "Functions Objects", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#functions-objects", "title": "Functions Objects", "text": "<p>This topic lists all available objects for functions in TheHive.</p> <p>API documentation</p> <p>The objects in functions are the same as those used in TheHive HTTP API.</p> <p>For details on the expected fields for each object, see the TheHive HTTP API documentation.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#user", "title": "User", "text": "<ul> <li><code>userId: string</code> : Returns the login identifier of the user executing the function.</li> <li><code>userName: string</code>: Returns the display name of the user executing the function.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#http-request", "title": "HTTP request", "text": "<ul> <li><code>request.queryString() : Record&lt;string, string[]&gt;</code>: Returns a dictionary of query string parameters formatted as a key-value map.</li> <li><code>request.getQueryString(key: string): string | null</code>: Retrieves the value associated with a specific query string key. Returns <code>null</code> if the key does not exist.</li> <li><code>request.getHeader(name: string): string | null</code>: Retrieves the value of a specific HTTP request header. Returns <code>null</code> if the header is not present.</li> <li><code>request.headers(): Record&lt;string, string&gt;</code>: Returns all request headers as a dictionary.</li> <li><code>request.contentType: string</code>: Retrieves the <code>Content-Type</code> header value from the request.</li> <li><code>request.remoteAddress()</code>: Returns the IP address of the client making the request.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#query", "title": "Query", "text": "<ul> <li><code>query.execute(query: any[])</code>: Executes a database query.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#alert", "title": "Alert", "text": "<ul> <li><code>alert.create(input: InputCreateAlert): OutputAlert</code>: Creates a new alert.</li> <li><code>alert.get(id: string): OutputAlert</code>: Retrieves an alert by its ID.</li> <li><code>alert.update(alertId: string, input: InputUpdateAlert): OutputAlert</code>: Updates an alert by its ID.</li> <li><code>alert.delete(alertId: string): void</code>: Deletes an alert by its ID.</li> <li><code>alert.createCase(alertId: string, input: InputCreateAlert): OutputCase</code>: Converts an alert into a case.</li> <li><code>alert.bulkDelete(input: {ids: string[]}): void</code>: Deletes multiple alerts at once.</li> <li><code>alert.mergeWithCase(alertId: string, caseId: string): OutputCase</code>: Merges an alert with an existing case.</li> <li><code>alert.bulkMergeWithCase( {caseId: string, alertIds: string[]} ): OutputCase</code>: Merges multiple alerts into a case.</li> <li><code>alert.followAlert(alertId: string): OutputAlert</code>: Starts following an alert for updates.</li> <li><code>alert.unfollowAlert(alertId: string): OutputAlert</code>: Stops following an alert.</li> <li><code>alert.importInCase(alertId: string, caseId: string): OutputAlert</code>: Imports an alert into an existing case.</li> <li><code>alert.bulkUpdate(input: {ids: string[]} &amp; InputUpdateAlert): void</code>: Updates multiple alerts at once.</li> <li><code>alert.find(query: any[]): OutputAlert[]</code>: Searches for alerts matching the given query.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#case", "title": "Case", "text": "<p>Caze</p> <p>Since <code>case</code> is a reserved keyword in Java, the API uses <code>caze</code>.</p> <ul> <li><code>caze.create(input: InputCreateCase): OutputCase</code>: Creates a new case.</li> <li><code>caze.get(idOrNumber: string): OutputCase</code>: Retrieves a case by its ID or case number.</li> <li><code>caze.update(idOrNumber: string, update: InputUpdateCase): void</code>: Updates a case.</li> <li><code>caze.merge(ids: string[]): OutputCase</code>: Merges multiple cases into one.</li> <li><code>caze.delete(idOrNumber: string): void</code>: Deletes a case by its ID or case number.</li> <li><code>caze.changeCaseOwnership(idOrNumber: string, update: InputChangeCaseOwnership): void</code>: Transfers ownership of a case.</li> <li><code>caze.unlinkAlert(caseId: string, alertId: string): void</code>: Removes an alert from a case.</li> <li><code>caze.mergeSimilarObservables(caseId: string): void</code>: Merges observables of the same type within a case.</li> <li><code>caze.bulkUpdate(update: {ids: string[]} &amp; InputUpdateCase): void</code>: Updates multiple cases simultaneously.</li> <li><code>caze.bulkApplyCaseTemplate(update: {ids: string[]} &amp; InputApplyCaseTemplate): void</code>: Applies a case template to multiple cases.</li> <li><code>caze.find(query: any[]): OutputCase[]</code>: Searches for cases based on a query.</li> <li><code>caze.manageCaseAccess(idOrNumber: string, accessDetails: { users: string[], _kind: \"UserAccessKind\" } | { _kind: \"OrganisationAccessKind\" }): void</code>: Sets the access level for a case. Use <code>UserAccessKind</code> to restrict access to specific users. The user list must include at least the case assignee and the user making the request. Use <code>OrganisationAccessKind</code> to make the case public to the organization.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#tasks", "title": "Tasks", "text": "<ul> <li><code>task.get(id: string): OutputTask</code>: Retrieves a task by its ID.</li> <li><code>task.update(idOrName: string, update: Partial&lt;OutputTask&gt;): void</code>: Updates a task.</li> <li><code>task.delete(id: string): void</code>: Deletes a task.</li> <li><code>task.find(query: any[]): OutputTask[]</code>: Searches for tasks matching the given query.</li> <li><code>task.setActionRequired(taskId: string, orgId: string): void</code>: Marks a task as requiring action.</li> <li><code>task.setActionDone(taskId: string, orgId: string): void</code>: Marks a task as completed.</li> <li><code>task.isActionRequired(taskId: string): Record&lt;string, bool&gt;</code>: Checks whether a task requires action.</li> <li><code>task.createInCase(caseId: string, task: InputTask): OutputTask</code>: Creates a new task within a case.</li> <li><code>task.bulkUpdate(update: {ids: string[]} &amp; Partial&lt;OutputTask&gt;): void</code>: Updates multiple tasks at once.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#log", "title": "Log", "text": "<ul> <li><code>log.create(taskId: string, log: InputCreateLog): OutputLog</code>: Creates a log entry for a task.</li> <li><code>log.update(logId: string, update: InputUpdateLog): void</code>: Updates a log entry.</li> <li><code>log.delete(logId: string): void</code>: Deletes a log entry.</li> <li><code>log.deleteAttachment(logId: string, attachmentId: string): void</code>: Removes an attachment from a log entry.</li> <li><code>log.find(query: any[]): OutputLog[]</code>: Searches for logs matching the given query.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#observable", "title": "Observable", "text": "<ul> <li><code>observable.createInCase(caseId: string, observable: InputObservable): OutputObservable</code>: Creates an observable within a case.</li> <li><code>observable.createInAlert(alertId: string, observable: InputObservable): OutputObservable)</code>: Creates an observable within an alert.</li> <li><code>observable.bulkUpdate(update: {ids: string[]} &amp; Partial&lt;OutputObservable&gt;)</code>: Updates multiple observables.</li> <li><code>observable.get(idOrName: string): OutputObservable</code>: Retrieves an observable by ID or name.</li> <li><code>observable.update(id: string, update: Partial&lt;OutputObservable&gt;): void</code>: Updates an observable.</li> <li><code>observable.delete(id: string): void</code>: Deletes an observable.</li> <li><code>observable.find(query: any[]): OutputObservable[]</code>: Searches for observables.</li> <li><code>observable.updateAllTypes(fromType: string, toType: String): void</code>: Changes the type of all observables from one type to another.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#observable-type", "title": "Observable type", "text": "<ul> <li><code>observableType.get(id: string): OutputObservableType</code>: Retrieves an observable type by its ID.</li> <li><code>observableType.delete(id: string): void</code>: Deletes an observable type by its ID.</li> <li><code>observableType.create(ot: InputObservableType)</code>: Creates a new observable type.</li> <li><code>observableType.find(query: any[]): OutputObservableType[]</code>: Searches for observable types matching the given query.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#customfield", "title": "CustomField", "text": "<ul> <li><code>customField.list(): OutputCustomField[]</code>: Returns a list of all custom fields.</li> <li><code>customField.update(idOrName: string, update: Partial&lt;OutputCustomField&gt;): void</code>: Updates a custom field by its ID or name.</li> <li><code>customField.delete(idOrName: string): void</code>: Deletes a custom field by its ID or name.</li> <li><code>customField.create(cf: InputCustomField): OutputCustomField</code>: Creates a new custom field.</li> <li><code>customField.find(query: any[]): OutputCustomField[]</code>: Searches for custom fields matching the query criteria.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#case-template", "title": "Case template", "text": "<ul> <li><code>caseTemplate.get(idOrName: string): OutputCaseTemplate</code>: Retrieves a case template by its ID or name.</li> <li><code>caseTemplate.update(idOrName: string, update: Partial&lt;InputCaseTemplate&gt;): void</code>: Updates a case template.</li> <li><code>caseTemplate.delete(idOrName: string): void</code>: Deletes a case template.</li> <li><code>caseTemplate.create(template: InputCaseTemplate): OutputCaseTemplate</code>: Creates a new case template.</li> <li><code>caseTemplate.find(query: any[]): OutputCaseTemplate[]</code>: Searches for case templates matching the query.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#procedure", "title": "Procedure", "text": "<ul> <li><code>procedure.bulkCreateInCase(caseId: string, input: {procedures: InputProcedure[]}): OutputProcedure[]</code>: Creates multiple procedures within a case.</li> <li><code>procedure.bulkCreateInAlert(alertId: string, input: {procedures: InputProcedure[]}): OutputProcedure[]</code>: Creates multiple procedures within an alert.</li> <li><code>procedure.createInCase(caseId: string, procedure: InputProcedure): OutputProcedure</code>: Creates a single procedure within a case.</li> <li><code>procedure.createInAlert(alertId: string, procedure: InputProcedure): OutputProcedure</code>: Creates a single procedure within an alert.</li> <li><code>procedure.update(id: string, procedure: Partial&lt;OutputProcedure&gt;): void</code>: Updates a procedure.</li> <li><code>procedure.delete(id: string): void</code>: Deletes a procedure.</li> <li><code>procedure.find(query: any[])</code>: Searches for procedures based on the query.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#case-status", "title": "Case status", "text": "<ul> <li><code>caseStatus.create(input: InputCreateCaseStatus): OutputCaseStatus</code>: Creates a new case status.</li> <li><code>caseStatus.update(idOrName: string, update: InputUpdateCaseStatus): void</code>: Updates a case status.</li> <li><code>caseStatus.delete(idOrName: string): void</code>: Deletes a case status.</li> <li><code>caseStatus.find(query: any[]): OutputCaseStatus[]</code>: Searches for case statuses.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#alert-status", "title": "Alert status", "text": "<ul> <li><code>alertStatus.create(input: InputCreateAlertStatus): OutputAlerttatus</code>: Creates a new alert status.</li> <li><code>alertStatus.update(idOrName: string, update: InputUpdateAlertStatus): void</code>: Updates an alert status.</li> <li><code>alertStatus.delete(idOrName: string): void</code>: Deletes an alert status.</li> <li><code>alertStatus.find(query: any[]): OutputAlerttatus[]</code>: Searches for alert statuses.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#comment", "title": "Comment", "text": "<ul> <li><code>comment.createInCase(caseId: string, comment: InputCreateComment): OutputComment</code>: Adds a comment to a case.</li> <li><code>comment.createInAlert(alertId:: string, comment: InputCreateComment): OutputComment</code>: Adds a comment to an alert.</li> <li><code>comment.update(id: string, update: InputUpdateComment): void</code>: Updates a comment.</li> <li><code>comment.delete(id: string): void</code>: Deletes a comment.</li> <li><code>comment.find(query: any[]): OutputComment[]</code>: Searches for comments.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#share", "title": "Share", "text": "<ul> <li><code>share.setCaseShares(caseId: string, input: InputCreateShares): OutputShare[]</code>: Sets sharing permissions for a case.</li> <li><code>share.removeSharesFromCase(caseId: string, input: InputRemoveShares): void</code>: Revokes sharing permissions from a case.</li> <li><code>share.removeShare(shareId: string): void</code>: Removes a specific share.</li> <li><code>share.removeShares(input: {ids: string[]} ): void</code>: Removes multiple shares at once.</li> <li><code>share.removeTaskShares(taskId: string, input: InputRemoveShares): void</code>: Revokes sharing permissions from a task.</li> <li><code>share.removeObservableShares(observableId: string, input: InputRemoveShares): void</code>: Revokes sharing permissions from an observable.</li> <li><code>share.listShareCases(caseId: string): OutputShare[]</code>: Lists all shared cases.</li> <li><code>share.listShareTasks(taskId: string): OutputShare[]</code>: Lists all shared tasks.</li> <li><code>share.listShareObservables(observableId: string): OutputShare[]</code>: Lists all shared observables.</li> <li><code>share.shareCase(caseId: string, input: InputCreateShare): OutputShare</code>: Shares a case with specified permissions.</li> <li><code>share.shareTask(taskId: string, input: InputCreateShare): OutputShare</code>: Shares a task with specified permissions.</li> <li><code>share.shareObservable(observableId: string, input: InputCreateShare): OutputShare</code>: Shares an observable with specified permissions.</li> <li><code>share.updateShare(shareId: string, update: InputUpdateShare): void</code>: Updates the sharing settings of a shared item.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#organization", "title": "Organization", "text": "<ul> <li><code>organisation.get(orgIdOrName: string): OutputOrganisation</code>: Retrieves details of an organization by ID or name.</li> <li><code>organisation.create(org: InputCreateOrganisation): OutputOrganisation</code>: Creates a new organization.</li> <li><code>organisation.update(orgIdOrName: string, update: InputUpdateOrganisation): void</code>: Updates an organization\u2019s details.</li> <li><code>organisation.bulkLink(orgIdOrName: string, links: InputOrganisationBulkLink): void</code>: Links multiple organizations together.</li> <li><code>organisation.listLinks(orgIdOrName: string): OutputOrganisationLink[]</code>: Lists all links between organizations.</li> <li><code>organisation.listSharingProfiles(): OutputSharingProfile[]</code>: Retrieves the list of available sharing profiles.</li> <li><code>organisation.link(orgA: string, orgB: string, link: InputOrganisationLink | null): void</code>: Creates a direct link between two organizations.</li> <li><code>organisation.unlink(orgA: string, orgB: string): void</code>: Removes the link between two organizations.</li> <li><code>organisation.find(query: any[]): OutputOrganisation[]</code>: Searches for organizations based on query criteria.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#profile", "title": "Profile", "text": "<ul> <li><code>profile.get(idOrName: string): OutputProfile</code>: Retrieves a profile by ID or name.</li> <li><code>profile.update(profileIdOrName: string, update: InputUpdateProfile): void</code>: Updates a user profile.</li> <li><code>profile.delete(profileIdOrName: string): void</code>: Deletes a user profile.</li> <li><code>profile.create(profile: InputCreateProfile): OutputProfile</code>: Creates a new user profile.</li> <li><code>profile.find(query: any[]): OutputProfile[]</code>: Searches for user profiles based on query criteria.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#custom-event", "title": "Custom event", "text": "<ul> <li><code>customEvent.createInCase(caseId: string, input: InputCreateCustomEvent): OutputCustomEvent</code>: Creates a custom event within a case.</li> <li><code>customEvent.update(id: string, update: InputUpdateCustomEvent): void</code>: Updates an existing custom event.</li> <li><code>customEvent.delete(id: string): void</code>: Deletes a custom event.</li> <li><code>customEvent.find(query: any[]): OutputCustomEvent[]</code>: Searches for custom events based on query parameters.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#function", "title": "Function", "text": "<ul> <li><code>function.create(function: InputCreateFunction): OutputFunction</code>: Creates a new function.</li> <li><code>function.update(functionIdOrName: string, update: InputUpdateFunction): void</code>: Updates an existing function.</li> <li><code>function.delete(functionIdOrName: string): void</code>: Deletes a function.</li> <li><code>function.find(query: any[]): OutputFunction</code>: Searches for functions based on query parameters.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#cortex", "title": "Cortex", "text": "<p>5.5.2</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#analyzer", "title": "Analyzer", "text": "<ul> <li> <p><code>cortex.createJob({ \"analyzerId\": \"analyzerFullName\", \"artifactId\": \"observableId\", \"cortexId\": \"cortexConnectorName\"})</code>:  Launches a Cortex analyzer job with <code>analyzerId</code> as the full name of the analyzer to run, <code>artifactId</code> as the ID of the observable to analyze, and <code>cortexId</code> as the name of the Cortex connector to use.</p> <p>Example</p> <pre><code>context.cortex.createJob(\n    {\n        \"analyzerId\": \"EmlParser_2_1\",\n        \"artifactId\": \"~7577792576\",\n        \"cortexId\": \"Cluster 1\"\n    });\n</code></pre> </li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/functions-objects/#responder", "title": "Responder", "text": "<ul> <li> <p><code>cortex.createAction({ \"responderId\": \"id\", \"objectId\": \"inputId\", \"objectType\": \"type\"})</code>: Launches a Cortex responder action with <code>responderId</code> as the full ID of the responder to run, <code>objectId</code> as of ID of the object to act on, and <code>objectType</code> as its type, such as case, alert, or task.</p> <p>Responder ID</p> <p>To get the responder ID, use the <code>GET /api/v1/connector/cortex/responder/</code> API endpoint.</p> <p>Example</p> <pre><code>context.cortex.createAction(\n    {\n        \"responderId\": \"cfbe6c77cc30dea5efe680cc622e3bd6\",\n        \"objectId\": \"~8683597912\",\n        \"objectType\": \"alert\"\n    });\n</code></pre> </li> </ul> Next steps <ul> <li>Create a Function</li> <li>Invoke a Function</li> <li>Manually Run a Function on a Case or an Alert</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/invoke-a-function/", "title": "Invoke a Function", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/invoke-a-function/#invoke-a-function", "title": "Invoke a Function", "text": "<p>5.1 <code>manageFunction/invoke</code> Platinum</p> <p>This topic provides step-by-step instructions for invoking a function in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Functions tab.</p> <p></p> </li> <li> <p>Select the function you want to invoke, or select  and then Edit.</p> </li> <li> <p>Select the How to call the function section.</p> </li> <li> <p>Copy the cURL or Python command example to use in your HTTP call.</p> </li> </ol> <pre><code>curl -X POST -H 'Authorization: Bearer $API_KEY' https://&lt;thehive_url&gt;/api/v1/function/&lt;function_name&gt; -H 'Content-Type: application/json' --data '\n{\n    \"eventId\": \"d9ec98b1-410f-40eb-8634-cfe189749da6\",\n    \"date\": \"2021-06-05T12:45:36.698Z\",\n    \"title\": \"An intrusion was detected\",\n    \"details\": \"An intrusion was detected on the server 10.10.43.2\",\n    \"data\": [\n        {\"kind\": \"ip\", \"value\": \"10.10.43.2\", \"name\": \"server-ip\" },\n        {\"kind\": \"name\", \"value\": \"root\", \"name\": \"login\" },\n        {\"kind\": \"ip\", \"value\": \"92.43.123.1\", \"name\": \"origin\" }\n    ]\n}\n'\n</code></pre> <p>TheHive processes your input (the body of the HTTP call) using the function definition and executes the function accordingly. It then responds to the HTTP call with the data returned by the function.    </p> Next steps <ul> <li>Create a Function</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/run-a-function-case-alert/", "title": "Run a Function on an Alert", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-functions/run-a-function-case-alert/#manually-run-a-function-on-a-case-or-an-alert", "title": "Manually Run a Function on a Case or an Alert", "text": "<p>5.4 <code>manageAction</code> Platinum</p> <p>This topic provides step-by-step instructions for manually running a function on a case or an alert in TheHive.</p> Procedure <ol> <li> <p>Locate the case or alert on which you want to run the function.</p> </li> <li> <p>In the case or alert, select the  button.</p> <p></p> </li> <li> <p>In the drawer, select the Functions tab.</p> </li> <li> <p>Select one or more functions to run.</p> </li> <li> <p>Select Launch actions.</p> </li> </ol> Next steps <ul> <li>Invoke a Function</li> <li>Delete a Function</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/", "title": "About Notifications", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#about-notifications", "title": "About Notifications", "text": "<p>A notification triggers automated actions when specific events occur within an organization.</p> <p>This topic explains the different notification capabilities in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#key-components", "title": "Key components", "text": "<p>A notification consists of two key components:</p> <p>One trigger, multiple notifiers</p> <p>A notification can have only one trigger but multiple notifiers.</p> <ul> <li>A trigger: Defines the event that activates the notification, such as case creation, task assignment, or alert import.</li> <li>One or more notifiers: Specify the action taken when the notification is triggered, such as sending an email, making an HTTP request, or posting to Slack or Mattermost.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#triggers", "title": "Triggers", "text": "<p>Associate each notification with only one trigger.</p> <p>TheHive provides several predefined triggers for cases, alerts, tasks, observables, jobs, and actions. Additionally, create custom triggers using FilteredEvent.</p> <p>Use the AnyEvent trigger to execute notifications for any event in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#triggers-on-cases", "title": "Triggers on cases", "text": "<ul> <li>CaseClosed: Triggered when a case is closed</li> <li>CaseCreated: Triggered when a new case is created</li> <li>CaseFlagged: Triggered when a case is flagged</li> <li>CaseShared: Triggered when a case is shared</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#triggers-on-alerts", "title": "Triggers on alerts", "text": "<ul> <li>AlertAssigned: Triggered when an alert is assigned to a user</li> <li>AlertClosed: Triggered when an alert is closed</li> <li>AlertCreated: Triggered when a new alert is created</li> <li>AlertImported: Triggered when an alert is imported\u2014either by merging it into a new case or into an existing one</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#triggers-on-observables", "title": "Triggers on observables", "text": "<ul> <li>AlertObservableCreated: Triggered when an observable is created within an alert</li> <li>CaseObservableCreated: Triggered when an observable is created within a case</li> <li>ObservableCreated: Triggered when an observable is created, regardless of whether it belongs to an alert or a case</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#triggers-on-tasks", "title": "Triggers on tasks", "text": "<ul> <li>LoginMyTask: Triggered when a new log is added to a task</li> <li>TaskAssigned: Triggered when a task is assigned to a user or the assignee is updated</li> <li>TaskClosed: Triggered when a task is closed</li> <li>TaskMandatory: Triggered when a task is made mandatory</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#triggers-on-jobs", "title": "Triggers on jobs", "text": "<ul> <li>JobFinished: Triggered when an analyzer job is completed, whether it succeeds or fails</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#triggers-on-actions", "title": "Triggers on actions", "text": "<ul> <li>ActionFinished: Triggered when a responder action is completed, whether it succeeds or fails</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#filteredevent", "title": "FilteredEvent", "text": "<p>Selecting FilteredEvent lets TheHive define a structured JSON filter to match specific events.</p> <p>Learn how to create filtered events and explore examples in the Write a Filtered Event Trigger topic.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#notifiers", "title": "Notifiers", "text": "<p>Several types of notifiers are available in TheHive:</p> <ul> <li>EmailerToUser: Sends an email to all users in the current organization</li> <li>EmailerToAddr: Sends an email to a specific email address</li> <li>HttpRequest: Sends data to a specified HTTP endpoint</li> <li>Mattermost: Sends data to a selected Mattermost endpoint</li> <li>Slack: Sends data to a selected Slack endpoint</li> <li>Teams: Sends data to a selected Microsoft Teams endpoint</li> <li>Webhook: Sends data to a chosen webhook endpoint</li> <li>Kafka: Sends data to a specified Kafka queue</li> <li>Redis: Sends data to a selected Redis channel</li> <li>RunAnalyzer: Executes a selected analyzer</li> <li>RunResponder: Executes a selected responder</li> <li>Function: Run a specified function</li> </ul> <p>Endpoints required</p> <p>Some notifiers require at least one defined endpoint. Endpoints can be local, defined at the organization level, or global, defined at the client level for one or more organizations. Refer to the dedicated page for each notifier to learn how to create the necessary local endpoints.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/about-notifications/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageConfig</code> permission can manage notifications in TheHive.</p> <ul> <li>Create a Notification</li> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/create-a-notification/", "title": "Create a Notification", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/create-a-notification/#create-a-notification", "title": "Create a Notification", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for creating a notification in TheHive.</p> <p>A notification triggers automated actions when specific events occur within an organization.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Add notification drawer, enter the name of your notification.</p> <p>Unique name</p> <p>This name must be unique, as two notifications can't have the same name.</p> </li> <li> <p>Turn on the Send notification to every user in the organization toggle to be able to send an email to all users in the organization.</p> <p>Available trigger</p> <p>If enabled, the AnyEvent trigger is no longer available, and only the EmailerToUser notifier is selectable.</p> </li> <li> <p>Select the trigger you want to use.</p> </li> <li> <p>Turn on the Enable notification toggle to activate the notification.</p> </li> <li> <p>Select one or more notifiers.</p> </li> <li> <p>Enter the required information for each selected notifier, following its specific configuration instructions:</p> <ul> <li>EmailerToUser</li> <li>EmailerToAddr</li> <li>HttpRequest</li> <li>Mattermost</li> <li>Slack</li> <li>Teams</li> <li>Webhook</li> <li>Kafka</li> <li>Redis</li> <li>RunAnalyzer</li> <li>RunResponder</li> <li>Function</li> </ul> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/delete-a-notification/", "title": "Delete a Notification", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/delete-a-notification/#delete-a-notification", "title": "Delete a Notification", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for deleting a notification in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/filtered-event-trigger-operators/", "title": "Operators", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/filtered-event-trigger-operators/#filteredevent-trigger-operators", "title": "FilteredEvent Trigger Operators", "text": "<p>This topic lists the available operators for use with the FilteredEvent trigger.</p> Operators <p>You can use the following operators to filter events.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/filtered-event-trigger-operators/#logical-operators", "title": "Logical operators", "text": "<ul> <li><code>_and</code>: Matches when all conditions are met</li> </ul> <p>This operator requires all filters in the array to be true to include an event.</p> <pre><code>{\"_and\": [\n  { ... filterA },\n  { ... filterB }\n]}\n</code></pre> <ul> <li><code>_or</code>: Matches when at least one condition is met</li> </ul> <p>This operator returns events that match any of the given filters.</p> <pre><code>{\"_or\": [\n  { ... filterA },\n  { ... filterB }\n]}\n</code></pre> <ul> <li><code>_not</code>: Excludes results that match the given filter</li> </ul> <p>This operator inverts the condition, returning events that don't match the specified filter.</p> <pre><code>{\"_not\": {... filterA} }\n</code></pre> <ul> <li><code>_any</code>: Matches any event (useful for wildcard filtering)</li> </ul> <p>This operator removes all filtering and returns all events.</p> <pre><code>{  \"_any\": \"\" }\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/filtered-event-trigger-operators/#comparison-operators", "title": "Comparison operators", "text": "<ul> <li><code>_lt</code>, <code>_gt</code>, <code>_lte</code>, and <code>_gte</code>: Compare numerical values</li> </ul> <p>These operators filter events based on less than (<code>_lt</code>), greater than (<code>_gt</code>), less than or equal (<code>_lte</code>), or greater than or equal (<code>_gte</code>) conditions.</p> <pre><code>{ \"_lt\": { \"foo\" : 42 } }\n</code></pre> <ul> <li><code>_eq</code> and <code>_is</code>: Matches an exact value</li> </ul> <p><code>_eq</code> is an alias for <code>_is</code>. Both check for exact matches.</p> <pre><code>{ \"_eq\": { \"foo\": 42 } }\n</code></pre> <pre><code>{ \"_eq\": { \"foo\": \"LOW\" } }\n</code></pre> <p>Also works with arrays:</p> <pre><code>{ \"_eq\": { \"tags\": [\"foo\", \"bar\"] } }\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/filtered-event-trigger-operators/#string-operators", "title": "String operators", "text": "<ul> <li><code>_startsWith</code> and <code>_endsWith</code>: Matches strings that begin or end with a specific sequence of characters</li> </ul> <p>These operators filter events based on whether a string starts with or ends with a given value.</p> <pre><code>{ \"_startsWith\": { \"foo\": \"LOW\" } }\n</code></pre> <ul> <li><code>_like</code>: Matches a string using wildcards (*)</li> </ul> <p>This operator performs pattern matching using wildcards (*).</p> <pre><code>{ \"_like\": { \"foo\": \"*ice\" } }\n</code></pre> <pre><code>{ \"_like\": { \"foo\": \"ali*\" } }\n</code></pre> <pre><code>{ \"_like\": { \"foo\": \"*lce*\" } }\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/filtered-event-trigger-operators/#range-and-inclusion-operators", "title": "Range and inclusion operators", "text": "<ul> <li><code>_between</code>: Matches values within a range</li> </ul> <p>This operator returns events where a numeric field falls within a specified range.</p> <pre><code>{ \"_between\": { \"_field\": \"foo\", \"_from\": 0, \"_to\": 2 } }\n</code></pre> <p>Only works when <code>foo</code> is a number.</p> <ul> <li><code>_in</code>: Matches when a value exists in an array</li> </ul> <p>This operator checks if a field\u2019s value is one of the values in a predefined list.</p> <p>Works with numbers:</p> <pre><code>{ \"_in\": { \"_field\": \"foo\", \"_values\": [1, 42] } }\n</code></pre> <p>Works with strings:</p> <pre><code>{ \"_in\": { \"_field\": \"tags\", \"_values\": [\"foo\", \"bar\"] } }\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/filtered-event-trigger-operators/#existence-and-content-operators", "title": "Existence and content operators", "text": "<ul> <li><code>_contains</code>: Checks if a field contains a specific value</li> </ul> <p>This operator searches within strings or arrays of strings.</p> <pre><code>{ \"_contains\": { \"foo\": \"LOW\" } }\n</code></pre> <p>Deprecation</p> <p>The <code>_contains</code> operator is deprecated. Use <code>_eq</code> to search for exact values in arrays or <code>_like</code> to search for substrings.</p> <ul> <li><code>_has</code>: Checks if a field is present</li> </ul> <p>This operator filters events that contain a specific field.</p> <pre><code>{ \"_has\": \"foo\" }\n</code></pre> <ul> <li><code>_empty</code>: Checks if a field is empty</li> </ul> <p>This operator filters events where a field is empty (contains <code>\"\"</code>, an empty array <code>[]</code>, or <code>null</code>).</p> <pre><code>{ \"_empty\": \"foo\" }\n</code></pre> <p>To check if a field doesn't exist, use:</p> <pre><code>{ \"_not\": {\"_has\": \"foo\"} }\n</code></pre> <ul> <li><code>_arrayMatch</code>: Checks if any element within an array field satisfies a specified condition</li> </ul> <pre><code>{\n    \"_arrayMatch\": {\n        \"_field\": \"foo\",\n        \"_filter\": {\n            \"_and\": [\n                {\n                    \"_eq\": {\n                        \"name\": \"bar\"\n                    }\n                },\n                {\n                    \"_eq\": {\n                        \"value\": \"LOW\"\n                    }\n                }\n            ]\n        }\n    }\n}\n</code></pre> Next steps <ul> <li>Write a FilteredEvent Trigger</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/turn-off-a-notification/", "title": "Turn Off a Notification", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/turn-off-a-notification/#turn-off-a-notification", "title": "Turn Off a Notification", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for turning off a notification in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Turn off the Enable notification toggle to deactivate the notification.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Create a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/variable-usage-examples/", "title": "Variable Usage Examples", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/variable-usage-examples/#variable-usage-examples", "title": "Variable Usage Examples", "text": "<p>This topic provides examples of variable usage in the context of configuring notifications in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/variable-usage-examples/#examples", "title": "Examples", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/variable-usage-examples/#emailertoaddr-notifier", "title": "EmailertoAddr notifier", "text": "<p>Subject</p> <p>Case #{{object.number}} severity reached {{object.severity}}</p> <p>From</p> <p>thehive@strangebee.com</p> <p>To</p> <p>{{user.email}}</p> <p>Template</p> <pre><code>Hello,\n\nThe following case severity reached {{object.severity}}.\n\nCase details:\nNumber: {{object.number}}\nTitle: {{object.title}}\nOwner: {{object.assignee}}\nDescription: {{object.description}}\n\nYou can review the case by clicking the following URL:\n{{url}}\n\nRegards,\n\nTheHive Notification System\n</code></pre> Next steps <ul> <li>Configure the EmailerToAddr Notifier</li> <li>Configure the HttpRequest Notifier</li> <li>Configure the Mattermost Notifier</li> <li>Configure the Slack Notifier</li> <li>Configure the Teams Notifier</li> <li>Configure the webhook Notifier</li> <li>Configure the Kafka Notifier</li> <li>Configure the Redis Notifier</li> <li>Configure the RunAnalyzer Notifier</li> <li>Configure the RunResponder Notifier</li> <li>Configure the Function Notifier</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/", "title": "Write a FilteredEvent Trigger", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#write-a-filteredevent-trigger", "title": "Write a FilteredEvent Trigger", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for writing a FilteredEvent trigger in TheHive.</p> <p>Capabilities of the FilteredEvent trigger</p> <p>Read this StrangeBee blog post for an introduction to the capabilities of FilteredEvent trigger.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>Select the FilteredEvent trigger.</p> <p>Selecting FilteredEvent opens a field where you can define a custom filter. These filters apply to all actions recorded in the organization's audit logs. When an action matches the filter criteria, a notification is triggered.</p> </li> <li> <p>Write your filter.</p> <p>Operators</p> <p>For details on the available operators, see FilteredEvent Trigger Operators.</p> <p>To access a specific field within a JSON object, use dot (<code>.</code>) notation to navigate through nested properties.</p> <p>For example <code>object.severity</code> retrieves the <code>severity</code>field from the following JSON structure:</p> <pre><code>{\n\"object\": {\n    \"severity\": 3\n}\n}\n</code></pre> <p>Tag and custom field changes</p> <p>5.5.9 Starting with TheHive 5.5.9, audit logs now record updates to tags and custom fields.</p> </li> <li> <p>Select the relevant notifiers to configure them:</p> <ul> <li>Configure the EmailerToAddr Notifier</li> <li>Configure the HttpRequest Notifier</li> <li>Configure the Mattermost Notifier</li> <li>Configure the Slack Notifier</li> <li>Configure the Teams Notifier</li> <li>Configure the webhook Notifier</li> <li>Configure the Kafka Notifier</li> <li>Configure the Redis Notifier</li> <li>Configure the RunAnalyzer Notifier</li> <li>Configure the RunResponder Notifier</li> <li>Configure the Function Notifier</li> </ul> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#examples", "title": "Examples", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#case-severity-updated-to-high-or-critical", "title": "Case severity updated to High or Critical", "text": "<pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"action\": \"update\"\n            }\n        },\n        {\n            \"_is\": {\n                \"objectType\": \"Case\"\n            }\n        },\n        {\n            \"_gte\": {\n                \"details.severity\": 3\n            }\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#alert-closed-without-an-assignee", "title": "Alert closed without an assignee", "text": "<pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"objectType\": \"Alert\"\n            }\n        },\n        {\n            \"_is\": {\n                \"details.stage\": \"Closed\"\n            }\n        },\n        {\n            \"_not\": {\n                \"_has\": \"object.assignee\"\n            }\n        },\n        {\n            \"_not\": {\n                \"_has\": \"details.assignee\"\n            }\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#observable-updated-with-a-report-from-analyzer-crt_sh_transparency_logs_1_0", "title": "Observable updated with a report from analyzer <code>Crt_sh_Transparency_Logs_1_0</code>", "text": "<pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"action\": \"update\"\n            }\n        },\n        {\n            \"_is\": {\n                \"objectType\": \"Observable\"\n            }\n        },\n        {\n            \"_has\": \"details.reports.Crt_sh_Transparency_Logs_1_0\"\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#responder-action-finished", "title": "Responder action finished", "text": "<pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"action\": \"update\"\n            }\n        },\n        {\n            \"_is\": {\n                \"objectType\": \"Action\"\n            }\n        },\n        {\n            \"_or\": [\n                {\n                    \"_is\": {\n                        \"details.status\": \"Success\"\n                    }\n                },\n                {\n                    \"_is\": {\n                        \"details.status\": \"Failure\"\n                    }\n                }\n            ]\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#case-status-updated-to-truepositive-or-falsepositive-with-the-custom-field-business-unit-set-to-sales-or-marketing", "title": "Case status updated to <code>TruePositive</code> or <code>FalsePositive</code>, with the custom field <code>business-unit</code> set to <code>Sales</code> or <code>Marketing</code>", "text": "<pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"action\": \"update\"\n            }\n        },\n        {\n            \"_is\": {\n                \"objectType\": \"Case\"\n            }\n        },\n        {\n            \"_or\": [\n                {\n                    \"_is\": {\n                        \"details.status\": \"TruePositive\"\n                    }\n                },\n                {\n                    \"_is\": {\n                        \"details.status\": \"FalsePositive\"\n                    }\n                }\n            ]\n        },\n        {\n            \"_or\": [\n                {\n                    \"_is\": {\n                        \"object.customFieldValues.business-unit\": \"Sales\"\n                    }\n                },\n                {\n                    \"_is\": {\n                        \"object.customFieldValues.business-unit\": \"Marketing\"\n                    }\n                }\n            ]\n        }\n    ]\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#custom-field-business-unit-updated-to-engineering", "title": "Custom field <code>business-unit</code> updated to <code>Engineering</code>", "text": "<p>5.5.9</p> <pre><code>{\n    \"_arrayMatch\": {\n        \"_field\": \"details.customFieldChanges\",\n        \"_filter\": {\n            \"_and\": [\n                {\n                    \"_eq\": {\n                        \"operation\": \"valuesAdded\"\n                    }\n                },\n                {\n                    \"_eq\": {\n                        \"name\": \"business-unit\"\n                    }\n                },\n                {\n                    \"_eq\": {\n                        \"values\": \"Engineering\"\n                    }\n                }\n            ]\n        }\n    }\n}\n</code></pre>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/write-filtered-event-trigger/#analyzer-emlparser_2_1-completed-successfully", "title": "Analyzer <code>EmlParser_2_1</code> completed successfully", "text": "<pre><code>{\n    \"_and\": [\n        {\n            \"_is\": {\n                \"objectType\": \"Job\"\n            }\n        },\n        {\n            \"_is\": {\n                \"object.analyzerName\": \"EmlParser_2_1\"\n            }\n        },\n        {\n            \"_is\": {\n                \"object.status\": \"Success\"\n            }\n        }\n    ]\n}\n</code></pre> Next steps <ul> <li>Configure the EmailerToAddr Notifier</li> <li>Configure the HttpRequest Notifier</li> <li>Configure the Mattermost Notifier</li> <li>Configure the Slack Notifier</li> <li>Configure the Teams Notifier</li> <li>Configure the webhook Notifier</li> <li>Configure the Kafka Notifier</li> <li>Configure the Redis Notifier</li> <li>Configure the RunAnalyzer Notifier</li> <li>Configure the RunResponder Notifier</li> <li>Configure the Function Notifier</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/analyzers/", "title": "RunAnalyzer", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/analyzers/#configure-the-runanalyzer-notifier", "title": "Configure the RunAnalyzer Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the RunAnalyzer notifier in TheHive.</p> <p>Notifier availability</p> <p>The RunAnalyzer notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers: - FilteredEvent - AlertObservableCreated - CaseObservableCreated - ObservableCreated </p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the RunAnalyzer notifier.</p> </li> <li> <p>Select the analyzers you want to run.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/email-to-addr/", "title": "EmailToAddr", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/email-to-addr/#configure-the-emailertoaddr-notifier", "title": "Configure the EmailerToAddr Notifier", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for configuring the EmailerToAddr notifier in TheHive.</p> <p>Notifier availability</p> <p>The EmailerToAddr notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> <p>SMTP configuration required</p> <p>Configuring EmailerToUsers and EmailertoAddr notifiers requires setting up SMTP beforehand.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the EmailerToAddr notifier.</p> </li> <li> <p>In the EmailerToAddr drawer, enter the following information:</p> <p>- Subject</p> <p>The email subject line.</p> <p>- From</p> <p>The sender's email address.</p> <p>- To</p> <p>The recipient's email address.</p> <p>- Template</p> <p>The email template used for the message. If you select the HTML format, you must write the full HTML syntax.</p> <p>Available variables</p> <pre><code>You can use variables in certain fields by selecting **Add variable**. Refer to the [Variable Usage Examples](../../../../../../variable-usage-examples.md) topic for detailed examples.\n</code></pre> <p>Conditional helpers using Mustache syntax</p> <p>Example:  </p><pre><code>{{#if (eq object.severity 2) }}MEDIUM {{else}}Other {{/if}}\n</code></pre> Find additional supported operators in the official Handlebars documentation.<p></p> <p>Data formatting helpers</p> <p>The following helpers are available to format your data:</p> Helper Description Usage Output <code>tlpLabel</code> Format the <code>tlp</code> field of the object <code>{{ tlpLabel object.tlp }}</code> <code>Amber</code> <code>papLabel</code> Format the <code>pap</code> field of the object <code>{{ papLabel object.pap }}</code> <code>Amber</code> <code>severityLabel</code> Format the <code>severity</code> field of the object <code>{{ severityLabel object.severity }}</code> <code>Critical</code> <code>dateFormat</code> Format a date field of the object using Java date time patterns <code>{{dateFormat audit._createdAt \"EEEEE dd MMMMM yyyy\" \"fr\" }}</code> <code>jeudi 01 septembre 2022</code> <p>Standard string helpers can be found in the official Handlebars documentation.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/email-to-users/", "title": "EmailToUser", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/email-to-users/#configure-the-emailertouser-notifier", "title": "Configure the EmailerToUser Notifier", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for configuring the EmailerToUser notifier in TheHive.</p> <p>Notifier availability</p> <p>The EmailerToUser notifier is available only when you enable the Send notification to every user in the organization toggle.</p> <p>SMTP configuration required</p> <p>Configuring EmailerToUsers and EmailertoAddr notifiers requires setting up SMTP beforehand.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the EmailerToUser notifier.</p> </li> <li> <p>In the EmailerToUser drawer, enter the following information:</p> <p>- Subject</p> <p>The email subject line.</p> <p>- From</p> <p>The sender's email address.</p> <p>- Template</p> <p>The email template used for the message. If you select the HTML format, you must write the full HTML syntax.</p> <p>Available variables</p> <pre><code>You can use variables in certain fields by selecting **Add variable**. Refer to the [Variable Usage Examples](../../../../../../variable-usage-examples.md) topic for detailed examples.\n</code></pre> <p>Conditional helpers using Mustache syntax</p> <p>Example:  </p><pre><code>{{#if (eq object.severity 2) }}MEDIUM {{else}}Other {{/if}}\n</code></pre> Find additional supported operators in the official Handlebars documentation.<p></p> <p>Data formatting helpers</p> <p>The following helpers are available to format your data:</p> Helper Description Usage Output <code>tlpLabel</code> Format the <code>tlp</code> field of the object <code>{{ tlpLabel object.tlp }}</code> <code>Amber</code> <code>papLabel</code> Format the <code>pap</code> field of the object <code>{{ papLabel object.pap }}</code> <code>Amber</code> <code>severityLabel</code> Format the <code>severity</code> field of the object <code>{{ severityLabel object.severity }}</code> <code>Critical</code> <code>dateFormat</code> Format a date field of the object using Java date time patterns <code>{{dateFormat audit._createdAt \"EEEEE dd MMMMM yyyy\" \"fr\" }}</code> <code>jeudi 01 septembre 2022</code> <p>Standard string helpers can be found in the official Handlebars documentation.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/function/", "title": "Function", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/function/#configure-the-function-notifier", "title": "Configure the Function Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the Function notifier in TheHive.</p> <p>To learn more about functions, see the About Functions topic.</p> <p>Notifier availability</p> <p>The Function notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertAssigned </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>LogInMyTask </li> <li>TaskAssigned </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the Function notifier.</p> </li> <li> <p>Select the function you want to run.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/http-request/", "title": "HttpRequest", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/http-request/#configure-the-httprequest-notifier", "title": "Configure the HttpRequest Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the HttpRequest notifier in TheHive.</p> <p>Notifier availability</p> <p>The HttpRequest notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the HttpRequest notifier.</p> </li> <li> <p>In the HttpRequest drawer, enter the following information:</p> <p>- Endpoint *</p> <p>Using HttpRequest as a notifier requires at least one endpoint.</p> <p>Select an existing endpoint. Endpoints can be local, defined at the organization level, or global, defined at the client level for one or more organizations. You can add a new local endpoint by selecting Add a new endpoint.</p> <p>- Method *</p> <p>Select an HTTP method from the dropdown list.</p> <p>- URL *</p> <p>Enter a valid URL.</p> <p>- Template *</p> <p>Enter the payload to be sent to the HTTP endpoint. Select JSON, XML, or plain text based on what your external system requirements.</p> <p>Available variables</p> <pre><code>You can use variables in certain fields by selecting **Add variable**. Refer to the [Variable Usage Examples](../../../../../../variable-usage-examples.md) topic for detailed examples.\n</code></pre> <p>Conditional helpers using Mustache syntax</p> <p>Example:  </p><pre><code>{{#if (eq object.severity 2) }}MEDIUM {{else}}Other {{/if}}\n</code></pre> Find additional supported operators in the official Handlebars documentation.<p></p> <p>Data formatting helpers</p> <p>The following helpers are available to format your data:</p> Helper Description Usage Output <code>tlpLabel</code> Format the <code>tlp</code> field of the object <code>{{ tlpLabel object.tlp }}</code> <code>Amber</code> <code>papLabel</code> Format the <code>pap</code> field of the object <code>{{ papLabel object.pap }}</code> <code>Amber</code> <code>severityLabel</code> Format the <code>severity</code> field of the object <code>{{ severityLabel object.severity }}</code> <code>Critical</code> <code>dateFormat</code> Format a date field of the object using Java date time patterns <code>{{dateFormat audit._createdAt \"EEEEE dd MMMMM yyyy\" \"fr\" }}</code> <code>jeudi 01 septembre 2022</code> <p>Standard string helpers can be found in the official Handlebars documentation.</p> </li> <li> <p>Turn on the Log errors toggle if you want to capture and track any errors that occur when sending the HTTP request.</p> </li> <li> <p>Select  in the Headers section to add headers.</p> <p>Enter a header key and its corresponding value to include in the HTTP request. Use headers to send authentication tokens, content types, or other metadata required by the external system.</p> </li> <li> <p>In the Authentication section, select an authentication type if required.</p> </li> <li> <p>In the Proxy settings section, select the proxy settings you want to apply:</p> <ul> <li>Default configuration</li> <li>Disabled</li> <li>Enabled:<ul> <li>Enter the type of protocol, either HTTP or HTTPS.</li> <li>Enter the IP address or domain name of the proxy server.</li> <li>Enter the port number used by the proxy server.</li> <li>Turn on the Authentication toggle if you want to require a username and password to authenticate with the proxy server.</li> </ul> </li> </ul> </li> <li> <p>Add a certificate authority (CA).</p> <pre><code>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See [Configure JVM Trust for SSL/TLS Certificates](/thehive/configuration/ssl/configure-ssl-jvm/) for instructions.\n\nYou can turn off the **Don't check certificate authority** toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.\n</code></pre> </li> <li> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/kafka/", "title": "Kafka", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/kafka/#configure-the-kafka-notifier", "title": "Configure the Kafka Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the Kafka notifier in TheHive.</p> <p>Notifier availability</p> <p>The Kafka notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <p>No endpoint required</p> <p>An endpoint definition isn't required to send data to a Kafka topic.</p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the Kafka notifier.</p> </li> <li> <p>In the Kafka drawer, enter the following information:</p> <p>- Topic</p> <p>The Kafka topic where TheHive will publish messages. This must match an existing topic in your Kafka setup.</p> <p>- Bootstrap servers</p> <p>A comma-separated list of Kafka network addresses with port numbers. These servers act as the entry point for TheHive to connect to your Kafka cluster.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/mattermost/", "title": "Mattermost", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/mattermost/#configure-the-mattermost-notifier", "title": "Configure the Mattermost Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the Mattermost notifier in TheHive.</p> <p>Notifier availability</p> <p>The Mattermost notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the Mattermost notifier.</p> </li> <li> <p>In the Mattermost drawer, enter the following information:</p> <p>- Endpoint</p> <p>Using Mattermost as a notifier requires at least one endpoint. This endpoint defines how TheHive connects to Mattermost.</p> <p>Select an existing endpoint. Endpoints can be local, defined at the organization level, or global, defined at the client level for one or more organizations. You can add a new local endpoint by selecting Add a new endpoint.</p> <p>- Channel</p> <p>The Mattermost channel where you want to send the data. This overrides the default channel set in the endpoint configuration.</p> <p>- Username</p> <p>The username that will appear as the sender of the message in Mattermost. This overrides the default username set in the endpoint configuration.</p> <p>- Template</p> <p>The message content to send to the Mattermost endpoint. Select JSON, Markdown, or plain text.</p> <p>Available variables</p> <pre><code>You can use variables in certain fields by selecting **Add variable**. Refer to the [Variable Usage Examples](../../../../../../variable-usage-examples.md) topic for detailed examples.\n</code></pre> <p>Conditional helpers using Mustache syntax</p> <p>Example:  </p><pre><code>{{#if (eq object.severity 2) }}MEDIUM {{else}}Other {{/if}}\n</code></pre> Find additional supported operators in the official Handlebars documentation.<p></p> <p>Data formatting helpers</p> <p>The following helpers are available to format your data:</p> Helper Description Usage Output <code>tlpLabel</code> Format the <code>tlp</code> field of the object <code>{{ tlpLabel object.tlp }}</code> <code>Amber</code> <code>papLabel</code> Format the <code>pap</code> field of the object <code>{{ papLabel object.pap }}</code> <code>Amber</code> <code>severityLabel</code> Format the <code>severity</code> field of the object <code>{{ severityLabel object.severity }}</code> <code>Critical</code> <code>dateFormat</code> Format a date field of the object using Java date time patterns <code>{{dateFormat audit._createdAt \"EEEEE dd MMMMM yyyy\" \"fr\" }}</code> <code>jeudi 01 septembre 2022</code> <p>Standard string helpers can be found in the official Handlebars documentation.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/redis/", "title": "Redis", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/redis/#configure-the-redis-notifier", "title": "Configure the Redis Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the Redis notifier in TheHive.</p> <p>Notifier availability</p> <p>The Redis notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <p>No endpoint required</p> <p>An endpoint definition isn't required to send data to a Redis database.</p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the Redis notifier.</p> </li> <li> <p>In the Redis drawer, enter the following information:</p> <p>- Channel *</p> <p>The Redis channel where you want to publish the data.</p> <p>- Host *</p> <p>The Redis server address. This is where TheHive will send data.</p> <p>- Port *</p> <p>The port number Redis is listening on.</p> <p>- Username</p> <p>The username for authentication if Redis Access Control Lists (ACLs) are enabled.</p> <p>- Password</p> <p>The password for authentication if Redis requires authentication.</p> <p>- Database</p> <p>The Redis database index to use. Redis allows multiple logical databases, and this field lets you specify which one to use.</p> <p>Available variables</p> <pre><code>You can use variables in certain fields by selecting **Add variable**. Refer to the [Variable Usage Examples](../../../../../../variable-usage-examples.md) topic for detailed examples.\n</code></pre> <p>Conditional helpers using Mustache syntax</p> <p>Example:  </p><pre><code>{{#if (eq object.severity 2) }}MEDIUM {{else}}Other {{/if}}\n</code></pre> Find additional supported operators in the official Handlebars documentation.<p></p> <p>Data formatting helpers</p> <p>The following helpers are available to format your data:</p> Helper Description Usage Output <code>tlpLabel</code> Format the <code>tlp</code> field of the object <code>{{ tlpLabel object.tlp }}</code> <code>Amber</code> <code>papLabel</code> Format the <code>pap</code> field of the object <code>{{ papLabel object.pap }}</code> <code>Amber</code> <code>severityLabel</code> Format the <code>severity</code> field of the object <code>{{ severityLabel object.severity }}</code> <code>Critical</code> <code>dateFormat</code> Format a date field of the object using Java date time patterns <code>{{dateFormat audit._createdAt \"EEEEE dd MMMMM yyyy\" \"fr\" }}</code> <code>jeudi 01 septembre 2022</code> <p>Standard string helpers can be found in the official Handlebars documentation.</p> </li> <li> <p>Turn on the Enable SSL toggle to encrypt the connection and secure data transmission between TheHive and the Redis server.</p> <p>Add a certificate authority (CA).</p> <pre><code>The server's SSL/TLS certificate must be trusted by the Java virtual machine (JVM) truststore for secure connections. If your server uses a certificate from an internal CA or self-signed certificate, add it to the JVM truststore first. See [Configure JVM Trust for SSL/TLS Certificates](/thehive/configuration/ssl/configure-ssl-jvm/) for instructions.\n\nYou can turn off the **Don't check certificate authority** toggle to bypass certificate validation, but this isn't recommended as it may compromise connection security.\n</code></pre> <p>Turn on the Disable host name verification toggle if you want to bypass the verification of the server's host name against the certificate.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/responders/", "title": "RunResponder", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/responders/#configure-the-runresponder-notifier", "title": "Configure the RunResponder Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the RunResponder notifier in TheHive.</p> <p>Notifier availability</p> <p>The RunResponder notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the RunResponder notifier.</p> </li> <li> <p>Select the responders you want to run.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/slack/", "title": "Slack", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/slack/#configure-the-slack-notifier", "title": "Configure the Slack Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the Slack notifier in TheHive.</p> <p>Notifier availability</p> <p>The Slack notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the Slack notifier.</p> </li> <li> <p>In the Slack drawer, enter the following information:</p> <p>- Endpoint</p> <p>Using Slack as a notifier requires at least one endpoint. This endpoint defines how TheHive connects to Slack.</p> <p>Select an existing endpoint. Endpoints can be local, defined at the organization level, or global, defined at the client level for one or more organizations. You can add a new local endpoint by selecting Add a new endpoint.</p> <p>- Text template</p> <p>The message content to send to the Slack endpoint. Select JSON, Markdown, or plain text.</p> <p>- Channel</p> <p>The Slack channel where you want to send the data. This overrides the default channel set in the endpoint configuration.</p> <p>- Username</p> <p>A username that will appear as the sender of the message in Slack. This overrides the default username set in the endpoint configuration.</p> <p>Available variables</p> <pre><code>You can use variables in certain fields by selecting **Add variable**. Refer to the [Variable Usage Examples](../../../../../../variable-usage-examples.md) topic for detailed examples.\n</code></pre> <p>Conditional helpers using Mustache syntax</p> <p>Example:  </p><pre><code>{{#if (eq object.severity 2) }}MEDIUM {{else}}Other {{/if}}\n</code></pre> Find additional supported operators in the official Handlebars documentation.<p></p> <p>Data formatting helpers</p> <p>The following helpers are available to format your data:</p> Helper Description Usage Output <code>tlpLabel</code> Format the <code>tlp</code> field of the object <code>{{ tlpLabel object.tlp }}</code> <code>Amber</code> <code>papLabel</code> Format the <code>pap</code> field of the object <code>{{ papLabel object.pap }}</code> <code>Amber</code> <code>severityLabel</code> Format the <code>severity</code> field of the object <code>{{ severityLabel object.severity }}</code> <code>Critical</code> <code>dateFormat</code> Format a date field of the object using Java date time patterns <code>{{dateFormat audit._createdAt \"EEEEE dd MMMMM yyyy\" \"fr\" }}</code> <code>jeudi 01 septembre 2022</code> <p>Standard string helpers can be found in the official Handlebars documentation.</p> </li> <li> <p>Select the Advanced settings checkbox if you want to configure additional options.</p> <p>Slack documentation to the rescue</p> <ul> <li>Test your integration the postMessage page.  </li> <li>Build your blocks with the Slack Block Kit Builder.</li> </ul> <p>Example of a blocks template: Send notification about case creation</p> <ul> <li>Trigger: CaseCreated</li> <li>Notifier: Slack</li> </ul> <pre><code>[\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*New Case created: Case #{{object.number}}*\"\n    }\n  },\n  {\n    \"type\": \"divider\"\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"&lt;{{url}}|{{object.title}}&gt; \\n :bee: \\n {{object.description}}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"fields\": [\n      {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*Created by*\\n{{object._createdBy}}\\n*Assigned to*\\n{{object.assignee}}\"\n      }\n    ]\n  }\n]\n</code></pre> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/teams/", "title": "Teams", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/teams/#configure-the-microsoft-teams-notifier", "title": "Configure the Microsoft Teams Notifier", "text": "<p><code>manageConfig</code> Platinum</p> <p>This topic provides step-by-step instructions for configuring the Microsoft Teams notifier in TheHive.</p> <p>Notifier availability</p> <p>The Microsoft Teams notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the Teams notifier.</p> </li> <li> <p>In the Teams drawer, enter the following information:</p> <p>- Endpoint</p> <p>Using Microsoft Teams as a notifier requires at least one endpoint. This endpoint defines how TheHive connects to Microsoft Teams.</p> <p>Endpoints can be local, defined at the organization level, or global, defined at the client level for one or more organizations.</p> <p>Select the local endpoint you created.</p> <p>- Text template</p> <p>The message content to send to the Microsoft Teams endpoint.</p> <p>If an Adaptive Card template isn't provided, you must use a plain text template. In version 5.4.3, TheHive automatically converts plain text into an Adaptive Card format structured with JSON.</p> <p>Tips to write text templates</p> <p>Adaptive Card template used to display notifications when a new case is created</p> <pre><code>{\n\"type\": \"AdaptiveCard\",\n\"body\": [\n    {\n    \"type\": \"TextBlock\",\n    \"size\": \"Medium\",\n    \"weight\": \"Bolder\",\n    \"text\": \"#{{object.number}}: {{object.title}}\",\n    \"horizontalAlignment\": \"Left\",\n    \"spacing\": \"None\",\n    \"wrap\": true\n    },\n    {\n    \"type\": \"ColumnSet\",\n    \"columns\": [\n        {\n        \"type\": \"Column\",\n        \"items\": [\n            {\n            \"type\": \"TextBlock\",\n            \"weight\": \"Bolder\",\n            \"text\": \"{{object._createdBy}}\",\n            \"fontType\": \"Default\",\n            \"color\": \"Accent\",\n            \"spacing\": \"None\"\n            },\n            {\n            \"type\": \"TextBlock\",\n            \"spacing\": \"None\",\n            \"text\": \"Created {{dateFormat object._createdAt 'EEEE d MMMM, k:m Z' locale='en' tz='Europe/Paris'}}\",\n            \"isSubtle\": true,\n            \"wrap\": true,\n            \"fontType\": \"Default\",\n            \"weight\": \"Default\",\n            \"size\": \"Default\"\n            }\n        ]\n        }\n    ]\n    },\n    {\n    \"type\": \"FactSet\",\n    \"facts\": [\n        {\n        \"title\": \"severity\",\n        \"weight\": \"Bolder\",\n        \"value\": \"{{ severityLabel object.severity}}\"\n        },\n        {\n        \"title\": \"TLP\",\n        \"weight\": \"Bolder\",\n        \"value\": \"{{ tlpLabel object.tlp}}\"\n        }\n    ]\n    },\n    {\n    \"type\": \"TextBlock\",\n    \"weight\": \"Bolder\",\n    \"text\": \"Description\",\n    \"spacing\": \"Large\",\n    \"wrap\": true,\n    \"horizontalAlignment\": \"Left\"\n    },\n    {\n    \"type\": \"TextBlock\",\n    \"text\": \"{{object.description}}\",\n    \"spacing\": \"None\",\n    \"wrap\": true,\n    \"horizontalAlignment\": \"Left\",\n    \"maxLines\": 3\n    }\n],\n\"actions\": [\n    {\n    \"type\": \"Action.OpenUrl\",\n    \"title\": \"Open Case in TheHive\",\n    \"iconUrl\": \"https://docs.strangebee.com/images/thehive.png\",\n    \"url\": \"{{url}}\",\n    \"style\": \"positive\"\n    }\n],\n\"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n\"version\": \"1.5\"\n}\n</code></pre> <p>Used with the trigger CaseCreated, this template will create a card like this in Microsoft Teams:</p> <p></p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/teams/#use-the-adaptive-cards-designer", "title": "Use the Adaptive Cards Designer", "text": "<p>Use the Adaptive Cards Designer as a starting point to design your Adaptive Cards.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/teams/#format-dates", "title": "Format dates", "text": "<ul> <li>TheHive uses Handlebars string helpers to read dates.</li> <li>Formatting date and time in notifications requires using dedicated Java patterns.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/teams/#format-other-custom-data-from-thehive", "title": "Format other custom data from TheHive", "text": "<p>Few data custom to TheHive can be properly displayed using custom string handlers together with <code>object</code> data in notifications:</p> <ul> <li><code>tlpLabel</code> to display the TLP value (example: <code>{{tlpLabel object.tlp}}</code>)</li> <li><code>papLabel</code> to display the PAP value (example: <code>{{papLabel object.pap}}</code>)</li> <li><code>severityLabel</code> to display the severity value (example: <code>{{severityLabel object.severity}}</code>)</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/webhook/", "title": "Webhook", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-notifications/notifiers/webhook/#configure-the-webhook-notifier", "title": "Configure the Webhook Notifier", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for configuring the Webhook notifier in TheHive.</p> <p>Notifier availability</p> <p>The Webhook notifier is available only when you turn off the Send notification to every user in the organization toggle and use one of the following triggers:</p> <ul> <li>AnyEvent </li> <li>FilteredEvent </li> <li>ActionFinished </li> <li>CaseClosed </li> <li>CaseCreated </li> <li>CaseFlagged </li> <li>CaseShared </li> <li>AlertClosed </li> <li>AlertCreated </li> <li>AlertImported </li> <li>JobFinished </li> <li>AlertObservableCreated </li> <li>CaseObservableCreated </li> <li>ObservableCreated </li> <li>TaskClosed </li> <li>TaskMandatory</li> </ul> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Notifications tab.</p> <p></p> </li> <li> <p>Select  and then Edit.</p> </li> <li> <p>Select the Webhook notifier.</p> </li> <li> <p>In the Webhook drawer, select an existing endpoint.</p> <p>Using a webhook as a notifier requires at least one endpoint. This endpoint defines how TheHive connects to the webhook.</p> <p>Endpoints can be local, defined at the organization level, or global, defined at the client level for one or more organizations.</p> <p>You can add a new local endpoint by selecting Add a new endpoint.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Turn Off a Notification</li> <li>Delete a Notification</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/about-case-page-templates/", "title": "About Page Templates", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/about-case-page-templates/#about-case-page-templates", "title": "About Case Page Templates", "text": "<p>Case page templates streamline page creation within cases in TheHive by automatically prefilling content.</p> <p>This topic provides an overview of case page template usage in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/about-case-page-templates/#benefits", "title": "Benefits", "text": "<p>Use case page templates to:</p> <ul> <li>Simplify page creation workflows within cases</li> <li>Save time when creating new pages in cases</li> <li>Maintain consistency in page formatting and content</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/about-case-page-templates/#usage", "title": "Usage", "text": "<p>Use a case page template when creating a case page.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/about-case-page-templates/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>managePageTemplate</code> permission can manage case page templates in TheHive.</p> <p>Once created, case page templates are automatically available to all users within the organization.</p> <p>To share a case page template with another organization or TheHive instance, use the export and import features.</p> <ul> <li>Create a Case Page Template</li> <li>Delete a Case Page Template</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/create-a-case-page-template/", "title": "Create a Page Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/create-a-case-page-template/#create-a-case-page-template", "title": "Create a Case Page Template", "text": "<p><code>managePageTemplate</code></p> <p>This topic provides step-by-step instructions for creating a case page template in TheHive.</p> <p>Case page templates streamline page creation within cases in TheHive by automatically prefilling content.</p> <p>To import an existing case template from another organization or TheHive instance, refer to the Import a Case Page Template topic.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding a page template drawer, enter the following fields:</p> <p>Title The case page template title. It's used to identify the template in the API and serves as the default page title when creating a page based on the template.</p> <p>Category The default category the pages belongs to. Pages are visually grouped by category for easier navigation. If the category doesn't exist, it will be created automatically.</p> <p>Content The default page content using TheHive-flavored Markdown syntax.</p> </li> <li> <p>Select Add page template.</p> </li> </ol> Next steps <ul> <li>Delete a Case Page Template</li> <li>Create a Case Page</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/delete-a-case-page-template/", "title": "Delete a Page Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/delete-a-case-page-template/#delete-a-case-page-template", "title": "Delete a Case Page Template", "text": "<p><code>managePageTemplate</code></p> <p>This topic provides step-by-step instructions for deleting a case page template in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select  next to the case page template you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a Case Page Template</li> <li>Create a Case Page</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/export-a-case-page-template/", "title": "Export a Page Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/export-a-case-page-template/#export-a-case-page-template", "title": "Export a Case Page Template", "text": "<p><code>managePageTemplate</code></p> <p>This topic provides step-by-step instructions for exporting a case page template in TheHive.</p> <p>You can import the exported JSON file, into another organization or TheHive instance for sharing.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select  next to the case page template you want to export.</p> </li> <li> <p>Select Export case template to export the case page template in JSON format.</p> </li> </ol> Next steps <ul> <li>Import a Case Page Template</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/import-a-case-page-template/", "title": "Import a Page Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-page-templates/import-a-case-page-template/#import-a-case-page-template", "title": "Import a Case Page Template", "text": "<p><code>managePageTemplate</code></p> <p>This topic provides step-by-step instructions for importing a case page template in TheHive.</p> <p>Use this procedure to use a case page template from another organization or TheHive instance.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Pages tab.</p> <p></p> </li> <li> <p>Select Import case template.</p> </li> <li> <p>In the Importing a case template drawer, drop a JSON file directly into the Attachment section or select it from your computer. Use the file you obtained from exporting the case page template.</p> </li> <li> <p>Select Confirm case template import.</p> </li> </ol> Next steps <ul> <li>Create a Case Page</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/about-case-report-templates/", "title": "About Case Report Templates", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/about-case-report-templates/#about-case-report-templates", "title": "About Case Report Templates", "text": "<p>Platinum</p> <p>Case report templates generate reports in a predefined format, available from case descriptions.</p> <p>This topic provides an overview of case report templates and their usage in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/about-case-report-templates/#benefits", "title": "Benefits", "text": "<p>Use case report templates to:</p> <ul> <li>Highlight key details for faster security actions</li> <li>Enhance better collaboration and decision-making</li> <li>Standardize reports for accurate analysis and comparisons</li> <li>Keep structured records for audits and regulations</li> <li>Build an archive for historical analysis and threat prevention</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/about-case-report-templates/#usage", "title": "Usage", "text": "<p>Create a case report template to automatically generate reports in case descriptions.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/about-case-report-templates/#structure", "title": "Structure", "text": "<p>Every case report template includes default header and footer sections customizable with content and case variables. These sections can't be moved or deleted but remain hidden in the case report if left empty.</p> <p>Add widgets between these sections to display case data. The order of widgets can be rearranged at any time.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/about-case-report-templates/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageCaseReportTemplate</code> permission can manage case report templates in TheHive.</p> <p>Once created, case report templates are automatically available to all users in the organization within case descriptions.</p> <ul> <li>About Widgets</li> <li>Create a Case Report Template</li> <li>Add or Remove Widgets in a Case Report Template</li> <li>Delete a Case Report Template</li> <li>Save and Download a Case Report</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/add-remove-widgets-case-report-template/", "title": "Add or Remove Widgets", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/add-remove-widgets-case-report-template/#add-or-remove-widgets-in-a-case-report-template", "title": "Add or Remove Widgets in a Case Report Template", "text": "<p><code>manageCaseReportTemplate</code> Platinum</p> <p>This topic provides step-by-step instructions for adding and removing widgets in a case report template in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/add-remove-widgets-case-report-template/#add-widgets-in-a-case-report-template", "title": "Add widgets in a case report template", "text": "<ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Reports tab.</p> <p> </p> </li> <li> <p>Select the case report template you want to edit, or select  next to the case report template you want to edit and then Edit.</p> </li> <li> <p>Drag available widgets to position them as needed.</p> <p></p> </li> <li> <p>Enter the required information for the widget.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>Select  to edit sections,  to duplicate them, and  to delete them.</p> </li> <li> <p>Select  to preview the case report display.</p> </li> <li> <p>Select  to save your case report template.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/add-remove-widgets-case-report-template/#remove-widgets-in-a-case-report-template", "title": "Remove widgets in a case report templateNext steps", "text": "<ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Reports tab.</p> <p> </p> </li> <li> <p>Select the case report template you want to edit, or select  next to the case report template you want to edit and then Edit.</p> </li> <li> <p>Select  at the top right of the widget you want to remove.</p> </li> <li> <p>Select OK.</p> </li> </ol> <ul> <li>Delete a Case Report Template</li> <li>Save and Download a Case Report</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/create-a-case-report-template/", "title": "Create a Case Report Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/create-a-case-report-template/#create-a-case-report-template", "title": "Create a Case Report Template", "text": "<p><code>manageCaseReportTemplate</code> Platinum</p> <p>This topic provides step-by-step instructions for creating a case report template in TheHive.</p> <p>Case report templates generate reports in a predefined format, available from case descriptions.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Reports tab.</p> <p> </p> </li> <li> <p>Two options are available:</p> <ul> <li> <p>Create a case report template from scratch by selecting .</p> </li> <li> <p>Duplicate an existing case report template by selecting  next to the case report template you want to duplicate, then select Duplicate.</p> </li> </ul> </li> <li> <p>In the drawer, enter the following fields:</p> <p>- Title * The title users will see when selecting reports in case descriptions.</p> <p>- Description A brief summary of your case report template, outlining its purpose and contents.</p> </li> <li> <p>Select Add report template or Edit report template. </p> </li> <li> <p>Drag available widgets to position them as needed.</p> <p></p> </li> <li> <p>Enter the required information for the widget.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>Select  to edit sections,  to duplicate them, and  to delete them.</p> </li> <li> <p>Select  to preview the case report display.</p> </li> <li> <p>Select  to save your case report template.</p> </li> </ol> Next steps <ul> <li>Add or Remove Widgets in a Case Report Template</li> <li>Save and Download a Case Report</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/delete-a-case-report-template/", "title": "Delete a Case Report Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/delete-a-case-report-template/#delete-a-case-report-template", "title": "Delete a Case Report Template", "text": "<p><code>manageCaseReportTemplate</code> Platinum</p> <p>This topic provides step-by-step instructions for deleting a case report template in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Reports tab.</p> <p> </p> </li> <li> <p>Select  next to the case report template you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> </ol> Next steps <ul> <li>Create a Case Report Template</li> <li>Add or Remove Widgets in a Case Report Template</li> <li>Save and Download a Case Report</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/", "title": "Widgets", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#widgets-in-case-report-templates", "title": "Widgets in Case Report Templates", "text": "<p>Several widget types are available for case report templates in TheHive.</p> <p>This topic describes each widget type and its attributes.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#text-widget", "title": "Text widget", "text": "<p>Displays formatted text, with support for case variables and TheHive-flavored Markdown.</p> <p>Text widget configuration includes:</p> <ul> <li>A title for the text block</li> <li>The content of the text block, with the option to include case variables</li> </ul> <p>Format your text block using TheHive-flavored Markdown syntax.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#image-widget", "title": "Image widget", "text": "<p>Displays an image to visually support the report content.</p> <p>Supported image formats</p> <p>Image widgets only support JPG, JPEG, and PNG formats.</p> <p>Image widget configuration includes:</p> <ul> <li>A title for the image</li> <li>An image that you can upload by dragging and dropping or selecting from your computer</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#table-widget", "title": "Table widget", "text": "<p>Displays structured data in a tabular format, based on selected case elements.</p> <p>Table widget configuration includes:</p> <ul> <li>A title for the table</li> <li>A parameter selection to choose from observables, tasks, TTPs, alerts, or custom fields, along with the data to display</li> </ul> <p>Protect observable URLs</p> <p>Turn on the Protect data? toggle to defang URLs and prevent accidental clicks.</p> <ul> <li>Sorting rules and filters to refine the displayed data</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#list-widget", "title": "List widget", "text": "<p>Displays a simplified list of observables, tasks, TTPs, or alerts.</p> <p>List widget configuration includes:</p> <ul> <li>A title for the list</li> <li>A parameter selection to choose from observables, tasks, TTPs, or alerts, along with the data to display</li> </ul> <p>Protect observable URLs</p> <p>Turn on the Protect data? toggle to defang URLs and prevent accidental clicks.</p> <ul> <li>Sorting rules and filters to refine the displayed data</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#timeline-widget", "title": "Timeline widget", "text": "<p>Displays case activity in a chronological list format.</p> <p>Timeline widget configuration includes:</p> <ul> <li>A title for the timeline</li> <li>A selection of multiple parameters, allowing you to choose from alerts, case events, tasks, task logs, sighted indicators of compromise (IOCs), and TTPs</li> <li>Custom events 5.5 You can choose if you want to display custom events with or without their descriptions.</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#comments-widget", "title": "Comments widget", "text": "<p>5.4</p> <p>Displays case comments with optional filters and a maximum display limit.</p> <p>Comments widget configuration includes:</p> <ul> <li>A title for the comments widget</li> <li>The maximum number of comments to display</li> <li>Filters to refine the displayed comments</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-report-templates/widgets-case-report-templates/#pages-widget", "title": "Pages widgetNext steps", "text": "<p>5.4</p> <p>Displays selected case pages.</p> <p>Pages widget configuration includes:</p> <ul> <li>A title for the pages widget</li> <li>Filters to refine the displayed pages</li> </ul> <ul> <li>About Case Report Templates</li> <li>Create a Case Report Template</li> <li>Add or Remove Widgets in a Case Report Template</li> <li>Save and Download a Case Report</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/about-case-templates/", "title": "About Case Templates", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/about-case-templates/#about-case-templates", "title": "About Case Templates", "text": "<p>Case templates streamline case creation in TheHive by automatically filling predefined fields.</p> <p>This topic provides an overview of case template usage in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/about-case-templates/#benefits", "title": "Benefits", "text": "<p>Use case templates to:</p> <ul> <li>Simplify case creation workflows</li> <li>Save time when creating new cases</li> <li>Maintain consistency in case descriptions</li> <li>Enrich ongoing cases by adding additional information</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/about-case-templates/#usage", "title": "Usage", "text": "<p>Base case templates on the threat category to maximize effectiveness and ensure continuous improvement.</p> <p>Create a case from a case template when initiating a new case.</p> <p>Apply a case template to an existing case as needed.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/about-case-templates/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with the <code>manageCaseTemplate</code> permission can manage case templates in TheHive.</p> <p>Once created, case templates are automatically available to all users in the organization.</p> <p>To share a case template with another organization or TheHive instance, use the export and import features.</p> <ul> <li>Create a Case Template</li> <li>Create a Case</li> <li>Apply a Case Template</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/create-a-case-template/", "title": "Create a Case Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/create-a-case-template/#create-a-case-template", "title": "Create a Case Template", "text": "<p><code>manageCaseTemplate</code></p> <p>This topic provides step-by-step instructions for creating a case template in TheHive.</p> <p>Case templates streamline case creation by automatically filling predefined fields.</p> <p>5.4 Duplicate an existing case template</p> <p>You can duplicate an existing case template within your organization to pre-fill fields and streamline the process.</p> <p>To import an existing case template from another organization or TheHive instance, refer to the Import a Case Template topic.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Cases tab.</p> <p></p> </li> <li> <p>Two options are available:</p> <ul> <li> <p>Create a case template from scratch by selecting .</p> </li> <li> <p>5.4 Duplicate an existing template by selecting  next to the case template you want to duplicate, then select Duplicate.</p> </li> </ul> </li> <li> <p>In the Adding a case template drawer, enter values in some or all the following fields to pre-fill:</p> <p>- Prefix </p> <p>A prefix that's automatically added to case titles. The prefix value isn't visible when creating a case from the template but applies after creation. Use it to categorize cases for reporting. Add a hyphen (-) after the prefix to clearly separate it from the case title.</p> <p>- Name * </p> <p>The name of the case template. This name identifies the case template in the API.</p> <p>- Display name </p> <p>The name that appears when users select this template to create a new case or to apply it to an existing case. If you don't specify a display name, the case template name is used.</p> <p>- TLP (traffic light protocol) * </p> <p>The TLP level for the case. It indicates how you can share the case's information with others. Refer to the Malware Information Sharing Platform (MISP) taxonomy for detailed definitions of TLP values. </p> <p>- PAP (permissible actions protocol) * </p> <p>The PAP level for the case. It specifies which actions you can take with the case data. Refer to the MISP taxonomy for detailed definitions of PAP values.</p> <p>- Severity </p> <p>The default severity level for cases.</p> <p>- Tags </p> <p>One or more tags for labeling cases.</p> <p>Description * </p> <p>A description for cases using TheHive-flavored Markdown syntax.</p> <p>- Tasks </p> <p>One or more tasks for cases.</p> <p>- Custom fields </p> <p>One or more custom fields for cases, with or without predefined values.</p> <p>- Pages </p> <p>A page template to document cases.</p> </li> <li> <p>Select Confirm case template creation.</p> </li> </ol> Next steps <ul> <li>Export or Import a Case Template</li> <li>Create a Case</li> <li>Apply a Case Template</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/delete-a-case-template/", "title": "Delete a Case Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/delete-a-case-template/#delete-a-case-template", "title": "Delete a Case Template", "text": "<p><code>manageCaseTemplate</code></p> <p>This topic provides step-by-step instructions for deleting a case template in TheHive.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Cases tab.</p> <p></p> </li> <li> <p>Select  next to the case template you want to delete.</p> </li> <li> <p>Select Delete.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Export or Import a Case Template</li> <li>Create a Case</li> <li>Apply a Case Template</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/export-import-a-case-template/", "title": "Export or Import a Case Template", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/export-import-a-case-template/#export-or-import-a-case-template", "title": "Export or Import a Case Template", "text": "<p><code>manageCaseTemplate</code></p> <p>This topic provides step-by-step instructions for exporting and importing a case template in TheHive.</p> <p>Share and discover case templates</p> <p>Contribute to and find case templates in our public GitHub repository.  </p> <p>Before submitting your pull request:</p> <ul> <li>Remove any sensitive information.</li> <li>Exclude custom fields.</li> </ul> <p>Each contribution is reviewed by StrangeBee before being published.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/export-import-a-case-template/#export-a-case-template", "title": "Export a case template", "text": "<p>Use this procedure to share a case template with another organization or TheHive instance.</p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Cases tab.</p> <p></p> </li> <li> <p>Select  next to the case template you want to export.</p> </li> <li> <p>Select Export case template to export the case template in JSON format.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-templates/case-templates/export-import-a-case-template/#import-a-case-template", "title": "Import a case templateNext steps", "text": "<p>Use this procedure to use a case template from another organization or TheHive instance.</p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Templates tab.</p> <p></p> </li> <li> <p>Select the Cases tab.</p> <p></p> </li> <li> <p>Select Import case template.</p> </li> <li> <p>In the Importing a case template drawer, drop a JSON file directly into the Attachment section or select it from your computer. Use the file you obtained from exporting the case template.</p> </li> <li> <p>Select Confirm case template import.</p> </li> </ol> <ul> <li>Create a Case</li> <li>Apply a Case Template</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/hide-key-performance-indicators/", "title": "Hide KPIs", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/hide-key-performance-indicators/#hide-key-performance-indicators", "title": "Hide Key Performance Indicators", "text": "<p>5.4 <code>manageConfig</code></p> <p>This topic provides step-by-step instructions for hiding one or several key performance indicators (KPIs) for cases and alerts in TheHive.</p> <p>By default, all indicators appear in case and alert descriptions.</p> <p>You can hide some or all indicators if they're not useful or could be misleading for your organization.</p> <p>If you want to know more about the KPIs available in TheHive, refer to the Key Performance Indicators topic.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the UI Configuration tab.</p> <p></p> </li> <li> <p>Move through the Time metrics section.</p> </li> <li> <p>Turn on the toggles for the indicators you want to hide in case and alert descriptions.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Measure Case Management Performance</li> <li>Measure Alert Management Performance</li> <li>Pause Dashboard Refresh</li> <li>Remove the All Periods Option in a Dashboard</li> <li>Prevent Users from Creating Empty Cases</li> <li>Prevent Users from Merging Alerts into Closed Cases</li> <li>Select Similar Cases and Alerts Filters</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/pause-dashboard-refresh/", "title": "Pause Dashboard Refresh", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/pause-dashboard-refresh/#pause-dashboard-refresh", "title": "Pause Dashboard Refresh", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for pausing dashboard refresh in TheHive.</p> <p>Use this procedure to improve application performance by preventing dashboard refresh and stopping users from re-enabling it.</p> <p>To reduce the refresh frequency while keeping it enabled, see Adjust Dashboard Refresh Frequency.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the UI Configuration tab.</p> <p></p> </li> <li> <p>In the Dashboard section, turn on the Disallow refresh option in dashboards toggle.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Remove the All Periods Option in a Dashboard</li> <li>Prevent Users from Creating Empty Cases</li> <li>Prevent Users from Merging Alerts into Closed Cases</li> <li>Select Similar Cases and Alerts Filters</li> <li>Hide Key Performance Indicators</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/prevent-creating-empty-cases/", "title": "Prevent Users from Creating Empty Cases", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/prevent-creating-empty-cases/#prevent-users-from-creating-empty-cases", "title": "Prevent Users from Creating Empty Cases", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for hiding the empty case option when creating a case in TheHive.</p> <p>By default, the empty case option is available. Use this procedure to require users to create cases only from templates, archived cases, or the Malware Information Sharing Platform (MISP) to ensure better standardization.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the UI Configuration tab.</p> <p></p> </li> <li> <p>In the Alert and case section, turn on the Hide empty case button toggle.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Pause Dashboard Refresh</li> <li>Remove the All Periods Option in a Dashboard</li> <li>Select Similar Cases and Alerts Filters</li> <li>Prevent Users from Merging Alerts into Closed Cases</li> <li>Hide Key Performance Indicators</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/prevent-merging-alerts-into-closed-cases/", "title": "Prevent Users from Merging Alerts into Closed Cases", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/prevent-merging-alerts-into-closed-cases/#prevent-users-from-merging-alerts-into-closed-cases", "title": "Prevent Users from Merging Alerts into Closed Cases", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for deactivating the ability to merge alerts into closed cases in TheHive.</p> <p>A closed case is one with a status assigned to the Closed stage.</p> <p>By default, it's possible to merge alerts into a closed case. Use this procedure to restrict merging alerts into cases statuses linked to the New or In progress stages.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the UI Configuration tab.</p> <p></p> </li> <li> <p>In the Alert and case section, turn on the Merge alerts into closed cases toggle.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Pause Dashboard Refresh</li> <li>Remove the All Periods Option in a Dashboard</li> <li>Prevent Users from Creating Empty Cases</li> <li>Select Similar Cases and Alerts Filters</li> <li>Hide Key Performance Indicators</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/remove-all-periods-option/", "title": "Remove the All Periods Option in a Dashboard", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/remove-all-periods-option/#remove-the-all-periods-option-in-a-dashboard", "title": "Remove the All Periods Option in a Dashboard", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for removing the All periods option in a dashboard in TheHive.</p> <p>Use this procedure to improve application performance by preventing users to select the All periods option.</p> <p>To learn how to change the display period for dashboards, see Set a Dashboard Display Period.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the UI Configuration tab.</p> <p></p> </li> <li> <p>In the Dashboard section, turn on the Disallow \"All\" period option in dashboards toggle.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Pause Dashboard Refresh</li> <li>Prevent Users from Creating Empty Cases</li> <li>Prevent Users from Merging Alerts into Closed Cases</li> <li>Select Similar Cases and Alerts Filters</li> <li>Hide Key Performance Indicators</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/select-similar-cases-alerts-filters/", "title": "Select Similar Cases and Alerts Filters", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/select-similar-cases-alerts-filters/#select-similar-cases-and-alerts-filters", "title": "Select Similar Cases and Alerts Filters", "text": "<p><code>manageConfig</code></p> <p>This topic provides step-by-step instructions for selecting filters to apply on the Similar cases and Similar alerts tabs in TheHive.</p> <p>The Similar cases and Similar alerts tabs display cases and alerts that share similar observables based on defined criteria.</p> Procedure <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the UI Configuration tab.</p> <p></p> </li> <li> <p>In the Alert and case section, select the filter you want to apply in the Select the default filter of alert case similarity panel dropdown list.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> Next steps <ul> <li>Pause Dashboard Refresh</li> <li>Remove the All Periods Option in a Dashboard</li> <li>Prevent Users from Creating Empty Cases</li> <li>Prevent Users from Merging Alerts into Closed Cases</li> <li>Hide Key Performance Indicators</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/ui-configuration-settings/", "title": "UI Configuration Settings", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/ui-configuration-settings/#ui-configuration-settings", "title": "UI Configuration Settings", "text": "<p>This topic provides a list of all UI configuration settings available at the organization level in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-ui-configuration/ui-configuration-settings/#configuration-settings", "title": "Configuration settingsNext steps", "text": "Setting Purpose Hide empty case button Hides the default option to create empty cases, enforcing new cases to start only from templates, archived cases, or MISP. See Prevent Users from Creating Empty Cases for detailed instructions. Merge alerts into closed cases Prevent users from merging alerts into closed cases. See Prevent Users from Merging Alerts into Closed Cases for detailed instructions. Select the default filter of alert case similarity panel Allows choosing how lists are displayed in the Similar alerts and Similar cases tabs. See Select Similar Cases and Alerts Filters for detailed instructions. Disallow refresh option in dashboards Prevents dashboard refresh and removes the ability to change this setting. This option reduces performance issues for organizations. See Pause Dashboard Refresh for detailed instructions. Disallow \"All\" period option in dashboards Prevents selecting All periods when displaying a dashboard. This option reduces performance issues for organizations. See Remove the All Periods Option in a Dashboard for detailed instructions. 5.4 Hide time to detect Hides the time to detect indicator on cases and alerts when it's not useful or could be misleading for your organization. See Hide Key Performance Indicators for detailed instructions. 5.4 Hide time to triage Hides the time to triage indicator on cases and alerts when it's not useful or could be misleading for your organization. See Hide Key Performance Indicators for detailed instructions. 5.4 Hide time to acknowledge Hides the time to acknowledge indicator on cases and alerts when it's not useful or could be misleading for your organization. See Hide Key Performance Indicators for detailed instructions. 5.4 Hide time to qualify Hides the time to qualify indicator on cases when it's not useful or could be misleading for your organization. See Hide Key Performance Indicators for detailed instructions. 5.4 Hide time to resolve Hides the time to resolve indicator on cases when it's not useful or could be misleading for your organization. See Hide Key Performance Indicators for detailed instructions. <ul> <li>Manage User Accounts</li> <li>Rename a Custom Tag</li> <li>Create a Case Page Template</li> <li>Create a Case Report Template</li> <li>Create a Case Template</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/about-user-accounts/", "title": "About User Accounts", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/about-user-accounts/#about-user-accounts", "title": "About User Accounts", "text": "<p>This topic explains how user accounts work in TheHive.</p> <p>License</p> <p>Your TheHive license defines how many user accounts you can create.  </p> <p>Count toward the limit:  </p> <ul> <li>Unlocked user accounts of type Normal with at least one licensed permission  </li> </ul> <p>Don't count:  </p> <ul> <li>Service user accounts  </li> <li>Normal user accounts with no licensed permissions, for example profiles such as Read-Only or Admin</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/about-user-accounts/#types", "title": "Types", "text": "<p>5.0 </p> <p>TheHive supports two types of user accounts:</p> <ul> <li> <p>Normal accounts: Intended for users who access TheHive through the web interface. Normal accounts support all authentication methods. These accounts can also generate API keys if enabled.</p> </li> <li> <p>Service accounts: Designed for programmatic access to TheHive via the API. Service accounts authenticate exclusively using an API key and can't sign in to the web interface.</p> </li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/about-user-accounts/#organizations", "title": "Organizations", "text": "<p>Each user account belongs to one or more organizations. If a user is linked to multiple organizations, they can switch between them at any time.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/about-user-accounts/#profiles", "title": "Profiles", "text": "<p>Each user account is assigned a profile. Profiles define the set of permissions available to the user.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/about-user-accounts/#permissions", "title": "PermissionsNext steps", "text": "<p>Only users with an admin-type profile that has the <code>manageUser</code> permission can manage user accounts at the client level in TheHive.</p> <p>Only users with the <code>manageUser</code> permission can manage user accounts at the organization level in TheHive.</p> <ul> <li>Create a User Account</li> <li>Delete a User Account</li> <li>Lock a User Account</li> <li>Export a List of User Accounts</li> <li>Manage User Accounts</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/create-a-user-account/", "title": "Create a User Account", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/create-a-user-account/#create-a-user-account", "title": "Create a User Account", "text": "<p>This topic provides step-by-step instructions for creating a user account in TheHive.</p> <p>To add an existing user account to an organization, see Add or Remove an Existing User Account from an Organization.</p> <p>License</p> <p>Your TheHive license defines how many user accounts you can create.  </p> <p>Count toward the limit:  </p> <ul> <li>Unlocked user accounts of type Normal with at least one licensed permission  </li> </ul> <p>Don't count:  </p> <ul> <li>Service user accounts  </li> <li>Normal user accounts with no licensed permissions, for example profiles such as Read-Only or Admin</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/create-a-user-account/#create-a-user-account-for-an-organization", "title": "Create a user account for an organization", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/create-a-user-account/#as-an-administrator", "title": "As an administrator", "text": "<p><code>[admin] manageUser</code></p> <ol> <li> <p>Go to the Organizations view from the sidebar menu.</p> <p> </p> </li> <li> <p>Select the organization to add the user account to, then select . Alternatively, hover over the organization, select , and select Add in the Users section.</p> </li> <li> <p>In the Adding a user drawer, enter:</p> <p>- Type *</p> <p>The user account type you want to create.</p> <p>Pick an option from the dropdown list:</p> <ul> <li>Normal: Intended for users who access TheHive through the web interface. Normal accounts support all authentication methods. These accounts can also generate API keys if enabled.</li> <li>Service: Designed for programmatic access to TheHive via the API. Service accounts authenticate exclusively using an API key and can't sign in to the web interface.</li> </ul> <p>- Login *</p> <p>The login used for the user to sign in. It can be an email address or another identifier, depending on your authentication configuration.</p> <p>- Name *</p> <p>The user account's display name.</p> <p>- Profile *</p> <p>Select a permission profile for the user account from the dropdown list.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>In the user accounts list, hover over the user you just created and select .</p> </li> <li> <p>Optional: Select the default user account avatar to modify it, then upload a new image. Only PNG and JPG formats are supported.</p> </li> <li> <p>Optional: If the login isn't an email, add an email address in the Email field. This address is used to send notifications and password-related information to the user.</p> </li> <li> <p>Optional: Select Create to generate an API key.</p> </li> <li> <p>Select Set a new password to create a default password for the user account.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/create-a-user-account/#as-an-organization-administrator", "title": "As an organization administrator", "text": "<p><code>manageUser</code></p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Users tab.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding a user drawer, enter:</p> <p>- Type *</p> <p>The user account type you want to create.</p> <p>Pick an option from the dropdown list:</p> <ul> <li>Normal: Intended for users who access TheHive through the web interface. Normal accounts support all authentication methods. These accounts can also generate API keys if enabled.</li> <li>Service: Designed for programmatic access to TheHive via the API. Service accounts authenticate exclusively using an API key and can't sign in to the web interface.</li> </ul> <p>- Login *</p> <p>The login used for the user to sign in. It can be an email address or another identifier, depending on your authentication configuration.</p> <p>- Name *</p> <p>The user account's display name.</p> <p>- Profile *</p> <p>Select a permission profile for the user account from the dropdown list.</p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>In the user accounts list, hover over the user you just created and select .</p> </li> <li> <p>Optional: Select the default user account avatar to modify it, then upload a new image. Only PNG and JPG formats are supported.</p> </li> <li> <p>Optional: If the login isn't an email, add an email address in the Email field. This address is used to send notifications and password-related information to the user.</p> </li> <li> <p>Optional: Select Create to generate an API key.</p> </li> <li> <p>Select Set a new password to create a default password for the user account.</p> </li> <li> <p>Select Confirm.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/create-a-user-account/#create-a-user-account-for-multiple-organizations", "title": "Create a user account for multiple organizationsNext steps", "text": "<p><code>[admin] manageUser</code></p> <ol> <li> <p>Go to the Users view from the sidebar menu.</p> <p></p> </li> <li> <p>Select .</p> </li> <li> <p>In the Adding a user drawer, enter:</p> <p>- Type *</p> <p>The user account type you want to create.</p> <p>Pick an option from the dropdown list:</p> <ul> <li>Normal: Intended for users who access TheHive through the web interface. Normal accounts support all authentication methods. These accounts can also generate API keys if enabled.</li> <li>Service: Designed for programmatic access to TheHive via the API. Service accounts authenticate exclusively using an API key and can't sign in to the web interface.</li> </ul> <p>- Login *</p> <p>The login used for the user to sign in. It can be an email address or another identifier, depending on your authentication configuration.</p> <p>- Name *</p> <p>The user account's display name.</p> <p>- Organizations *</p> <p>Select one or more organizations to assign to the user account. To set the default organization the user accesses when signing in to TheHive, select Set as default.</p> <p>For each organization, select a permission profile for the user account from the dropdown list.</p> <p>5.4.3 Profiles that require a Gold or Platinum license are labeled License required. </p> </li> <li> <p>Select Confirm.</p> </li> <li> <p>In the user accounts list, hover over the user you just created and select .</p> </li> <li> <p>Optional: Select the default user account avatar to modify it, then upload a new image. Only PNG and JPG formats are supported.</p> </li> <li> <p>Optional: If the login isn't an email, add an email address in the Email field. This address is used to send notifications and password-related information to the user.</p> </li> <li> <p>Optional: Select Create to generate an API key.</p> </li> <li> <p>Select Set a new password to create a default password for the user account.</p> </li> <li> <p>Select Confirm.</p> </li> </ol> <ul> <li>Delete a User Account</li> <li>Lock a User Account</li> <li>Export a List of User Accounts</li> <li>Manage User Accounts</li> <li>Add or Remove an Existing User Account from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/delete-a-user-account/", "title": "Delete a User Account", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/delete-a-user-account/#delete-a-user-account", "title": "Delete a User Account", "text": "<p><code>[admin] manageUser</code></p> <p>This topic provides step-by-step instructions for deleting a user account in TheHive.</p> <p>Permanent action</p> <p>This action permanently deletes the user account at the client level, removing it from all organizations.</p> <p>To lock a user account without deleting it, see Lock a User Account.</p> <p>To remove a user account from a specific organization without deleting it, see Add or Remove an Existing User Account to an Organization.</p> Procedure <ol> <li> <p>Go to the Users view from the sidebar menu.</p> <p></p> </li> <li> <p>Hover over the user account you want to delete and select .</p> <p>Can't find a user account?</p> <p>You can apply filters and sorting to help locate user accounts. These preferences can be saved using views.</p> </li> <li> <p>In the drawer, select Delete user.</p> <p>Delete multiple user accounts in bulk</p> <p>To delete multiple user accounts, select  next to each account you want to delete. Then select  and confirm with OK.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a User Account</li> <li>Lock a User Account</li> <li>Export a List of User Accounts</li> <li>Manage User Accounts</li> <li>Add or Remove an Existing User Account from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/export-list-user-accounts/", "title": "Export a List of User Accounts", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/export-list-user-accounts/#export-a-list-of-user-accounts", "title": "Export a List of User Accounts", "text": "<p>This topic provides step-by-step instructions for exporting a list of user accounts in TheHive.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/export-list-user-accounts/#export-a-list-of-user-accounts-at-the-client-level", "title": "Export a list of user accounts at the client level", "text": "<p><code>[admin] manageUser</code></p> <ol> <li> <p>Go to the Users view from the sidebar menu.</p> <p></p> </li> <li> <p>Select Export list to export all displayed user accounts, reflecting the applied filters and sorting. To export a specific selection of user accounts, select  next to the user accounts you want to export, then select Export selection.</p> <p></p> </li> <li> <p>In the Export users to file drawer, select your preferred formatting options.</p> </li> <li> <p>Select Export to file.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/export-list-user-accounts/#export-a-list-of-user-accounts-for-an-organization", "title": "Export a list of user accounts for an organizationNext steps", "text": "<p><code>manageUser</code></p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Users tab.</p> <p></p> </li> <li> <p>Select Export list to export all displayed user accounts, reflecting the applied filters and sorting. To export a specific selection of user accounts, select  next to the user accounts you want to export, then select Export selection.</p> <p></p> </li> <li> <p>In the Export users to file drawer, select your preferred formatting options.</p> </li> <li> <p>Select Export to file.</p> </li> </ol> <ul> <li>Create a User Account</li> <li>Delete a User Account</li> <li>Lock a User Account</li> <li>Manage User Accounts</li> <li>Add or Remove an Existing User Account from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/lock-a-user-account/", "title": "Lock a User Account", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/lock-a-user-account/#lock-a-user-account", "title": "Lock a User Account", "text": "<p>This topic provides step-by-step instructions for locking a user account in TheHive.</p> <p>To permanently delete a user account, see Delete a User Account.</p> <p>To remove a user account from a specific organization without deleting it, see Add or Remove an Existing User Account to an Organization.</p> Procedure"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/lock-a-user-account/#as-an-administrator", "title": "As an administrator", "text": "<p><code>[admin] manageUser</code></p> <ol> <li> <p>Go to the Users view from the sidebar menu.</p> <p></p> </li> <li> <p>Select  next to the user account you want to lock.</p> <p>Can't find a user account?</p> <p>You can apply filters and sorting to help locate user accounts. These preferences can be saved using views.</p> </li> <li> <p>Select Lock.</p> <p>Lock multiple user accounts in bulk</p> <p>To lock multiple user accounts, select  next to each account you want to lock. Then select  and confirm with OK.</p> </li> <li> <p>Select OK.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/lock-a-user-account/#as-an-organization-administrator", "title": "As an organization administrator", "text": "<p><code>manageUser</code></p> <p>Lock applies to all organizations</p> <p>Locking a user account from one organization locks it across all organizations.</p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Users tab.</p> <p></p> </li> <li> <p>Select  next to the user account you want to lock.</p> </li> <li> <p>Select Lock.</p> <p>Lock multiple user accounts in bulk</p> <p>To lock multiple user accounts, select  next to each account you want to lock. Then select  and confirm with OK.</p> </li> <li> <p>Select OK.</p> </li> </ol> Next steps <ul> <li>Create a User Account</li> <li>Delete a User Account</li> <li>Export a List of User Accounts</li> <li>Manage User Accounts</li> <li>Add or Remove an Existing User Account from an Organization</li> </ul>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/", "title": "Manage User Accounts", "text": ""}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#manage-user-accounts", "title": "Manage User Accounts", "text": "<p>This topic provides step-by-step instructions for managing user accounts in TheHive.</p> As an administratorAs an organization administrator <p><code>[admin] manageUser</code></p> <ol> <li> <p>Go to the Users view from the sidebar menu.</p> <p></p> </li> <li> <p>Locate the user account you're looking for, hover over it, and select .</p> <p>Can't find a user account?</p> <p>You can apply filters and sorting to help locate user accounts. These preferences can be saved using views.</p> </li> </ol> <p><code>manageUser</code></p> <ol> <li> <p>Go to the Organization view from the sidebar menu.</p> <p></p> </li> <li> <p>Select the Users tab.</p> <p></p> </li> <li> <p>Locate the user account you're looking for, hover over it, and select .</p> <p>Can't find a user account?</p> <p>You can apply filters and sorting to help locate user accounts. These preferences can be saved using views.</p> </li> </ol>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#manage-a-user-account-email", "title": "Manage a user account email", "text": "<p>Use this field when the login isn\u2019t an email address or when you want to set a different email. The email address is used to send notifications and password-related information to the user.</p> <p>Update the email address and select Confirm.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#edit-a-user-account-avatar", "title": "Edit a user account avatar", "text": "<p>Select the avatar, then select a new image in PNG or JPG format. The file must be smaller than 500 KB. Select Confirm to apply the change.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#check-whether-a-user-account-has-activated-multi-factor-authentication", "title": "Check whether a user account has activated multi-factor authentication", "text": "<p>Move through the MFA section. If the user has activated multi-factor authentication, Yes appears.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#edit-a-user-account-permission-profile", "title": "Edit a user account permission profile", "text": "<p>Move through the Organizations section and update the permission profile for the relevant organizations. Select Confirm to apply the change.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#manage-a-user-account-api-key", "title": "Manage a user account API key", "text": "<p>Move through the API key section and select Renew, Reveal, or Revoke, depending on the action you want to take. Select Confirm to apply the change.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#delete-a-user-account-session", "title": "Delete a user account session", "text": "<p>Move through the Sessions section and select Delete next to the session you want to delete. This logs the user out of the TheHive interface.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#edit-a-user-account-password", "title": "Edit a user account password", "text": "<p>The password edit feature is available only if an SMTP server is configured.</p> <p>Move through the Password section and select Edit password. Select Confirm to apply the change. You must send the new password to the user via a secure channel.</p>"}, {"location": "thehive/user-guides/organization/configure-organization/manage-user-accounts/manage-user-accounts/#reset-a-user-account-password", "title": "Reset a user account passwordNext steps", "text": "<p>The password reset feature is available only if an SMTP server is configured.</p> <p>Move through the Password section and select Reset password. The user gets an email asking them to choose a new password. The link is only valid for a limited time.</p> <ul> <li>Create a User Account</li> <li>Delete a User Account</li> <li>Lock a User Account</li> <li>Export a List of User Accounts</li> <li>Add or Remove an Existing User Account from an Organization</li> </ul>"}]}