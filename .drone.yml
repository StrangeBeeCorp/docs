---
kind: pipeline
type: docker
name: build

steps:
  - name: build
    image: squidfunk/mkdocs-material:latest
    volumes:
    - name: site
      path: /site
    commands:
    - pip install -U -r ./requirements.txt
    - mkdocs build

  # Publish install scripts on archives.strangebee.com
  - name: upload scripts to archives.strangebee.com
    image: appleboy/drone-scp
    settings:
      host: {from_secret: package_host}
      username: {from_secret: package_user}
      key: {from_secret: package_key}
      target: {from_secret: catalog_path}
      source:
        - docs/thehive/setup/installation/assets/install-deb.sh
        - docs/thehive/setup/installation/assets/install-rpm.sh
      strip_components: 5
    when:
      event: [tag, cron, custom, promote]
      