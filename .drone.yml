---
kind: pipeline
type: docker
name: build

steps:
  - name: build
    image: squidfunk/mkdocs-material:latest
    volumes:
    - name: site
      path: /site
    commands:
    - pip install -U -r ./requirements.txt
    - mkdocs build

  # Publish packages to lab web server
  - name: publish docs in lab
    image: appleboy/drone-scp
    settings:      
      host: 
        from_secret: lab_ssh_host
      port: 22
      username: 
        from_secret: lab_ssh_username
      password: 
        from_secret: lab_ssh_password
      target: /var/www/docs
      source: site/*
      strip_components: 1

# references
# https://blog.ktz.me/deploying-mkdocs-using-droneci/